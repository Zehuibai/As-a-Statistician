[
["proc-sqplot.html", "Chapter 8 Proc Sqplot 8.1 ODS 8.2 Introduction 8.3 Scatter Plot 8.4 Bar chart 8.5 Histogram", " Chapter 8 Proc Sqplot 8.1 ODS ODS LISTING GPATH=&quot;/home/zehuibai24885190/Bai-Statistische Praogrammierung/02_Scatter&quot;; ODS LISTING style=HTMLBlue; ODS GRAPHICS ON / RESET=ALL WIDTH =12.0 IN HEIGHT=8.4 IN OUTPUTFMT=PNG IMAGEMAP=on IMAGENAME=&quot;FEV_obs&quot; RESET=INDEX BORDER=off; PROC SGPLOT DATA=bai; SCATTER x=time y=FEV / GROUP=treatment; TITLE &quot;Observed FEV values&quot;; RUN; QUIT; ODS GRAPHICS OFF; 8.2 Introduction hbar category-var/options; /* 水平柱状图 */ vbar category-var/options; /* 垂直柱状图 */ hline category-var/options; /* 水平线图 */ vline category-var/options; /* 垂直线图 */ dot category-var/options; /* 点图 */ Xaxis/Yaxis 设置坐标轴 Grid 生成网格线 Label=‘---’ 设置坐标轴标记文字 Type=axistype 坐标轴的类型（axistype：字符变量默认discrete 数值变量默认linear；日期默认time） Values=（ ） 设置刻度标记 z.B values=(0 5 10 15 20)等同于 values=(0 to 20 by 5) Refline values/options; 设置基准线 Axis=X 或者 Y 默认Y-竖直划线 Transparency=n 设置透明度【1.1】默认0.8 8.3 Scatter Plot 8.3.1 Vector in scatter Plot *** calculate mean vector; data VENUS_F8_2_3_6_D04; length label_SIA label_TIA label_DV $100.; set VENUS_F8_2_3_6_D03; by RD_IOL_TYP visit; if first.visit then do; *** SIA; tot_X13 = 0; tot_Y13 = 0; SIA_Index = 0; *** TIA; tot_X12 = 0; tot_Y12 = 0; TIA_Index = 0; *** DV; tot_X32 = 0; tot_Y32 = 0; DV_Index = 0; end; *** SIA; tot_X13 + X13; tot_Y13 + Y13; SIA_Index + 1; *** TIA; tot_X12 + X12; tot_Y12 + Y12; TIA_Index + 1; *** DV; tot_X32 + X32; tot_Y32 + Y32; DV_Index + 1; if last.visit then do; mean_X13 = tot_X13 / SIA_Index; mean_Y13 = tot_Y13 / SIA_Index; mean_X12 = tot_X12 / TIA_Index; mean_Y12 = tot_Y12 / TIA_Index; mean_X32 = tot_X32 / DV_Index; mean_Y32 = tot_Y32 / DV_Index; end; if mean_X13 ne . then label_SIA = &quot;mean(SIA) = &quot;||&quot;(&quot;||strip(put(round(mean_X13,0.01),5.2))||&quot;, &quot;||strip(put(round(mean_Y13,0.01),5.2))||&quot;)&quot;; if mean_X12 ne . then label_TIA = &quot;mean(TIA) = &quot;||&quot;(&quot;||strip(put(round(mean_X12,0.01),5.2))||&quot;, &quot;||strip(put(round(mean_Y12,0.01),5.2))||&quot;)&quot;; if mean_X32 ne . then label_DV = &quot;mean(DV) = &quot;||&quot;(&quot;||strip(put(round(mean_X32,0.01),5.2))||&quot;, &quot;||strip(put(round(mean_Y32,0.01),5.2))||&quot;)&quot;; drop tot_X13 tot_Y13 SIA_Index tot_X12 tot_Y12 TIA_Index tot_X32 tot_Y32 DV_Index; run; *** Head number; *** Visit 5 1 month; data _NULL_; set VENUS_F8_2_3_6_D03 (where=(RD_IOL_TYP eq 1 and Visit eq 5)) end=eof; if eof then call symputx(&#39;num_ITT_LARA_5&#39;,_N_); run; data _NULL_; set VENUS_F8_2_3_6_D03 (where=(RD_IOL_TYP eq 2 and Visit eq 5)) end=eof; if eof then call symputx(&#39;num_ITT_TECN_5&#39;,_N_); run; *** Visit 6 4-6 months; data _NULL_; set VENUS_F8_2_3_6_D03 (where=(RD_IOL_TYP eq 1 and Visit eq 6)) end=eof; if eof then call symputx(&#39;num_ITT_LARA_6&#39;,_N_); run; data _NULL_; set VENUS_F8_2_3_6_D03 (where=(RD_IOL_TYP eq 2 and Visit eq 6)) end=eof; if eof then call symputx(&#39;num_ITT_TECN_6&#39;,_N_); run; *** Check macro variable; %put &amp;num_ITT_LARA_5; %put &amp;num_ITT_TECN_5; %put &amp;num_ITT_LARA_6; %put &amp;num_ITT_TECN_6; *** graphic formats; proc format; value category_a 1 = &quot;AT LARA toric 929MP (N = &amp;num_ITT_LARA_5)&quot; 2 = &quot;TECNIS Symfony toric (N = &amp;num_ITT_TECN_5)&quot;; value category_b 1 = &quot;AT LARA toric 929MP (N = &amp;num_ITT_LARA_6)&quot; 2 = &quot;TECNIS Symfony toric (N = &amp;num_ITT_TECN_6)&quot;; run; *** Report; ods proclabel=&quot;Figure 8.2.3.6.1: Vector analysis (SIA)&quot;; options orientation = landscape; ods tagsets.rtf file=&quot;Z:\\STUDIES\\ZEISS\\VENUS\\WORKSPACE\\07_STATISTIC\\04_Statistical_Analysis\\01_Final\\02_Output\\02_Figures\\VENUS_F8_2_3_6_1_VectorSIA_fin_D01_0_0.rtf&quot; style=gcpservice_style; ods escapechar=&quot;^&quot;; ods exclude none; option nobyline; *** Graphical output; ods graphics on; ods graphics / height=13cm width=25cm border=off; *** SIA: X13 Y13; *** M1; ods text = &#39;^S={width=100%}Figure 8.2.3.6.1:^R/RTF&quot;\\tab&quot; Performance and safety data ^n^R/RTF&quot;\\tab\\tab\\tab&quot; Other secondary endpoint ^n^R/RTF&quot;\\tab\\tab\\tab&quot; Vector analysis (SIA) ^n^nAnalysis set: SES, Level: Eye, Visit: Postoperative 1 month&#39;; proc sgplot data=Venus_f8_2_3_6_d04_m1 /*sganno=class_annotations NOAUTOLEGEND*/; styleattrs datasymbols=(circlefilled squarefilled); scatter x=X13 y=Y13 /group=RD_IOL_TYP groupdisplay=cluster markerattrs=(size=5px); vector y=mean_Y13 x=mean_X13 / group=RD_IOL_TYP nomissinggroup datalabel=label_sia arrowheadshape=filled; xaxis label = &#39;X (SIA)&#39;; yaxis label = &#39;Y (SIA)&#39;; keylegend / location=outside position=bottom across=2; format RD_IOL_TYP category_a.; run; ods text = &quot;^R/RTF&#39;\\ql&#39; Output generated by program &amp;this_prog.&quot;; ods startpage= now; footnote; title; ods graphics off; ods exclude all; ods tagsets.rtf close; ods _all_ close; 8.3.2 增加预测曲线 proc sgplot data=a; scatter x=petallength y=petalwidth; ellipse x=petallength y=petalwidth; keylegend / location=inside position=bottomright; run; 8.3.3 分组 proc sgplot; scatter x=groesse Y=gewicht/group=sex markerattrs=(size=12 symbol=circlefilled); /* group进行分组最后会出现两条图 symbol=circlefilled 表示填充的点点形状 reg x=groesse y=gewicht/group=sex; format sex sex.; run; proc sgplot data=Sashelp.Iris; /* BY-group visualization. Three independent graphs. */ by Species; histogram SepalLength; density SepalLength / type=kernel; run; proc sgpanel data=Sashelp.Iris; /* Panel visualization. Shared common axis. */ panelby Species / columns=1 onepanel; histogram SepalLength; density SepalLength / type=kernel; run; proc sgplot data=Sashelp.Iris; /* Overlay three plots in one graph */ histogram SepalLength / GROUP=Species binstart=42 binwidth=3 transparency=0.5; density SepalLength / type=kernel GROUP=Species; run; 8.4 Bar chart 8.4.1 Group and using freq *** Convert wide dataset to long dataset; proc transpose data=VENUS_F8_2_3_4_D05_&amp;var. out=VENUS_F8_2_3_4_D05_&amp;var.t; by analysis_set visit RD_IOL_TYP subject_id eye; var CAT0-CAT7; run; *** Get values for proc sgplot; proc sort data=VENUS_F8_2_3_4_D05_&amp;var.t; by Analysis_set visit RD_IOL_TYP _NAME_; run; proc means data=VENUS_F8_2_3_4_D05_&amp;var.t stackodsoutput n nmiss maxdec=3 completetypes missing order=data ; var COL1; class Analysis_set visit RD_IOL_TYP _NAME_; ods output summary = VENUS_F8_2_3_4_D06_&amp;var.; run; data VENUS_F8_2_3_4_D06_&amp;var.; label pct=&#39;Percent&#39;; format _NAME_ $CAT_Snell_Name. pct percent.; set VENUS_F8_2_3_4_D06_&amp;var.; by Analysis_set visit RD_IOL_TYP _NAME_; p = (divide (N,Nobs))*100; if visit in (1,5,6); if Analysis_Set=&quot;ITT&quot;; pct = p/100; keep _NAME_ RD_IOL_TYP visit pct; run; *** Sort data transpose p; proc sort data = VENUS_F8_2_3_4_D06_&amp;var.;by RD_IOL_TYP _NAME_;;run; Proc transpose data=VENUS_F8_2_3_4_D06_&amp;var. out=VENUS_F8_2_3_4_D07_&amp;var.; var pct; ID visit; by RD_IOL_TYP _NAME_; run; *** Legend numbers; *** Preoperative Visit; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 1 and Visit eq 1)) end=eof; if eof then call symputx(&#39;num_ITT_LARA_1&#39;,_N_/8); run; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 2 and Visit eq 1)) end=eof; if eof then call symputx(&#39;num_ITT_TECN_1&#39;,_N_/8); run; *** Visit 5 1 month; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 1 and Visit eq 5)) end=eof; if eof then call symputx(&#39;num_ITT_LARA_5&#39;,_N_/8); run; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 2 and Visit eq 5)) end=eof; if eof then call symputx(&#39;num_ITT_TECN_5&#39;,_N_/8); run; *** Visit 6 4-6 months; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 1 and Visit eq 6)) end=eof; if eof then call symputx(&#39;num_ITT_LARA_6&#39;,_N_/8); run; data _NULL_; set VENUS_F8_2_3_4_D05_&amp;var.t (where=(Analysis_set eq &quot;ITT&quot; and RD_IOL_TYP eq 2 and Visit eq 6)) end=eof; if eof then call symputx(&#39;num_ITT_TECN_6&#39;,_N_/8); run; *** Check macro variable; %put &amp;num_ITT_LARA_1; %put &amp;num_ITT_TECN_1; *** graphic formats; proc format; value category_a 1 = &quot;AT LARA toric 929MP (N = &amp;num_ITT_LARA_1)&quot; 2 = &quot;TECNIS Symfony toric (N = &amp;num_ITT_TECN_1)&quot;; value category_b 1 = &quot;AT LARA toric 929MP (N = &amp;num_ITT_LARA_5)&quot; 2 = &quot;TECNIS Symfony toric (N = &amp;num_ITT_TECN_5)&quot;; value category_c 1 = &quot;AT LARA toric 929MP (N = &amp;num_ITT_LARA_6)&quot; 2 = &quot;TECNIS Symfony toric (N = &amp;num_ITT_TECN_6)&quot;; run; ods proclabel=&quot;Figure 8.2.3.4.9: Categorization of differences in monocular preoperative uncorrected distance visual acuity (UDVA) and 1-2-month as well as 4-6-month postoperative best corrected distance visual acuity (CDVA)&quot;; options orientation = landscape; ods tagsets.rtf file=&quot;Z:\\STUDIES\\ZEISS\\VENUS\\WORKSPACE\\07_STATISTIC\\04_Statistical_Analysis\\01_Final\\02_Output\\02_Figures\\VENUS_F8_2_3_4_9_DVAcat_fin_D01_0_0.rtf&quot; style=gcpservice_style; ods escapechar=&quot;^&quot;; ods exclude none; *** Graphical output; ods graphics on; ods graphics / height=13cm width=25cm border=off; *** Postoperative 4-6 months; ods text = &#39;^S={width=100%}Figure 8.2.3.4.9:^R/RTF&quot;\\tab&quot; Other secondary endpoint ^n^R/RTF&quot;\\tab\\tab\\tab&quot; Visual acuity assessments ^n^R/RTF&quot;\\tab\\tab\\tab&quot; Categorization of differences in monocular preoperative uncorrected distance visual acuity (UDVA) and 1-2-month as well as 4-6-month postoperative best corrected distance visual acuity (CDVA) ^n^nAnalysis set: mITT, Visit: Postoperative 4-6 months&#39;; proc sgplot data=VENUS_F8_2_3_4_D07_&amp;var. pad=(bottom=5%); vbar _NAME_ / group=RD_IOL_TYP groupdisplay=cluster barwidth = 1 response=M4_6 stat=sum datalabel GROUPORDER=DATA; xaxis display=(nolabel) valueattrs=(size=10pt) offsetmin=0.1 offsetmax=0.1 ; yaxis label=&#39;Percentage [%]&#39; max = 1; keylegend / location=outside position=bottom across=2; format RD_IOL_TYP category_c.; run; ods text = &quot;^R/RTF&#39;\\ql&#39; Output generated by program &amp;this_prog.&quot;; ods startpage= now; footnote; title; ods graphics off; ods exclude all; ods tagsets.rtf close; ods _all_ close; 8.5 Histogram proc sgplot data=Sashelp.Iris; /* BY-group visualization. Three independent graphs. */ by Species; histogram SepalLength; density SepalLength / type=kernel; run; proc sgpanel data=Sashelp.Iris; /* Panel visualization. Shared common axis. */ panelby Species / columns=1 onepanel; histogram SepalLength; density SepalLength / type=kernel; run; proc sgplot data=Sashelp.Iris; /* Overlay three plots in one graph */ histogram SepalLength / GROUP=Species binstart=42 binwidth=3 transparency=0.5; density SepalLength / type=kernel GROUP=Species; run; "]
]
