<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 ggplot2 | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 ggplot2 | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 ggplot2 | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2021-05-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="space.html"/>
<link rel="next" href="proc-sqplot.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="input-and-format.html"><a href="input-and-format.html"><i class="fa fa-check"></i><b>2</b> Input and Format</a>
<ul>
<li class="chapter" data-level="2.1" data-path="input-and-format.html"><a href="input-and-format.html#import-in-sas"><i class="fa fa-check"></i><b>2.1</b> Import in SAS</a></li>
<li class="chapter" data-level="2.2" data-path="input-and-format.html"><a href="input-and-format.html#import-in-r"><i class="fa fa-check"></i><b>2.2</b> Import in R</a></li>
<li class="chapter" data-level="2.3" data-path="input-and-format.html"><a href="input-and-format.html#package-readr"><i class="fa fa-check"></i><b>2.3</b> Package readr</a></li>
<li class="chapter" data-level="2.4" data-path="input-and-format.html"><a href="input-and-format.html#package-strings"><i class="fa fa-check"></i><b>2.4</b> Package Strings</a></li>
<li class="chapter" data-level="2.5" data-path="input-and-format.html"><a href="input-and-format.html#package-forcats"><i class="fa fa-check"></i><b>2.5</b> Package forcats</a></li>
<li class="chapter" data-level="2.6" data-path="input-and-format.html"><a href="input-and-format.html#package-lubridate"><i class="fa fa-check"></i><b>2.6</b> Package lubridate</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html"><i class="fa fa-check"></i><b>3</b> Data Management in SAS</a></li>
<li class="chapter" data-level="4" data-path="data-management-in-r.html"><a href="data-management-in-r.html"><i class="fa fa-check"></i><b>4</b> Data Management in R</a></li>
<li class="chapter" data-level="5" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>5</b> SQL</a></li>
<li class="chapter" data-level="6" data-path="space.html"><a href="space.html"><i class="fa fa-check"></i><b>6</b> ^_^ Space</a></li>
<li class="chapter" data-level="7" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>7</b> ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ggplot2.html"><a href="ggplot2.html#parametric-rendering"><i class="fa fa-check"></i><b>7.1</b> Parametric Rendering</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ggplot2.html"><a href="ggplot2.html#grammar"><i class="fa fa-check"></i><b>7.1.1</b> Grammar</a></li>
<li class="chapter" data-level="7.1.2" data-path="ggplot2.html"><a href="ggplot2.html#coord"><i class="fa fa-check"></i><b>7.1.2</b> coord</a></li>
<li class="chapter" data-level="7.1.3" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>7.1.3</b> facet</a></li>
<li class="chapter" data-level="7.1.4" data-path="ggplot2.html"><a href="ggplot2.html#geom"><i class="fa fa-check"></i><b>7.1.4</b> geom</a></li>
<li class="chapter" data-level="7.1.5" data-path="ggplot2.html"><a href="ggplot2.html#position"><i class="fa fa-check"></i><b>7.1.5</b> position</a></li>
<li class="chapter" data-level="7.1.6" data-path="ggplot2.html"><a href="ggplot2.html#scale"><i class="fa fa-check"></i><b>7.1.6</b> scale</a></li>
<li class="chapter" data-level="7.1.7" data-path="ggplot2.html"><a href="ggplot2.html#stat"><i class="fa fa-check"></i><b>7.1.7</b> stat</a></li>
<li class="chapter" data-level="7.1.8" data-path="ggplot2.html"><a href="ggplot2.html#color"><i class="fa fa-check"></i><b>7.1.8</b> Color</a></li>
<li class="chapter" data-level="7.1.9" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>7.1.9</b> Thema</a></li>
<li class="chapter" data-level="7.1.10" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>7.1.10</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ggplot2.html"><a href="ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>7.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ggplot2.html"><a href="ggplot2.html#grouping-aesthetic"><i class="fa fa-check"></i><b>7.2.1</b> Grouping Aesthetic</a></li>
<li class="chapter" data-level="7.2.2" data-path="ggplot2.html"><a href="ggplot2.html#facet-1"><i class="fa fa-check"></i><b>7.2.2</b> facet</a></li>
<li class="chapter" data-level="7.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_smooth"><i class="fa fa-check"></i><b>7.2.3</b> geom_smooth</a></li>
<li class="chapter" data-level="7.2.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-plot"><i class="fa fa-check"></i><b>7.2.4</b> Dot Plot</a></li>
<li class="chapter" data-level="7.2.5" data-path="ggplot2.html"><a href="ggplot2.html#label-and-title"><i class="fa fa-check"></i><b>7.2.5</b> Label and Title</a></li>
<li class="chapter" data-level="7.2.6" data-path="ggplot2.html"><a href="ggplot2.html#residuals"><i class="fa fa-check"></i><b>7.2.6</b> Residuals</a></li>
<li class="chapter" data-level="7.2.7" data-path="ggplot2.html"><a href="ggplot2.html#encircling"><i class="fa fa-check"></i><b>7.2.7</b> Encircling</a></li>
<li class="chapter" data-level="7.2.8" data-path="ggplot2.html"><a href="ggplot2.html#dumbbell-plot"><i class="fa fa-check"></i><b>7.2.8</b> Dumbbell Plot</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>7.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ggplot2.html"><a href="ggplot2.html#general-appearance"><i class="fa fa-check"></i><b>7.3.1</b> General appearance</a></li>
<li class="chapter" data-level="7.3.2" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>7.3.2</b> Themes</a></li>
<li class="chapter" data-level="7.3.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_freqpoly"><i class="fa fa-check"></i><b>7.3.3</b> geom_freqpoly()</a></li>
<li class="chapter" data-level="7.3.4" data-path="ggplot2.html"><a href="ggplot2.html#marginal-histogram-boxplot"><i class="fa fa-check"></i><b>7.3.4</b> Marginal Histogram / Boxplot</a></li>
<li class="chapter" data-level="7.3.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>7.3.5</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>7.4</b> Bar plot</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic"><i class="fa fa-check"></i><b>7.4.1</b> Aesthetic</a></li>
<li class="chapter" data-level="7.4.2" data-path="ggplot2.html"><a href="ggplot2.html#proportion"><i class="fa fa-check"></i><b>7.4.2</b> Proportion</a></li>
<li class="chapter" data-level="7.4.3" data-path="ggplot2.html"><a href="ggplot2.html#statidentity"><i class="fa fa-check"></i><b>7.4.3</b> stat=“identity”</a></li>
<li class="chapter" data-level="7.4.4" data-path="ggplot2.html"><a href="ggplot2.html#ranking"><i class="fa fa-check"></i><b>7.4.4</b> Ranking</a></li>
<li class="chapter" data-level="7.4.5" data-path="ggplot2.html"><a href="ggplot2.html#means-and-error-bars"><i class="fa fa-check"></i><b>7.4.5</b> Means and error bars</a></li>
<li class="chapter" data-level="7.4.6" data-path="ggplot2.html"><a href="ggplot2.html#waffle-chart"><i class="fa fa-check"></i><b>7.4.6</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ggplot2.html"><a href="ggplot2.html#box-plot"><i class="fa fa-check"></i><b>7.5</b> Box plot</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ggplot2.html"><a href="ggplot2.html#varwidth"><i class="fa fa-check"></i><b>7.5.1</b> varwidth</a></li>
<li class="chapter" data-level="7.5.2" data-path="ggplot2.html"><a href="ggplot2.html#fill"><i class="fa fa-check"></i><b>7.5.2</b> Fill</a></li>
<li class="chapter" data-level="7.5.3" data-path="ggplot2.html"><a href="ggplot2.html#statidentity-1"><i class="fa fa-check"></i><b>7.5.3</b> stat=“identity”</a></li>
<li class="chapter" data-level="7.5.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-box-plot"><i class="fa fa-check"></i><b>7.5.4</b> Dot + Box Plot</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ggplot2.html"><a href="ggplot2.html#other-rendering"><i class="fa fa-check"></i><b>7.6</b> Other rendering</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i><b>7.6.1</b> Annotation</a></li>
<li class="chapter" data-level="7.6.2" data-path="ggplot2.html"><a href="ggplot2.html#text-ggtext"><i class="fa fa-check"></i><b>7.6.2</b> Text: ggtext</a></li>
<li class="chapter" data-level="7.6.3" data-path="ggplot2.html"><a href="ggplot2.html#text-ggrepel"><i class="fa fa-check"></i><b>7.6.3</b> Text: ggrepel</a></li>
<li class="chapter" data-level="7.6.4" data-path="ggplot2.html"><a href="ggplot2.html#arrage-gridextra"><i class="fa fa-check"></i><b>7.6.4</b> Arrage: gridExtra</a></li>
<li class="chapter" data-level="7.6.5" data-path="ggplot2.html"><a href="ggplot2.html#interactive-charts-plotly"><i class="fa fa-check"></i><b>7.6.5</b> Interactive charts: plotly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="proc-sqplot.html"><a href="proc-sqplot.html"><i class="fa fa-check"></i><b>8</b> Proc Sqplot</a>
<ul>
<li class="chapter" data-level="8.1" data-path="proc-sqplot.html"><a href="proc-sqplot.html#ods"><i class="fa fa-check"></i><b>8.1</b> ODS</a></li>
<li class="chapter" data-level="8.2" data-path="proc-sqplot.html"><a href="proc-sqplot.html#introduction-1"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="proc-sqplot.html"><a href="proc-sqplot.html#scatter-plot-1"><i class="fa fa-check"></i><b>8.3</b> Scatter Plot</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="proc-sqplot.html"><a href="proc-sqplot.html#vector-in-scatter-plot"><i class="fa fa-check"></i><b>8.3.1</b> Vector in scatter Plot</a></li>
<li class="chapter" data-level="8.3.2" data-path="proc-sqplot.html"><a href="proc-sqplot.html#增加预测曲线"><i class="fa fa-check"></i><b>8.3.2</b> 增加预测曲线</a></li>
<li class="chapter" data-level="8.3.3" data-path="proc-sqplot.html"><a href="proc-sqplot.html#分组"><i class="fa fa-check"></i><b>8.3.3</b> 分组</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="proc-sqplot.html"><a href="proc-sqplot.html#bar-chart"><i class="fa fa-check"></i><b>8.4</b> Bar chart</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="proc-sqplot.html"><a href="proc-sqplot.html#group-and-using-freq"><i class="fa fa-check"></i><b>8.4.1</b> Group and using freq</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="proc-sqplot.html"><a href="proc-sqplot.html#histogram-1"><i class="fa fa-check"></i><b>8.5</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="space-1.html"><a href="space-1.html"><i class="fa fa-check"></i><b>9</b> ^_^ Space</a></li>
<li class="chapter" data-level="10" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html"><i class="fa fa-check"></i><b>10</b> Descriptive Statistics in SAS</a>
<ul>
<li class="chapter" data-level="10.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-freq"><i class="fa fa-check"></i><b>10.1</b> Proc Freq</a></li>
<li class="chapter" data-level="10.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-means"><i class="fa fa-check"></i><b>10.2</b> Proc Means</a></li>
<li class="chapter" data-level="10.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-tabulatte"><i class="fa fa-check"></i><b>10.3</b> Proc Tabulatte</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>11</b> Descriptive Statistics in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-pape"><i class="fa fa-check"></i><b>11.1</b> Package pape</a></li>
<li class="chapter" data-level="11.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-summarytools"><i class="fa fa-check"></i><b>11.2</b> Package summarytools</a></li>
<li class="chapter" data-level="11.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-comparegroups"><i class="fa fa-check"></i><b>11.3</b> Package compareGroups</a></li>
<li class="chapter" data-level="11.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-kableextra"><i class="fa fa-check"></i><b>11.4</b> Package kableExtra</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#kable_styling"><i class="fa fa-check"></i><b>11.4.1</b> kable_styling</a></li>
<li class="chapter" data-level="11.4.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#columnrow-specification"><i class="fa fa-check"></i><b>11.4.2</b> Column/Row Specification</a></li>
<li class="chapter" data-level="11.4.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#grouping-columnsrows"><i class="fa fa-check"></i><b>11.4.3</b> Grouping columns/rows</a></li>
<li class="chapter" data-level="11.4.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#add-footnote"><i class="fa fa-check"></i><b>11.4.4</b> Add Footnote</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html"><i class="fa fa-check"></i><b>12</b> CI and Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#distribution"><i class="fa fa-check"></i><b>12.1</b> Distribution</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#quantile-function-in-sas"><i class="fa fa-check"></i><b>12.1.1</b> Quantile Function in SAS</a></li>
<li class="chapter" data-level="12.1.2" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#binomial-distribution"><i class="fa fa-check"></i><b>12.1.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="12.1.3" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>12.1.3</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="12.1.4" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#multinomial-distribution"><i class="fa fa-check"></i><b>12.1.4</b> Multinomial distribution</a></li>
<li class="chapter" data-level="12.1.5" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#normal-distribution"><i class="fa fa-check"></i><b>12.1.5</b> Normal Distribution</a></li>
<li class="chapter" data-level="12.1.6" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>12.1.6</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="12.1.7" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#poisson-distribution"><i class="fa fa-check"></i><b>12.1.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="12.1.8" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#exponential-distribution"><i class="fa fa-check"></i><b>12.1.8</b> Exponential distribution</a></li>
<li class="chapter" data-level="12.1.9" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#gamma-distribution"><i class="fa fa-check"></i><b>12.1.9</b> Gamma distribution</a></li>
<li class="chapter" data-level="12.1.10" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#weibull-distribution"><i class="fa fa-check"></i><b>12.1.10</b> Weibull Distribution</a></li>
<li class="chapter" data-level="12.1.11" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#beta-distribution"><i class="fa fa-check"></i><b>12.1.11</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#point-estimates"><i class="fa fa-check"></i><b>12.2</b> Point Estimates</a></li>
<li class="chapter" data-level="12.3" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#binomial-ci"><i class="fa fa-check"></i><b>12.3</b> Binomial CI</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#binomial-ci-for-small-samples"><i class="fa fa-check"></i><b>12.3.1</b> Binomial CI for Small Samples</a></li>
<li class="chapter" data-level="12.3.2" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#package-binom"><i class="fa fa-check"></i><b>12.3.2</b> Package binom</a></li>
<li class="chapter" data-level="12.3.3" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#ci_single_proportion"><i class="fa fa-check"></i><b>12.3.3</b> %CI_Single_Proportion</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#incidence-rate-ci"><i class="fa fa-check"></i><b>12.4</b> Incidence rate CI</a></li>
<li class="chapter" data-level="12.5" data-path="ci-and-sample-size-calculation.html"><a href="ci-and-sample-size-calculation.html#package-pwr"><i class="fa fa-check"></i><b>12.5</b> Package: pwr</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="parametric-test.html"><a href="parametric-test.html"><i class="fa fa-check"></i><b>13</b> Parametric Test</a>
<ul>
<li class="chapter" data-level="13.1" data-path="parametric-test.html"><a href="parametric-test.html#proc-freq-1"><i class="fa fa-check"></i><b>13.1</b> Proc FREQ</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="parametric-test.html"><a href="parametric-test.html#ods-table-names"><i class="fa fa-check"></i><b>13.1.1</b> ODS Table Names</a></li>
<li class="chapter" data-level="13.1.2" data-path="parametric-test.html"><a href="parametric-test.html#ods-plots"><i class="fa fa-check"></i><b>13.1.2</b> ODS Plots</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="parametric-test.html"><a href="parametric-test.html#section"><i class="fa fa-check"></i><b>13.2</b> </a></li>
<li class="chapter" data-level="13.3" data-path="parametric-test.html"><a href="parametric-test.html#binomial-test"><i class="fa fa-check"></i><b>13.3</b> Binomial test</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula"><i class="fa fa-check"></i><b>13.3.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="13.3.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation"><i class="fa fa-check"></i><b>13.3.2</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="parametric-test.html"><a href="parametric-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>13.4</b> Fisher’s Exact Test</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula-1"><i class="fa fa-check"></i><b>13.4.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="13.4.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation"><i class="fa fa-check"></i><b>13.4.2</b> SAS implementation</a></li>
<li class="chapter" data-level="13.4.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-1"><i class="fa fa-check"></i><b>13.4.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="parametric-test.html"><a href="parametric-test.html#contingency-test"><i class="fa fa-check"></i><b>13.5</b> Contingency test</a></li>
<li class="chapter" data-level="13.6" data-path="parametric-test.html"><a href="parametric-test.html#mcnemars-test"><i class="fa fa-check"></i><b>13.6</b> McNemar’s test</a></li>
<li class="chapter" data-level="13.7" data-path="parametric-test.html"><a href="parametric-test.html#cochranmantelhaenszel-test"><i class="fa fa-check"></i><b>13.7</b> Cochran–Mantel–Haenszel Test</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-2"><i class="fa fa-check"></i><b>13.7.1</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="parametric-test.html"><a href="parametric-test.html#correlation-test"><i class="fa fa-check"></i><b>13.8</b> Correlation Test</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="parametric-test.html"><a href="parametric-test.html#pearson-correlation"><i class="fa fa-check"></i><b>13.8.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="13.8.2" data-path="parametric-test.html"><a href="parametric-test.html#spearman-correlation"><i class="fa fa-check"></i><b>13.8.2</b> Spearman correlation</a></li>
<li class="chapter" data-level="13.8.3" data-path="parametric-test.html"><a href="parametric-test.html#kendall-correlation"><i class="fa fa-check"></i><b>13.8.3</b> Kendall correlation</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="parametric-test.html"><a href="parametric-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>13.9</b> Two Sample T-Test</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-1"><i class="fa fa-check"></i><b>13.9.1</b> SAS implementation</a></li>
<li class="chapter" data-level="13.9.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-3"><i class="fa fa-check"></i><b>13.9.2</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="parametric-test.html"><a href="parametric-test.html#normality-test"><i class="fa fa-check"></i><b>13.10</b> Normality test</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-2"><i class="fa fa-check"></i><b>13.10.1</b> SAS implementation</a></li>
<li class="chapter" data-level="13.10.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-4"><i class="fa fa-check"></i><b>13.10.2</b> R implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>14</b> ANOVA</a>
<ul>
<li class="chapter" data-level="14.1" data-path="anova.html"><a href="anova.html#unstructured-models"><i class="fa fa-check"></i><b>14.1</b> Unstructured Models</a></li>
<li class="chapter" data-level="14.2" data-path="anova.html"><a href="anova.html#balanced-one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>14.2</b> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="anova.html"><a href="anova.html#modeling-assumptions-and-basic-analysis"><i class="fa fa-check"></i><b>14.2.1</b> Modeling Assumptions and Basic Analysis</a></li>
<li class="chapter" data-level="14.2.2" data-path="anova.html"><a href="anova.html#parameter-estimates"><i class="fa fa-check"></i><b>14.2.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="14.2.3" data-path="anova.html"><a href="anova.html#r-implementation-5"><i class="fa fa-check"></i><b>14.2.3</b> R Implementation</a></li>
<li class="chapter" data-level="14.2.4" data-path="anova.html"><a href="anova.html#sas-implementation-3"><i class="fa fa-check"></i><b>14.2.4</b> SAS Implementation</a></li>
<li class="chapter" data-level="14.2.5" data-path="anova.html"><a href="anova.html#model-diagnosis"><i class="fa fa-check"></i><b>14.2.5</b> Model Diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="anova.html"><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>14.3</b> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="14.4" data-path="anova.html"><a href="anova.html#two-ways-anova-test"><i class="fa fa-check"></i><b>14.4</b> Two-Ways ANOVA Test</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="anova.html"><a href="anova.html#introduction-2"><i class="fa fa-check"></i><b>14.4.1</b> Introduction</a></li>
<li class="chapter" data-level="14.4.2" data-path="anova.html"><a href="anova.html#r-implementation-6"><i class="fa fa-check"></i><b>14.4.2</b> R implementation</a></li>
<li class="chapter" data-level="14.4.3" data-path="anova.html"><a href="anova.html#unbalanced-design"><i class="fa fa-check"></i><b>14.4.3</b> Unbalanced design</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="anova.html"><a href="anova.html#heteroscedastic-responses"><i class="fa fa-check"></i><b>14.5</b> Heteroscedastic Responses</a></li>
<li class="chapter" data-level="14.6" data-path="anova.html"><a href="anova.html#repeated-measures-anova-data"><i class="fa fa-check"></i><b>14.6</b> Repeated Measures ANOVA Data</a></li>
<li class="chapter" data-level="14.7" data-path="anova.html"><a href="anova.html#multivariate-responses-with-normally-distributed-data"><i class="fa fa-check"></i><b>14.7</b> Multivariate Responses with Normally Distributed Data</a></li>
<li class="chapter" data-level="14.8" data-path="anova.html"><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>14.8</b> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li class="chapter" data-level="14.9" data-path="anova.html"><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>14.9</b> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="multiple-comparison.html"><a href="multiple-comparison.html"><i class="fa fa-check"></i><b>15</b> Multiple-Comparison</a>
<ul>
<li class="chapter" data-level="15.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-3"><i class="fa fa-check"></i><b>15.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiplicity-problem"><i class="fa fa-check"></i><b>15.1.1</b> Multiplicity Problem</a></li>
<li class="chapter" data-level="15.1.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#error-rates"><i class="fa fa-check"></i><b>15.1.2</b> Error Rates</a></li>
<li class="chapter" data-level="15.1.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-adjusted-p"><i class="fa fa-check"></i><b>15.1.3</b> The adjusted P</a></li>
<li class="chapter" data-level="15.1.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#basic-statistical-concepts"><i class="fa fa-check"></i><b>15.1.4</b> Basic Statistical Concepts</a></li>
<li class="chapter" data-level="15.1.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#functions-in-glht-package-in-r"><i class="fa fa-check"></i><b>15.1.5</b> Functions in glht package in R</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-and-šidák-methods"><i class="fa fa-check"></i><b>15.2</b> Bonferroni and Šidák Methods</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#lsd-least-significance-difference"><i class="fa fa-check"></i><b>15.2.1</b> LSD (least significance difference)</a></li>
<li class="chapter" data-level="15.2.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák"><i class="fa fa-check"></i><b>15.2.2</b> Šidák</a></li>
<li class="chapter" data-level="15.2.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni"><i class="fa fa-check"></i><b>15.2.3</b> Bonferroni</a></li>
<li class="chapter" data-level="15.2.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot"><i class="fa fa-check"></i><b>15.2.4</b> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova"><i class="fa fa-check"></i><b>15.3</b> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#ls-means"><i class="fa fa-check"></i><b>15.3.1</b> LS-Means</a></li>
<li class="chapter" data-level="15.3.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-multivariate-t-distribution"><i class="fa fa-check"></i><b>15.3.2</b> The Multivariate t Distribution</a></li>
<li class="chapter" data-level="15.3.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha"><i class="fa fa-check"></i><b>15.3.3</b> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li class="chapter" data-level="15.3.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution"><i class="fa fa-check"></i><b>15.3.4</b> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li class="chapter" data-level="15.3.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons"><i class="fa fa-check"></i><b>15.3.5</b> Tukey’s Method for All Pairwise Comparisons</a></li>
<li class="chapter" data-level="15.3.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically"><i class="fa fa-check"></i><b>15.3.6</b> Displaying Pairwise Comparisons Graphically</a></li>
<li class="chapter" data-level="15.3.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><i class="fa fa-check"></i><b>15.3.7</b> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li class="chapter" data-level="15.3.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control"><i class="fa fa-check"></i><b>15.3.8</b> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li class="chapter" data-level="15.3.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><i class="fa fa-check"></i><b>15.3.9</b> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><i class="fa fa-check"></i><b>15.4</b> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-model-and-estimates"><i class="fa fa-check"></i><b>15.4.1</b> The Model and Estimates</a></li>
<li class="chapter" data-level="15.4.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukey-kramer-method"><i class="fa fa-check"></i><b>15.4.2</b> Tukey-Kramer Method</a></li>
<li class="chapter" data-level="15.4.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#alternative-simulation-based-method"><i class="fa fa-check"></i><b>15.4.3</b> Alternative Simulation-Based Method</a></li>
<li class="chapter" data-level="15.4.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#pairwise-comparisons-with-control"><i class="fa fa-check"></i><b>15.4.4</b> Pairwise Comparisons with Control</a></li>
<li class="chapter" data-level="15.4.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom"><i class="fa fa-check"></i><b>15.4.5</b> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>15.5</b> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation"><i class="fa fa-check"></i><b>15.5.1</b> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li class="chapter" data-level="15.5.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method"><i class="fa fa-check"></i><b>15.5.2</b> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li class="chapter" data-level="15.5.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction"><i class="fa fa-check"></i><b>15.5.3</b> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>16</b> Non-Parametric Test</a></li>
<li class="chapter" data-level="17" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>17</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation"><i class="fa fa-check"></i><b>17.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>17.1.1</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="17.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>17.1.2</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="17.1.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient"><i class="fa fa-check"></i><b>17.1.3</b> Kendall rank correlation coefficient</a></li>
<li class="chapter" data-level="17.1.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#intraclass-correlation"><i class="fa fa-check"></i><b>17.1.4</b> Intraclass correlation</a></li>
<li class="chapter" data-level="17.1.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualize-the-correlation-in-r"><i class="fa fa-check"></i><b>17.1.5</b> Visualize the correlation in R</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>17.2</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#assumpions"><i class="fa fa-check"></i><b>17.2.1</b> Assumpions</a></li>
<li class="chapter" data-level="17.2.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#interpretation"><i class="fa fa-check"></i><b>17.2.2</b> Interpretation</a></li>
<li class="chapter" data-level="17.2.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#matrix-solution"><i class="fa fa-check"></i><b>17.2.3</b> Matrix Solution</a></li>
<li class="chapter" data-level="17.2.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>17.2.4</b> Gauss-Markov Theorem</a></li>
<li class="chapter" data-level="17.2.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#limitation"><i class="fa fa-check"></i><b>17.2.5</b> limitation</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-statistics"><i class="fa fa-check"></i><b>17.3</b> Model Statistics</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#residuals-standard-error"><i class="fa fa-check"></i><b>17.3.1</b> Residuals Standard Error</a></li>
<li class="chapter" data-level="17.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>17.3.2</b> R-Squared and Adjusted R-Squared</a></li>
<li class="chapter" data-level="17.3.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#t-statistic"><i class="fa fa-check"></i><b>17.3.3</b> T Statistic</a></li>
<li class="chapter" data-level="17.3.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#f-statistic"><i class="fa fa-check"></i><b>17.3.4</b> F Statistic</a></li>
<li class="chapter" data-level="17.3.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>17.3.5</b> Confidence Intervals</a></li>
<li class="chapter" data-level="17.3.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>17.3.6</b> Likelihood-ratio test</a></li>
<li class="chapter" data-level="17.3.7" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#accuracy"><i class="fa fa-check"></i><b>17.3.7</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>17.4</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-error-assumptions"><i class="fa fa-check"></i><b>17.4.1</b> Checking Error Assumptions</a></li>
<li class="chapter" data-level="17.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#finding-unusual-observations"><i class="fa fa-check"></i><b>17.4.2</b> Finding Unusual Observations</a></li>
<li class="chapter" data-level="17.4.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-the-structure-of-the-model"><i class="fa fa-check"></i><b>17.4.3</b> Checking the Structure of the Model</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#sas-implementation-proc-reg"><i class="fa fa-check"></i><b>17.5</b> SAS implementation Proc Reg</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#options"><i class="fa fa-check"></i><b>17.5.1</b> Options</a></li>
<li class="chapter" data-level="17.5.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#diagnose"><i class="fa fa-check"></i><b>17.5.2</b> Diagnose</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-implementation-7"><i class="fa fa-check"></i><b>17.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html"><i class="fa fa-check"></i><b>18</b> Advanced Linear Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#model-selection"><i class="fa fa-check"></i><b>18.1</b> Model Selection</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-methods"><i class="fa fa-check"></i><b>18.1.1</b> Selection Methods</a></li>
<li class="chapter" data-level="18.1.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-criteria"><i class="fa fa-check"></i><b>18.1.2</b> Selection Criteria</a></li>
<li class="chapter" data-level="18.1.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#k--fold-cross-validation"><i class="fa fa-check"></i><b>18.1.3</b> k- Fold Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#practical-difficulties-using-ols"><i class="fa fa-check"></i><b>18.2</b> Practical Difficulties using OLS</a></li>
<li class="chapter" data-level="18.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#skewness"><i class="fa fa-check"></i><b>18.3</b> Skewness</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#introduction-4"><i class="fa fa-check"></i><b>18.3.1</b> Introduction</a></li>
<li class="chapter" data-level="18.3.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#baisc-transformation"><i class="fa fa-check"></i><b>18.3.2</b> Baisc Transformation</a></li>
<li class="chapter" data-level="18.3.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#box-cox-power-transformation"><i class="fa fa-check"></i><b>18.3.3</b> Box-Cox Power Transformation</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#scale-1"><i class="fa fa-check"></i><b>18.4</b> Scale</a></li>
<li class="chapter" data-level="18.5" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#interaction"><i class="fa fa-check"></i><b>18.5</b> Interaction</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>18.5.1</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="18.5.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#plotting-interactions"><i class="fa fa-check"></i><b>18.5.2</b> Plotting Interactions</a></li>
<li class="chapter" data-level="18.5.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#check-linearity-assumption"><i class="fa fa-check"></i><b>18.5.3</b> Check linearity assumption</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#collinearity"><i class="fa fa-check"></i><b>18.6</b> Collinearity</a></li>
<li class="chapter" data-level="18.7" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#problems-with-the-error"><i class="fa fa-check"></i><b>18.7</b> Problems with the Error</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#generalized-least-squares"><i class="fa fa-check"></i><b>18.7.1</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="18.7.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>18.7.2</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="18.7.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#robust-regression"><i class="fa fa-check"></i><b>18.7.3</b> Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#shrinkage-methods"><i class="fa fa-check"></i><b>18.8</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="18.8.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#principal-components-analzsis"><i class="fa fa-check"></i><b>18.8.1</b> Principal Components Analzsis</a></li>
<li class="chapter" data-level="18.8.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#partial-least-squares"><i class="fa fa-check"></i><b>18.8.2</b> Partial Least Squares</a></li>
<li class="chapter" data-level="18.8.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>18.8.3</b> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>19</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-5"><i class="fa fa-check"></i><b>19.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>19.1.1</b> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li class="chapter" data-level="19.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#more-fundamental-problem-outside-01"><i class="fa fa-check"></i><b>19.1.2</b> More fundamental problem outside [0,1]</a></li>
<li class="chapter" data-level="19.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-model"><i class="fa fa-check"></i><b>19.1.3</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="19.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-of-the-logistic-model"><i class="fa fa-check"></i><b>19.1.4</b> Estimation of the Logistic Model</a></li>
<li class="chapter" data-level="19.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#convergence-problems"><i class="fa fa-check"></i><b>19.1.5</b> Convergence Problems</a></li>
<li class="chapter" data-level="19.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#use-exact-methods."><i class="fa fa-check"></i><b>19.1.6</b> Use exact methods.</a></li>
<li class="chapter" data-level="19.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#use-penalized-likelihood"><i class="fa fa-check"></i><b>19.1.7</b> Use penalized likelihood</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="logistic-regression.html"><a href="logistic-regression.html#binary-regression"><i class="fa fa-check"></i><b>19.2</b> Binary Regression</a></li>
<li class="chapter" data-level="19.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-modell"><i class="fa fa-check"></i><b>19.3</b> Logit Modell</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-6"><i class="fa fa-check"></i><b>19.3.1</b> Introduction</a></li>
<li class="chapter" data-level="19.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-4"><i class="fa fa-check"></i><b>19.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="19.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#multicollinearity"><i class="fa fa-check"></i><b>19.3.3</b> Multicollinearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html"><i class="fa fa-check"></i><b>20</b> Advanced Logistic Regression</a></li>
<li class="chapter" data-level="21" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>21</b> Survival Analysis</a></li>
<li class="chapter" data-level="22" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html"><i class="fa fa-check"></i><b>22</b> Advanced Survival Analysis</a></li>
<li class="chapter" data-level="23" data-path="count-data-regression.html"><a href="count-data-regression.html"><i class="fa fa-check"></i><b>23</b> Count Data Regression</a></li>
<li class="chapter" data-level="24" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html"><i class="fa fa-check"></i><b>24</b> Proportion Response Regression</a></li>
<li class="chapter" data-level="25" data-path="mixed-model.html"><a href="mixed-model.html"><i class="fa fa-check"></i><b>25</b> Mixed Model</a></li>
<li class="chapter" data-level="26" data-path="generalized-linear-mixed-model.html"><a href="generalized-linear-mixed-model.html"><i class="fa fa-check"></i><b>26</b> Generalized Linear (Mixed) Model</a></li>
<li class="chapter" data-level="27" data-path="generalized-estimating-equation.html"><a href="generalized-estimating-equation.html"><i class="fa fa-check"></i><b>27</b> Generalized Estimating Equation</a></li>
<li class="chapter" data-level="28" data-path="time-series-analysis.html"><a href="time-series-analysis.html"><i class="fa fa-check"></i><b>28</b> Time Series Analysis</a></li>
<li class="chapter" data-level="29" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>29</b> Meta Analysis</a></li>
<li class="chapter" data-level="30" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html"><i class="fa fa-check"></i><b>30</b> Group (Adaptive) Sequential Design</a></li>
<li class="chapter" data-level="31" data-path="clinic-study-design.html"><a href="clinic-study-design.html"><i class="fa fa-check"></i><b>31</b> Clinic Study Design</a></li>
<li class="chapter" data-level="32" data-path="propensity-score.html"><a href="propensity-score.html"><i class="fa fa-check"></i><b>32</b> Propensity Score</a></li>
<li class="chapter" data-level="33" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>33</b> Missing Data</a></li>
<li class="chapter" data-level="34" data-path="space-2.html"><a href="space-2.html"><i class="fa fa-check"></i><b>34</b> ^_^ Space</a></li>
<li class="chapter" data-level="35" data-path="space-3.html"><a href="space-3.html"><i class="fa fa-check"></i><b>35</b> ^_^ Space</a></li>
<li class="chapter" data-level="36" data-path="space-4.html"><a href="space-4.html"><i class="fa fa-check"></i><b>36</b> ^_^ Space</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> ggplot2</h1>
<div id="parametric-rendering" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Parametric Rendering</h2>
<div id="grammar" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Grammar</h3>
<p>ggplot2 implements the idea of a “grammar of graphics.” The grammar implemented by ggplot2 could be summarized as follows:</p>
<ul>
<li>plot ::= coord scale+ facet? layer+</li>
<li>layer ::= data mapping stat geom position?</li>
</ul>
<p>A plot is defined by a coordinate system (coord), one or more scales (scale), an optional faceting specification (facet), and one or more layers (layer). A layer is defined as an R data frame (data), a specification mapping columns of that frame into aesthetic properties (mapping), a statistical approach to summarize the rows of that frame (stat), a geometric object to visually represent that summary (geom), and an optional position adjustment to move overlapping geometric objects out of their way (position).</p>
</div>
<div id="coord" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> coord</h3>
<ul>
<li>coord_cartesian - (default) cartesian coordinate system (x horizontal from left to right, y vertical from bottom to top)</li>
<li>coord_flip - flipped cartesian coordinate system (x vertical from bottom to top, y horizontal from left to right)</li>
<li>coord_trans</li>
<li>coord_equal</li>
<li>coord_polar - polar coordinate system; the x (or y) scale is mapped to the angle (theta)</li>
<li>coord_map - various map projections</li>
</ul>
<!-- coord_cartesian（默认）笛卡尔坐标系, coord_flip 直角坐标系 -->
</div>
<div id="facet" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> facet</h3>
<ul>
<li>facet_wrap(~cell) - univariate: create a 1-d strip of panels, based on one factor, and wrap the strip into a 2-d matrix</li>
<li>facet_grid(row~col) - (usually) bivariate: create a 2-d matrix of panels, based on two factors</li>
</ul>
</div>
<div id="geom" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> geom</h3>
<table>
<colgroup>
<col width="5%" />
<col width="14%" />
<col width="13%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th>geom</th>
<th>Useful stats (default in bold)</th>
<th>Default position adjustment</th>
<th>Parameters (when used with given stat)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>blank</td>
<td>identity</td>
<td>identity</td>
<td>no parameters</td>
</tr>
<tr class="even">
<td>abline</td>
<td>abline</td>
<td>identity</td>
<td>slope, intercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>slope, intercept, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>hline</td>
<td>hline</td>
<td>identity</td>
<td>yintercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>y, yend, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>vline</td>
<td>vline</td>
<td>identity</td>
<td>xintercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>x, xend, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>text</td>
<td>identity</td>
<td>identity</td>
<td>x, y, label, size, colour, alpha, hjust, vjust, parse</td>
</tr>
<tr class="odd">
<td>point</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, shape, colour, fill, alpha, na.rm</td>
</tr>
<tr class="even">
<td>jitter</td>
<td>identity</td>
<td>jitter</td>
<td>x, y, size, shape, colour, fill, alpha, na.rm</td>
</tr>
<tr class="odd">
<td>segment</td>
<td>identity</td>
<td>identity</td>
<td>x, xend, y, yend, size, linetype, colour, alpha, arrow</td>
</tr>
<tr class="even">
<td>line</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, arrow</td>
</tr>
<tr class="odd">
<td>bar</td>
<td>identity</td>
<td>stack</td>
<td>x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>bin</td>
<td>stack</td>
<td>x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>histogram</td>
<td>alias for geom_bar</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>area</td>
<td>identity</td>
<td>stack</td>
<td>group, x, y, size, linetype, colour, fill, alpha, na.rm</td>
</tr>
<tr class="odd">
<td>ribbon</td>
<td>identity</td>
<td>identity</td>
<td>group, x, ymin, ymax, size, linetype, colour, fill, alpha, na.rm</td>
</tr>
<tr class="even">
<td>linerange</td>
<td>identity</td>
<td>identity</td>
<td>x, ymin, ymax, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td>pointrange</td>
<td>identity</td>
<td>identity</td>
<td>x, y, ymin, ymax, size, shape, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td>errorbar</td>
<td>identity</td>
<td>identity</td>
<td>x, ymin, ymax, size, linetype, colour, alpha, width</td>
</tr>
<tr class="odd">
<td>errorbarh</td>
<td>identity</td>
<td>identity</td>
<td>x, xmin, xmax, y, size, linetype, colour, alpha, height</td>
</tr>
<tr class="even">
<td>crossbar</td>
<td>identity</td>
<td>identity</td>
<td>x, y, ymin, ymax, size, linetype, colour, fill, alpha, width, fatten</td>
</tr>
<tr class="odd">
<td>boxplot</td>
<td>identity</td>
<td>dodge</td>
<td>x, ymin, lower, middle, upper, ymax, size, colour, fill, alpha, weight(?), width(?), outliers(?), outlier.size, outlier.shape, outlier.colour ???</td>
</tr>
<tr class="even">
<td></td>
<td>boxplot</td>
<td>dodge</td>
<td>x, ymin, lower, middle, upper, ymax, size, colour, fill, alpha, weight(?), width(?), outliers(?), outlier.size, outlier.shape, outlier.colour ???</td>
</tr>
<tr class="odd">
<td>path</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="even">
<td>polygon</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>rect</td>
<td>identity</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td>rug</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td>step</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, direction</td>
</tr>
<tr class="even">
<td>bin2d</td>
<td>identity</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td></td>
<td>bin2d</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td>tile</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>hex</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, colour, fill, alpha</td>
</tr>
<tr class="even">
<td></td>
<td>binhex</td>
<td>identity</td>
<td>x, y, size, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>density</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>density</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>density2d</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="even">
<td></td>
<td>density2d</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="odd">
<td>contour</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="even">
<td></td>
<td>contour</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="odd">
<td>freqpoly</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>bin</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>quantile</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="even">
<td></td>
<td>quantile</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight, quantiles, formula, xseq, method, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="odd">
<td>smooth</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, ymin, ymax, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td></td>
<td>smooth</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight</td>
</tr>
</tbody>
</table>
</div>
<div id="position" class="section level3" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> position</h3>
<ul>
<li>position_identity - default of most geoms</li>
<li>position_jitter - default of geom_jitter</li>
<li>position_dodge - default of geom_boxplot</li>
<li>position_stack - default of geom_bar==geom_histogram and geom_area</li>
<li>position_fill - useful for geom_bar==geom_histogram and geom_area</li>
</ul>
</div>
<div id="scale" class="section level3" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> scale</h3>
<ul>
<li>size - size of a geom</li>
<li>shape - shape of a geom</li>
<li>linetype - type of a geom’s outline (e.g., dashed, dotted)</li>
<li>colour - color of a geom’s outline</li>
<li>fill - color of a geom’s fill</li>
<li>alpha - transparency of a geom (0=transparent … 1=opaque)</li>
</ul>
<p>Functions that ggplot2 provides to define each of the above kinds of scales.</p>
<ul>
<li>x (or y) position
<ul>
<li>scale_x_continuous</li>
<li>scale_x_date</li>
<li>scale_x_datetime</li>
<li>scale_x_discrete</li>
</ul></li>
<li>size
<ul>
<li>scale_size_continuous</li>
<li>scale_area</li>
<li>scale_size_discrete</li>
<li>scale_size_identity</li>
<li>scale_size_manual</li>
</ul></li>
<li>shape
<ul>
<li>scale_shape_discrete</li>
<li>scale_shape_identity</li>
<li>scale_shape_manual</li>
</ul></li>
<li>linetype
<ul>
<li>scale_linetype_discrete</li>
<li>scale_linetype_identity</li>
<li>scale_linetype_manual</li>
</ul></li>
<li>colour (or fill)
<ul>
<li>scale_colour_gradient</li>
<li>scale_colour_gradient2</li>
<li>scale_colour_gradientn</li>
<li>scale_colour_hue</li>
<li>scale_colour_brewer</li>
<li>scale_colour_grey</li>
<li>scale_colour_identity</li>
<li>scale_colour_manual</li>
</ul></li>
<li>alpha
<ul>
<li>scale_alpha_continuous</li>
</ul></li>
</ul>
</div>
<div id="stat" class="section level3" number="7.1.7">
<h3><span class="header-section-number">7.1.7</span> stat</h3>
<ul>
<li>stat_abline - used by geom_abline</li>
<li>stat_bin - used by geom_bar == geom_histogram, and geom_freqpoly</li>
<li>stat_bin2d - used by geom_bin2d</li>
<li>stat_binhex - used by geom_hex</li>
<li>stat_boxplot - used by geom_boxplot</li>
<li>stat_contour - used by geom_contour</li>
<li>stat_density - used by geom_density</li>
<li>stat_density2d - used by geom_density2d</li>
<li>stat_ecdf</li>
<li>stat_function</li>
<li>stat_hline - used by geom_hline</li>
<li>stat_identity - used by a large number of geoms</li>
<li>stat_qq</li>
<li>stat_quantile - used by geom_quantile</li>
<li>stat_smooth - used by geom_smooth</li>
<li>stat_spoke</li>
<li>stat_sum</li>
<li>stat_summary</li>
<li>stat_unique</li>
<li>stat_vline - used by geom_vline</li>
</ul>
</div>
<div id="color" class="section level3" number="7.1.8">
<h3><span class="header-section-number">7.1.8</span> Color</h3>
<pre><code>+ [ColorBrewer scales](https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3)
+ Hexadecimal color code chart</code></pre>
<div class="figure" style="text-align: center">
<img src="02_Plots/ggplot2_Hexadecimal_Color_Code.png" alt="Figure: Hexadecimal color code chart" width="100%" />
<p class="caption">
(#fig:Hexadecimal color code chart)Figure: Hexadecimal color code chart
</p>
</div>
</div>
<div id="thema" class="section level3" number="7.1.9">
<h3><span class="header-section-number">7.1.9</span> Thema</h3>
<ul>
<li>theme_grey() - the default theme, with a grey background</li>
<li>theme_bw() - a theme with a white background</li>
</ul>
<p>ggplot2 includes eight themes by default, as shown in Figure. Many more are included in add-on packages like <a href="https://github.com/jrnold/ggthemes">ggthemes</a>, by Jeffrey Arnold.</p>
<div class="figure" style="text-align: center"><span id="fig:Thema"></span>
<img src="02_Plots/ggplot2_ggthemes.png" alt="Figure: ggplot2 Thema" width="100%" />
<p class="caption">
Figure 7.1: Figure: ggplot2 Thema
</p>
</div>
</div>
<div id="saving-plots" class="section level3" number="7.1.10">
<h3><span class="header-section-number">7.1.10</span> Saving plots</h3>
<pre><code># Save the plot
ggsave(p, filename = &quot;chartFromRPractical.png&quot;)</code></pre>
</div>
</div>
<div id="scatter-plot" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Scatter plot</h2>
<div id="grouping-aesthetic" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Grouping Aesthetic</h3>
<ul>
<li>Color Aesthetic</li>
<li>Size Aesthetic</li>
<li>Alpha Aesthetic</li>
<li>Shape Aesthetic</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ggplot2.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="ggplot2.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Color Aesthetic</span></span>
<span id="cb3-3"><a href="ggplot2.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="ggplot2.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ggplot2.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set the aesthetic properties of your geom manually</span></span>
<span id="cb4-2"><a href="ggplot2.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="ggplot2.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ggplot2.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Size Aesthetic</span></span>
<span id="cb5-2"><a href="ggplot2.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="ggplot2.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ggplot2.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Alpha aesthetic, which controls the transparency of the points</span></span>
<span id="cb6-2"><a href="ggplot2.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="ggplot2.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ggplot2.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## shape aesthetic</span></span>
<span id="cb7-2"><a href="ggplot2.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="ggplot2.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="ggplot2.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb8-2"><a href="ggplot2.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb8-3"><a href="ggplot2.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="ggplot2.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="ggplot2.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#3399CC&quot;</span>,<span class="st">&quot;#33FF33&quot;</span>,<span class="st">&quot;#FFCC33&quot;</span>))<span class="sc">+</span></span>
<span id="cb8-6"><a href="ggplot2.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="ggplot2.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">&quot;Petal Width&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="ggplot2.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-9"><a href="ggplot2.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Petal Width and Length&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="ggplot2.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb8-11"><a href="ggplot2.html#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-12"><a href="ggplot2.html#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.85</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-6.png" width="672" /></p>
</div>
<div id="facet-1" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> facet</h3>
<p>facet_wrap(), “winding facet,” only one standard can be applied to data classification, and the small shapes obtained from different sets of data are arranged in the order of “winding” from left to right and from top to bottom</p>
<p>facet_grid(), facet the drawing of the combination of two variables</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ggplot2.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="ggplot2.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="ggplot2.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span> class, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="ggplot2.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="ggplot2.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="ggplot2.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> class)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-2.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ggplot2.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="ggplot2.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="ggplot2.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-3.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ggplot2.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="ggplot2.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="ggplot2.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-4.png" width="672" /></p>
<p><strong>Replacing facet strips with text boxes using ggtext::</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ggplot2.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cowplot&quot;</span>)</span>
<span id="cb13-2"><a href="ggplot2.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="ggplot2.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="ggplot2.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="ggplot2.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class) <span class="sc">+</span></span>
<span id="cb13-6"><a href="ggplot2.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_half_open</span>(<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="ggplot2.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_grid</span>() </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Replacing%20facet%20strips-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="ggplot2.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggtext&quot;</span>)</span>
<span id="cb14-2"><a href="ggplot2.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="ggplot2.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="ggplot2.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class) <span class="sc">+</span></span>
<span id="cb14-5"><a href="ggplot2.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_half_open</span>(<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="ggplot2.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_grid</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="ggplot2.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-8"><a href="ggplot2.html#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-9"><a href="ggplot2.html#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_textbox</span>(</span>
<span id="cb14-10"><a href="ggplot2.html#cb14-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb14-11"><a href="ggplot2.html#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#5D729D&quot;</span>, <span class="at">box.color =</span> <span class="st">&quot;#4A618C&quot;</span>,</span>
<span id="cb14-12"><a href="ggplot2.html#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">halign =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb14-13"><a href="ggplot2.html#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb14-14"><a href="ggplot2.html#cb14-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-15"><a href="ggplot2.html#cb14-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Replacing%20facet%20strips-2.png" width="672" /></p>
</div>
<div id="geom_smooth" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> geom_smooth</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ggplot2.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## display different aesthetics in different layers</span></span>
<span id="cb15-2"><a href="ggplot2.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="ggplot2.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="ggplot2.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="ggplot2.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## no aesthetic just grouping</span></span>
<span id="cb16-2"><a href="ggplot2.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb16-3"><a href="ggplot2.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">group =</span> drv)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="ggplot2.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ggplot2.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## linetype aesthetic set the shape of a point</span></span>
<span id="cb17-2"><a href="ggplot2.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="ggplot2.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linetype =</span> drv))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="ggplot2.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## color aesthetic</span></span>
<span id="cb18-2"><a href="ggplot2.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb18-3"><a href="ggplot2.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb18-4"><a href="ggplot2.html#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv),</span>
<span id="cb18-5"><a href="ggplot2.html#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb18-6"><a href="ggplot2.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ggplot2.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear line</span></span>
<span id="cb19-2"><a href="ggplot2.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy))<span class="sc">+</span></span>
<span id="cb19-3"><a href="ggplot2.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb19-4"><a href="ggplot2.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb19-5"><a href="ggplot2.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb19-6"><a href="ggplot2.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, </span>
<span id="cb19-7"><a href="ggplot2.html#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;hwy&quot;</span>, </span>
<span id="cb19-8"><a href="ggplot2.html#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;cty&quot;</span>, </span>
<span id="cb19-9"><a href="ggplot2.html#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Scatterplot with overlapping points&quot;</span>, </span>
<span id="cb19-10"><a href="ggplot2.html#cb19-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="ggplot2.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 原始数据有234个数据点，但图表似乎显示的点更少</span></span>
<span id="cb20-2"><a href="ggplot2.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 这是因为有许多重叠的点显示为单个点。在源数据集中cty和hwy都是整数</span></span>
<span id="cb20-3"><a href="ggplot2.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 可以使用jitter_geom（）绘制一个抖动图</span></span>
<span id="cb20-4"><a href="ggplot2.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy))<span class="sc">+</span></span>
<span id="cb20-5"><a href="ggplot2.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-6"><a href="ggplot2.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-7"><a href="ggplot2.html#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">5</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="ggplot2.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, </span>
<span id="cb20-9"><a href="ggplot2.html#cb20-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;hwy&quot;</span>, </span>
<span id="cb20-10"><a href="ggplot2.html#cb20-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;cty&quot;</span>, </span>
<span id="cb20-11"><a href="ggplot2.html#cb20-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Jittered Points&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-6.png" width="672" /></p>
</div>
<div id="dot-plot" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Dot Plot</h3>
<p>Order <code>fct_reorder</code>: Modifying factor order</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ggplot2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb21-2"><a href="ggplot2.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-3"><a href="ggplot2.html#cb21-3" aria-hidden="true" tabindex="-1"></a>relig_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="ggplot2.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(relig) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="ggplot2.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-6"><a href="ggplot2.html#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-7"><a href="ggplot2.html#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-8"><a href="ggplot2.html#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb21-9"><a href="ggplot2.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-10"><a href="ggplot2.html#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="ggplot2.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(tvhours, relig)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/fct_reorder-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="ggplot2.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(tvhours, <span class="fu">fct_reorder</span>(relig, tvhours))) <span class="sc">+</span></span>
<span id="cb22-2"><a href="ggplot2.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/fct_reorder-2.png" width="672" /></p>
<p><strong>Diverging Dot Plot </strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ggplot2.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Prep</span></span>
<span id="cb23-2"><a href="ggplot2.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)  <span class="co"># load data</span></span>
<span id="cb23-3"><a href="ggplot2.html#cb23-3" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)  <span class="co"># create new column for car names</span></span>
<span id="cb23-4"><a href="ggplot2.html#cb23-4" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>mpg_z <span class="ot">&lt;-</span> <span class="fu">round</span>((mtcars<span class="sc">$</span>mpg <span class="sc">-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg))<span class="sc">/</span><span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg), <span class="dv">2</span>)  <span class="co"># compute normalized mpg</span></span>
<span id="cb23-5"><a href="ggplot2.html#cb23-5" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>mpg_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg_z <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;below&quot;</span>, <span class="st">&quot;above&quot;</span>)  <span class="co"># above / below avg flag</span></span>
<span id="cb23-6"><a href="ggplot2.html#cb23-6" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars[<span class="fu">order</span>(mtcars<span class="sc">$</span>mpg_z), ]  <span class="co"># sort</span></span>
<span id="cb23-7"><a href="ggplot2.html#cb23-7" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">levels =</span> mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>)  <span class="co"># convert to factor to retain sorted order in plot.</span></span>
<span id="cb23-8"><a href="ggplot2.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="ggplot2.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="ggplot2.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb23-11"><a href="ggplot2.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="fu">aes</span>(<span class="at">col=</span>mpg_type), <span class="at">size=</span><span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb23-12"><a href="ggplot2.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Mileage&quot;</span>, </span>
<span id="cb23-13"><a href="ggplot2.html#cb23-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), </span>
<span id="cb23-14"><a href="ggplot2.html#cb23-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;above&quot;</span><span class="ot">=</span><span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span><span class="ot">=</span><span class="st">&quot;#f8766d&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="ggplot2.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="ggplot2.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Diverging Dot Plot&quot;</span>, </span>
<span id="cb23-17"><a href="ggplot2.html#cb23-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Dotplot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb23-18"><a href="ggplot2.html#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="ggplot2.html#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ggplot2.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Diverging Lollipop Chart</span></span>
<span id="cb24-2"><a href="ggplot2.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="ggplot2.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb24-4"><a href="ggplot2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb24-5"><a href="ggplot2.html#cb24-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">`</span><span class="at">car name</span><span class="st">`</span>, </span>
<span id="cb24-6"><a href="ggplot2.html#cb24-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> mpg_z, </span>
<span id="cb24-7"><a href="ggplot2.html#cb24-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">car name</span><span class="st">`</span>), </span>
<span id="cb24-8"><a href="ggplot2.html#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="ggplot2.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="ggplot2.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Diverging Lollipop Chart&quot;</span>, </span>
<span id="cb24-11"><a href="ggplot2.html#cb24-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Lollipop&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-12"><a href="ggplot2.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="ggplot2.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ggplot2.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diverging Barcharts</span></span>
<span id="cb25-2"><a href="ggplot2.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="ggplot2.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>mpg_type), <span class="at">width=</span>.<span class="dv">5</span>)  <span class="sc">+</span></span>
<span id="cb25-4"><a href="ggplot2.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Mileage&quot;</span>, </span>
<span id="cb25-5"><a href="ggplot2.html#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), </span>
<span id="cb25-6"><a href="ggplot2.html#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;above&quot;</span><span class="ot">=</span><span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span><span class="ot">=</span><span class="st">&quot;#f8766d&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb25-7"><a href="ggplot2.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Normalised mileage from &#39;mtcars&#39;&quot;</span>, </span>
<span id="cb25-8"><a href="ggplot2.html#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span> <span class="st">&quot;Diverging Bars&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="ggplot2.html#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="ggplot2.html#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-3.png" width="672" /></p>
</div>
<div id="label-and-title" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Label and Title</h3>
<p><code>+ ggtitle("Area Vs Population", subtitle="From midwest dataset") + xlab("Area") + ylab("Population")</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ggplot2.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="ggplot2.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb26-3"><a href="ggplot2.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-4"><a href="ggplot2.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000000</span>)) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="ggplot2.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Area Vs Population&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;From midwest dataset&quot;</span>, <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, <span class="at">x=</span><span class="st">&quot;Area&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Midwest Demographics&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtitle-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ggplot2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Or</span></span>
<span id="cb27-2"><a href="ggplot2.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="ggplot2.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb27-4"><a href="ggplot2.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="ggplot2.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000000</span>)) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="ggplot2.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Area Vs Population&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;From midwest dataset&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Area&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Population&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtitle-2.png" width="672" /></p>
<p><strong>Change the Title rendering using ggtext::element_textbox()</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="ggplot2.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(disp, mpg)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="ggplot2.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="ggplot2.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-4"><a href="ggplot2.html#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;&lt;b&gt;Fuel economy vs. engine displacement&lt;/b&gt;&lt;br&gt;</span></span>
<span id="cb28-5"><a href="ggplot2.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;span style = &#39;font-size:10pt&#39;&gt;Lorem ipsum *dolor sit amet,*</span></span>
<span id="cb28-6"><a href="ggplot2.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">    consectetur adipiscing elit, **sed do eiusmod tempor incididunt** ut</span></span>
<span id="cb28-7"><a href="ggplot2.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">    labore et dolore magna aliqua. &lt;span style = &#39;color:red;&#39;&gt;Ut enim</span></span>
<span id="cb28-8"><a href="ggplot2.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">    ad minim veniam,&lt;/span&gt; quis nostrud exercitation ullamco laboris nisi</span></span>
<span id="cb28-9"><a href="ggplot2.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ut aliquip ex ea commodo consequat.&lt;/span&gt;&quot;</span>,</span>
<span id="cb28-10"><a href="ggplot2.html#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;displacement (in&lt;sup&gt;3&lt;/sup&gt;)&quot;</span>,</span>
<span id="cb28-11"><a href="ggplot2.html#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Miles per gallon (mpg)&lt;br&gt;&lt;span style = &#39;font-size:8pt&#39;&gt;A measure of</span></span>
<span id="cb28-12"><a href="ggplot2.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">    the car&#39;s fuel efficiency.&lt;/span&gt;&quot;</span></span>
<span id="cb28-13"><a href="ggplot2.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-14"><a href="ggplot2.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-15"><a href="ggplot2.html#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb28-16"><a href="ggplot2.html#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-17"><a href="ggplot2.html#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">13</span>,</span>
<span id="cb28-18"><a href="ggplot2.html#cb28-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lineheight =</span> <span class="dv">1</span>,</span>
<span id="cb28-19"><a href="ggplot2.html#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fl">5.5</span>),</span>
<span id="cb28-20"><a href="ggplot2.html#cb28-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>),</span>
<span id="cb28-21"><a href="ggplot2.html#cb28-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;cornsilk&quot;</span></span>
<span id="cb28-22"><a href="ggplot2.html#cb28-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-23"><a href="ggplot2.html#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-24"><a href="ggplot2.html#cb28-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-25"><a href="ggplot2.html#cb28-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb28-26"><a href="ggplot2.html#cb28-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb28-27"><a href="ggplot2.html#cb28-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb28-28"><a href="ggplot2.html#cb28-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="dv">8</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb28-29"><a href="ggplot2.html#cb28-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;azure1&quot;</span></span>
<span id="cb28-30"><a href="ggplot2.html#cb28-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-31"><a href="ggplot2.html#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-32"><a href="ggplot2.html#cb28-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb28-33"><a href="ggplot2.html#cb28-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">orientation =</span> <span class="st">&quot;left-rotated&quot;</span>,</span>
<span id="cb28-34"><a href="ggplot2.html#cb28-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">minwidth =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb28-35"><a href="ggplot2.html#cb28-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxwidth =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb28-36"><a href="ggplot2.html#cb28-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb28-37"><a href="ggplot2.html#cb28-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb28-38"><a href="ggplot2.html#cb28-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;lightsteelblue1&quot;</span></span>
<span id="cb28-39"><a href="ggplot2.html#cb28-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-40"><a href="ggplot2.html#cb28-40" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/element_textbox-1.png" width="672" /></p>
</div>
<div id="residuals" class="section level3" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Residuals</h3>
<pre><code>modf2 &lt;- fortify(lm(formular, data = rf10_comp))
ggplot(modf2, aes(x = modf$bmi, y = .resid)) + geom_point()+
  geom_hline(aes(yintercept=0), colour=&quot;#990000&quot;) +
  labs(title=&quot;Residuals plot for BMI using MICE RF with 10 trees&quot;,
       x = &quot;BMI&quot;,
       y = &quot;Residuals&quot;)+
  theme_classic()
  
## Standardized Residuals
modf &lt;- fortify(lm(formular, data = data))
ggplot(modf, aes(x = modf$bmi, y = .stdresid)) + geom_point()+
  geom_hline(aes(yintercept=0), colour=&quot;#990000&quot;) +
  labs(title=&quot;Standardised residuals plot for BMI using Full data&quot;,
       x = &quot;BMI&quot;,
       y = &quot;Residuals&quot;)+
  theme_classic()</code></pre>
</div>
<div id="encircling" class="section level3" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> Encircling</h3>
<p>In geom_encircle(), set the data to a new data frame containing only points (rows) or points of interest. In addition, you can expand the curve so that it passes outside the point. The color and size (thickness) of the curve can also be modified.</p>
<!-- 在图表中加上某些特殊的点或区域组，以便引起人们对这些特殊情况的注意。 可以使用ggalt包中的geom_encircle（）方便地完成此操作。 -->
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="ggplot2.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install &#39;ggalt&#39; pkg</span></span>
<span id="cb30-2"><a href="ggplot2.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span></span>
<span id="cb30-3"><a href="ggplot2.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb30-4"><a href="ggplot2.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb30-5"><a href="ggplot2.html#cb30-5" aria-hidden="true" tabindex="-1"></a>midwest_select <span class="ot">&lt;-</span> midwest[midwest<span class="sc">$</span>poptotal <span class="sc">&gt;</span> <span class="dv">350000</span> <span class="sc">&amp;</span> </span>
<span id="cb30-6"><a href="ggplot2.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>poptotal <span class="sc">&lt;=</span> <span class="dv">500000</span> <span class="sc">&amp;</span> </span>
<span id="cb30-7"><a href="ggplot2.html#cb30-7" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>area <span class="sc">&gt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> </span>
<span id="cb30-8"><a href="ggplot2.html#cb30-8" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>area <span class="sc">&lt;</span> <span class="fl">0.1</span>, ]</span>
<span id="cb30-9"><a href="ggplot2.html#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="ggplot2.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb30-11"><a href="ggplot2.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb30-12"><a href="ggplot2.html#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>state, <span class="at">size=</span>popdensity)) <span class="sc">+</span>   <span class="co"># draw points</span></span>
<span id="cb30-13"><a href="ggplot2.html#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span> </span>
<span id="cb30-14"><a href="ggplot2.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb30-15"><a href="ggplot2.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) <span class="sc">+</span>   <span class="co"># draw smoothing line</span></span>
<span id="cb30-16"><a href="ggplot2.html#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_encircle</span>(<span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal), </span>
<span id="cb30-17"><a href="ggplot2.html#cb30-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>midwest_select, </span>
<span id="cb30-18"><a href="ggplot2.html#cb30-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb30-19"><a href="ggplot2.html#cb30-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="dv">2</span>, </span>
<span id="cb30-20"><a href="ggplot2.html#cb30-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">expand=</span><span class="fl">0.08</span>) <span class="sc">+</span>   <span class="co"># encircle</span></span>
<span id="cb30-21"><a href="ggplot2.html#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Area Vs Population&quot;</span>, </span>
<span id="cb30-22"><a href="ggplot2.html#cb30-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, </span>
<span id="cb30-23"><a href="ggplot2.html#cb30-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Area&quot;</span>, </span>
<span id="cb30-24"><a href="ggplot2.html#cb30-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Scatterplot + Encircle&quot;</span>, </span>
<span id="cb30-25"><a href="ggplot2.html#cb30-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Encircling%20for%20emphasizen-1.png" width="672" /></p>
</div>
<div id="dumbbell-plot" class="section level3" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span> Dumbbell Plot</h3>
<ol style="list-style-type: decimal">
<li>可视化两个时间点之间的相对位置（如增长和下降）。</li>
<li>比较两个类别之间的距离。</li>
</ol>
<p>为了获得正确的哑铃排序，应将Y变量作为一个因子，并且该因子变量的级别应与在图中显示的顺序相同。</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ggplot2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalt) </span>
<span id="cb31-2"><a href="ggplot2.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="ggplot2.html#cb31-3" aria-hidden="true" tabindex="-1"></a>health <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/health.csv&quot;</span>)</span>
<span id="cb31-4"><a href="ggplot2.html#cb31-4" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>Area <span class="ot">&lt;-</span> <span class="fu">factor</span>(health<span class="sc">$</span>Area, <span class="at">levels=</span><span class="fu">as.character</span>(health<span class="sc">$</span>Area))  <span class="co"># for right ordering of the dumbells</span></span>
<span id="cb31-5"><a href="ggplot2.html#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="ggplot2.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># health$Area &lt;- factor(health$Area)</span></span>
<span id="cb31-7"><a href="ggplot2.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(health, <span class="fu">aes</span>(<span class="at">x=</span>pct_2013, <span class="at">xend=</span>pct_2014, <span class="at">y=</span>Area, <span class="at">group=</span>Area)) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="ggplot2.html#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dumbbell</span>(<span class="at">color=</span><span class="st">&quot;#a3c4dc&quot;</span>, </span>
<span id="cb31-9"><a href="ggplot2.html#cb31-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">0.75</span>, </span>
<span id="cb31-10"><a href="ggplot2.html#cb31-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">point.colour.l=</span><span class="st">&quot;#0e668b&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-11"><a href="ggplot2.html#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, </span>
<span id="cb31-12"><a href="ggplot2.html#cb31-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="cn">NULL</span>, </span>
<span id="cb31-13"><a href="ggplot2.html#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Dumbbell Chart&quot;</span>, </span>
<span id="cb31-14"><a href="ggplot2.html#cb31-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Pct Change: 2013 vs 2014&quot;</span>, </span>
<span id="cb31-15"><a href="ggplot2.html#cb31-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: https://github.com/hrbrmstr/ggalt&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-16"><a href="ggplot2.html#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb31-17"><a href="ggplot2.html#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb31-18"><a href="ggplot2.html#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb31-19"><a href="ggplot2.html#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb31-20"><a href="ggplot2.html#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(),</span>
<span id="cb31-21"><a href="ggplot2.html#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb31-22"><a href="ggplot2.html#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x=</span><span class="fu">element_line</span>(),</span>
<span id="cb31-23"><a href="ggplot2.html#cb31-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>(),</span>
<span id="cb31-24"><a href="ggplot2.html#cb31-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>,</span>
<span id="cb31-25"><a href="ggplot2.html#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border=</span><span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Dumbbell%20Plot%20-1.png" width="672" /></p>
</div>
</div>
<div id="histogram" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Histogram</h2>
<div id="general-appearance" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> General appearance</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ggplot2.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb32-2"><a href="ggplot2.html#cb32-2" aria-hidden="true" tabindex="-1"></a>smaller <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="ggplot2.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb32-4"><a href="ggplot2.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smaller, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">fill=</span>color))<span class="sc">+</span></span>
<span id="cb32-5"><a href="ggplot2.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span>.<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="ggplot2.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram with Auto Binning&quot;</span>, </span>
<span id="cb32-7"><a href="ggplot2.html#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Engine Displacement across Vehicle Classes&quot;</span>)  </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Appearance-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ggplot2.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## geom_histogram(bins=5, col=&quot;black&quot;, size=.1) </span></span>
<span id="cb33-2"><a href="ggplot2.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="ggplot2.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Change the color according the number of legend</span></span>
<span id="cb33-4"><a href="ggplot2.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## scale_color_manual(values = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;)) </span></span>
<span id="cb33-5"><a href="ggplot2.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## scale_fill_manual(values = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span></span></code></pre></div>
</div>
<div id="themes" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Themes</h3>
<p>ggplot2 offers a set of pre-built themes. Try the followings to see which one you like the most:</p>
<ul>
<li>theme_bw()</li>
<li>theme_dark()</li>
<li>theme_minimal()</li>
<li>theme_classic()</li>
</ul>
<p>The hrbrthemes package provides my favourite style.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ggplot2.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb34-2"><a href="ggplot2.html#cb34-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/1_OneNum.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb34-3"><a href="ggplot2.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the histogram</span></span>
<span id="cb34-4"><a href="ggplot2.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb34-5"><a href="ggplot2.html#cb34-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="ggplot2.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( price<span class="sc">&lt;</span><span class="dv">300</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="ggplot2.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="ggplot2.html#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_bin</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">300</span>,<span class="dv">10</span>), <span class="at">fill=</span><span class="st">&quot;#69b3a2&quot;</span>, <span class="at">color=</span><span class="st">&quot;#e9ecef&quot;</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href="ggplot2.html#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Night price distribution of Airbnb appartements&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="ggplot2.html#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/hrbrthemes-1.png" width="672" /></p>
</div>
<div id="geom_freqpoly" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> geom_freqpoly()</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ggplot2.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb35-2"><a href="ggplot2.html#cb35-2" aria-hidden="true" tabindex="-1"></a>smaller <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="ggplot2.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb35-4"><a href="ggplot2.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smaller, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">colour =</span> cut)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="ggplot2.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ggplot2.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## display density instead of count</span></span>
<span id="cb36-2"><a href="ggplot2.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> ..density..)) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="ggplot2.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> cut), <span class="at">binwidth =</span> <span class="dv">500</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-2.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ggplot2.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## geom_density</span></span>
<span id="cb37-2"><a href="ggplot2.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="ggplot2.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl)), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="ggplot2.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Density plot&quot;</span>, </span>
<span id="cb37-5"><a href="ggplot2.html#cb37-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&quot;City Mileage Grouped by Number of cylinders&quot;</span>,</span>
<span id="cb37-6"><a href="ggplot2.html#cb37-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb37-7"><a href="ggplot2.html#cb37-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">&quot;City Mileage&quot;</span>,</span>
<span id="cb37-8"><a href="ggplot2.html#cb37-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="st">&quot;# Cylinders&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-3.png" width="672" /></p>
</div>
<div id="marginal-histogram-boxplot" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Marginal Histogram / Boxplot</h3>
<p>This can be achieved using the ggMarginal() function in the “ggExtra” package. In addition to histograms, you can choose to draw marginal box plots or density plots by setting the corresponding type options.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="ggplot2.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggExtra&quot;</span>)</span>
<span id="cb38-2"><a href="ggplot2.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="ggplot2.html#cb38-3" aria-hidden="true" tabindex="-1"></a>mpg_select <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>hwy <span class="sc">&gt;=</span> <span class="dv">35</span> <span class="sc">&amp;</span> mpg<span class="sc">$</span>cty <span class="sc">&gt;</span> <span class="dv">27</span>, ]</span>
<span id="cb38-4"><a href="ggplot2.html#cb38-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="ggplot2.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>() <span class="sc">+</span> </span>
<span id="cb38-6"><a href="ggplot2.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb38-7"><a href="ggplot2.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-8"><a href="ggplot2.html#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="ggplot2.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>, <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb38-10"><a href="ggplot2.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;boxplot&quot;</span>,   <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb38-11"><a href="ggplot2.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>,   <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Marginal%20Plot-1.png" width="672" /></p>
</div>
<div id="scales" class="section level3" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Scales</h3>
<p>Scales control the details of how data values are translated to visual properties. Many <a href="https://ggplot2.tidyverse.org/reference/index.html#section-scales">different scales</a> are offered by ggplot2. The most widely one is probably the log scale.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ggplot2.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb39-2"><a href="ggplot2.html#cb39-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/1_OneNum.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="ggplot2.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="ggplot2.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the histogram</span></span>
<span id="cb39-5"><a href="ggplot2.html#cb39-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="ggplot2.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="ggplot2.html#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;steelblue4&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="ggplot2.html#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Night price distribution of Airbnb appartements&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="ggplot2.html#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Night price&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="ggplot2.html#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of apartments&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Change%20Scales-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="ggplot2.html#cb40-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="ggplot2.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="ggplot2.html#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;steelblue4&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="ggplot2.html#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Night price distribution of Airbnb appartements&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="ggplot2.html#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Night price&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="ggplot2.html#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of apartments&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-7"><a href="ggplot2.html#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Change%20Scales-2.png" width="672" /></p>
</div>
</div>
<div id="bar-plot" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Bar plot</h2>
<div id="aesthetic" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Aesthetic</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ggplot2.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Color Aesthetic</span></span>
<span id="cb41-2"><a href="ggplot2.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="ggplot2.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> cut ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="ggplot2.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="ggplot2.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> color ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ggplot2.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Position aesthetic</span></span>
<span id="cb43-2"><a href="ggplot2.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="do">## position adjustment options: &quot;identity&quot;, &quot;dodge&quot; or &quot;fill&quot;.</span></span>
<span id="cb43-3"><a href="ggplot2.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="do">## position =“ fill”的作用类似于堆叠，但是使每组堆叠的条具有相同的高度。 这样可以更轻松地比较各组之间的比例。</span></span>
<span id="cb43-4"><a href="ggplot2.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="do">## position =“ dodge”将重叠的对象彼此相邻放置。 这样可以更轻松地比较各个值。</span></span>
<span id="cb43-5"><a href="ggplot2.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="ggplot2.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity)) <span class="sc">+</span> </span>
<span id="cb43-7"><a href="ggplot2.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="ggplot2.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">colour =</span> clarity)) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="ggplot2.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-3"><a href="ggplot2.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>color) <span class="sc">+</span></span>
<span id="cb44-4"><a href="ggplot2.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ggplot2.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="ggplot2.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="ggplot2.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="ggplot2.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram on Categorical Variable&quot;</span>, </span>
<span id="cb45-5"><a href="ggplot2.html#cb45-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Manufacturer across Vehicle Classes&quot;</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ggplot2.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="ggplot2.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-6.png" width="672" /></p>
<p><strong>Change outline colors</strong></p>
<p>It is also possible to change manually barplot line colors using the functions :</p>
<ul>
<li>scale_color_manual() : to use custom color palettes
<ul>
<li><code>p+scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))</code></li>
</ul></li>
<li>scale_color_brewer() : to use color palettes from RColorBrewer package
<ul>
<li><code>p+scale_color_brewer(palette="Dark2")</code></li>
</ul></li>
<li>scale_color_grey() : to use grey color palettes
<ul>
<li><code>p + scale_color_grey() + theme_classic()</code></li>
</ul></li>
</ul>
<p><strong>Change fill colors</strong></p>
<ul>
<li>scale_fill_manual() : to use custom colors
<ul>
<li><code>p+scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))</code></li>
</ul></li>
<li>scale_fill_brewer() : to use color palettes from RColorBrewer package
<ul>
<li><code>p+scale_fill_brewer(palette="Dark2")</code></li>
</ul></li>
<li>scale_fill_grey() : to use grey color palettes
<ul>
<li><code>p + scale_fill_grey()</code></li>
</ul></li>
</ul>
<p><strong>Change the legend position</strong></p>
<ul>
<li>Change bar fill colors to blues
<ul>
<li><code>p &lt;- p+scale_fill_brewer(palette="Blues")</code></li>
</ul></li>
<li>Change the legend position
<ul>
<li><code>p + theme(legend.position="top")</code></li>
<li><code>p + theme(legend.position="bottom")</code></li>
</ul></li>
<li>Remove legend
<ul>
<li><code>p + theme(legend.position="none")</code></li>
</ul></li>
<li>Change the order of items in the legend
<ul>
<li><code>p + scale_x_discrete(limits=c("D2", "D0.5", "D1"))</code></li>
</ul></li>
</ul>
</div>
<div id="proportion" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Proportion</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ggplot2.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="ggplot2.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> color ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/proportion-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ggplot2.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion, rather than count:</span></span>
<span id="cb48-2"><a href="ggplot2.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="ggplot2.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">y =</span> ..prop.., <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb48-4"><a href="ggplot2.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb48-5"><a href="ggplot2.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Name&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-6"><a href="ggplot2.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/proportion-2.png" width="672" />
### coord</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="ggplot2.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## coord_polar() uses polar coordinates</span></span>
<span id="cb49-2"><a href="ggplot2.html#cb49-2" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb49-3"><a href="ggplot2.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb49-4"><a href="ggplot2.html#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> cut), </span>
<span id="cb49-5"><a href="ggplot2.html#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-6"><a href="ggplot2.html#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span></span>
<span id="cb49-7"><a href="ggplot2.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-8"><a href="ggplot2.html#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="ggplot2.html#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb49-10"><a href="ggplot2.html#cb49-10" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/coordinary%20system-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ggplot2.html#cb50-1" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/coordinary%20system-2.png" width="672" /></p>
</div>
<div id="statidentity" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> stat=“identity”</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ggplot2.html#cb51-1" aria-hidden="true" tabindex="-1"></a>Rotation_5 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/Rotation_5.rds&quot;</span>)</span>
<span id="cb51-2"><a href="ggplot2.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="ggplot2.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Rotation_5, <span class="fu">aes</span>(<span class="at">x =</span> Visit, <span class="at">y=</span> Percentage, <span class="at">fill=</span>Treatment)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="ggplot2.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width =</span><span class="fl">0.5</span>,</span>
<span id="cb51-5"><a href="ggplot2.html#cb51-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb51-6"><a href="ggplot2.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>N), <span class="at">vjust=</span><span class="fl">1.6</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb51-7"><a href="ggplot2.html#cb51-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb51-8"><a href="ggplot2.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>P, <span class="at">x=</span>Visit, <span class="at">y=</span><span class="fl">0.97</span>),<span class="at">hjust=</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb51-9"><a href="ggplot2.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-10"><a href="ggplot2.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb51-11"><a href="ggplot2.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-12"><a href="ggplot2.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="ggplot2.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb51-14"><a href="ggplot2.html#cb51-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Responder rate&quot;</span>,</span>
<span id="cb51-15"><a href="ggplot2.html#cb51-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Rotational stability within 5° from Visit H0 (sitting)&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/identity-1.png" width="672" /></p>
</div>
<div id="ranking" class="section level3" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Ranking</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="ggplot2.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Ordered Bar Chart </span></span>
<span id="cb52-2"><a href="ggplot2.html#cb52-2" aria-hidden="true" tabindex="-1"></a>cty_mpg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(mpg<span class="sc">$</span>cty, <span class="at">by=</span><span class="fu">list</span>(mpg<span class="sc">$</span>manufacturer), <span class="at">FUN=</span>mean)  <span class="co"># aggregate</span></span>
<span id="cb52-3"><a href="ggplot2.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cty_mpg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;make&quot;</span>, <span class="st">&quot;mileage&quot;</span>)  <span class="co"># change column names</span></span>
<span id="cb52-4"><a href="ggplot2.html#cb52-4" aria-hidden="true" tabindex="-1"></a>cty_mpg <span class="ot">&lt;-</span> cty_mpg[<span class="fu">order</span>(cty_mpg<span class="sc">$</span>mileage), ]  <span class="co"># sort</span></span>
<span id="cb52-5"><a href="ggplot2.html#cb52-5" aria-hidden="true" tabindex="-1"></a>cty_mpg<span class="sc">$</span>make <span class="ot">&lt;-</span> <span class="fu">factor</span>(cty_mpg<span class="sc">$</span>make, <span class="at">levels =</span> cty_mpg<span class="sc">$</span>make)  <span class="co"># to retain the order in plot.</span></span>
<span id="cb52-6"><a href="ggplot2.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="ggplot2.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw plot</span></span>
<span id="cb52-8"><a href="ggplot2.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cty_mpg, <span class="fu">aes</span>(<span class="at">x=</span>make, <span class="at">y=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb52-9"><a href="ggplot2.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">&quot;tomato3&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-10"><a href="ggplot2.html#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Ordered Bar Chart&quot;</span>, </span>
<span id="cb52-11"><a href="ggplot2.html#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, </span>
<span id="cb52-12"><a href="ggplot2.html#cb52-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-13"><a href="ggplot2.html#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb52-14"><a href="ggplot2.html#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Ranking%20the%20bar-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ggplot2.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Lollipop Chart</span></span>
<span id="cb53-2"><a href="ggplot2.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Lollipop charts conveys the same information as in bar charts. By reducing the thick bars into thin lines, it reduces the clutter and lays more emphasis on the value. It looks nice and modern.</span></span>
<span id="cb53-3"><a href="ggplot2.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cty_mpg, <span class="fu">aes</span>(<span class="at">x=</span>make, <span class="at">y=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb53-4"><a href="ggplot2.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb53-5"><a href="ggplot2.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>make, </span>
<span id="cb53-6"><a href="ggplot2.html#cb53-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend=</span>make, </span>
<span id="cb53-7"><a href="ggplot2.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span><span class="dv">0</span>, </span>
<span id="cb53-8"><a href="ggplot2.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb53-9"><a href="ggplot2.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Lollipop Chart&quot;</span>, </span>
<span id="cb53-10"><a href="ggplot2.html#cb53-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, </span>
<span id="cb53-11"><a href="ggplot2.html#cb53-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb53-12"><a href="ggplot2.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Ranking%20the%20bar-2.png" width="672" /></p>
</div>
<div id="means-and-error-bars" class="section level3" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Means and error bars</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="ggplot2.html#cb54-1" aria-hidden="true" tabindex="-1"></a>PrimEnd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;Primary Endpoint&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Primary Analysis&quot;</span>, </span>
<span id="cb54-2"><a href="ggplot2.html#cb54-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Sensitivity Analysis 1&quot;</span>,</span>
<span id="cb54-3"><a href="ggplot2.html#cb54-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Sensitivity Analysis 2&quot;</span>,</span>
<span id="cb54-4"><a href="ggplot2.html#cb54-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Primary Analysis after imputation&quot;</span>),</span>
<span id="cb54-5"><a href="ggplot2.html#cb54-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2945</span>, <span class="sc">-</span><span class="fl">0.08334</span>, <span class="sc">-</span><span class="fl">0.2926</span>, <span class="sc">-</span><span class="fl">0.2395</span>),</span>
<span id="cb54-6"><a href="ggplot2.html#cb54-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">LL=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.9612</span>, <span class="sc">-</span><span class="fl">0.2861</span>, <span class="sc">-</span><span class="fl">0.9344</span>, <span class="sc">-</span><span class="fl">0.7521</span>),</span>
<span id="cb54-7"><a href="ggplot2.html#cb54-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">UL=</span><span class="fu">c</span>(<span class="fl">0.3722</span>, <span class="fl">0.1194</span>, <span class="fl">0.3491</span>, <span class="fl">0.2730</span>),</span>
<span id="cb54-8"><a href="ggplot2.html#cb54-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">pvalue=</span><span class="fu">c</span>(<span class="st">&quot;P = 0.313&quot;</span>, <span class="st">&quot;P = 0.347&quot;</span>, <span class="st">&quot;P = 0.304&quot;</span>,<span class="st">&quot;P = 0.359&quot;</span>))</span>
<span id="cb54-9"><a href="ggplot2.html#cb54-9" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> PrimEnd<span class="sc">$</span>Primary.Endpoint</span>
<span id="cb54-10"><a href="ggplot2.html#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="ggplot2.html#cb54-11" aria-hidden="true" tabindex="-1"></a>PrimEnd<span class="sc">$</span>Primary.Endpoint <span class="ot">&lt;-</span> <span class="fu">factor</span>(PrimEnd<span class="sc">$</span>Primary.Endpoint, <span class="at">levels=</span>level)</span>
<span id="cb54-12"><a href="ggplot2.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-13"><a href="ggplot2.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PrimEnd, <span class="fu">aes</span>(<span class="at">x=</span>Primary.Endpoint, <span class="at">y=</span>mean)) <span class="sc">+</span> </span>
<span id="cb54-14"><a href="ggplot2.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb54-15"><a href="ggplot2.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb54-16"><a href="ggplot2.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>pvalue),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb54-17"><a href="ggplot2.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dot&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb54-18"><a href="ggplot2.html#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>LL, <span class="at">ymax=</span>UL), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb54-19"><a href="ggplot2.html#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-20"><a href="ggplot2.html#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-21"><a href="ggplot2.html#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb54-22"><a href="ggplot2.html#cb54-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Difference between the IOLs&quot;</span>,</span>
<span id="cb54-23"><a href="ggplot2.html#cb54-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Superiority analysis in mean absolute rotation between Visit H0 (sitting) and H1&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-1.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ggplot2.html#cb55-1" aria-hidden="true" tabindex="-1"></a>tg <span class="ot">&lt;-</span> ToothGrowth</span>
<span id="cb55-2"><a href="ggplot2.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb55-3"><a href="ggplot2.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb55-4"><a href="ggplot2.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb55-5"><a href="ggplot2.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb55-6"><a href="ggplot2.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA&#39;s</span></span>
<span id="cb55-7"><a href="ggplot2.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb55-8"><a href="ggplot2.html#cb55-8" aria-hidden="true" tabindex="-1"></a>summarySE <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data=</span><span class="cn">NULL</span>, measurevar, <span class="at">groupvars=</span><span class="cn">NULL</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>,</span>
<span id="cb55-9"><a href="ggplot2.html#cb55-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">conf.interval=</span>.<span class="dv">95</span>, <span class="at">.drop=</span><span class="cn">TRUE</span>) {</span>
<span id="cb55-10"><a href="ggplot2.html#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(plyr)</span>
<span id="cb55-11"><a href="ggplot2.html#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="ggplot2.html#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># New version of length which can handle NA&#39;s: if na.rm==T, don&#39;t count them</span></span>
<span id="cb55-13"><a href="ggplot2.html#cb55-13" aria-hidden="true" tabindex="-1"></a>    length2 <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">na.rm=</span><span class="cn">FALSE</span>) {</span>
<span id="cb55-14"><a href="ggplot2.html#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (na.rm) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))</span>
<span id="cb55-15"><a href="ggplot2.html#cb55-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>       <span class="fu">length</span>(x)</span>
<span id="cb55-16"><a href="ggplot2.html#cb55-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-17"><a href="ggplot2.html#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="ggplot2.html#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This does the summary. For each group&#39;s data frame, return a vector with</span></span>
<span id="cb55-19"><a href="ggplot2.html#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># N, mean, and sd</span></span>
<span id="cb55-20"><a href="ggplot2.html#cb55-20" aria-hidden="true" tabindex="-1"></a>    datac <span class="ot">&lt;-</span> <span class="fu">ddply</span>(data, groupvars, <span class="at">.drop=</span>.drop,</span>
<span id="cb55-21"><a href="ggplot2.html#cb55-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fun =</span> <span class="cf">function</span>(xx, col) {</span>
<span id="cb55-22"><a href="ggplot2.html#cb55-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="at">N    =</span> <span class="fu">length2</span>(xx[[col]], <span class="at">na.rm=</span>na.rm),</span>
<span id="cb55-23"><a href="ggplot2.html#cb55-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>   (xx[[col]], <span class="at">na.rm=</span>na.rm),</span>
<span id="cb55-24"><a href="ggplot2.html#cb55-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd   =</span> <span class="fu">sd</span>     (xx[[col]], <span class="at">na.rm=</span>na.rm)</span>
<span id="cb55-25"><a href="ggplot2.html#cb55-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb55-26"><a href="ggplot2.html#cb55-26" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb55-27"><a href="ggplot2.html#cb55-27" aria-hidden="true" tabindex="-1"></a>      measurevar</span>
<span id="cb55-28"><a href="ggplot2.html#cb55-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-29"><a href="ggplot2.html#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="ggplot2.html#cb55-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename the &quot;mean&quot; column    </span></span>
<span id="cb55-31"><a href="ggplot2.html#cb55-31" aria-hidden="true" tabindex="-1"></a>    datac <span class="ot">&lt;-</span> <span class="fu">rename</span>(datac, <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span> <span class="ot">=</span> measurevar))</span>
<span id="cb55-32"><a href="ggplot2.html#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="ggplot2.html#cb55-33" aria-hidden="true" tabindex="-1"></a>    datac<span class="sc">$</span>se <span class="ot">&lt;-</span> datac<span class="sc">$</span>sd <span class="sc">/</span> <span class="fu">sqrt</span>(datac<span class="sc">$</span>N)  <span class="co"># Calculate standard error of the mean</span></span>
<span id="cb55-34"><a href="ggplot2.html#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="ggplot2.html#cb55-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Confidence interval multiplier for standard error</span></span>
<span id="cb55-36"><a href="ggplot2.html#cb55-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate t-statistic for confidence interval: </span></span>
<span id="cb55-37"><a href="ggplot2.html#cb55-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb55-38"><a href="ggplot2.html#cb55-38" aria-hidden="true" tabindex="-1"></a>    ciMult <span class="ot">&lt;-</span> <span class="fu">qt</span>(conf.interval<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> .<span class="dv">5</span>, datac<span class="sc">$</span>N<span class="dv">-1</span>)</span>
<span id="cb55-39"><a href="ggplot2.html#cb55-39" aria-hidden="true" tabindex="-1"></a>    datac<span class="sc">$</span>ci <span class="ot">&lt;-</span> datac<span class="sc">$</span>se <span class="sc">*</span> ciMult</span>
<span id="cb55-40"><a href="ggplot2.html#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-41"><a href="ggplot2.html#cb55-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(datac)</span>
<span id="cb55-42"><a href="ggplot2.html#cb55-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-43"><a href="ggplot2.html#cb55-43" aria-hidden="true" tabindex="-1"></a>tgc <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(tg, <span class="at">measurevar=</span><span class="st">&quot;len&quot;</span>, <span class="at">groupvars=</span><span class="fu">c</span>(<span class="st">&quot;supp&quot;</span>,<span class="st">&quot;dose&quot;</span>))</span>
<span id="cb55-44"><a href="ggplot2.html#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="co"># The errorbars overlapped, so use position_dodge to move them horizontally</span></span>
<span id="cb55-45"><a href="ggplot2.html#cb55-45" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.1</span>) </span>
<span id="cb55-46"><a href="ggplot2.html#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tgc, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>len, <span class="at">colour=</span>supp, <span class="at">group=</span>supp)) <span class="sc">+</span> </span>
<span id="cb55-47"><a href="ggplot2.html#cb55-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>len<span class="sc">-</span>se, <span class="at">ymax=</span>len<span class="sc">+</span>se), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb55-48"><a href="ggplot2.html#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb55-49"><a href="ggplot2.html#cb55-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position=</span>pd, <span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="co"># 21 is filled circle</span></span>
<span id="cb55-50"><a href="ggplot2.html#cb55-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-51"><a href="ggplot2.html#cb55-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Tooth length&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-52"><a href="ggplot2.html#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_hue</span>(<span class="at">name=</span><span class="st">&quot;Supplement type&quot;</span>,    <span class="co"># Legend label, use darker colors</span></span>
<span id="cb55-53"><a href="ggplot2.html#cb55-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;OJ&quot;</span>, <span class="st">&quot;VC&quot;</span>),</span>
<span id="cb55-54"><a href="ggplot2.html#cb55-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Orange juice&quot;</span>, <span class="st">&quot;Ascorbic acid&quot;</span>),</span>
<span id="cb55-55"><a href="ggplot2.html#cb55-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">l=</span><span class="dv">40</span>) <span class="sc">+</span>                    <span class="co"># Use darker colors, lightness=40</span></span>
<span id="cb55-56"><a href="ggplot2.html#cb55-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;The Effect of Vitamin C on</span><span class="sc">\n</span><span class="st">Tooth Growth in Guinea Pigs&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-57"><a href="ggplot2.html#cb55-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span>                        <span class="co"># Expand y range</span></span>
<span id="cb55-58"><a href="ggplot2.html#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">+</span>         <span class="co"># Set tick every 4</span></span>
<span id="cb55-59"><a href="ggplot2.html#cb55-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb55-60"><a href="ggplot2.html#cb55-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.justification=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb55-61"><a href="ggplot2.html#cb55-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))               <span class="co"># Position legend in bottom right</span></span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-2.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ggplot2.html#cb56-1" aria-hidden="true" tabindex="-1"></a>tgc2 <span class="ot">&lt;-</span> tgc</span>
<span id="cb56-2"><a href="ggplot2.html#cb56-2" aria-hidden="true" tabindex="-1"></a>tgc2<span class="sc">$</span>dose <span class="ot">&lt;-</span> <span class="fu">factor</span>(tgc2<span class="sc">$</span>dose)</span>
<span id="cb56-3"><a href="ggplot2.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tgc2, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>len, <span class="at">fill=</span>supp)) <span class="sc">+</span> </span>
<span id="cb56-4"><a href="ggplot2.html#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,</span>
<span id="cb56-5"><a href="ggplot2.html#cb56-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="co"># Use black outlines,</span></span>
<span id="cb56-6"><a href="ggplot2.html#cb56-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span>.<span class="dv">3</span>) <span class="sc">+</span>      <span class="co"># Thinner lines</span></span>
<span id="cb56-7"><a href="ggplot2.html#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>len<span class="sc">-</span>se, <span class="at">ymax=</span>len<span class="sc">+</span>se),</span>
<span id="cb56-8"><a href="ggplot2.html#cb56-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span>.<span class="dv">3</span>,    <span class="co"># Thinner lines</span></span>
<span id="cb56-9"><a href="ggplot2.html#cb56-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb56-10"><a href="ggplot2.html#cb56-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb56-11"><a href="ggplot2.html#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-12"><a href="ggplot2.html#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Tooth length&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-13"><a href="ggplot2.html#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>(<span class="at">name=</span><span class="st">&quot;Supplement type&quot;</span>, <span class="co"># Legend label, use darker colors</span></span>
<span id="cb56-14"><a href="ggplot2.html#cb56-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;OJ&quot;</span>, <span class="st">&quot;VC&quot;</span>),</span>
<span id="cb56-15"><a href="ggplot2.html#cb56-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Orange juice&quot;</span>, <span class="st">&quot;Ascorbic acid&quot;</span>)) <span class="sc">+</span></span>
<span id="cb56-16"><a href="ggplot2.html#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;The Effect of Vitamin C on</span><span class="sc">\n</span><span class="st">Tooth Growth in Guinea Pigs&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="ggplot2.html#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="ggplot2.html#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-3.png" width="672" /></p>
</div>
<div id="waffle-chart" class="section level3" number="7.4.6">
<h3><span class="header-section-number">7.4.6</span> Waffle Chart</h3>
<p>Show a good way to make a total classification. Although there is no direct function, it can be clarified by using the geom_tile () function.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ggplot2.html#cb57-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> mpg<span class="sc">$</span>class  <span class="co"># the categorical data </span></span>
<span id="cb57-2"><a href="ggplot2.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="ggplot2.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Prep data (nothing to change here)</span></span>
<span id="cb57-4"><a href="ggplot2.html#cb57-4" aria-hidden="true" tabindex="-1"></a>nrows <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb57-5"><a href="ggplot2.html#cb57-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span>nrows, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>nrows)</span>
<span id="cb57-6"><a href="ggplot2.html#cb57-6" aria-hidden="true" tabindex="-1"></a>categ_table <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">table</span>(var) <span class="sc">*</span> ((nrows<span class="sc">*</span>nrows)<span class="sc">/</span>(<span class="fu">length</span>(var))))</span>
<span id="cb57-7"><a href="ggplot2.html#cb57-7" aria-hidden="true" tabindex="-1"></a>categ_table</span></code></pre></div>
<pre><code>## var
##    2seater    compact    midsize    minivan     pickup subcompact        suv 
##          2         20         18          5         14         15         26</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ggplot2.html#cb59-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">names</span>(categ_table), categ_table)) </span>
<span id="cb59-2"><a href="ggplot2.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="ggplot2.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb59-4"><a href="ggplot2.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> category)) <span class="sc">+</span> </span>
<span id="cb59-5"><a href="ggplot2.html#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="ggplot2.html#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb59-7"><a href="ggplot2.html#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">trans =</span> <span class="st">&#39;reverse&#39;</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="ggplot2.html#cb59-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-9"><a href="ggplot2.html#cb59-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Waffle Chart&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;&#39;Class&#39; of vehicles&quot;</span>,</span>
<span id="cb59-10"><a href="ggplot2.html#cb59-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb59-11"><a href="ggplot2.html#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">2</span>),</span>
<span id="cb59-12"><a href="ggplot2.html#cb59-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>)),</span>
<span id="cb59-13"><a href="ggplot2.html#cb59-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-14"><a href="ggplot2.html#cb59-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-15"><a href="ggplot2.html#cb59-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-16"><a href="ggplot2.html#cb59-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-17"><a href="ggplot2.html#cb59-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_tile-1.png" width="672" /></p>
</div>
</div>
<div id="box-plot" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Box plot</h2>
<div id="varwidth" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> varwidth</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ggplot2.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span>
<span id="cb60-2"><a href="ggplot2.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="ggplot2.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty))<span class="sc">+</span></span>
<span id="cb60-4"><a href="ggplot2.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth=</span>T, <span class="at">fill=</span><span class="st">&quot;plum&quot;</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="ggplot2.html#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot&quot;</span>, </span>
<span id="cb60-6"><a href="ggplot2.html#cb60-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,</span>
<span id="cb60-7"><a href="ggplot2.html#cb60-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb60-8"><a href="ggplot2.html#cb60-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb60-9"><a href="ggplot2.html#cb60-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Boxplot%20using%20identity-1.png" width="672" />
### Reorder</p>
<p>Reorder: To make the trend easier to see, we can reorder class based on the median value of hwy:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ggplot2.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb61-2"><a href="ggplot2.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(class, hwy, <span class="at">FUN =</span> median), <span class="at">y =</span> hwy))<span class="sc">+</span></span>
<span id="cb61-3"><a href="ggplot2.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Reorder%20according%20to%20median-1.png" width="672" /></p>
</div>
<div id="fill" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Fill</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ggplot2.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty))<span class="sc">+</span></span>
<span id="cb62-2"><a href="ggplot2.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="ggplot2.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb62-4"><a href="ggplot2.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot&quot;</span>, </span>
<span id="cb62-5"><a href="ggplot2.html#cb62-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,</span>
<span id="cb62-6"><a href="ggplot2.html#cb62-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb62-7"><a href="ggplot2.html#cb62-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb62-8"><a href="ggplot2.html#cb62-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/grouping%20using%20fill-1.png" width="672" /></p>
</div>
<div id="statidentity-1" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> stat=“identity”</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ggplot2.html#cb63-1" aria-hidden="true" tabindex="-1"></a>Cylinder3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/Cylinder_Baseline.rds&quot;</span>)</span>
<span id="cb63-2"><a href="ggplot2.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-3"><a href="ggplot2.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Cylinder3,<span class="fu">aes</span>(<span class="at">x=</span>Subgroup,<span class="at">fill=</span>Treatment))<span class="sc">+</span></span>
<span id="cb63-4"><a href="ggplot2.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">lower=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">  SD</span><span class="st">`</span>,</span>
<span id="cb63-5"><a href="ggplot2.html#cb63-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">  SD</span><span class="st">`</span>,</span>
<span id="cb63-6"><a href="ggplot2.html#cb63-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">middle=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span>,</span>
<span id="cb63-7"><a href="ggplot2.html#cb63-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin=</span><span class="st">`</span><span class="at">  Min</span><span class="st">`</span>,</span>
<span id="cb63-8"><a href="ggplot2.html#cb63-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax=</span><span class="st">`</span><span class="at">  Max</span><span class="st">`</span>),</span>
<span id="cb63-9"><a href="ggplot2.html#cb63-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-10"><a href="ggplot2.html#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="st">`</span><span class="at">P-Value</span><span class="st">`</span>, <span class="at">x=</span>Subgroup, <span class="at">y=</span><span class="fl">5.5</span>),<span class="at">hjust=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb63-11"><a href="ggplot2.html#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="ggplot2.html#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-13"><a href="ggplot2.html#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="ggplot2.html#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Subgroups&quot;</span>,</span>
<span id="cb63-15"><a href="ggplot2.html#cb63-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cylinder [D]&quot;</span>,</span>
<span id="cb63-16"><a href="ggplot2.html#cb63-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Subjective refraction Cylinder at Baseline&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/identity-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="ggplot2.html#cb64-1" aria-hidden="true" tabindex="-1"></a>MeanRotation <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/MeanRotation.rds&quot;</span> )</span>
<span id="cb64-2"><a href="ggplot2.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(MeanRotation, <span class="fu">aes</span>(<span class="at">x=</span>Visit,<span class="at">fill=</span>Treatment))<span class="sc">+</span></span>
<span id="cb64-3"><a href="ggplot2.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">lower=</span>mean<span class="sc">-</span>SD,</span>
<span id="cb64-4"><a href="ggplot2.html#cb64-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper=</span>mean<span class="sc">+</span>SD,</span>
<span id="cb64-5"><a href="ggplot2.html#cb64-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">middle=</span>mean,</span>
<span id="cb64-6"><a href="ggplot2.html#cb64-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin=</span>min,</span>
<span id="cb64-7"><a href="ggplot2.html#cb64-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax=</span>max),</span>
<span id="cb64-8"><a href="ggplot2.html#cb64-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-9"><a href="ggplot2.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n, <span class="at">x=</span>Visit, <span class="at">y=</span>mean<span class="fl">+1.5</span>), <span class="at">vjust=</span><span class="fl">1.3</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb64-10"><a href="ggplot2.html#cb64-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb64-11"><a href="ggplot2.html#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>P,<span class="at">colour=</span>label_color, <span class="at">x=</span>Visit, <span class="at">y=</span><span class="dv">25</span>),<span class="at">hjust=</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb64-12"><a href="ggplot2.html#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-13"><a href="ggplot2.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span> Subgroup, <span class="at">nrow =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb64-14"><a href="ggplot2.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb64-15"><a href="ggplot2.html#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-16"><a href="ggplot2.html#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-17"><a href="ggplot2.html#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb64-18"><a href="ggplot2.html#cb64-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean absolute rotation&quot;</span>,</span>
<span id="cb64-19"><a href="ggplot2.html#cb64-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Mean absolute rotation by visit&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Identity-2.png" width="672" /></p>
</div>
<div id="dot-box-plot" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Dot + Box Plot</h3>
<p>In addition to the information provided by the box plot, you can provide clearer information in the form of summary statistics for each group. These points are interlaced to make each point represent an observation value.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ggplot2.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb65-2"><a href="ggplot2.html#cb65-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">reorder</span>(manufacturer, cty, <span class="at">FUN =</span> median) , cty))</span>
<span id="cb65-3"><a href="ggplot2.html#cb65-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb65-4"><a href="ggplot2.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">&#39;y&#39;</span>, </span>
<span id="cb65-5"><a href="ggplot2.html#cb65-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">stackdir=</span><span class="st">&#39;center&#39;</span>, </span>
<span id="cb65-6"><a href="ggplot2.html#cb65-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">dotsize =</span> .<span class="dv">5</span>, </span>
<span id="cb65-7"><a href="ggplot2.html#cb65-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="ggplot2.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb65-9"><a href="ggplot2.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-10"><a href="ggplot2.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot + Dot plot&quot;</span>, </span>
<span id="cb65-11"><a href="ggplot2.html#cb65-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage vs Class: Each dot represents 1 row in source data&quot;</span>,</span>
<span id="cb65-12"><a href="ggplot2.html#cb65-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb65-13"><a href="ggplot2.html#cb65-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb65-14"><a href="ggplot2.html#cb65-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Dot%20Box%20Plot-1.png" width="672" />
### Violin Plot</p>
<p>The violigogram is similar to the box pattern, but the density of the group is displayed. There is no too much information like a box line map.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="ggplot2.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="ggplot2.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb66-3"><a href="ggplot2.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Violin plot&quot;</span>, </span>
<span id="cb66-4"><a href="ggplot2.html#cb66-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage vs Class of vehicle&quot;</span>,</span>
<span id="cb66-5"><a href="ggplot2.html#cb66-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb66-6"><a href="ggplot2.html#cb66-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb66-7"><a href="ggplot2.html#cb66-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="ggplot2.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_violin-1.png" width="672" /></p>
</div>
</div>
<div id="other-rendering" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Other rendering</h2>
<div id="annotation" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Annotation</h3>
<p>Annotation for Text, Shape</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ggplot2.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb67-2"><a href="ggplot2.html#cb67-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/3_TwoNumOrdered.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb67-3"><a href="ggplot2.html#cb67-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(data<span class="sc">$</span>date)</span>
<span id="cb67-4"><a href="ggplot2.html#cb67-4" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="ggplot2.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="ggplot2.html#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-7"><a href="ggplot2.html#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fu">as.Date</span>(<span class="st">&quot;2017-01-01&quot;</span>), <span class="at">y=</span><span class="dv">19000</span>, </span>
<span id="cb67-8"><a href="ggplot2.html#cb67-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span><span class="st">&quot;Bitcoin price reached 20k $</span><span class="sc">\n</span><span class="st">at the end of 2017&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-9"><a href="ggplot2.html#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">x=</span><span class="fu">as.Date</span>(<span class="st">&quot;2017-12-17&quot;</span>), <span class="at">y=</span><span class="dv">20089</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-10"><a href="ggplot2.html#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">5000</span>, <span class="at">color=</span><span class="st">&quot;orange&quot;</span>, <span class="at">size=</span>.<span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Text%20and%20Shape-1.png" width="672" /></p>
</div>
<div id="text-ggtext" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Text: ggtext</h3>
<p><strong>Markdown in theme elements</strong></p>
<p>The ggtext package defines two new theme elements, element_markdown() and element_textbox(). Both behave similarly to element_text() but render the provided text as markdown/html. element_markdown() is meant as a direct replacement for element_text(), and it renders text without word wrapping. To start a new line, use the <br> tag or add two spaces before the end of a line.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="ggplot2.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## remotes::install_github(&quot;wilkelab/ggtext&quot;)</span></span>
<span id="cb68-2"><a href="ggplot2.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;ggtext&quot;)</span></span>
<span id="cb68-3"><a href="ggplot2.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggtext&quot;</span>)</span>
<span id="cb68-4"><a href="ggplot2.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb68-5"><a href="ggplot2.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;glue&quot;</span>)</span>
<span id="cb68-6"><a href="ggplot2.html#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="ggplot2.html#cb68-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-8"><a href="ggplot2.html#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bactname =</span> <span class="fu">c</span>(<span class="st">&quot;Staphylococcaceae&quot;</span>, <span class="st">&quot;Moraxella&quot;</span>, <span class="st">&quot;Streptococcus&quot;</span>, <span class="st">&quot;Acinetobacter&quot;</span>),</span>
<span id="cb68-9"><a href="ggplot2.html#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">OTUname =</span> <span class="fu">c</span>(<span class="st">&quot;OTU 1&quot;</span>, <span class="st">&quot;OTU 2&quot;</span>, <span class="st">&quot;OTU 3&quot;</span>, <span class="st">&quot;OTU 4&quot;</span>),</span>
<span id="cb68-10"><a href="ggplot2.html#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb68-11"><a href="ggplot2.html#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="ggplot2.html#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="ggplot2.html#cb68-13" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb68-14"><a href="ggplot2.html#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#0072B2&quot;</span>, <span class="st">&quot;#000000&quot;</span>),</span>
<span id="cb68-15"><a href="ggplot2.html#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">glue</span>(<span class="st">&quot;&lt;i style=&#39;color:{color}&#39;&gt;{bactname}&lt;/i&gt; ({OTUname})&quot;</span>),</span>
<span id="cb68-16"><a href="ggplot2.html#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">fct_reorder</span>(name, value)</span>
<span id="cb68-17"><a href="ggplot2.html#cb68-17" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="ggplot2.html#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, name, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb68-19"><a href="ggplot2.html#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb68-20"><a href="ggplot2.html#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb68-21"><a href="ggplot2.html#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">&quot;Example posted on **stackoverflow.com**&lt;br&gt;(using made-up data)&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-22"><a href="ggplot2.html#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-23"><a href="ggplot2.html#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb68-24"><a href="ggplot2.html#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_markdown</span>(<span class="at">lineheight =</span> <span class="fl">1.2</span>)</span>
<span id="cb68-25"><a href="ggplot2.html#cb68-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtext-1.png" width="672" /></p>
</div>
<div id="text-ggrepel" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Text: ggrepel</h3>
<p>There are two important functions in ggrepel R packages:</p>
<ul>
<li>geom_label_repel()</li>
<li>geom_text_repel()</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ggplot2.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb69-2"><a href="ggplot2.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Take a subset of 15 random points</span></span>
<span id="cb69-3"><a href="ggplot2.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb69-4"><a href="ggplot2.html#cb69-4" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">15</span>)</span>
<span id="cb69-5"><a href="ggplot2.html#cb69-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mtcars[ss, ]</span>
<span id="cb69-6"><a href="ggplot2.html#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="ggplot2.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a scatter plot:</span></span>
<span id="cb69-8"><a href="ggplot2.html#cb69-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb69-9"><a href="ggplot2.html#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb69-10"><a href="ggplot2.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb69-11"><a href="ggplot2.html#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="ggplot2.html#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Add text labels:</span></span>
<span id="cb69-13"><a href="ggplot2.html#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Add text annotations using ggplot2::geom_text</span></span>
<span id="cb69-14"><a href="ggplot2.html#cb69-14" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df)),</span>
<span id="cb69-15"><a href="ggplot2.html#cb69-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ggplot2.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Use ggrepel::geom_text_repel</span></span>
<span id="cb70-2"><a href="ggplot2.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb70-3"><a href="ggplot2.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb70-4"><a href="ggplot2.html#cb70-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df)),</span>
<span id="cb70-5"><a href="ggplot2.html#cb70-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fl">3.5</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-2.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="ggplot2.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change color by groups</span></span>
<span id="cb71-2"><a href="ggplot2.html#cb71-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df),</span>
<span id="cb71-3"><a href="ggplot2.html#cb71-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="fu">factor</span>(cyl)), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb71-4"><a href="ggplot2.html#cb71-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb71-5"><a href="ggplot2.html#cb71-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-3.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ggplot2.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With selection</span></span>
<span id="cb72-2"><a href="ggplot2.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Data are available in the gapminder package</span></span>
<span id="cb72-3"><a href="ggplot2.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb72-4"><a href="ggplot2.html#cb72-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">==</span><span class="st">&quot;2007&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>year)</span>
<span id="cb72-5"><a href="ggplot2.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb72-6"><a href="ggplot2.html#cb72-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="ggplot2.html#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">annotation =</span> <span class="fu">ifelse</span>(gdpPercap <span class="sc">&gt;</span> <span class="dv">5000</span> <span class="sc">&amp;</span> lifeExp <span class="sc">&lt;</span> <span class="dv">60</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</span>
<span id="cb72-8"><a href="ggplot2.html#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb72-9"><a href="ggplot2.html#cb72-9" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb72-10"><a href="ggplot2.html#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>gdpPercap, <span class="at">y=</span>lifeExp, <span class="at">size =</span> pop, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb72-11"><a href="ggplot2.html#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb72-12"><a href="ggplot2.html#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-13"><a href="ggplot2.html#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data=</span>tmp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annotation<span class="sc">==</span><span class="st">&quot;yes&quot;</span>), <span class="fu">aes</span>(<span class="at">label=</span>country), <span class="at">size=</span><span class="dv">4</span> )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-4.png" width="672" /></p>
</div>
<div id="arrage-gridextra" class="section level3" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Arrage: gridExtra</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ggplot2.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## assemble multiple plots on a page is to use the grid.arrange() function</span></span>
<span id="cb73-2"><a href="ggplot2.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb73-3"><a href="ggplot2.html#cb73-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(mpg, wt, <span class="at">data =</span> mtcars, <span class="at">colour =</span> cyl)</span>
<span id="cb73-4"><a href="ggplot2.html#cb73-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(mpg, <span class="at">data =</span> mtcars) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;title&quot;</span>)</span>
<span id="cb73-5"><a href="ggplot2.html#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="ggplot2.html#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/lay-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ggplot2.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tables and other grobs</span></span>
<span id="cb74-2"><a href="ggplot2.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb74-3"><a href="ggplot2.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tableGrob</span>(mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]),</span>
<span id="cb74-4"><a href="ggplot2.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  p2,</span>
<span id="cb74-5"><a href="ggplot2.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb74-6"><a href="ggplot2.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>),</span>
<span id="cb74-7"><a href="ggplot2.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">clip =</span> <span class="cn">FALSE</span></span>
<span id="cb74-8"><a href="ggplot2.html#cb74-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/lay-2.png" width="672" /></p>
</div>
<div id="interactive-charts-plotly" class="section level3" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Interactive charts: plotly</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ggplot2.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb75-2"><a href="ggplot2.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb75-3"><a href="ggplot2.html#cb75-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">==</span><span class="st">&quot;2007&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>year)</span>
<span id="cb75-4"><a href="ggplot2.html#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="ggplot2.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive version</span></span>
<span id="cb75-6"><a href="ggplot2.html#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb75-7"><a href="ggplot2.html#cb75-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb75-8"><a href="ggplot2.html#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">myText=</span><span class="fu">paste</span>(<span class="st">&quot;This country is: &quot;</span> , country )) <span class="sc">%&gt;%</span></span>
<span id="cb75-9"><a href="ggplot2.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>gdpPercap, <span class="at">y=</span>lifeExp, <span class="at">size =</span> pop, <span class="at">color =</span> continent, <span class="at">text=</span>myText)) <span class="sc">+</span></span>
<span id="cb75-10"><a href="ggplot2.html#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) </span>
<span id="cb75-11"><a href="ggplot2.html#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="ggplot2.html#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-471cb6a5008ccd84c836" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-471cb6a5008ccd84c836">{"x":{"data":[{"x":[6223.367465,4797.231267,1441.284873,12569.85177,1217.032994,430.0706916,2042.09524,706.016537,1704.063724,986.1478792,277.5518587,3632.557798,1544.750112,2082.481567,5581.180998,12154.08975,641.3695236,690.8055759,13206.48452,752.7497265,1327.60891,942.6542111,579.231743,1463.249282,1569.331442,414.5073415,12057.49928,1044.770126,759.3499101,1042.581557,1803.151496,10956.99112,3820.17523,823.6856205,4811.060429,619.6768924,2013.977305,7670.122558,863.0884639,1598.435089,1712.472136,862.5407561,926.1410683,9269.657808,2602.394995,4513.480643,1107.482182,882.9699438,7092.923025,1056.380121,1271.211593,469.7092981],"y":[72.301,42.731,56.728,50.728,52.295,49.58,50.43,44.741,50.651,65.152,46.462,55.322,48.328,54.791,71.338,51.579,58.04,52.947,56.735,59.448,60.022,56.007,46.388,54.11,42.592,45.678,73.952,59.443,48.303,54.467,64.164,72.801,71.164,42.082,52.906,56.867,46.859,76.442,46.242,65.528,63.062,42.568,48.159,49.339,58.556,39.613,52.517,58.42,73.923,51.542,42.384,43.487],"text":["This country is:  Algeria","This country is:  Angola","This country is:  Benin","This country is:  Botswana","This country is:  Burkina Faso","This country is:  Burundi","This country is:  Cameroon","This country is:  Central African Republic","This country is:  Chad","This country is:  Comoros","This country is:  Congo, Dem. Rep.","This country is:  Congo, Rep.","This country is:  Cote d'Ivoire","This country is:  Djibouti","This country is:  Egypt","This country is:  Equatorial Guinea","This country is:  Eritrea","This country is:  Ethiopia","This country is:  Gabon","This country is:  Gambia","This country is:  Ghana","This country is:  Guinea","This country is:  Guinea-Bissau","This country is:  Kenya","This country is:  Lesotho","This country is:  Liberia","This country is:  Libya","This country is:  Madagascar","This country is:  Malawi","This country is:  Mali","This country is:  Mauritania","This country is:  Mauritius","This country is:  Morocco","This country is:  Mozambique","This country is:  Namibia","This country is:  Niger","This country is:  Nigeria","This country is:  Reunion","This country is:  Rwanda","This country is:  Sao Tome and Principe","This country is:  Senegal","This country is:  Sierra Leone","This country is:  Somalia","This country is:  South Africa","This country is:  Sudan","This country is:  Swaziland","This country is:  Tanzania","This country is:  Togo","This country is:  Tunisia","This country is:  Uganda","This country is:  Zambia","This country is:  Zimbabwe"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.7,"size":[6.77527173254923,5.598900411863,5.24035330707835,4.40395768399738,5.7356199392208,5.26901439581437,5.9564773609874,4.8422259478741,5.42852631166044,4.15169850163956,7.9562662998771,4.76713328307226,5.97611663817011,4.06305719383881,8.43636871732964,4.08813627550005,4.90865391372741,8.32592567062337,4.36262596871136,4.41454467512776,6.25770233060098,5.40445197132612,4.3666011970112,6.87649613589243,4.480300710223,4.68010775450673,5.03693920169262,6.0461636385333,5.66517797748393,5.5697344023561,4.69148323166173,4.31315004312066,6.79437672410524,6.09253246174489,4.48845333089755,5.6338762963756,9.82271393327331,4.18215900239245,5.3111594952501,3.77952755905512,5.58747695964146,5.04848038390226,5.33382085391144,7.22380829377829,7.1561065468969,4.282361176813,6.98520027409899,5.00028803920838,5.43159101796171,6.580769078434,5.54798462578679,5.59074371141117],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Africa","legendgroup":"Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12779.37964,3822.137084,9065.800825,36319.23501,13171.63885,7006.580419,9645.06142,8948.102923,6025.374752,6873.262326,5728.353514,5186.050003,1201.637154,3548.330846,7320.880262,11977.57496,2749.320965,9809.185636,4172.838464,7408.905561,19328.70901,18008.50924,42951.65309,10611.46299,11415.80569],"y":[75.32,65.554,72.39,80.653,78.553,72.889,78.782,78.273,72.235,74.994,71.878,70.259,60.916,70.198,72.567,76.195,72.899,75.537,71.752,71.421,78.746,69.819,78.242,76.384,73.747],"text":["This country is:  Argentina","This country is:  Bolivia","This country is:  Brazil","This country is:  Canada","This country is:  Chile","This country is:  Colombia","This country is:  Costa Rica","This country is:  Cuba","This country is:  Dominican Republic","This country is:  Ecuador","This country is:  El Salvador","This country is:  Guatemala","This country is:  Haiti","This country is:  Honduras","This country is:  Jamaica","This country is:  Mexico","This country is:  Nicaragua","This country is:  Panama","This country is:  Paraguay","This country is:  Peru","This country is:  Puerto Rico","This country is:  Trinidad and Tobago","This country is:  United States","This country is:  Uruguay","This country is:  Venezuela"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":0.7,"size":[7.07528369289545,5.33385387656466,10.9497220287062,6.77784403625228,5.86681801798997,7.23282911414924,4.81182340745332,5.52260397354913,5.35122378867242,5.69571313317988,5.1306777542305,5.61021330347734,5.27919109958551,5.18415329737334,4.6155666029278,9.20063061292984,4.99737544049698,4.68733172329479,5.10307852744492,6.55670348636785,4.78640121163658,4.26132881438327,12.807919245623,4.71746231550028,6.42738713411734],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Americas","legendgroup":"Americas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[974.5803384,29796.04834,1391.253792,1713.778686,4959.114854,39724.97867,2452.210407,3540.651564,11605.71449,4471.061906,25523.2771,31656.06806,4519.461171,1593.06548,23348.13973,47306.98978,10461.05868,12451.6558,3095.772271,944,1091.359778,22316.19287,2605.94758,3190.481016,21654.83194,47143.17964,3970.095407,4184.548089,28718.27684,7458.396327,2441.576404,3025.349798,2280.769906],"y":[43.828,75.635,64.062,59.723,72.961,82.208,64.698,70.65,70.964,59.545,80.745,82.603,72.535,67.297,78.623,77.588,71.993,74.241,66.803,62.069,63.785,75.64,65.483,71.688,72.777,79.972,72.396,74.143,78.4,70.616,74.249,73.422,62.698],"text":["This country is:  Afghanistan","This country is:  Bahrain","This country is:  Bangladesh","This country is:  Cambodia","This country is:  China","This country is:  Hong Kong, China","This country is:  India","This country is:  Indonesia","This country is:  Iran","This country is:  Iraq","This country is:  Israel","This country is:  Japan","This country is:  Jordan","This country is:  Korea, Dem. Rep.","This country is:  Korea, Rep.","This country is:  Kuwait","This country is:  Lebanon","This country is:  Malaysia","This country is:  Mongolia","This country is:  Myanmar","This country is:  Nepal","This country is:  Oman","This country is:  Pakistan","This country is:  Philippines","This country is:  Saudi Arabia","This country is:  Singapore","This country is:  Sri Lanka","This country is:  Syria","This country is:  Taiwan","This country is:  Thailand","This country is:  Vietnam","This country is:  West Bank and Gaza","This country is:  Yemen, Rep."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":0.7,"size":[6.70929835135528,4.1508288847182,10.1588656081799,5.72211801075065,22.6771653543307,5.13475345805415,21.1203680953071,11.5573968303758,8.11057131553749,6.49879524068774,5.07824026167466,9.65077587363648,5.03869129857133,6.28100350114513,7.4168446506104,4.56983839481089,4.78354392302204,6.36196165910748,4.63065651672448,7.36876387589759,6.56775273775666,4.68175365529605,10.5466615830696,8.74086596862592,6.50384061768477,4.86541785279541,6.11737587407916,6.05493528307165,6.27409491409121,7.97119993399054,8.57951329437571,4.79655097614072,6.22127948111281],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"Asia","legendgroup":"Asia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5937.029526,36126.4927,33692.60508,7446.298803,10680.79282,14619.22272,22833.30851,35278.41874,33207.0844,30470.0167,32170.37442,27538.41188,18008.94444,36180.78919,40675.99635,28569.7197,9253.896111,36797.93332,49357.19017,15389.92468,20509.64777,10808.47561,9786.534714,18678.31435,25768.25759,28821.0637,33859.74835,37506.41907,8458.276384,33203.26128],"y":[76.423,79.829,79.441,74.852,73.005,75.748,76.486,78.332,79.313,80.657,79.406,79.483,73.338,81.757,78.885,80.546,74.543,79.762,80.196,75.563,78.098,72.476,74.002,74.663,77.926,80.941,80.884,81.701,71.777,79.425],"text":["This country is:  Albania","This country is:  Austria","This country is:  Belgium","This country is:  Bosnia and Herzegovina","This country is:  Bulgaria","This country is:  Croatia","This country is:  Czech Republic","This country is:  Denmark","This country is:  Finland","This country is:  France","This country is:  Germany","This country is:  Greece","This country is:  Hungary","This country is:  Iceland","This country is:  Ireland","This country is:  Italy","This country is:  Montenegro","This country is:  Netherlands","This country is:  Norway","This country is:  Poland","This country is:  Portugal","This country is:  Romania","This country is:  Serbia","This country is:  Slovak Republic","This country is:  Slovenia","This country is:  Spain","This country is:  Sweden","This country is:  Switzerland","This country is:  Turkey","This country is:  United Kingdom"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":0.7,"size":[4.73930360976545,5.2515712457991,5.44107849786917,4.86531670289218,5.16855282584858,4.85794694387522,5.42769965273683,4.97410786436283,4.94778140481952,7.84043376621969,8.49809123744673,5.46648280699294,5.40514308400654,3.9460291298415,4.8085649745634,7.74130405516196,4.14203032052794,5.88528441607637,4.87472139425141,7.00115515259145,5.46138101214586,6.22484391610449,5.42123845033248,4.97176812735327,4.47964255788798,7.0812884751231,5.32616181946541,5.19097245574501,8.16356363915206,7.83015990857845],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Europe","legendgroup":"Europe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34435.36744,25185.00911],"y":[81.235,80.204],"text":["This country is:  Australia","This country is:  New Zealand"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":0.7,"size":[6.12061399094626,4.80944439195868],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Oceania","legendgroup":"Oceania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2176.430056865,51811.172085565],"tickmode":"array","ticktext":["0","10000","20000","30000","40000","50000"],"tickvals":[0,10000,20000,30000,40000,50000],"categoryorder":"array","categoryarray":["0","10000","20000","30000","40000","50000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"gdpPercap","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.4635,84.7525],"tickmode":"array","ticktext":["40","50","60","70","80"],"tickvals":[40,50,60,70,80],"categoryorder":"array","categoryarray":["40","50","60","70","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"lifeExp","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"pop<br />continent","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3abc48ce383d":{"x":{},"y":{},"size":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"3abc48ce383d","visdat":{"3abc48ce383d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="space.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="proc-sqplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
