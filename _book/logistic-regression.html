<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Logistic Regression | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Logistic Regression | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Logistic Regression | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2021-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-linear-regression.html"/>
<link rel="next" href="advanced-logistic-regression.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="input-and-format.html"><a href="input-and-format.html"><i class="fa fa-check"></i><b>2</b> Input and Format</a>
<ul>
<li class="chapter" data-level="2.1" data-path="input-and-format.html"><a href="input-and-format.html#input-data-into-sas"><i class="fa fa-check"></i><b>2.1</b> Input data into SAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="input-and-format.html"><a href="input-and-format.html#reading-free-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.1</b> Reading free formatted data instream</a></li>
<li class="chapter" data-level="2.1.2" data-path="input-and-format.html"><a href="input-and-format.html#reading-fixed-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.2</b> Reading fixed formatted data instream</a></li>
<li class="chapter" data-level="2.1.3" data-path="input-and-format.html"><a href="input-and-format.html#infile-reading-fixed-formatted-data-from-an-external-file"><i class="fa fa-check"></i><b>2.1.3</b> INFILE: Reading fixed formatted data from an external file</a></li>
<li class="chapter" data-level="2.1.4" data-path="input-and-format.html"><a href="input-and-format.html#write-the-sas-file"><i class="fa fa-check"></i><b>2.1.4</b> Write the SAS File</a></li>
<li class="chapter" data-level="2.1.5" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data"><i class="fa fa-check"></i><b>2.1.5</b> Import csv data</a></li>
<li class="chapter" data-level="2.1.6" data-path="input-and-format.html"><a href="input-and-format.html#import"><i class="fa fa-check"></i><b>2.1.6</b> %Import</a></li>
<li class="chapter" data-level="2.1.7" data-path="input-and-format.html"><a href="input-and-format.html#infile-read-multiple-raw-data-files"><i class="fa fa-check"></i><b>2.1.7</b> Infile Read multiple raw data files</a></li>
<li class="chapter" data-level="2.1.8" data-path="input-and-format.html"><a href="input-and-format.html#generate-automatic-file-name"><i class="fa fa-check"></i><b>2.1.8</b> Generate automatic file name</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="input-and-format.html"><a href="input-and-format.html#input-and-import-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Input and import data in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data-1"><i class="fa fa-check"></i><b>2.2.1</b> Import csv data</a></li>
<li class="chapter" data-level="2.2.2" data-path="input-and-format.html"><a href="input-and-format.html#import-txt-data"><i class="fa fa-check"></i><b>2.2.2</b> Import txt data</a></li>
<li class="chapter" data-level="2.2.3" data-path="input-and-format.html"><a href="input-and-format.html#import-excel-data"><i class="fa fa-check"></i><b>2.2.3</b> Import excel data</a></li>
<li class="chapter" data-level="2.2.4" data-path="input-and-format.html"><a href="input-and-format.html#import-stata-data"><i class="fa fa-check"></i><b>2.2.4</b> Import stata data</a></li>
<li class="chapter" data-level="2.2.5" data-path="input-and-format.html"><a href="input-and-format.html#import-sas-data"><i class="fa fa-check"></i><b>2.2.5</b> Import SAS data</a></li>
<li class="chapter" data-level="2.2.6" data-path="input-and-format.html"><a href="input-and-format.html#copy-from-clipboard"><i class="fa fa-check"></i><b>2.2.6</b> Copy from clipboard</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="input-and-format.html"><a href="input-and-format.html#save-and-write-objective-in-r"><i class="fa fa-check"></i><b>2.3</b> Save and write objective in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="input-and-format.html"><a href="input-and-format.html#save-as-r-datei"><i class="fa fa-check"></i><b>2.3.1</b> Save as R-Datei</a></li>
<li class="chapter" data-level="2.3.2" data-path="input-and-format.html"><a href="input-and-format.html#write.table-and-write.csv"><i class="fa fa-check"></i><b>2.3.2</b> write.table and write.csv</a></li>
<li class="chapter" data-level="2.3.3" data-path="input-and-format.html"><a href="input-and-format.html#write.foreign"><i class="fa fa-check"></i><b>2.3.3</b> write.foreign</a></li>
<li class="chapter" data-level="2.3.4" data-path="input-and-format.html"><a href="input-and-format.html#write.xlsx"><i class="fa fa-check"></i><b>2.3.4</b> write.xlsx</a></li>
<li class="chapter" data-level="2.3.5" data-path="input-and-format.html"><a href="input-and-format.html#save-the-plot"><i class="fa fa-check"></i><b>2.3.5</b> Save the plot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="input-and-format.html"><a href="input-and-format.html#format-in-sas"><i class="fa fa-check"></i><b>2.4</b> Format in SAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="input-and-format.html"><a href="input-and-format.html#proc-format"><i class="fa fa-check"></i><b>2.4.1</b> Proc format</a></li>
<li class="chapter" data-level="2.4.2" data-path="input-and-format.html"><a href="input-and-format.html#copy-and-combine-sas-format-libraries"><i class="fa fa-check"></i><b>2.4.2</b> Copy and combine SAS format libraries</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="input-and-format.html"><a href="input-and-format.html#package-readr"><i class="fa fa-check"></i><b>2.5</b> Package readr</a></li>
<li class="chapter" data-level="2.6" data-path="input-and-format.html"><a href="input-and-format.html#package-strings"><i class="fa fa-check"></i><b>2.6</b> Package Strings</a></li>
<li class="chapter" data-level="2.7" data-path="input-and-format.html"><a href="input-and-format.html#package-forcats"><i class="fa fa-check"></i><b>2.7</b> Package forcats</a></li>
<li class="chapter" data-level="2.8" data-path="input-and-format.html"><a href="input-and-format.html#package-lubridate"><i class="fa fa-check"></i><b>2.8</b> Package lubridate</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html"><i class="fa fa-check"></i><b>3</b> Data Management in SAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#array"><i class="fa fa-check"></i><b>3.1</b> Array</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#defining"><i class="fa fa-check"></i><b>3.1.1</b> Defining</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#format-multiple-variables"><i class="fa fa-check"></i><b>3.1.2</b> Format multiple variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#arrays"><i class="fa fa-check"></i><b>3.1.3</b> 2*2 arrays</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables"><i class="fa fa-check"></i><b>3.1.4</b> Dynamic Element List using Macro Variables</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#carry-over-values"><i class="fa fa-check"></i><b>3.1.5</b> Carry over values</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#retain"><i class="fa fa-check"></i><b>3.2</b> Retain</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#change-from-basilne"><i class="fa fa-check"></i><b>3.2.1</b> Change from Basilne</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#variable-names-and-types"><i class="fa fa-check"></i><b>3.3</b> Variable Names and Types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#convert-all-numeric-to-char"><i class="fa fa-check"></i><b>3.3.1</b> Convert all numeric to char*</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#get-all-the-numeric-variable-names"><i class="fa fa-check"></i><b>3.3.2</b> Get all the numeric variable names</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-variable-names-as-macro-variables"><i class="fa fa-check"></i><b>3.3.3</b> Write all variable names as macro variables</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-observations-as-macro-variable"><i class="fa fa-check"></i><b>3.3.4</b> Write all observations as macro variable</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-some-variables"><i class="fa fa-check"></i><b>3.3.5</b> Rename some variables</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-with-suffix"><i class="fa fa-check"></i><b>3.3.6</b> Rename with suffix</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-array-variables"><i class="fa fa-check"></i><b>3.3.7</b> Rename array variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-exists-for-validation"><i class="fa fa-check"></i><b>3.4</b> Check exists for validation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-exists"><i class="fa fa-check"></i><b>3.4.1</b> Check datasets exists</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-and-variables"><i class="fa fa-check"></i><b>3.4.2</b> Check datasets and Variables</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-if-empty"><i class="fa fa-check"></i><b>3.4.3</b> Check datasets if empty</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#sysfunc-get-the-observations"><i class="fa fa-check"></i><b>3.4.4</b> %sysfunc get the observations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#proc-transpose"><i class="fa fa-check"></i><b>3.5</b> Proc Transpose</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#numeric"><i class="fa fa-check"></i><b>3.5.1</b> <em>numeric</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#in-processing"><i class="fa fa-check"></i><b>3.5.2</b> In processing</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#clean-up"><i class="fa fa-check"></i><b>3.6</b> Clean Up</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#basic-setting"><i class="fa fa-check"></i><b>3.6.1</b> Basic setting</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-datasets"><i class="fa fa-check"></i><b>3.6.2</b> Delete datasets</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#deleting-formats"><i class="fa fa-check"></i><b>3.6.3</b> Deleting Formats</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#remove-assigned-formats"><i class="fa fa-check"></i><b>3.6.4</b> Remove assigned formats</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro-variables"><i class="fa fa-check"></i><b>3.6.5</b> Delete macro variables</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro"><i class="fa fa-check"></i><b>3.6.6</b> Delete Macro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management-in-r.html"><a href="data-management-in-r.html"><i class="fa fa-check"></i><b>4</b> Data Management in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-tidyr"><i class="fa fa-check"></i><b>4.1</b> Package tidyr</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#pivoting"><i class="fa fa-check"></i><b>4.1.1</b> Pivoting</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#gather-and-spread"><i class="fa fa-check"></i><b>4.1.2</b> gather and spread</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#separate-and-unite"><i class="fa fa-check"></i><b>4.1.3</b> separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-dplyr"><i class="fa fa-check"></i><b>4.2</b> Package dplyr</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#data-transformation-with-dplyr"><i class="fa fa-check"></i><b>4.2.1</b> Data Transformation with dplyr</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#across"><i class="fa fa-check"></i><b>4.2.2</b> across</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#arrange"><i class="fa fa-check"></i><b>4.2.3</b> arrange</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#coalesce"><i class="fa fa-check"></i><b>4.2.4</b> coalesce</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#filter"><i class="fa fa-check"></i><b>4.2.5</b> filter</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#if_else"><i class="fa fa-check"></i><b>4.2.6</b> if_else</a></li>
<li class="chapter" data-level="4.2.7" data-path="data-management-in-r.html"><a href="data-management-in-r.html#join"><i class="fa fa-check"></i><b>4.2.7</b> join</a></li>
<li class="chapter" data-level="4.2.8" data-path="data-management-in-r.html"><a href="data-management-in-r.html#mutate"><i class="fa fa-check"></i><b>4.2.8</b> mutate</a></li>
<li class="chapter" data-level="4.2.9" data-path="data-management-in-r.html"><a href="data-management-in-r.html#select"><i class="fa fa-check"></i><b>4.2.9</b> select</a></li>
<li class="chapter" data-level="4.2.10" data-path="data-management-in-r.html"><a href="data-management-in-r.html#summarise"><i class="fa fa-check"></i><b>4.2.10</b> summarise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>5</b> SQL</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sql.html"><a href="sql.html#mysql-management"><i class="fa fa-check"></i><b>5.1</b> MySQL: Management</a></li>
<li class="chapter" data-level="5.2" data-path="sql.html"><a href="sql.html#mysql-php-in-processing"><i class="fa fa-check"></i><b>5.2</b> MySQL PHP (In processing)</a></li>
<li class="chapter" data-level="5.3" data-path="sql.html"><a href="sql.html#proc-sql-in-sas"><i class="fa fa-check"></i><b>5.3</b> PROC SQL in SAS</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sql.html"><a href="sql.html#inreoduction"><i class="fa fa-check"></i><b>5.3.1</b> Inreoduction</a></li>
<li class="chapter" data-level="5.3.2" data-path="sql.html"><a href="sql.html#create-normal-table"><i class="fa fa-check"></i><b>5.3.2</b> Create Normal Table</a></li>
<li class="chapter" data-level="5.3.3" data-path="sql.html"><a href="sql.html#creating-tables-like-an-existing-table"><i class="fa fa-check"></i><b>5.3.3</b> Creating Tables like an Existing Table</a></li>
<li class="chapter" data-level="5.3.4" data-path="sql.html"><a href="sql.html#inserting-rows"><i class="fa fa-check"></i><b>5.3.4</b> Inserting Rows</a></li>
<li class="chapter" data-level="5.3.5" data-path="sql.html"><a href="sql.html#delete-rows-and-table"><i class="fa fa-check"></i><b>5.3.5</b> Delete Rows and Table</a></li>
<li class="chapter" data-level="5.3.6" data-path="sql.html"><a href="sql.html#new-columns-using-summary-function"><i class="fa fa-check"></i><b>5.3.6</b> New Columns using Summary Function</a></li>
<li class="chapter" data-level="5.3.7" data-path="sql.html"><a href="sql.html#aggregation-summary"><i class="fa fa-check"></i><b>5.3.7</b> Aggregation: Summary</a></li>
<li class="chapter" data-level="5.3.8" data-path="sql.html"><a href="sql.html#conditionality-if"><i class="fa fa-check"></i><b>5.3.8</b> Conditionality (If)</a></li>
<li class="chapter" data-level="5.3.9" data-path="sql.html"><a href="sql.html#filtering-aggregated-data-having"><i class="fa fa-check"></i><b>5.3.9</b> Filtering Aggregated Data (HAVING)</a></li>
<li class="chapter" data-level="5.3.10" data-path="sql.html"><a href="sql.html#select-operator-union"><i class="fa fa-check"></i><b>5.3.10</b> Select Operator (Union…)</a></li>
<li class="chapter" data-level="5.3.11" data-path="sql.html"><a href="sql.html#loap"><i class="fa fa-check"></i><b>5.3.11</b> Loap</a></li>
<li class="chapter" data-level="5.3.12" data-path="sql.html"><a href="sql.html#join-1"><i class="fa fa-check"></i><b>5.3.12</b> Join</a></li>
<li class="chapter" data-level="5.3.13" data-path="sql.html"><a href="sql.html#reordering-rows-proc-sort"><i class="fa fa-check"></i><b>5.3.13</b> Reordering Rows (Proc Sort)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sql.html"><a href="sql.html#package-dbi-in-processing"><i class="fa fa-check"></i><b>5.4</b> Package DBI (In processing)</a></li>
<li class="chapter" data-level="5.5" data-path="sql.html"><a href="sql.html#package-sparklyr-in-processing"><i class="fa fa-check"></i><b>5.5</b> Package sparklyr (In processing)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>6</b> ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ggplot2.html"><a href="ggplot2.html#parametric-rendering"><i class="fa fa-check"></i><b>6.1</b> Parametric Rendering</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ggplot2.html"><a href="ggplot2.html#grammar"><i class="fa fa-check"></i><b>6.1.1</b> Grammar</a></li>
<li class="chapter" data-level="6.1.2" data-path="ggplot2.html"><a href="ggplot2.html#coord"><i class="fa fa-check"></i><b>6.1.2</b> coord</a></li>
<li class="chapter" data-level="6.1.3" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>6.1.3</b> facet</a></li>
<li class="chapter" data-level="6.1.4" data-path="ggplot2.html"><a href="ggplot2.html#geom"><i class="fa fa-check"></i><b>6.1.4</b> geom</a></li>
<li class="chapter" data-level="6.1.5" data-path="ggplot2.html"><a href="ggplot2.html#position"><i class="fa fa-check"></i><b>6.1.5</b> position</a></li>
<li class="chapter" data-level="6.1.6" data-path="ggplot2.html"><a href="ggplot2.html#scale"><i class="fa fa-check"></i><b>6.1.6</b> scale</a></li>
<li class="chapter" data-level="6.1.7" data-path="ggplot2.html"><a href="ggplot2.html#stat"><i class="fa fa-check"></i><b>6.1.7</b> stat</a></li>
<li class="chapter" data-level="6.1.8" data-path="ggplot2.html"><a href="ggplot2.html#color"><i class="fa fa-check"></i><b>6.1.8</b> Color</a></li>
<li class="chapter" data-level="6.1.9" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>6.1.9</b> Thema</a></li>
<li class="chapter" data-level="6.1.10" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>6.1.10</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ggplot2.html"><a href="ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>6.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ggplot2.html"><a href="ggplot2.html#grouping-aesthetic"><i class="fa fa-check"></i><b>6.2.1</b> Grouping Aesthetic</a></li>
<li class="chapter" data-level="6.2.2" data-path="ggplot2.html"><a href="ggplot2.html#facet-1"><i class="fa fa-check"></i><b>6.2.2</b> facet</a></li>
<li class="chapter" data-level="6.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_smooth"><i class="fa fa-check"></i><b>6.2.3</b> geom_smooth</a></li>
<li class="chapter" data-level="6.2.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-plot"><i class="fa fa-check"></i><b>6.2.4</b> Dot Plot</a></li>
<li class="chapter" data-level="6.2.5" data-path="ggplot2.html"><a href="ggplot2.html#label-and-title"><i class="fa fa-check"></i><b>6.2.5</b> Label and Title</a></li>
<li class="chapter" data-level="6.2.6" data-path="ggplot2.html"><a href="ggplot2.html#residuals"><i class="fa fa-check"></i><b>6.2.6</b> Residuals</a></li>
<li class="chapter" data-level="6.2.7" data-path="ggplot2.html"><a href="ggplot2.html#encircling"><i class="fa fa-check"></i><b>6.2.7</b> Encircling</a></li>
<li class="chapter" data-level="6.2.8" data-path="ggplot2.html"><a href="ggplot2.html#dumbbell-plot"><i class="fa fa-check"></i><b>6.2.8</b> Dumbbell Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>6.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ggplot2.html"><a href="ggplot2.html#general-appearance"><i class="fa fa-check"></i><b>6.3.1</b> General appearance</a></li>
<li class="chapter" data-level="6.3.2" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>6.3.2</b> Themes</a></li>
<li class="chapter" data-level="6.3.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_freqpoly"><i class="fa fa-check"></i><b>6.3.3</b> geom_freqpoly()</a></li>
<li class="chapter" data-level="6.3.4" data-path="ggplot2.html"><a href="ggplot2.html#marginal-histogram-boxplot"><i class="fa fa-check"></i><b>6.3.4</b> Marginal Histogram / Boxplot</a></li>
<li class="chapter" data-level="6.3.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>6.3.5</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>6.4</b> Bar plot</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic"><i class="fa fa-check"></i><b>6.4.1</b> Aesthetic</a></li>
<li class="chapter" data-level="6.4.2" data-path="ggplot2.html"><a href="ggplot2.html#proportion"><i class="fa fa-check"></i><b>6.4.2</b> Proportion</a></li>
<li class="chapter" data-level="6.4.3" data-path="ggplot2.html"><a href="ggplot2.html#coord-1"><i class="fa fa-check"></i><b>6.4.3</b> coord</a></li>
<li class="chapter" data-level="6.4.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity"><i class="fa fa-check"></i><b>6.4.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.4.5" data-path="ggplot2.html"><a href="ggplot2.html#ranking"><i class="fa fa-check"></i><b>6.4.5</b> Ranking</a></li>
<li class="chapter" data-level="6.4.6" data-path="ggplot2.html"><a href="ggplot2.html#means-and-error-bars"><i class="fa fa-check"></i><b>6.4.6</b> Means and error bars</a></li>
<li class="chapter" data-level="6.4.7" data-path="ggplot2.html"><a href="ggplot2.html#waffle-chart"><i class="fa fa-check"></i><b>6.4.7</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ggplot2.html"><a href="ggplot2.html#box-plot"><i class="fa fa-check"></i><b>6.5</b> Box plot</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="ggplot2.html"><a href="ggplot2.html#varwidth"><i class="fa fa-check"></i><b>6.5.1</b> varwidth</a></li>
<li class="chapter" data-level="6.5.2" data-path="ggplot2.html"><a href="ggplot2.html#reorder"><i class="fa fa-check"></i><b>6.5.2</b> Reorder</a></li>
<li class="chapter" data-level="6.5.3" data-path="ggplot2.html"><a href="ggplot2.html#fill"><i class="fa fa-check"></i><b>6.5.3</b> Fill</a></li>
<li class="chapter" data-level="6.5.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity-1"><i class="fa fa-check"></i><b>6.5.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.5.5" data-path="ggplot2.html"><a href="ggplot2.html#dot-box-plot"><i class="fa fa-check"></i><b>6.5.5</b> Dot + Box Plot</a></li>
<li class="chapter" data-level="6.5.6" data-path="ggplot2.html"><a href="ggplot2.html#violin-plot"><i class="fa fa-check"></i><b>6.5.6</b> Violin Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ggplot2.html"><a href="ggplot2.html#other-rendering"><i class="fa fa-check"></i><b>6.6</b> Other rendering</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i><b>6.6.1</b> Annotation</a></li>
<li class="chapter" data-level="6.6.2" data-path="ggplot2.html"><a href="ggplot2.html#text-ggtext"><i class="fa fa-check"></i><b>6.6.2</b> Text: ggtext</a></li>
<li class="chapter" data-level="6.6.3" data-path="ggplot2.html"><a href="ggplot2.html#text-ggrepel"><i class="fa fa-check"></i><b>6.6.3</b> Text: ggrepel</a></li>
<li class="chapter" data-level="6.6.4" data-path="ggplot2.html"><a href="ggplot2.html#arrage-gridextra"><i class="fa fa-check"></i><b>6.6.4</b> Arrage: gridExtra</a></li>
<li class="chapter" data-level="6.6.5" data-path="ggplot2.html"><a href="ggplot2.html#interactive-charts-plotly"><i class="fa fa-check"></i><b>6.6.5</b> Interactive charts: plotly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html"><i class="fa fa-check"></i><b>7</b> Proc Sqplot (In Processing)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#ods"><i class="fa fa-check"></i><b>7.1</b> ODS</a></li>
<li class="chapter" data-level="7.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#scatter-plot-1"><i class="fa fa-check"></i><b>7.3</b> Scatter Plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#vector-in-scatter-plot"><i class="fa fa-check"></i><b>7.3.1</b> Vector in scatter Plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#add-predict-curve"><i class="fa fa-check"></i><b>7.3.2</b> Add predict curve</a></li>
<li class="chapter" data-level="7.3.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#grouping"><i class="fa fa-check"></i><b>7.3.3</b> grouping</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#bar-chart"><i class="fa fa-check"></i><b>7.4</b> Bar chart</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#group-and-using-freq"><i class="fa fa-check"></i><b>7.4.1</b> Group and using freq</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#histogram-1"><i class="fa fa-check"></i><b>7.5</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html"><i class="fa fa-check"></i><b>8</b> Descriptive Statistics in SAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-freq"><i class="fa fa-check"></i><b>8.1</b> PROC FREQ</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-table-names"><i class="fa fa-check"></i><b>8.1.1</b> ODS Table Names</a></li>
<li class="chapter" data-level="8.1.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-plots"><i class="fa fa-check"></i><b>8.1.2</b> ODS Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-univariate"><i class="fa fa-check"></i><b>8.2</b> PROC UNIVARIATE</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#histogram-statement"><i class="fa fa-check"></i><b>8.2.1</b> HISTOGRAM Statement</a></li>
<li class="chapter" data-level="8.2.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#cdfplot-statement"><i class="fa fa-check"></i><b>8.2.2</b> CDFPLOT Statement</a></li>
<li class="chapter" data-level="8.2.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ppplot-statement"><i class="fa fa-check"></i><b>8.2.3</b> PPPLOT Statement</a></li>
<li class="chapter" data-level="8.2.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#probplot-and-qqplot-statement"><i class="fa fa-check"></i><b>8.2.4</b> PROBPLOT and QQPLOT Statement</a></li>
<li class="chapter" data-level="8.2.5" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-tables"><i class="fa fa-check"></i><b>8.2.5</b> ODS Tables</a></li>
<li class="chapter" data-level="8.2.6" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-graphics"><i class="fa fa-check"></i><b>8.2.6</b> ODS Graphics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-means"><i class="fa fa-check"></i><b>8.3</b> PROC MEANS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-summary-statistics"><i class="fa fa-check"></i><b>8.3.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="8.3.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#autoname-option"><i class="fa fa-check"></i><b>8.3.2</b> AUTONAME Option</a></li>
<li class="chapter" data-level="8.3.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#chartype-option"><i class="fa fa-check"></i><b>8.3.3</b> CHARTYPE Option</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-tabulate"><i class="fa fa-check"></i><b>8.4</b> PROC TABULATE</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-syntax-for-proc-tabulate"><i class="fa fa-check"></i><b>8.4.1</b> Basic Syntax for PROC TABULATE</a></li>
<li class="chapter" data-level="8.4.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#identification-of-desired-statistics"><i class="fa fa-check"></i><b>8.4.2</b> Identification of Desired Statistics</a></li>
<li class="chapter" data-level="8.4.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#in-processing-1"><i class="fa fa-check"></i><b>8.4.3</b> In processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>9</b> Descriptive Statistics in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-pape"><i class="fa fa-check"></i><b>9.1</b> Package pape</a></li>
<li class="chapter" data-level="9.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-summarytools"><i class="fa fa-check"></i><b>9.2</b> Package summarytools</a></li>
<li class="chapter" data-level="9.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-comparegroups"><i class="fa fa-check"></i><b>9.3</b> Package compareGroups</a></li>
<li class="chapter" data-level="9.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-kableextra"><i class="fa fa-check"></i><b>9.4</b> Package kableExtra</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#kable_styling"><i class="fa fa-check"></i><b>9.4.1</b> kable_styling</a></li>
<li class="chapter" data-level="9.4.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#columnrow-specification"><i class="fa fa-check"></i><b>9.4.2</b> Column/Row Specification</a></li>
<li class="chapter" data-level="9.4.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#grouping-columnsrows"><i class="fa fa-check"></i><b>9.4.3</b> Grouping columns/rows</a></li>
<li class="chapter" data-level="9.4.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#add-footnote"><i class="fa fa-check"></i><b>9.4.4</b> Add Footnote</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html"><i class="fa fa-check"></i><b>10</b> Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#distribution"><i class="fa fa-check"></i><b>10.1</b> Distribution</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#quantile-function-in-sas"><i class="fa fa-check"></i><b>10.1.1</b> Quantile Function in SAS</a></li>
<li class="chapter" data-level="10.1.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>10.1.3</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="10.1.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multinomial-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Multinomial distribution</a></li>
<li class="chapter" data-level="10.1.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#normal-distribution"><i class="fa fa-check"></i><b>10.1.5</b> Normal Distribution</a></li>
<li class="chapter" data-level="10.1.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>10.1.6</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="10.1.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#poisson-distribution"><i class="fa fa-check"></i><b>10.1.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="10.1.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#exponential-distribution"><i class="fa fa-check"></i><b>10.1.8</b> Exponential distribution</a></li>
<li class="chapter" data-level="10.1.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#gamma-distribution"><i class="fa fa-check"></i><b>10.1.9</b> Gamma distribution</a></li>
<li class="chapter" data-level="10.1.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#weibull-distribution"><i class="fa fa-check"></i><b>10.1.10</b> Weibull Distribution</a></li>
<li class="chapter" data-level="10.1.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#beta-distribution"><i class="fa fa-check"></i><b>10.1.11</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#point-estimates"><i class="fa fa-check"></i><b>10.2</b> Point Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-proportions"><i class="fa fa-check"></i><b>10.3</b> Test Proportion(s)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-ci-for-small-samples"><i class="fa fa-check"></i><b>10.3.1</b> Binomial CI for Small Samples</a></li>
<li class="chapter" data-level="10.3.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-binom"><i class="fa fa-check"></i><b>10.3.2</b> Package binom</a></li>
<li class="chapter" data-level="10.3.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#ci_single_proportion"><i class="fa fa-check"></i><b>10.3.3</b> %CI_Single_Proportion</a></li>
<li class="chapter" data-level="10.3.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#incidence-rate-ci"><i class="fa fa-check"></i><b>10.3.4</b> Incidence rate CI</a></li>
<li class="chapter" data-level="10.3.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-pwr"><i class="fa fa-check"></i><b>10.3.5</b> Package: pwr</a></li>
<li class="chapter" data-level="10.3.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-one-proportion-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.6</b> Test one Proportion based on Wald CI</a></li>
<li class="chapter" data-level="10.3.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-two-proportions-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.7</b> Test two Proportions based on Wald CI</a></li>
<li class="chapter" data-level="10.3.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test"><i class="fa fa-check"></i><b>10.3.8</b> Paired Proportions: McNemar’s Z-test</a></li>
<li class="chapter" data-level="10.3.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#chi-square-test"><i class="fa fa-check"></i><b>10.3.9</b> Chi-square test</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-means"><i class="fa fa-check"></i><b>10.4</b> Test Mean(s)</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-one-sample-mean"><i class="fa fa-check"></i><b>10.4.1</b> Test one sample mean</a></li>
<li class="chapter" data-level="10.4.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-two-sample-means"><i class="fa fa-check"></i><b>10.4.2</b> Test two sample means</a></li>
<li class="chapter" data-level="10.4.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test"><i class="fa fa-check"></i><b>10.4.3</b> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li class="chapter" data-level="10.4.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-k-means"><i class="fa fa-check"></i><b>10.4.4</b> Test k Means</a></li>
<li class="chapter" data-level="10.4.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#anova-using-pwr.anova.test"><i class="fa fa-check"></i><b>10.4.5</b> Anova using <code>pwr.anova.test</code></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#other-methods"><i class="fa fa-check"></i><b>10.5</b> Other Methods</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#odds-ratio"><i class="fa fa-check"></i><b>10.5.1</b> Odds Ratio</a></li>
<li class="chapter" data-level="10.5.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlation"><i class="fa fa-check"></i><b>10.5.2</b> Correlation</a></li>
<li class="chapter" data-level="10.5.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies"><i class="fa fa-check"></i><b>10.5.3</b> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multiple-test"><i class="fa fa-check"></i><b>10.6</b> Multiple test</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#definitions-of-power"><i class="fa fa-check"></i><b>10.6.1</b> Definitions of Power</a></li>
<li class="chapter" data-level="10.6.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#bonferroni-tests-individual-power"><i class="fa fa-check"></i><b>10.6.2</b> Bonferroni Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#tukeys-method-individual-power"><i class="fa fa-check"></i><b>10.6.3</b> Tukey’s method (Individual Power)</a></li>
<li class="chapter" data-level="10.6.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power"><i class="fa fa-check"></i><b>10.6.4</b> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower"><i class="fa fa-check"></i><b>10.6.5</b> Combined Power %SimPower and %PlotSimPower</a></li>
<li class="chapter" data-level="10.6.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r"><i class="fa fa-check"></i><b>10.6.6</b> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#time-to-event-data"><i class="fa fa-check"></i><b>10.7</b> Time-To-Event Data</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#cox-ph-2-sided-equality"><i class="fa fa-check"></i><b>10.7.1</b> Cox PH, 2-Sided Equality</a></li>
<li class="chapter" data-level="10.7.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks"><i class="fa fa-check"></i><b>10.7.2</b> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#estimation-in-diagnostic-test"><i class="fa fa-check"></i><b>10.8</b> Estimation in diagnostic test</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#adequate-sensitivityspecificity"><i class="fa fa-check"></i><b>10.8.1</b> Adequate sensitivity/specificity</a></li>
<li class="chapter" data-level="10.8.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#testing-sensitivity-or-specificity"><i class="fa fa-check"></i><b>10.8.2</b> Testing sensitivity (or specificity)</a></li>
<li class="chapter" data-level="10.8.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#likelihood-ratio-estimation"><i class="fa fa-check"></i><b>10.8.3</b> Likelihood ratio estimation</a></li>
<li class="chapter" data-level="10.8.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#roc-index-of-accuracy"><i class="fa fa-check"></i><b>10.8.4</b> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="parametric-test.html"><a href="parametric-test.html"><i class="fa fa-check"></i><b>11</b> Parametric Test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="parametric-test.html"><a href="parametric-test.html#binomial-test"><i class="fa fa-check"></i><b>11.1</b> Binomial test</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula"><i class="fa fa-check"></i><b>11.1.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="11.1.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation"><i class="fa fa-check"></i><b>11.1.2</b> R implementation</a></li>
<li class="chapter" data-level="11.1.3" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation"><i class="fa fa-check"></i><b>11.1.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="parametric-test.html"><a href="parametric-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>11.2</b> Fisher’s Exact Test</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-2"><i class="fa fa-check"></i><b>11.2.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-1"><i class="fa fa-check"></i><b>11.2.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.2.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-1"><i class="fa fa-check"></i><b>11.2.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="parametric-test.html"><a href="parametric-test.html#mcnemars-test"><i class="fa fa-check"></i><b>11.3</b> McNemar’s test</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-3"><i class="fa fa-check"></i><b>11.3.1</b> introduction</a></li>
<li class="chapter" data-level="11.3.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-2"><i class="fa fa-check"></i><b>11.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="11.3.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-2"><i class="fa fa-check"></i><b>11.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="parametric-test.html"><a href="parametric-test.html#cochranmantelhaenszel-test"><i class="fa fa-check"></i><b>11.4</b> Cochran–Mantel–Haenszel Test</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-3"><i class="fa fa-check"></i><b>11.4.1</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="parametric-test.html"><a href="parametric-test.html#correlation-test"><i class="fa fa-check"></i><b>11.5</b> Correlation Test</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="parametric-test.html"><a href="parametric-test.html#pearson-correlation"><i class="fa fa-check"></i><b>11.5.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="11.5.2" data-path="parametric-test.html"><a href="parametric-test.html#spearman-correlation"><i class="fa fa-check"></i><b>11.5.2</b> Spearman correlation</a></li>
<li class="chapter" data-level="11.5.3" data-path="parametric-test.html"><a href="parametric-test.html#kendall-correlation"><i class="fa fa-check"></i><b>11.5.3</b> Kendall correlation</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="parametric-test.html"><a href="parametric-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two Sample T-Test</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="parametric-test.html"><a href="parametric-test.html#inreoduction-1"><i class="fa fa-check"></i><b>11.6.1</b> Inreoduction</a></li>
<li class="chapter" data-level="11.6.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-3"><i class="fa fa-check"></i><b>11.6.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.6.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-4"><i class="fa fa-check"></i><b>11.6.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="parametric-test.html"><a href="parametric-test.html#normality-test"><i class="fa fa-check"></i><b>11.7</b> Normality test</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-4"><i class="fa fa-check"></i><b>11.7.1</b> SAS implementation</a></li>
<li class="chapter" data-level="11.7.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-5"><i class="fa fa-check"></i><b>11.7.2</b> R implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>12</b> ANOVA</a>
<ul>
<li class="chapter" data-level="12.1" data-path="anova.html"><a href="anova.html#unstructured-models"><i class="fa fa-check"></i><b>12.1</b> Unstructured Models</a></li>
<li class="chapter" data-level="12.2" data-path="anova.html"><a href="anova.html#balanced-one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>12.2</b> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="anova.html"><a href="anova.html#modeling-assumptions-and-basic-analysis"><i class="fa fa-check"></i><b>12.2.1</b> Modeling Assumptions and Basic Analysis</a></li>
<li class="chapter" data-level="12.2.2" data-path="anova.html"><a href="anova.html#parameter-estimates"><i class="fa fa-check"></i><b>12.2.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="12.2.3" data-path="anova.html"><a href="anova.html#r-implementation-6"><i class="fa fa-check"></i><b>12.2.3</b> R Implementation</a></li>
<li class="chapter" data-level="12.2.4" data-path="anova.html"><a href="anova.html#sas-implementation-5"><i class="fa fa-check"></i><b>12.2.4</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.2.5" data-path="anova.html"><a href="anova.html#model-diagnosis"><i class="fa fa-check"></i><b>12.2.5</b> Model Diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="anova.html"><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>12.3</b> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="12.4" data-path="anova.html"><a href="anova.html#two-ways-anova-test"><i class="fa fa-check"></i><b>12.4</b> Two-Ways ANOVA Test</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="anova.html"><a href="anova.html#introduction-4"><i class="fa fa-check"></i><b>12.4.1</b> Introduction</a></li>
<li class="chapter" data-level="12.4.2" data-path="anova.html"><a href="anova.html#r-implementation-7"><i class="fa fa-check"></i><b>12.4.2</b> R implementation</a></li>
<li class="chapter" data-level="12.4.3" data-path="anova.html"><a href="anova.html#sas-implementation-6"><i class="fa fa-check"></i><b>12.4.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.4.4" data-path="anova.html"><a href="anova.html#unbalanced-design"><i class="fa fa-check"></i><b>12.4.4</b> Unbalanced design</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="anova.html"><a href="anova.html#heteroscedastic-responses"><i class="fa fa-check"></i><b>12.5</b> Heteroscedastic Responses</a></li>
<li class="chapter" data-level="12.6" data-path="anova.html"><a href="anova.html#repeated-measures-anova-data"><i class="fa fa-check"></i><b>12.6</b> Repeated Measures ANOVA Data</a></li>
<li class="chapter" data-level="12.7" data-path="anova.html"><a href="anova.html#multivariate-responses-with-normally-distributed-data"><i class="fa fa-check"></i><b>12.7</b> Multivariate Responses with Normally Distributed Data</a></li>
<li class="chapter" data-level="12.8" data-path="anova.html"><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.8</b> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li class="chapter" data-level="12.9" data-path="anova.html"><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.9</b> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-comparison.html"><a href="multiple-comparison.html"><i class="fa fa-check"></i><b>13</b> Multiple-Comparison</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-5"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiplicity-problem"><i class="fa fa-check"></i><b>13.1.1</b> Multiplicity Problem</a></li>
<li class="chapter" data-level="13.1.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#error-rates"><i class="fa fa-check"></i><b>13.1.2</b> Error Rates</a></li>
<li class="chapter" data-level="13.1.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-adjusted-p"><i class="fa fa-check"></i><b>13.1.3</b> The adjusted P</a></li>
<li class="chapter" data-level="13.1.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#basic-statistical-concepts"><i class="fa fa-check"></i><b>13.1.4</b> Basic Statistical Concepts</a></li>
<li class="chapter" data-level="13.1.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#functions-in-glht-package-in-r"><i class="fa fa-check"></i><b>13.1.5</b> Functions in glht package in R</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-and-šidák-methods"><i class="fa fa-check"></i><b>13.2</b> Bonferroni and Šidák Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#lsd-least-significance-difference"><i class="fa fa-check"></i><b>13.2.1</b> LSD (least significance difference)</a></li>
<li class="chapter" data-level="13.2.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák"><i class="fa fa-check"></i><b>13.2.2</b> Šidák</a></li>
<li class="chapter" data-level="13.2.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni"><i class="fa fa-check"></i><b>13.2.3</b> Bonferroni</a></li>
<li class="chapter" data-level="13.2.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot"><i class="fa fa-check"></i><b>13.2.4</b> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova"><i class="fa fa-check"></i><b>13.3</b> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#ls-means"><i class="fa fa-check"></i><b>13.3.1</b> LS-Means</a></li>
<li class="chapter" data-level="13.3.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-multivariate-t-distribution"><i class="fa fa-check"></i><b>13.3.2</b> The Multivariate t Distribution</a></li>
<li class="chapter" data-level="13.3.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha"><i class="fa fa-check"></i><b>13.3.3</b> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li class="chapter" data-level="13.3.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution"><i class="fa fa-check"></i><b>13.3.4</b> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li class="chapter" data-level="13.3.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons"><i class="fa fa-check"></i><b>13.3.5</b> Tukey’s Method for All Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically"><i class="fa fa-check"></i><b>13.3.6</b> Displaying Pairwise Comparisons Graphically</a></li>
<li class="chapter" data-level="13.3.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><i class="fa fa-check"></i><b>13.3.7</b> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li class="chapter" data-level="13.3.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control"><i class="fa fa-check"></i><b>13.3.8</b> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li class="chapter" data-level="13.3.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><i class="fa fa-check"></i><b>13.3.9</b> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><i class="fa fa-check"></i><b>13.4</b> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-model-and-estimates"><i class="fa fa-check"></i><b>13.4.1</b> The Model and Estimates</a></li>
<li class="chapter" data-level="13.4.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukey-kramer-method"><i class="fa fa-check"></i><b>13.4.2</b> Tukey-Kramer Method</a></li>
<li class="chapter" data-level="13.4.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#alternative-simulation-based-method"><i class="fa fa-check"></i><b>13.4.3</b> Alternative Simulation-Based Method</a></li>
<li class="chapter" data-level="13.4.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#pairwise-comparisons-with-control"><i class="fa fa-check"></i><b>13.4.4</b> Pairwise Comparisons with Control</a></li>
<li class="chapter" data-level="13.4.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom"><i class="fa fa-check"></i><b>13.4.5</b> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>13.5</b> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation"><i class="fa fa-check"></i><b>13.5.1</b> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li class="chapter" data-level="13.5.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method"><i class="fa fa-check"></i><b>13.5.2</b> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li class="chapter" data-level="13.5.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction"><i class="fa fa-check"></i><b>13.5.3</b> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters"><i class="fa fa-check"></i><b>13.6</b> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#scheffés-method"><i class="fa fa-check"></i><b>13.6.1</b> Scheffés Method</a></li>
<li class="chapter" data-level="13.6.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#finding-the-maximal-contrast"><i class="fa fa-check"></i><b>13.6.2</b> Finding the Maximal Contrast</a></li>
<li class="chapter" data-level="13.6.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#working-hotelling-method"><i class="fa fa-check"></i><b>13.6.3</b> Working-Hotelling method</a></li>
<li class="chapter" data-level="13.6.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#discrete-approximation-method"><i class="fa fa-check"></i><b>13.6.4</b> Discrete approximation method</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7</b> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-of-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.1</b> Introduction of heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#satterthwaite-approximation"><i class="fa fa-check"></i><b>13.7.2</b> Satterthwaite Approximation</a></li>
<li class="chapter" data-level="13.7.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.3</b> MaxT Method under Heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#minp-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.4</b> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-and-stepwise-testing-methods"><i class="fa fa-check"></i><b>13.8</b> Closed and Stepwise Testing Methods</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-family-of-hypotheses"><i class="fa fa-check"></i><b>13.8.1</b> Closed Family of Hypotheses</a></li>
<li class="chapter" data-level="13.8.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-holm-method"><i class="fa fa-check"></i><b>13.8.2</b> Bonferroni-Holm Method</a></li>
<li class="chapter" data-level="13.8.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák-holm-method"><i class="fa fa-check"></i><b>13.8.3</b> Šidák-Holm Method</a></li>
<li class="chapter" data-level="13.8.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-fisher-combination-method"><i class="fa fa-check"></i><b>13.8.4</b> Closed Fisher Combination Method</a></li>
<li class="chapter" data-level="13.8.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#simes-hommel-method"><i class="fa fa-check"></i><b>13.8.5</b> Simes-Hommel Method</a></li>
<li class="chapter" data-level="13.8.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hochbergs-ok-step-up"><i class="fa fa-check"></i><b>13.8.6</b> Hochberg’s O(k) Step-Up</a></li>
<li class="chapter" data-level="13.8.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences"><i class="fa fa-check"></i><b>13.8.7</b> Sequential Testing with Fixed Sequences</a></li>
<li class="chapter" data-level="13.8.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods"><i class="fa fa-check"></i><b>13.8.8</b> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts"><i class="fa fa-check"></i><b>13.9</b> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#incorporating-logical-constraints"><i class="fa fa-check"></i><b>13.9.1</b> Incorporating Logical Constraints</a></li>
<li class="chapter" data-level="13.9.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#shaffers-method"><i class="fa fa-check"></i><b>13.9.2</b> Shaffer’s Method</a></li>
<li class="chapter" data-level="13.9.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#extended-shaffer-royen-method"><i class="fa fa-check"></i><b>13.9.3</b> Extended Shaffer-Royen Method</a></li>
<li class="chapter" data-level="13.9.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#step-down-dunnett-test"><i class="fa fa-check"></i><b>13.9.4</b> Step-down Dunnett test</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-with-binary-data"><i class="fa fa-check"></i><b>13.10</b> Multiple Comparisons with Binary Data</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-6"><i class="fa fa-check"></i><b>13.10.1</b> Introduction</a></li>
<li class="chapter" data-level="13.10.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes"><i class="fa fa-check"></i><b>13.10.2</b> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>14</b> Non-Parametric Test</a>
<ul>
<li class="chapter" data-level="14.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#two-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.1</b> Two Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples"><i class="fa fa-check"></i><b>14.1.1</b> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li class="chapter" data-level="14.1.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched"><i class="fa fa-check"></i><b>14.1.2</b> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li class="chapter" data-level="14.1.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.3</b> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.4</b> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions"><i class="fa fa-check"></i><b>14.1.5</b> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#several-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.2</b> Several Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples"><i class="fa fa-check"></i><b>14.2.1</b> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter"><i class="fa fa-check"></i><b>14.2.2</b> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#tests-for-categorical-data"><i class="fa fa-check"></i><b>14.3</b> Tests for Categorical Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test"><i class="fa fa-check"></i><b>14.3.1</b> Spearman Rank Correlation Coefficient Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#fisher-exact-test"><i class="fa fa-check"></i><b>14.3.2</b> Fisher Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-test"><i class="fa fa-check"></i><b>14.4</b> Permutation test</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#introduction-7"><i class="fa fa-check"></i><b>14.4.1</b> Introduction</a></li>
<li class="chapter" data-level="14.4.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#package-coin"><i class="fa fa-check"></i><b>14.4.2</b> Package: coin</a></li>
<li class="chapter" data-level="14.4.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.3</b> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.4</b> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles"><i class="fa fa-check"></i><b>14.4.5</b> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#nonparametric-regression"><i class="fa fa-check"></i><b>14.5</b> Nonparametric Regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>15</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation-1"><i class="fa fa-check"></i><b>15.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.1</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="15.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.2</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.3</b> Kendall rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#intraclass-correlation"><i class="fa fa-check"></i><b>15.1.4</b> Intraclass correlation</a></li>
<li class="chapter" data-level="15.1.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualize-the-correlation-in-r"><i class="fa fa-check"></i><b>15.1.5</b> Visualize the correlation in R</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>15.2</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#assumpions"><i class="fa fa-check"></i><b>15.2.1</b> Assumpions</a></li>
<li class="chapter" data-level="15.2.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#interpretation"><i class="fa fa-check"></i><b>15.2.2</b> Interpretation</a></li>
<li class="chapter" data-level="15.2.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#matrix-solution"><i class="fa fa-check"></i><b>15.2.3</b> Matrix Solution</a></li>
<li class="chapter" data-level="15.2.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>15.2.4</b> Gauss-Markov Theorem</a></li>
<li class="chapter" data-level="15.2.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#limitation"><i class="fa fa-check"></i><b>15.2.5</b> limitation</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-statistics"><i class="fa fa-check"></i><b>15.3</b> Model Statistics</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#residuals-standard-error"><i class="fa fa-check"></i><b>15.3.1</b> Residuals Standard Error</a></li>
<li class="chapter" data-level="15.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>15.3.2</b> R-Squared and Adjusted R-Squared</a></li>
<li class="chapter" data-level="15.3.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#t-statistic"><i class="fa fa-check"></i><b>15.3.3</b> T Statistic</a></li>
<li class="chapter" data-level="15.3.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#f-statistic"><i class="fa fa-check"></i><b>15.3.4</b> F Statistic</a></li>
<li class="chapter" data-level="15.3.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>15.3.5</b> Confidence Intervals</a></li>
<li class="chapter" data-level="15.3.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>15.3.6</b> Likelihood-ratio test</a></li>
<li class="chapter" data-level="15.3.7" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#accuracy"><i class="fa fa-check"></i><b>15.3.7</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>15.4</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-error-assumptions"><i class="fa fa-check"></i><b>15.4.1</b> Checking Error Assumptions</a></li>
<li class="chapter" data-level="15.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#finding-unusual-observations"><i class="fa fa-check"></i><b>15.4.2</b> Finding Unusual Observations</a></li>
<li class="chapter" data-level="15.4.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-the-structure-of-the-model"><i class="fa fa-check"></i><b>15.4.3</b> Checking the Structure of the Model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#sas-implementation-proc-reg"><i class="fa fa-check"></i><b>15.5</b> SAS implementation Proc Reg</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#options"><i class="fa fa-check"></i><b>15.5.1</b> Options</a></li>
<li class="chapter" data-level="15.5.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#diagnose"><i class="fa fa-check"></i><b>15.5.2</b> Diagnose</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-implementation-8"><i class="fa fa-check"></i><b>15.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html"><i class="fa fa-check"></i><b>16</b> Advanced Linear Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#model-selection"><i class="fa fa-check"></i><b>16.1</b> Model Selection</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-methods"><i class="fa fa-check"></i><b>16.1.1</b> Selection Methods</a></li>
<li class="chapter" data-level="16.1.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-criteria"><i class="fa fa-check"></i><b>16.1.2</b> Selection Criteria</a></li>
<li class="chapter" data-level="16.1.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#k--fold-cross-validation"><i class="fa fa-check"></i><b>16.1.3</b> k- Fold Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#practical-difficulties-using-ols"><i class="fa fa-check"></i><b>16.2</b> Practical Difficulties using OLS</a></li>
<li class="chapter" data-level="16.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#skewness"><i class="fa fa-check"></i><b>16.3</b> Skewness</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#introduction-8"><i class="fa fa-check"></i><b>16.3.1</b> Introduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#baisc-transformation"><i class="fa fa-check"></i><b>16.3.2</b> Baisc Transformation</a></li>
<li class="chapter" data-level="16.3.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#box-cox-power-transformation"><i class="fa fa-check"></i><b>16.3.3</b> Box-Cox Power Transformation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#scale-1"><i class="fa fa-check"></i><b>16.4</b> Scale</a></li>
<li class="chapter" data-level="16.5" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#interaction"><i class="fa fa-check"></i><b>16.5</b> Interaction</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>16.5.1</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="16.5.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#plotting-interactions"><i class="fa fa-check"></i><b>16.5.2</b> Plotting Interactions</a></li>
<li class="chapter" data-level="16.5.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#check-linearity-assumption"><i class="fa fa-check"></i><b>16.5.3</b> Check linearity assumption</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#collinearity"><i class="fa fa-check"></i><b>16.6</b> Collinearity</a></li>
<li class="chapter" data-level="16.7" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#problems-with-the-error"><i class="fa fa-check"></i><b>16.7</b> Problems with the Error</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#generalized-least-squares"><i class="fa fa-check"></i><b>16.7.1</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="16.7.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>16.7.2</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="16.7.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#robust-regression"><i class="fa fa-check"></i><b>16.7.3</b> Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#shrinkage-methods"><i class="fa fa-check"></i><b>16.8</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#principal-components-analzsis"><i class="fa fa-check"></i><b>16.8.1</b> Principal Components Analzsis</a></li>
<li class="chapter" data-level="16.8.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#partial-least-squares"><i class="fa fa-check"></i><b>16.8.2</b> Partial Least Squares</a></li>
<li class="chapter" data-level="16.8.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>16.8.3</b> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>17</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-9"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>17.1.1</b> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li class="chapter" data-level="17.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#more-fundamental-problem-outside-01"><i class="fa fa-check"></i><b>17.1.2</b> More fundamental problem outside [0,1]</a></li>
<li class="chapter" data-level="17.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-model"><i class="fa fa-check"></i><b>17.1.3</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="17.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-of-the-logistic-model"><i class="fa fa-check"></i><b>17.1.4</b> Estimation of the Logistic Model</a></li>
<li class="chapter" data-level="17.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#convergence-problems"><i class="fa fa-check"></i><b>17.1.5</b> Convergence Problems</a></li>
<li class="chapter" data-level="17.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#use-exact-methods."><i class="fa fa-check"></i><b>17.1.6</b> Use exact methods.</a></li>
<li class="chapter" data-level="17.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#use-penalized-likelihood"><i class="fa fa-check"></i><b>17.1.7</b> Use penalized likelihood</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-modell"><i class="fa fa-check"></i><b>17.2</b> Logit Modell</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-10"><i class="fa fa-check"></i><b>17.2.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-9"><i class="fa fa-check"></i><b>17.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="17.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-7"><i class="fa fa-check"></i><b>17.2.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="17.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#multicollinearity"><i class="fa fa-check"></i><b>17.2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="17.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance"><i class="fa fa-check"></i><b>17.2.5</b> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li class="chapter" data-level="17.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.2.6</b> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="17.2.7" data-path="logistic-regression.html"><a href="logistic-regression.html#statistics-measuring-predictive-power-r2"><i class="fa fa-check"></i><b>17.2.7</b> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="17.2.8" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>17.2.8</b> ROC Curves</a></li>
<li class="chapter" data-level="17.2.9" data-path="logistic-regression.html"><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics"><i class="fa fa-check"></i><b>17.2.9</b> Predicted Values, Residuals, and Influence Statistics</a></li>
<li class="chapter" data-level="17.2.10" data-path="logistic-regression.html"><a href="logistic-regression.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>17.2.10</b> Unobserved Heterogeneity</a></li>
<li class="chapter" data-level="17.2.11" data-path="logistic-regression.html"><a href="logistic-regression.html#plotting-effects-of-predictor-variables"><i class="fa fa-check"></i><b>17.2.11</b> Plotting Effects of Predictor Variables</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="logistic-regression.html"><a href="logistic-regression.html#probit-modell"><i class="fa fa-check"></i><b>17.3</b> Probit Modell</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-11"><i class="fa fa-check"></i><b>17.3.1</b> Introduction</a></li>
<li class="chapter" data-level="17.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation"><i class="fa fa-check"></i><b>17.3.2</b> R Implemetation</a></li>
<li class="chapter" data-level="17.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-8"><i class="fa fa-check"></i><b>17.3.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="logistic-regression.html"><a href="logistic-regression.html#complementary-log-log-modell"><i class="fa fa-check"></i><b>17.4</b> Complementary log-log-Modell</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation-1"><i class="fa fa-check"></i><b>17.4.1</b> R Implemetation</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multi-category-logit-model"><i class="fa fa-check"></i><b>17.5</b> Multi-category logit model</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomialverteilung"><i class="fa fa-check"></i><b>17.5.1</b> Multinomialverteilung</a></li>
<li class="chapter" data-level="17.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-10"><i class="fa fa-check"></i><b>17.5.2</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="logistic-regression.html"><a href="logistic-regression.html#ordinal-cumulative-logit-model"><i class="fa fa-check"></i><b>17.6</b> Ordinal Cumulative Logit Model</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-11"><i class="fa fa-check"></i><b>17.6.1</b> R Implementation</a></li>
<li class="chapter" data-level="17.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-9"><i class="fa fa-check"></i><b>17.6.2</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="logistic-regression.html"><a href="logistic-regression.html#adjacent-categories-model"><i class="fa fa-check"></i><b>17.7</b> Adjacent Categories Model</a></li>
<li class="chapter" data-level="17.8" data-path="logistic-regression.html"><a href="logistic-regression.html#continuation-ratio-model"><i class="fa fa-check"></i><b>17.8</b> Continuation Ratio Model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html"><i class="fa fa-check"></i><b>18</b> Advanced Logistic Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.1</b> Logit Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table"><i class="fa fa-check"></i><b>18.1.1</b> Two-Way Table</a></li>
<li class="chapter" data-level="18.1.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#three-way-table"><i class="fa fa-check"></i><b>18.1.2</b> Three-Way Table</a></li>
<li class="chapter" data-level="18.1.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#four-way-table"><i class="fa fa-check"></i><b>18.1.3</b> Four-Way Table</a></li>
<li class="chapter" data-level="18.1.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#overdispersion"><i class="fa fa-check"></i><b>18.1.4</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.2</b> Loglinear Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table-1"><i class="fa fa-check"></i><b>18.2.1</b> Two-way Table</a></li>
<li class="chapter" data-level="18.2.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#problem-of-zeros"><i class="fa fa-check"></i><b>18.2.2</b> Problem of Zeros</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#discrete-choice-analysis"><i class="fa fa-check"></i><b>18.3</b> Discrete Choice Analysis</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logistic-strata"><i class="fa fa-check"></i><b>18.3.1</b> Logistic Strata</a></li>
<li class="chapter" data-level="18.3.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#conditional-logit-model"><i class="fa fa-check"></i><b>18.3.2</b> Conditional logit model</a></li>
<li class="chapter" data-level="18.3.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#ranked-data"><i class="fa fa-check"></i><b>18.3.3</b> Ranked Data</a></li>
<li class="chapter" data-level="18.3.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model"><i class="fa fa-check"></i><b>18.3.4</b> Heteroscedastic extreme value (HEV) Model</a></li>
<li class="chapter" data-level="18.3.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#nested-logit-model"><i class="fa fa-check"></i><b>18.3.5</b> Nested logit model</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data"><i class="fa fa-check"></i><b>18.4</b> Longitudinal and Other Clustered Data</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#introduction-12"><i class="fa fa-check"></i><b>18.4.1</b> Introduction</a></li>
<li class="chapter" data-level="18.4.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#robust-standard-errors"><i class="fa fa-check"></i><b>18.4.2</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="18.4.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod"><i class="fa fa-check"></i><b>18.4.3</b> GEE Estimation with PROC GENMOD</a></li>
<li class="chapter" data-level="18.4.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix"><i class="fa fa-check"></i><b>18.4.4</b> Mixed Models with PROC GLIMMIX</a></li>
<li class="chapter" data-level="18.4.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression"><i class="fa fa-check"></i><b>18.4.5</b> Fixed-Effects with Conditional Logistic Regression</a></li>
<li class="chapter" data-level="18.4.6" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#hybrid-method"><i class="fa fa-check"></i><b>18.4.6</b> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>19</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="survival-analysis.html"><a href="survival-analysis.html#preliminary"><i class="fa fa-check"></i><b>19.1</b> Preliminary</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="survival-analysis.html"><a href="survival-analysis.html#probability-density-function"><i class="fa fa-check"></i><b>19.1.1</b> Probability density function</a></li>
<li class="chapter" data-level="19.1.2" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-distribution-function"><i class="fa fa-check"></i><b>19.1.2</b> Cumulative distribution function</a></li>
<li class="chapter" data-level="19.1.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-function"><i class="fa fa-check"></i><b>19.1.3</b> Survival function</a></li>
<li class="chapter" data-level="19.1.4" data-path="survival-analysis.html"><a href="survival-analysis.html#hazard-function"><i class="fa fa-check"></i><b>19.1.4</b> Hazard function</a></li>
<li class="chapter" data-level="19.1.5" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-hazard-function"><i class="fa fa-check"></i><b>19.1.5</b> Cumulative hazard function</a></li>
<li class="chapter" data-level="19.1.6" data-path="survival-analysis.html"><a href="survival-analysis.html#mean-residual-life"><i class="fa fa-check"></i><b>19.1.6</b> Mean Residual Life</a></li>
<li class="chapter" data-level="19.1.7" data-path="survival-analysis.html"><a href="survival-analysis.html#relation-between-functions"><i class="fa fa-check"></i><b>19.1.7</b> Relation between functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>19.2</b> Kaplan-Meier estimator</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="survival-analysis.html"><a href="survival-analysis.html#km-introduction"><i class="fa fa-check"></i><b>19.2.1</b> KM Introduction</a></li>
<li class="chapter" data-level="19.2.2" data-path="survival-analysis.html"><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function"><i class="fa fa-check"></i><b>19.2.2</b> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li class="chapter" data-level="19.2.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-curve-in-sas"><i class="fa fa-check"></i><b>19.2.3</b> Survival curve in SAS</a></li>
<li class="chapter" data-level="19.2.4" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-sas"><i class="fa fa-check"></i><b>19.2.4</b> KM Survival Plots in SAS</a></li>
<li class="chapter" data-level="19.2.5" data-path="survival-analysis.html"><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r"><i class="fa fa-check"></i><b>19.2.5</b> Convert Personal-level to Personal-period in R</a></li>
<li class="chapter" data-level="19.2.6" data-path="survival-analysis.html"><a href="survival-analysis.html#package-survfit-in-r"><i class="fa fa-check"></i><b>19.2.6</b> Package survfit in R</a></li>
<li class="chapter" data-level="19.2.7" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-r"><i class="fa fa-check"></i><b>19.2.7</b> KM Survival Plots in R</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="survival-analysis.html"><a href="survival-analysis.html#compare-the-survival-function"><i class="fa fa-check"></i><b>19.3</b> Compare the survival function</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="survival-analysis.html"><a href="survival-analysis.html#tests-of-equality-of-the-survival-function"><i class="fa fa-check"></i><b>19.3.1</b> Tests of equality of the survival function</a></li>
<li class="chapter" data-level="19.3.2" data-path="survival-analysis.html"><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement"><i class="fa fa-check"></i><b>19.3.2</b> Other nonparametric tests for STRATA statement</a></li>
<li class="chapter" data-level="19.3.3" data-path="survival-analysis.html"><a href="survival-analysis.html#multiple-comparisons"><i class="fa fa-check"></i><b>19.3.3</b> Multiple comparisons</a></li>
<li class="chapter" data-level="19.3.4" data-path="survival-analysis.html"><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr"><i class="fa fa-check"></i><b>19.3.4</b> Comparing survival functions using Log-Rank HR</a></li>
<li class="chapter" data-level="19.3.5" data-path="survival-analysis.html"><a href="survival-analysis.html#mantel-haenszel-hr"><i class="fa fa-check"></i><b>19.3.5</b> Mantel-Haenszel HR</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>19.4</b> Cox Proportional Hazards Model</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-13"><i class="fa fa-check"></i><b>19.4.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html"><i class="fa fa-check"></i><b>20</b> Advanced Survival Analysis</a></li>
<li class="chapter" data-level="21" data-path="count-data-regression.html"><a href="count-data-regression.html"><i class="fa fa-check"></i><b>21</b> Count Data Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="count-data-regression.html"><a href="count-data-regression.html#introduction-of-count-data-regression"><i class="fa fa-check"></i><b>21.1</b> Introduction of Count Data Regression</a></li>
<li class="chapter" data-level="21.2" data-path="count-data-regression.html"><a href="count-data-regression.html#poisson-regression"><i class="fa fa-check"></i><b>21.2</b> Poisson regression</a></li>
<li class="chapter" data-level="21.3" data-path="count-data-regression.html"><a href="count-data-regression.html#negative-binomial-regression"><i class="fa fa-check"></i><b>21.3</b> Negative Binomial Regression</a></li>
<li class="chapter" data-level="21.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-truncated-poisson-regression-model"><i class="fa fa-check"></i><b>21.4</b> Zero-truncated Poisson Regression Model</a></li>
<li class="chapter" data-level="21.5" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-insflated-model"><i class="fa fa-check"></i><b>21.5</b> Zero-Insflated Model</a></li>
<li class="chapter" data-level="21.6" data-path="count-data-regression.html"><a href="count-data-regression.html#hurdle-models"><i class="fa fa-check"></i><b>21.6</b> Hurdle models</a></li>
<li class="chapter" data-level="21.7" data-path="count-data-regression.html"><a href="count-data-regression.html#proportion-response-regression"><i class="fa fa-check"></i><b>21.7</b> Proportion-Response-Regression</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="count-data-regression.html"><a href="count-data-regression.html#beta-regression"><i class="fa fa-check"></i><b>21.7.1</b> Beta Regression</a></li>
<li class="chapter" data-level="21.7.2" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.2</b> Zero-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.7.3" data-path="count-data-regression.html"><a href="count-data-regression.html#one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.3</b> One-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.7.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.4</b> Zero-one-inflated Beta Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mixed-model.html"><a href="mixed-model.html"><i class="fa fa-check"></i><b>22</b> Mixed Model</a>
<ul>
<li class="chapter" data-level="22.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-14"><i class="fa fa-check"></i><b>22.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="mixed-model.html"><a href="mixed-model.html#correlated-response-data"><i class="fa fa-check"></i><b>22.1.1</b> Correlated response data</a></li>
<li class="chapter" data-level="22.1.2" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-and-marginal-model"><i class="fa fa-check"></i><b>22.1.2</b> Hierarchical and Marginal model</a></li>
<li class="chapter" data-level="22.1.3" data-path="mixed-model.html"><a href="mixed-model.html#mle-in-marginal-model"><i class="fa fa-check"></i><b>22.1.3</b> MLE in Marginal model</a></li>
<li class="chapter" data-level="22.1.4" data-path="mixed-model.html"><a href="mixed-model.html#reml-in-marginal-model"><i class="fa fa-check"></i><b>22.1.4</b> REML in Marginal model</a></li>
<li class="chapter" data-level="22.1.5" data-path="mixed-model.html"><a href="mixed-model.html#variance-correction"><i class="fa fa-check"></i><b>22.1.5</b> Variance correction</a></li>
<li class="chapter" data-level="22.1.6" data-path="mixed-model.html"><a href="mixed-model.html#hypothesis-tests"><i class="fa fa-check"></i><b>22.1.6</b> Hypothesis tests</a></li>
<li class="chapter" data-level="22.1.7" data-path="mixed-model.html"><a href="mixed-model.html#residual-structure"><i class="fa fa-check"></i><b>22.1.7</b> Residual Structure</a></li>
<li class="chapter" data-level="22.1.8" data-path="mixed-model.html"><a href="mixed-model.html#converge-problems"><i class="fa fa-check"></i><b>22.1.8</b> Converge problems</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model"><i class="fa fa-check"></i><b>22.2</b> Random Slope and Intercept Model</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction"><i class="fa fa-check"></i><b>22.2.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.2.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-10"><i class="fa fa-check"></i><b>22.2.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.2.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-12"><i class="fa fa-check"></i><b>22.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model-with-covariance-structure"><i class="fa fa-check"></i><b>22.3</b> Random Slope and Intercept Model with Covariance Structure</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction-1"><i class="fa fa-check"></i><b>22.3.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.3.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-11"><i class="fa fa-check"></i><b>22.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.3.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-13"><i class="fa fa-check"></i><b>22.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="mixed-model.html"><a href="mixed-model.html#generalized-estimating-equation"><i class="fa fa-check"></i><b>22.4</b> Generalized Estimating Equation</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-of-gee"><i class="fa fa-check"></i><b>22.4.1</b> Introduction of GEE</a></li>
<li class="chapter" data-level="22.4.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-12"><i class="fa fa-check"></i><b>22.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.4.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-14"><i class="fa fa-check"></i><b>22.4.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-regression-model-for-normal-response"><i class="fa fa-check"></i><b>22.5</b> Hierarchical Regression Model for Normal Response</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-15"><i class="fa fa-check"></i><b>22.5.1</b> Introduction</a></li>
<li class="chapter" data-level="22.5.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-13"><i class="fa fa-check"></i><b>22.5.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.5.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-15"><i class="fa fa-check"></i><b>22.5.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="generalized-linear-mixed-model.html"><a href="generalized-linear-mixed-model.html"><i class="fa fa-check"></i><b>23</b> Generalized Linear (Mixed) Model</a></li>
<li class="chapter" data-level="24" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html"><i class="fa fa-check"></i><b>24</b> Group (Adaptive) Sequential Design</a>
<ul>
<li class="chapter" data-level="24.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#section"><i class="fa fa-check"></i><b>24.1</b> </a></li>
<li class="chapter" data-level="24.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#adaptive-designs"><i class="fa fa-check"></i><b>24.2</b> Adaptive designs</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#introduction-16"><i class="fa fa-check"></i><b>24.2.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="space.html"><a href="space.html"><i class="fa fa-check"></i><b>25</b> ^_^ Space</a></li>
<li class="chapter" data-level="26" data-path="propensity-score.html"><a href="propensity-score.html"><i class="fa fa-check"></i><b>26</b> Propensity Score</a></li>
<li class="chapter" data-level="27" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>27</b> Missing Data</a>
<ul>
<li class="chapter" data-level="27.1" data-path="missing-data.html"><a href="missing-data.html#missing-mechanisms"><i class="fa fa-check"></i><b>27.1</b> Missing mechanisms</a></li>
<li class="chapter" data-level="27.2" data-path="missing-data.html"><a href="missing-data.html#compatibility-and-congeniality"><i class="fa fa-check"></i><b>27.2</b> Compatibility and Congeniality</a></li>
<li class="chapter" data-level="27.3" data-path="missing-data.html"><a href="missing-data.html#single-imputation"><i class="fa fa-check"></i><b>27.3</b> Single imputation</a></li>
<li class="chapter" data-level="27.4" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>27.4</b> Multiple imputation</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="missing-data.html"><a href="missing-data.html#joint-modeling-jm"><i class="fa fa-check"></i><b>27.4.1</b> Joint Modeling (JM)</a></li>
<li class="chapter" data-level="27.4.2" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice"><i class="fa fa-check"></i><b>27.4.2</b> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="missing-data.html"><a href="missing-data.html#bayesian-linear-regression"><i class="fa fa-check"></i><b>27.5</b> Bayesian linear regression</a></li>
<li class="chapter" data-level="27.6" data-path="missing-data.html"><a href="missing-data.html#predictive-mean-matching"><i class="fa fa-check"></i><b>27.6</b> Predictive Mean Matching</a></li>
<li class="chapter" data-level="27.7" data-path="missing-data.html"><a href="missing-data.html#mice-using-random-forest"><i class="fa fa-check"></i><b>27.7</b> MICE using random forest</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> Logistic Regression</h1>
<div id="htmlwidget-038785e64b105bc24c48" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-038785e64b105bc24c48">{"x":{"data":"# \n## Logistic Regression \n### Introduction\n#### Violation of assumptions of Ordinary least squares (OLS) \n#### More fundamental problem outside [0,1]\n#### Logistic Regression Model \n#### Estimation of the Logistic Model\n#### Convergence Problems\n#### Use exact methods. \n#### Use penalized likelihood\n### Logit Modell\n#### Introduction\n#### R Implementation\n#### SAS Implementation\n#### Multicollinearity\n#### Goodness-of-Fit Statistics Pearson deviance\n#### Hosmer and Lemeshow Goodness-of-Fit Test\n#### Statistics Measuring Predictive Power $R^2$\n##### Generalized $R^$\n##### McFadden $R^$\n##### Tjur's $R^$\n#### ROC Curves \n#### Predicted Values, Residuals, and Influence Statistics\n#### Unobserved Heterogeneity\n#### Plotting Effects of Predictor Variables\n### Probit Modell\n#### Introduction\n#### R Implemetation\n#### SAS Implementation\n### Complementary log-log-Modell\n#### R Implemetation\n### Multi-category logit model\n#### Multinomialverteilung\n#### Mehrkategoriales Logit-Modell\n#### R Implementation\n#### SAS Implementation\n### Ordinal Cumulative Logit Model\n#### R Implementation\n#### SAS Implementation\n### Adjacent Categories Model\n### Continuation Ratio Model","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="introduction-9" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Introduction</h2>
<p>Use probability-based linear models to predict qualitative response variables, three methods:</p>
<ol style="list-style-type: decimal">
<li>Logistic regression</li>
<li>Linear discriminant analysis<br />
</li>
<li>Multivariate adaptive regression spline</li>
</ol>
<div id="violation-of-assumptions-of-ordinary-least-squares-ols" class="section level3" number="17.1.1">
<h3><span class="header-section-number">17.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</h3>
<p>The basic assumptions of OLS regression</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(y_{i}=\alpha+\beta x_{i}+\varepsilon_{i} \mid\)</span></li>
<li><span class="math inline">\(\mathrm{E}\left(\varepsilon_{i}\right)=0\)</span></li>
<li><span class="math inline">\(\operatorname{var}\left(\varepsilon_{i}\right)=\sigma^{2}\)</span></li>
<li><span class="math inline">\(\operatorname{cov}\left(\varepsilon_{i}, \varepsilon_{j}\right)=0\)</span></li>
<li><span class="math inline">\(\varepsilon_{i} \sim\)</span> Normal</li>
</ol>
<p><strong>Normal residuals assumption</strong></p>
<p>Assuming y is a dichotomy, the possible values are 1 or 0. Assume yi = 1. Then hypothesis 1 means εi = 1–α–βxi. On the other hand, if yi = 0, we have εi = –α–βxi. Since εi can only take two values, it is impossible to have a normal distribution</p>
<p><strong>Consistant variance assumption</strong></p>
<p><span class="math display">\[E\left(y_{i}\right)=1 \times \operatorname{Pr}\left(y_{i}=1\right)+0 \times \operatorname{Pr}\left(y_{i}=0\right)\]</span></p>
<p>If we define <span class="math inline">\(p i=\operatorname{Pr}(y i=1)\)</span>,Then
<span class="math display">\[E\left(y_{i}\right)=p_{i}\]</span></p>
<p><span class="math display">\[
\begin{array}{c}
E\left(y_{i}\right)=E\left(\alpha+\beta x_{i}+\varepsilon_{i}\right) 
=E(\alpha)+E\left(\beta x_{i}\right)+E\left(\varepsilon_{i}\right) 
=\alpha+\beta x_{i}
\end{array}
\]</span>
Putting these two results together, we get
<span class="math display">\[
\begin{array}{c}
p_{i}=\alpha+\beta x_{i} \\
\operatorname{var}\left(\varepsilon_{i}\right)=p_{i}\left(1-p_{i}\right)=\left(\alpha+\beta x_{i}\right)\left(1-\alpha-\beta x_{i}\right)
\end{array}
\]</span>
For different observations, the variance of <span class="math inline">\(ε_i\)</span> must be different, especially as it changes with changes in x. When pi = 0.5, the disturbance variance is the largest, and when pi is close to 1 or 0, the disturbance variance becomes smaller.</p>
<p><strong>Problems</strong></p>
<p>If the sample is quite large, the normality assumption is not required. The <strong>central limit theorem</strong> assures us that even if ε is not normally distributed, the coefficient estimates will have an approximately normal distribution. This means that we can still use ordinary tables to calculate p-values and confidence intervals. However, if the sample is small, these approximations may be poor.</p>
<!-- 如果样本相当大，则不需要正态假设。中心极限定理向我们保证，即使ε不呈正态分布，系数估计也将具有近似正态的分布。这意味着我们仍然可以使用普通表来计算p值和置信区间。但是，如果样本较小，则这些近似值可能会很差。 -->
<p><strong>Violation of the homoscedasticity assumption has two undesirable consequences.</strong></p>
<ol style="list-style-type: decimal">
<li>First, the coefficient estimates are no longer <strong>effective</strong>. In statistical terms, this means that there are other selection methods with smaller standard errors.</li>
<li>the standard error estimates are no longer consistent estimates of the true standard errors. That means that the estimated standard errors could be biased (either upward or downward) to unknown degrees. And because the standard errors are used in calculating test statistics, the test statistics could also be problematic.</li>
</ol>
<!-- 首先，系数估计不再有效。用统计术语来说，这意味着存在其他选择方法，它们的标准误差较小。 -->
<!-- 其次，更严重的是，标准误差估计不再是真实标准误差的一致估计。这意味着估计的标准误差可能会偏向（向上或向下）到未知程度。并且由于标准误差用于计算测试统计信息，因此测试统计信息也可能会出现问题。幸运的是，可以轻松解决标准错误和测试统计信息的潜在问题。 -->
<p><strong>Heteroscedasticity consistent covariance estimator “sandwich”</strong></p>
<p>Even if the homogeneity assumption is violated, this method will produce a consistent estimate of the standard error. To implement this method in PROC REG, just put the option HCC on the MODEL statement</p>
<pre><code>PROC REG DATA=penalty;
  MODEL death=blackd whitvic serious / HCC; 
RUN;</code></pre>
<!-- 尽管HCC标准误差很容易解决，但是请注意，它们固有地具有比常规标准误差更大的采样变异性（Kauermann和Carroll 2001），并且在小样本中可能尤其不可靠。但是，对于大样本，它们应该是令人满意的. -->
</div>
<div id="more-fundamental-problem-outside-01" class="section level3" number="17.1.2">
<h3><span class="header-section-number">17.1.2</span> More fundamental problem outside [0,1]</h3>
<p>For Linear probability model <span class="math inline">\(p_{i}=\alpha+\beta x_{i}\)</span>, If x has no upper or lower limit, then for any value of β, there is a value of x whose pi is greater than 1 or less than 0.</p>
</div>
<div id="logistic-regression-model" class="section level3" number="17.1.3">
<h3><span class="header-section-number">17.1.3</span> Logistic Regression Model</h3>
<p>Probability is bounded by 0 and 1, while linear functions are inherently unbounded. The solution is to convert the probability so that it is no longer restricted. Converting probabilities to odds eliminates the upper limit. For k explanatory variables
<span class="math display">\[\log \left[\frac{p_{i}}{1-p_{i}}\right]=\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
<span class="math display">\[p_{i}=\frac{\exp \left(\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right)}{1+\exp \left(\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right)}\]</span>
<span class="math display">\[p_{i}=\frac{1}{1+\exp \left(-\alpha-\beta_{1} x_{i 1}-\beta_{2} x_{i 2}-\ldots-\beta_{k} x_{i k}\right)}\]</span></p>
<!-- 逻辑模型的方程式中没有随机扰动项。这并不意味着该模型是确定性的，因为pi和yi之间的概率关系仍然存在随机变化的空间。-->
<p>There is <strong>no random disturbance term</strong> in the equation of the logic model. This does not mean that the model is deterministic, because there is still room for random variation in the probability relationship between pi and yi.</p>
</div>
<div id="estimation-of-the-logistic-model" class="section level3" number="17.1.4">
<h3><span class="header-section-number">17.1.4</span> Estimation of the Logistic Model</h3>
<ul>
<li>ordinary least squares,</li>
<li>weighted least squares,</li>
<li>maximum likelihood.</li>
</ul>
<blockquote>
<p>假设分析单位是商业公司，并且因变量是员工是全职员工的概率。设Pi为在i公司中全职工作的可观察员工比例。
要通过OLS估计逻辑模型，我们可以简单地采用P的logit变换，即log [P/（1-P）]，然后将结果回归到公司特征和员工平均特征上。
加权最小二乘（WLS）分析将类似，不同之处在于将对数据进行加权以针对异方差进行调整。
最大似然（ML）是为分组数据估算逻辑模型的第三种方法，也是一般用于单个级别数据的唯一方法。
利用个人数据，我们只需观察每个人的二分因变量以及该人的测量特征即可。</p>
</blockquote>
<p><strong>ML</strong></p>
<blockquote>
<p>最大似然受欢迎程度有两个原因。
1. ML估计量是一致的，渐近有效的并且渐近正态的。
2. 在没有其他明显候选者的情况下，通常很容易得出ML估计量. 为此，有两个步骤：
（1）写下数据概率作为未知参数的函数的表达式，以及（2）找到使该表达式的值尽可能大的未知参数值。</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><strong>Consistency</strong> means that as the sample size gets larger the probability that the estimate is within some small distance of the true value also gets larger. No matter how small the distance or how high the specified probability, there is always a sample size that yields an even higher probability that the estimator is within that distance of the true value. One implication of consistency is that the ML estimator is approximately unbiased in large samples.</li>
<li><strong>Asymptotic efficiency</strong> means that, in large samples, the estimates will have standard errors that are, approximately, at least as small as those for any other estimation method. And, finally, the sampling distribution of the estimates will be approximately normal in large samples, which means that you can use the normal and chi-square distributions to compute confidence intervals and p-values. All these approximations get better as the sample size gets larger. The fact that these desirable properties have only been proven for large samples does not mean that ML has bad properties for small samples. It simply means that we usually don’t know exactly what the small-sample properties are. And in the absence of attractive alternatives, researchers routinely use ML estimation for both large and small samples.</li>
</ol>
<!-- 一致性意味着，随着样本数量的增加，估计值在真实值的一小段距离内的可能性也会随之增加。无论距离有多小或指定概率有多高，总有一个样本大小会产生更高的概率，即估计量在真实值的该距离内。一致性的一个暗示是，在大样本中ML估计量几乎是无偏的。 -->
<!-- 渐近效率意味着，在大样本中，估计将具有大约至少与任何其他估计方法一样小的标准误差。最后，在大样本中，估计值的采样分布将近似于正态，这意味着您可以使用正态分布和卡方分布来计算置信区间和p值。随着样本数量的增加，所有这些近似值都会变得更好。这些合意的特性仅在大样本中得到证明的事实并不意味着ML对于小样本具有不良的特性。这仅表示我们通常不确切知道小样本属性是什么。而且，在没有有吸引力的替代方案的情况下，研究人员通常对大型和小型样本都使用ML估计。 -->
<p><strong>Maximum Likelihood Estimation </strong></p>
<p>We have data for n individuals (i = 1, …, n), and these individuals are considered statistically independent. For each i, the data consists of yi and xi, where yi is a random variable with possible values 0 and 1, and xi = [1 xi1…xik]’ is a vector of explanatory variables (1 is the intercept).) Let pi The probability of yi = 1
<span class="math display">\[p_{i}=\frac{1}{1+e^{-\boldsymbol{\beta} \mathbf{x}_{i}}}\]</span></p>
<p>The likelihood of observing the values of <span class="math inline">\(y\)</span> for all the observations can be written as
<span class="math display">\[L=\operatorname{Pr}\left(y_{1}, y_{2,} \ldots, y_{n}\right)\]</span></p>
<p>Because we are assuming that observations are independent, the overall probability of observing all the <span class="math inline">\(y_{i}, \mathrm{~s}\)</span> can be factored into the product of the individual probabilities:
<span class="math display">\[
L=\operatorname{Pr}\left(y_{1}\right) \operatorname{Pr}\left(y_{2}\right) \ldots \operatorname{Pr}\left(y_{n}\right)=\prod_{i=1}^{n} \operatorname{Pr}\left(y_{i}\right)
\]</span>
By definition, <span class="math inline">\(\operatorname{Pr}\left(y_{i}=1\right)=p_{i}\)</span> and <span class="math inline">\(\operatorname{Pr}\left(y_{i}=0\right)=1-p_{i} .\)</span> That implies that we can write
<span class="math display">\[
\begin{array}{c}
\operatorname{Pr}\left(y_{i}\right)=p_{i}^{y_{i}}\left(1-p_{i}\right)^{1-y_{i}} \\
L=\prod_{i=1}^{n} p_{i}^{y_{i}}\left(1-p_{i}\right)^{1-y_{i}}=\prod_{i=1}^{n}\left(\frac{p_{i}}{1-p_{i}}\right)^{y_{i}}\left(1-p_{i}\right) .
\end{array}
\]</span>
At this point we take the logarithm of both sides of the equation to get
<span class="math display">\[
\log L=\sum_{i} y_{i} \log \left(\frac{p_{i}}{1-p_{i}}\right)+\sum_{i} \log \left(1-p_{i}\right)
\]</span>
And for equation
<span class="math display">\[
\log L=\sum_{i} \boldsymbol{\beta} \mathbf{x}_{i} y_{i}-\sum_{i} \log \left(1+e^{\boldsymbol{\beta} \mathbf{x}_{i}}\right)
\]</span>
Taking the derivative of equation and setting it equal to 0 gives us:
<span class="math display">\[
\begin{aligned}
\frac{\partial \log L}{\partial \boldsymbol{\beta}} &amp;=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i}\left(1+e^{-\boldsymbol{\beta} \mathbf{x}_{i}}\right)^{-1} \\
&amp;=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i}=0
\end{aligned}
\]</span>
<span class="math display">\[\hat{y}_{i}=\frac{1}{1+e^{-\beta \mathbf{x}_{i}}}\]</span>
<strong>Newton-Raphson iterative methods</strong></p>
<p>There is no clear solution to the equation. Instead, we must rely on iterative methods, which are equivalent to successive approximations to the solution until the approximation “converges” to the solution. Until the approximation “converges” to the correct value. Again, there are many different ways to do this. All methods produce the same solution, but they differ in factors such as convergence speed, sensitivity to initial values, and computational difficulty of each iteration. The Newton-Raphson algorithm is one of the most widely used iterative methods.
<span class="math display">\[
\begin{array}{l}
\mathbf{U}(\boldsymbol{\beta})=\frac{\partial \log L}{\partial \boldsymbol{\beta}}=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i} \\
\mathbf{I}(\boldsymbol{\beta})=\frac{\partial^{2} \log L}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^{\prime}}=-\sum_{i} \mathbf{x}_{i} \mathbf{x}_{i}^{\prime} \hat{y}_{i}\left(1-\hat{y}_{i}\right)
\end{array}
\]</span></p>
<!-- 方程没有明确的解决方案。 取而代之的是，我们必须依靠迭代方法，这些方法等于对解的逐次逼近，直到逼近“收敛”到解。直到逼近“收敛”到正确的值为止。同样，有许多不同的方法可以执行此操作。所有方法都产生相同的解决方案，但是它们在诸如收敛速度，对初始值的敏感性以及每次迭代的计算难度等因素方面有所不同。 牛顿-拉夫森（Newton-Raphson）算法是最广泛使用的迭代方法之一 -->
<p>The Newton-Raphson algorithm is then <span class="math display">\[\boldsymbol{\beta}_{j+1}=\boldsymbol{\beta}_{j}-\mathbf{I}^{-1}\left(\boldsymbol{\beta}_{j}\right) \mathbf{U}\left(\boldsymbol{\beta}_{j}\right)\]</span></p>
<p>We need a set of initial values <span class="math inline">\(\beta_0\)</span>. PROC LOGISTIC starts by setting all slope coefficients to 0. Set the intercept to be equal to log [p /(1-p)], where p is the total proportion of events. These initial values are substituted into the right side of the equation, resulting in the result of the first iteration <span class="math inline">\(\beta_1\)</span>. Then substitute these values into the right side, recalculate the first and second derivatives, and the result is <span class="math inline">\(\beta_2\)</span> Repeat this process until you get “convergence.”</p>
<p>This means that what is inserted on the right is obtained on the left. In fact, you will never get exactly the same thing, so it is necessary to adopt a convergence criterion to judge whether the proximity is close enough. But since every successful run of PROC LOGISTIC reports “Convergence criterion (GCONV=1E-8) satisfied,”
<span class="math display">\[\frac{\mathbf{U}\left(\boldsymbol{\beta}_{j}\right)^{\prime} \mathbf{I}^{-1}\left(\boldsymbol{\beta}_{j}\right) \mathbf{U}\left(\boldsymbol{\beta}_{j}\right)}{\left|\log L\left(\boldsymbol{\beta}_{j}\right)\right|+.000001}\]</span></p>
<p>If the number is less than .00000001, convergence is declared and the algorithm stops.</p>
</div>
<div id="convergence-problems" class="section level3" number="17.1.5">
<h3><span class="header-section-number">17.1.5</span> Convergence Problems</h3>
<blockquote>
<p>逻辑模型的最大似然估计是逐次逼近的迭代过程。通常，该过程会顺利进行，无需特别注意。很少需要超过10次迭代才能达到收敛。但是，有时迭代过程会中断，因此无法实现收敛。处理收敛失败可能是逻辑回归用户遇到的更令人沮丧的问题之一。 LOGISTIC的默认限制为25次迭代。如果算法尚未达到此限制，则LOGISTIC会发出警告消息，并在最后一次迭代时打印出结果。尽管可以提高迭代限制（使用MODEL语句中的MAXITER =选项），但这很少能解决问题。未进行25次迭代收敛的模型通常永远不会收敛。在大多数收敛失败的情况下，最大似然估计根本不存在。</p>
</blockquote>
<p><strong>Quasi-complete separation of data points detected.</strong></p>
<blockquote>
<p>准完全分离的最常见原因是虚拟预测变量具有以下属性：在虚拟变量的一个级别上，每种情况下因变量都为1或每种情况下都为0。查看任何分类自变量与因变量的交叉分类也非常有帮助。如果您在这些表中的任何一个中发现单元频率为0，则说明了造成准完全分离的原因。找到问题变量后，如何处理</p>
</blockquote>
<ul>
<li>Recode the problem variables</li>
<li>Collapse categories</li>
<li>Exclude cases from the model</li>
</ul>
<p><strong>Retain the model with quasi-complete separation but use likelihood-ratio tests.</strong></p>
<p>The reported standard error and Wald’s chi-square of this variable are also of no avail. Nevertheless, it is still possible to obtain a valid likelihood ratio test, <em>Profile Likelihood confidence interval.</em></p>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious / CLPARM=PL ALPHA=.01;
RUN;

##########################################
Parameter Estimate   99% Confidence Limits
culp 1    -15.5467          . -3.2344</code></pre>
</div>
<div id="use-exact-methods." class="section level3" number="17.1.6">
<h3><span class="header-section-number">17.1.6</span> Use exact methods.</h3>
<blockquote>
<p>尽管最大似然具有许多吸引人的属性，但请务必记住，最大似然产生的标准误差和p值是大样本近似值。 在小样本或分离的情况下，准确性可能不如我们想要的那样好。 具有良好的小样本属性的另一种估算方法是“精确逻辑回归”。 这种方法可以看作是费雪（Fisher）对双向列联表的精确检验的概括。 在这种方法中，p值是通过在原假设下枚举所有可能的样本结果来计算的。 即使在完全分离或准完全分离的情况下，精确方法也会产生有效的p值。</p>
</blockquote>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious;
 EXACT culp serious / ESTIMATE=BOTH;
RUN; </code></pre>
<p>These tests are conditional in the sense that they are based on the conditional distribution of the sufficient statistic for each parameter, conditioning on the sufficient statistics for all the other parameters. (The sufficient statistics are the sums of cross products for each x and the binary dependent variable y.) The tests are exact in the same sense that t-statistics are exact in normal-theory linear regression. That is, they are not large sample approximations, and they give the correct probability of getting a result that is at least as extreme as the one observed in the sample, under the null hypothesis that a variable has no effect.</p>
</div>
<div id="use-penalized-likelihood" class="section level3" number="17.1.7">
<h3><span class="header-section-number">17.1.7</span> Use penalized likelihood</h3>
<p>处理拟完全分离的最简单，最有效的方法之一是一种被称为惩罚似然估计的方法，该方法由Firth（1993）引入，因此通常被称为Firth方法。 众所周知，传统的最大似然估计可能会在小样本中产生偏差。 惩罚似然法旨在减少这种偏差，适用于最大似然的广泛应用。 Heinze和Schemper（2002）表明，这种方法在处理准完全分离的情况下特别有效。 运作方式如下。 在牛顿-拉夫森算法（方程3.7）中，一阶导数U（β）</p>
<p><span class="math display">\[\mathbf{U}(\boldsymbol{\beta})=\frac{\partial \log L}{\partial \boldsymbol{\beta}}=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i}-\sum_{i} h_{i} \mathbf{x}_{i}\left(.5-\hat{y}_{i}\right)\]</span>
In PROC LOGISTIC, the method is implemented with the FIRTH option on the MODEL statement</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious / FIRTH
 CLPARM=PL;
RUN;</code></pre>
</div>
</div>
<div id="logit-modell" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Logit Modell</h2>
<div id="introduction-10" class="section level3" number="17.2.1">
<h3><span class="header-section-number">17.2.1</span> Introduction</h3>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Complementary log-log model:
<span class="math display">\[\pi=1-\exp (-\exp (\eta)) \quad \Longleftrightarrow \quad \log (-\log (1-\pi))=\eta\]</span></p>
<p><strong>Interpretation</strong></p>
<p><span class="math display">\[\frac{\mathrm{P}\left(y_{i}=1 \mid \boldsymbol{x}_{i}\right)}{\mathrm{P}\left(y_{i}=0 \mid \boldsymbol{x}_{i}\right)}=\exp \left(\beta_{0}\right) \cdot \exp \left(x_{i 1} \beta_{1}\right) \cdot \ldots \cdot \exp \left(x_{i k} \beta_{k}\right)\]</span></p>
<p><span class="math display">\[\frac{\mathrm{P}\left(y_{i}=1 \mid x_{i 1}, \ldots\right)}{\mathrm{P}\left(y_{i}=0 \mid x_{i 1}, \ldots\right)} / \frac{\mathrm{P}\left(y_{i}=1 \mid x_{i 1}+1, \ldots\right)}{\mathrm{P}\left(y_{i}=0 \mid x_{i 1}+1, \ldots\right)}=\exp \left(\beta_{1}\right)\]</span></p>
<p><span class="math display">\[
\begin{array}{l}
\beta_{1}&gt;0: \text {Chance} $\mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text {wird größer},\\
\beta_{1}&lt;0: \text { Chance } \mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text { wird kleiner, } \\
\beta_{1}=0: \text { Chance } \mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text { bleibt gleich. }
\end{array}
\]</span></p>
</div>
<div id="r-implementation-9" class="section level3" number="17.2.2">
<h3><span class="header-section-number">17.2.2</span> R Implementation</h3>
<ul>
<li>Compare models <code>anova(fit.model1, fit.model2, test = "Chisq")</code></li>
<li>Change Referenz <code>relevel(factor(school2$RANK),ref=4)</code></li>
<li>Interpret coefficients Odds <code>exp(coef(fit.reduced))</code></li>
<li>Predict using new datasets <code>predict(fit.model, newdata = testdata, type = "response")</code></li>
<li>CIs using profiled log-likelihood <code>confint(fit.model)</code></li>
<li>CIs using standard errors <code>confint.default(fit.model)</code></li>
<li>VIF statistics <code>library(car), vif(fit.model)</code></li>
<li>Wald Test <code>library(aod) ,wald.test()</code></li>
<li>Log likelihood ratio test <code>logLik()</code></li>
<li>Marginal effects <code>library(mfx), logitmfx</code></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="logistic-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get summary statistics </span></span>
<span id="cb5-2"><a href="logistic-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Affairs, <span class="at">package =</span> <span class="st">&quot;AER&quot;</span>)</span>
<span id="cb5-3"><a href="logistic-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Affairs)</span></code></pre></div>
<pre><code>##     affairs          gender         age         yearsmarried    children 
##  Min.   : 0.000   female:315   Min.   :17.50   Min.   : 0.125   no :171  
##  1st Qu.: 0.000   male  :286   1st Qu.:27.00   1st Qu.: 4.000   yes:430  
##  Median : 0.000                Median :32.00   Median : 7.000            
##  Mean   : 1.456                Mean   :32.49   Mean   : 8.178            
##  3rd Qu.: 0.000                3rd Qu.:37.00   3rd Qu.:15.000            
##  Max.   :12.000                Max.   :57.00   Max.   :15.000            
##  religiousness     education       occupation        rating     
##  Min.   :1.000   Min.   : 9.00   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:14.00   1st Qu.:3.000   1st Qu.:3.000  
##  Median :3.000   Median :16.00   Median :5.000   Median :4.000  
##  Mean   :3.116   Mean   :16.17   Mean   :4.195   Mean   :3.932  
##  3rd Qu.:4.000   3rd Qu.:18.00   3rd Qu.:6.000   3rd Qu.:5.000  
##  Max.   :5.000   Max.   :20.00   Max.   :7.000   Max.   :5.000</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="logistic-regression.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Affairs<span class="sc">$</span>affairs)</span></code></pre></div>
<pre><code>## 
##   0   1   2   3   7  12 
## 451  34  17  19  42  38</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="logistic-regression.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 感兴趣的是二值型结果(有过一次婚 外情/没有过婚外情),将affairs转化为二值型因子ynaffair。</span></span>
<span id="cb9-2"><a href="logistic-regression.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## create binary outcome variable</span></span>
<span id="cb9-3"><a href="logistic-regression.html#cb9-3" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair[Affairs<span class="sc">$</span>affairs <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="logistic-regression.html#cb9-4" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair[Affairs<span class="sc">$</span>affairs <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-5"><a href="logistic-regression.html#cb9-5" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair <span class="ot">&lt;-</span> <span class="fu">factor</span>(Affairs<span class="sc">$</span>ynaffair, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb9-6"><a href="logistic-regression.html#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb9-7"><a href="logistic-regression.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Affairs<span class="sc">$</span>ynaffair)</span></code></pre></div>
<pre><code>## 
##  No Yes 
## 451 150</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="logistic-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit full model</span></span>
<span id="cb11-2"><a href="logistic-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a>fit.full <span class="ot">&lt;-</span> <span class="fu">glm</span>(ynaffair <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> yearsmarried <span class="sc">+</span> </span>
<span id="cb11-3"><a href="logistic-regression.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    children <span class="sc">+</span> religiousness <span class="sc">+</span> education <span class="sc">+</span> occupation <span class="sc">+</span> rating, </span>
<span id="cb11-4"><a href="logistic-regression.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Affairs, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-5"><a href="logistic-regression.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.full)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ynaffair ~ gender + age + yearsmarried + children + 
##     religiousness + education + occupation + rating, family = &quot;binomial&quot;, 
##     data = Affairs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5713  -0.7499  -0.5690  -0.2539   2.5191  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.37726    0.88776   1.551 0.120807    
## gendermale     0.28029    0.23909   1.172 0.241083    
## age           -0.04426    0.01825  -2.425 0.015301 *  
## yearsmarried   0.09477    0.03221   2.942 0.003262 ** 
## childrenyes    0.39767    0.29151   1.364 0.172508    
## religiousness -0.32472    0.08975  -3.618 0.000297 ***
## education      0.02105    0.05051   0.417 0.676851    
## occupation     0.03092    0.07178   0.431 0.666630    
## rating        -0.46845    0.09091  -5.153 2.56e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 675.38  on 600  degrees of freedom
## Residual deviance: 609.51  on 592  degrees of freedom
## AIC: 627.51
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="logistic-regression.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从回归系数的p值(最后一栏)可以看到，性别、是否有孩子、学历和职业对方程的贡献都不显著(你无法拒绝参数为0的假设)。去除这些变量重新拟合模型，检验新模型是否拟合得好</span></span>
<span id="cb13-2"><a href="logistic-regression.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit reduced model</span></span>
<span id="cb13-3"><a href="logistic-regression.html#cb13-3" aria-hidden="true" tabindex="-1"></a>fit.reduced <span class="ot">&lt;-</span> <span class="fu">glm</span>(ynaffair <span class="sc">~</span> age <span class="sc">+</span> yearsmarried <span class="sc">+</span> </span>
<span id="cb13-4"><a href="logistic-regression.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    religiousness <span class="sc">+</span> rating, <span class="at">data =</span> Affairs, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb13-5"><a href="logistic-regression.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reduced)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ynaffair ~ age + yearsmarried + religiousness + 
##     rating, family = binomial(), data = Affairs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6278  -0.7550  -0.5701  -0.2624   2.3998  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.93083    0.61032   3.164 0.001558 ** 
## age           -0.03527    0.01736  -2.032 0.042127 *  
## yearsmarried   0.10062    0.02921   3.445 0.000571 ***
## religiousness -0.32902    0.08945  -3.678 0.000235 ***
## rating        -0.46136    0.08884  -5.193 2.06e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 675.38  on 600  degrees of freedom
## Residual deviance: 615.36  on 596  degrees of freedom
## AIC: 625.36
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="logistic-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb15-2"><a href="logistic-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.reduced, fit.full, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: ynaffair ~ age + yearsmarried + religiousness + rating
## Model 2: ynaffair ~ gender + age + yearsmarried + children + religiousness + 
##     education + occupation + rating
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1       596     615.36                     
## 2       592     609.51  4   5.8474   0.2108</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="logistic-regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果的卡方值不显著(p=0.21)，表明四个预测变量的新模型与九个完整预测变量的模型拟合程度一样好。这使得你更加坚信添加性别、孩子、学历和职业变量不会显著提高方程的预测精 度，因此可以依据更简单的模型进行解释。</span></span>
<span id="cb17-2"><a href="logistic-regression.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="logistic-regression.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 解释模型参数</span></span>
<span id="cb17-4"><a href="logistic-regression.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># interpret coefficients</span></span>
<span id="cb17-5"><a href="logistic-regression.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.reduced)</span></code></pre></div>
<pre><code>##   (Intercept)           age  yearsmarried religiousness        rating 
##    1.93083017   -0.03527112    0.10062274   -0.32902386   -0.46136144</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="logistic-regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit.reduced))</span></code></pre></div>
<pre><code>##   (Intercept)           age  yearsmarried religiousness        rating 
##     6.8952321     0.9653437     1.1058594     0.7196258     0.6304248</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="logistic-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CIs using profiled log-likelihood</span></span>
<span id="cb21-2"><a href="logistic-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit.reduced)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept)    0.75404303  3.150622807
## age           -0.07006400 -0.001854759
## yearsmarried   0.04388142  0.158562400
## religiousness -0.50637196 -0.155156981
## rating        -0.63741235 -0.288566411</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="logistic-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CIs using standard errors</span></span>
<span id="cb23-2"><a href="logistic-regression.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(fit.reduced)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept)    0.73463085  3.127029497
## age           -0.06928747 -0.001254761
## yearsmarried   0.04337199  0.157873491
## religiousness -0.50434371 -0.153703999
## rating        -0.63547499 -0.287247895</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="logistic-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 测试等级的总体效果。 在系数表中给出系数的顺序与模型中项的顺序相同</span></span>
<span id="cb25-2"><a href="logistic-regression.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Globale Test</span></span>
<span id="cb25-3"><a href="logistic-regression.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb25-4"><a href="logistic-regression.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(fit.reduced), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit.reduced), <span class="at">Terms =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 27.4, df = 4, P(&gt; X2) = 1.7e-05</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="logistic-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## the three terms for the levels of rank.</span></span>
<span id="cb27-2"><a href="logistic-regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(fit.reduced), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit.reduced), <span class="at">Terms =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 26.7, df = 3, P(&gt; X2) = 6.9e-06</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="logistic-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## likelihood ratio test</span></span>
<span id="cb29-2"><a href="logistic-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## An indicator to measure the degree of model fit. The test statistic is the residual deviation between the model with predictor variables and the zero model.</span></span>
<span id="cb29-3"><a href="logistic-regression.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## The degree of freedom of the chi-square distribution of the test statistic is equal to the degree of freedom difference between the current model and the zero model (that is, the number of predictors in the model)</span></span>
<span id="cb29-4"><a href="logistic-regression.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, null.deviance <span class="sc">-</span> deviance)            <span class="co"># 卡方值为41.46</span></span></code></pre></div>
<pre><code>## [1] 60.01915</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="logistic-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, df.null <span class="sc">-</span> df.residual)               <span class="co"># degrees of freedom </span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="logistic-regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, <span class="fu">pchisq</span>(null.deviance <span class="sc">-</span> deviance, </span>
<span id="cb33-2"><a href="logistic-regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a>     df.null <span class="sc">-</span> df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))       <span class="co"># the p-value</span></span></code></pre></div>
<pre><code>## [1] 2.874106e-12</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="logistic-regression.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## called a likelihood ratio test (the deviance residual is -2*log likelihood).</span></span>
<span id="cb35-2"><a href="logistic-regression.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(fit.reduced)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -307.6789 (df=5)</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="logistic-regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 探究每一个预测变量对结果概率的影响</span></span>
<span id="cb37-2"><a href="logistic-regression.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个虚拟数据集，设定 年龄、婚龄和宗教信仰为它们的均值，婚姻评分的范围为1~5。</span></span>
<span id="cb37-3"><a href="logistic-regression.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probability of extramariatal affair by marital ratings</span></span>
<span id="cb37-4"><a href="logistic-regression.html#cb37-4" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rating =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), </span>
<span id="cb37-5"><a href="logistic-regression.html#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>age), <span class="at">yearsmarried =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>yearsmarried), </span>
<span id="cb37-6"><a href="logistic-regression.html#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">religiousness =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>religiousness))</span>
<span id="cb37-7"><a href="logistic-regression.html#cb37-7" aria-hidden="true" tabindex="-1"></a>testdata<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.reduced, <span class="at">newdata =</span> testdata, </span>
<span id="cb37-8"><a href="logistic-regression.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb37-9"><a href="logistic-regression.html#cb37-9" aria-hidden="true" tabindex="-1"></a>testdata</span></code></pre></div>
<pre><code>##   rating      age yearsmarried religiousness      prob
## 1      1 32.48752     8.177696      3.116473 0.5302296
## 2      2 32.48752     8.177696      3.116473 0.4157377
## 3      3 32.48752     8.177696      3.116473 0.3096712
## 4      4 32.48752     8.177696      3.116473 0.2204547
## 5      5 32.48752     8.177696      3.116473 0.1513079</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="logistic-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probabilites of extramariatal affair by age</span></span>
<span id="cb39-2"><a href="logistic-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rating =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>rating), </span>
<span id="cb39-3"><a href="logistic-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">seq</span>(<span class="dv">17</span>, <span class="dv">57</span>, <span class="dv">10</span>), <span class="at">yearsmarried =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>yearsmarried), </span>
<span id="cb39-4"><a href="logistic-regression.html#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">religiousness =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>religiousness))</span>
<span id="cb39-5"><a href="logistic-regression.html#cb39-5" aria-hidden="true" tabindex="-1"></a>testdata<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.reduced, <span class="at">newdata =</span> testdata, </span>
<span id="cb39-6"><a href="logistic-regression.html#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb39-7"><a href="logistic-regression.html#cb39-7" aria-hidden="true" tabindex="-1"></a>testdata</span></code></pre></div>
<pre><code>##    rating age yearsmarried religiousness      prob
## 1 3.93178  17     8.177696      3.116473 0.3350834
## 2 3.93178  27     8.177696      3.116473 0.2615373
## 3 3.93178  37     8.177696      3.116473 0.1992953
## 4 3.93178  47     8.177696      3.116473 0.1488796
## 5 3.93178  57     8.177696      3.116473 0.1094738</code></pre>
</div>
<div id="sas-implementation-7" class="section level3" number="17.2.3">
<h3><span class="header-section-number">17.2.3</span> SAS Implementation</h3>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic serious;
RUN; </code></pre>
<blockquote>
<p>在MODEL语句中指定的一个选项是因变量之后的EVENT =‘1’。 LOGISTIC中的默认值是估计一个预测因变量最低值的模型。因此，如果我省略了EVENT =‘1’，则结果将是一个逻辑模型，预测因变量DEATH等于0的概率。EVENT=’1’选项将其反转，以便模型预测因变量等于1。</p>
</blockquote>
<blockquote>
<p>一种等效的（流行的）方法是使用选项DEATH （DESCENDING），它告诉LOGISTIC对DEATH的“较高”值进行建模，而不是对较低值进行建模。但是，较高而不是较低的值取决于所选的其他选项，因此明确建模哪个因变量值较为安全。如果您忘记了EVENT =’1’选项，则唯一的结果就是更改系数的符号。</p>
</blockquote>
<pre><code>*** For Multiplicative Terms in the MODEL Statement;

MODEL y = x|x|x;
MODEL y = x x*x x*x*x;</code></pre>
<p><strong>class</strong></p>
<blockquote>
<p>当CLASS变量作为解释变量包含在MODEL语句中时，LOGISTIC自动创建一组“设计变量”来表示CLASS变量的级别。当预测变量是指示变量（虚拟变量）时，例如仅具有0或1的值，则无需将其声明为CLASS变量。实际上，将指示符变量放在CLASS语句上可能会产生误导性的结果。这是因为CLASS语句可能会以意想不到的方式重新编码变量，正如我们将看到的那样。因此，CLASS语句应保留给具有两个以上类别的分类变量，或保留具有字符值（例如“是”和“否”）的二分变量。</p>
</blockquote>
<pre><code>PROC LOGISTIC DATA=penalty;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp ;
RUN;</code></pre>
<p>Change the default reference category (5 in this example) and hope it is the minimum value of CULP instead of the maximum value</p>
<p><code>CLASS culp / PARAM=REF DESCENDING;</code></p>
<p>Particular value, say 3</p>
<p><code>CLASS culp(REF='3') / PARAM=REF;</code></p>
<p><strong>Confidence Intervals</strong></p>
<ul>
<li>Wald CI: <code>CLPARM = WALD</code></li>
<li>Profile likelihood CI: Can produce better approximations, especially in smaller samples using <code>CLPARM = PL</code></li>
<li>Two confidence intervals:</li>
</ul>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / CLPARM=BOTH;
RUN;</code></pre>
<p><strong>Marginal effect</strong></p>
<p>For each variable, we obtain the predicted change in the probability of death penalty for each additional unit of the variable according to the predicted probability of the person.
Get them easily with PROC QLIM</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic serious;
RUN; 

PROC QLIM DATA=penalty;
 ENDOGENOUS death~DISCRETE(DIST=LOGISTIC);
 MODEL death = blackd whitvic serious;
 OUTPUT OUT=a MARGINAL;
PROC PRINT DATA=a(OBS=10);
 VAR meff_p2_blackd meff_p2_whitvic meff_p2_serious;
RUN; </code></pre>
</div>
<div id="multicollinearity" class="section level3" number="17.2.4">
<h3><span class="header-section-number">17.2.4</span> Multicollinearity</h3>
<p>当解释变量之间有很强的线性相关性时，就会发生多重共线性。基本要点是，如果两个或多个变量彼此高度相关，则很难很好地估计它们对某些因变量的不同影响。尽管多重共线性不会使系数产生偏差，但确实会使系数更加不稳定。标准误差可能会变得很大，并且看起来似乎单独具有较弱影响的变量实际上可能整体上具有相当强的影响。幸运的是，多重共线性的结果仅适用于共线性的那些变量。</p>
<p>当单个变量都不是重要变量，而整个变量集都很重要时，多重共线性很可能是罪魁祸首 When none of the individual variables is significant but the entire set is significant, multicollinearity is a likely culprit.</p>
<p><strong>How to diagnose multicollinearity</strong></p>
<ul>
<li>检查PROC CORR产生的相关矩阵可能会有所帮助，但还不够。没有一对变量之间具有高度相关性的数据是很有可能的，但是几个变量在一起可能是高度相互依存的。</li>
<li>PROC REG使用TOL，VIF和COLLINOINT选项可以产生更好的诊断结果。但是PROC LOGISTIC没有这些选项，
多重共线性是解释变量的属性，而不是因变量。因此，每当您怀疑logit模型中的多重共线性时，只需在PROC REG中估计等效模型并请求共线性选项即可</li>
</ul>
<pre><code>PROC REG DATA=penalty;
 MODEL death = blackd whitvic serious serious2 / TOL VIF;
RUN; </code></pre>
<p><span class="math display">\[
\begin{array}{|l|r|r|r|r|r|r|r|}
\hline \text { Variable } &amp; \text { DF } &amp; \text {Parameter} &amp; \text { Standard } &amp; \text { t Value } &amp; \text { Pr }&gt;\mid \text { |t| }&amp; \text { Tolerance }&amp; \text { Variance } \\
&amp; \text {   } &amp; \text {Estimate  } &amp; \text {Error  } &amp;  &amp; &amp; &amp; \text { Inflation } \\
\hline \text { Intercept } &amp; 1 &amp; -0.14164 &amp; 0.18229 &amp; -0.78 &amp; 0.4384 &amp; &amp; 0 \\
\hline \text { blackd } &amp; 1 &amp; 0.12093 &amp; 0.08242 &amp; 1.47 &amp; 0.1445 &amp; 0.85428 &amp; 1.17058 \\
\hline \text { whitvic } &amp; 1 &amp; 0.05739 &amp; 0.08451 &amp; 0.68 &amp; 0.4982 &amp; 0.84548 &amp; 1.18276 \\
\hline \text { serious } &amp; 1 &amp; 0.01924 &amp; 0.03165 &amp; 0.61 &amp; 0.5442 &amp; 0.14290 &amp; 6.99788 \\
\hline \text { serious2 } &amp; 1 &amp; 0.07044 &amp; 0.10759 &amp; 0.65 &amp; 0.5137 &amp; 0.14387 &amp; 6.95081 \\
\hline
\end{array}
\]</span>
在绝大多数情况下，这种诊断方法应该完全令人满意，但有时可能会漏掉严重的多重共线性（Davis等人，1986）。这是因为理想情况下，应通过最大似然算法中使用的权重矩阵来调整线性组合</p>
<p><strong>Weight matrix</strong></p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic serious serious2;
 OUTPUT OUT=a PRED=phat;
DATA b;
 SET a;
 w = phat*(1-phat);
PROC REG DATA=b;
 WEIGHT w;
 MODEL death = blackd whitvic serious1 serious2 / TOL VIF;
RUN; </code></pre>
<p>OUTPUT语句创建一个新的数据集，该数据集包含MODEL语句中的所有变量以及变量PHAT，该变量PHAT包含因变量的预测概率。然后，将这些预测值用于DATA步骤以构建权重变量W。最后，使用W作为权重变量执行加权最小二乘回归。对于这些数据，共线性诊断仅与显示的略有不同</p>
<p>可用于逻辑回归的解决方案范围与线性回归的解决方案范围几乎相同，例如删除变量，将变量组合到索引中以及测试关于变量集的假设。通常，没有一个潜在的解决办法是非常令人满意的。</p>
</div>
<div id="goodness-of-fit-statistics-pearson-deviance" class="section level3" number="17.2.5">
<h3><span class="header-section-number">17.2.5</span> Goodness-of-Fit Statistics Pearson deviance</h3>
<p>三种不同的“模型拟合统计量”：AIC，SC和-2 LogL。2 Log L的值越高，表示数据拟合越差。但是请记住，此统计信息的总体大小在很大程度上取决于观察值的数量。此外，对于适合的条件还没有绝对的标准，因此人们只能使用此统计信息来比较适合同一数据集的不同模型。-2 Log L的问题在于，协变量更多的模型仅靠偶然就趋于更好地拟合。其他两个拟合统计量通过惩罚具有更多协变量的模型来避免此问题。</p>
<ul>
<li>Akaike’s Information Criterion (AIC) <span class="math inline">\(A I C=-2 \log L+2 k\)</span></li>
<li>Schwarz Criterion (SC), also known as the Bayesian Information Criterion (BIC) <span class="math inline">\(S C=-2 \log L+k \log n\)</span></li>
</ul>
<p><strong>deviance</strong></p>
<p>deviance is a goodness-of-fit statistic for a statistical model; it is often used for statistical hypothesis testing. It is a generalization of the idea of using the sum of squares of residuals (RSS) in ordinary least squares to cases where model-fitting is achieved by maximum likelihood.</p>
<p><span class="math display">\[{\displaystyle D(y,{\hat {\mu }})=2{\Big (}\log {\big (}p(y\mid {\hat {\theta }}_{s}){\big )}-\log {\big (}p(y\mid {\hat {\theta }}_{0}){\big )}{\Big )}.\,}\]</span></p>
<p>LOGISTIC中的AGGREGATE和SCALE选项获得具有卡方分布的偏差, AGGREGATE选项告诉LOGISTIC汇总各个预测变量级别上的数据。 SCALE选项要求拟合优度统计信息，但是指定SCALE = NONE会告诉LOGISTIC不要针对过度分散调整拟合优度统计信息</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / AGGREGATE
SCALE=NONE;
RUN;</code></pre>
<p><strong>Saturated mode</strong></p>
<p>偏差将拟合模型与饱和模型进行了隐式对比。 我们可以使用以下程序拟合饱和模型：</p>
<pre><code>PROC LOGISTIC DATA=penalty;
    CLASS culp;
    MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp blackd*whitvic
    blackd*culp whitvic*culp blackd*whitvic*culp ;
RUN; 

*** The MODEL statement could also be abbreviated;
MODEL death(EVENT=&#39;1&#39;) = blackd|whitvic|culp;</code></pre>
</div>
<div id="hosmer-and-lemeshow-goodness-of-fit-test" class="section level3" number="17.2.6">
<h3><span class="header-section-number">17.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</h3>
<p>与偏差不同，皮尔逊（Pearson）的卡方在应用于个人级数据时没有卡方分布。 尽管SCALE和AGGREGATE选项通常很有用，但如果有很多解释变量，或者如果其中一些变量是按连续统来衡量的，那么它们就无济于事。 在这些情况下，轮廓将几乎与原始观测值一样多，并且通过汇总无法实现任何目的。 偏差和皮尔逊卡方均不会具有真实的卡方分布。 为了弥补这一缺陷，Hosmer和Lemeshow（2000）提出了一种已迅速得到广泛使用的测试。 可以使用MODEL语句中的LACKFIT选项在LOGISTIC中实现。 让我们将其应用于我们刚刚评估的模型。</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / LACKFIT;
RUN; </code></pre>
<p>Hosmer-Lemeshow（HL）统计信息的计算方法如下。基于估计的模型，将为所有观测值生成预测的概率。这些文件按大小排序，然后分成大约10个间隔。在每个时间间隔内，通过将预测的概率相加来获得预期的事件数。通过从间隔中的案例数中减去预期的事件数，可以得到预期的非事件数。通过常规的Pearson卡方统计，将这些预期频率与观察到的频率进行比较。自由度是间隔数减去2。高p值（如本例所示）表明拟合模型不能被拒绝，并得出结论：该模型拟合良好。也就是说，无法通过添加非线性和/或交互来显着改善它</p>
</div>
<div id="statistics-measuring-predictive-power-r2" class="section level3" number="17.2.7">
<h3><span class="header-section-number">17.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></h3>
<div id="generalized-r2" class="section level4" number="17.2.7.1">
<h4><span class="header-section-number">17.2.7.1</span> Generalized <span class="math inline">\(R^{2}\)</span></h4>
<p>which is the statistic reported by LOGISTIC under the heading “Testihg Global Null Hypothesis: BETA=0.” If we denote that statistic by <span class="math inline">\(L^{2}\)</span> and let <span class="math inline">\(n\)</span> be the sample size, the generalized <span class="math inline">\(R^{2}\)</span> is
<span class="math display">\[
R^{2}=1-\exp \left\{-\frac{L^{2}}{n}\right\}
\]</span>
将RSQ选项放在MODEL语句上, <span class="math inline">\(\mathrm{LOGISTIC}\)</span> 会为您完成。这是广义R2的原理。此公式可用于通过最大似然估 计的任何回归模型, 包括概率模型, 泊松回归模型和Cox回归模型。除了作为常规R2的泛化的吸引力之
外, 广义R2还具有以下几方面的作用:
- It’s based on the quantity being maximized, namely the log-likelihood. 基于最大化的数量, 即对数似然
- It’s invariant to grouping. You get the same <span class="math inline">\(\mathrm{R} 2\)</span> whether you’re working with grouped or individual-level data (as long as cases are only grouped together if they’re identical on all the independent variables). 分组不变。无论您使用分组数据还是个人数据, 您都将获得相同的R2
- It’s readily obtained with virtually all computer programs because the loglikelihood is nearly always
reported by default.
几乎所有计算机程序都可以轻松获得它, 因为默认情况下几乎总是报告对数可能性
- It never diminishes when you add variables to a model. 当您向模型添加变量时, 它永远不会减少。
- The calculated values are usually quite similar to the <span class="math inline">\(\mathrm{R} 2\)</span> obtained from fitting a linear probability model to dichotomous data by ordinary least squares. 计算得出的值通常与通过普通最小二乘法将线性概率模型拟合为二分数据所获得的R2十分相似。</p>
<p>尽管广义R2的行为可能与线性模型R2非常相似，但不能将其解释为自变量“解释”的方差比例。广义R2的一 个可能的缺点是它的上限小于1，因为因变量是离散的。为了解决这个问题, LOGISTIC还报告了一个标有“ Max-rescaled Rsquare"的字样, 它将原始R2除以上限 (Nagelkerke 1991) 。</p>
</div>
<div id="mcfadden-r2" class="section level4" number="17.2.7.2">
<h4><span class="header-section-number">17.2.7.2</span> McFadden <span class="math inline">\(R^{2}\)</span></h4>
<p>McFadden的 <span class="math inline">\(R^{2}\)</span> 也是基于对数似然法, 但公式有些不同。 <span class="math inline">\(L^{2}\)</span> 为检验所有系数均为0的零假设的似然比卡
方, <span class="math inline">\(\ell_{0}\)</span> 为无协变量模型的对数似然。
<span class="math display">\[
R_{M c F}^{2}=\frac{L^{2}}{-2 \log \ell_{0}}
\]</span>
与广义R2不同, McFadden的 <span class="math inline">\(R^{2}\)</span> 的上限不小于1。McFadden <span class="math inline">\(R^{2}\)</span> 和广义 <span class="math inline">\(R^{2}\)</span> 均基于最大化的数量, 即对 数似然。因此，可以将ML视为一种选择系数以使R2最大化的方法, 至少如这些措施所定义的那样。可以将 其视为一件好事，但是如果您想比较逻辑回归模型和其他不基于似然函数的方法 (例如神经网络模型) 的 预测能力，则不是一件好事。</p>
</div>
<div id="tjurs-r2" class="section level4" number="17.2.7.3">
<h4><span class="header-section-number">17.2.7.3</span> Tjur’s <span class="math inline">\(R^{2}\)</span></h4>
<p>一种方法是使用Tjur (2009) 提出的“model free” <span class="math inline">\(R^{2}\)</span> 。这很容易计算, 并具有一些吸引人的特性。通过计 算 <span class="math inline">\(\mathrm{y}=1\)</span> 的观测值的预测值的平均值和 <span class="math inline">\(\mathrm{y}=\)</span> 0的观测值的预测值的平均值来找到Tjur的 <span class="math inline">\(R^{2}\)</span> 。 <span class="math inline">\(R^{2}\)</span> 只是这两个平 均值之间的差。Tjur的 <span class="math inline">\(R^{2}\)</span> 上限为1.</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=culp whitvic blackd;
 OUTPUT OUT=a PRED=yhat;
PROC MEANS;
 CLASS death;
 VAR yhat;
RUN; </code></pre>
<p><strong>Whenever you run binary (or ordinal) logistic regression, PROC LOGISTIC reports four such metrics by default.</strong></p>
<p><span class="math display">\[
\begin{array}{|l|c|l|l|}
\hline \text { Percent Concordant } &amp; 88.3 &amp; \text { Somers&#39; } \mathbf{D} &amp; 0.800 \\
\hline \text { Percent Discordant } &amp; 8.4 &amp; \text { Gamma } &amp; 0.827 \\
\hline \text { Percent Tied } &amp; 3.3 &amp; \text { Tau-a } &amp; 0.361 \\
\hline \text { Pairs } &amp; 4850 &amp; \mathrm{C} &amp; 0.900 \\
\hline
\end{array}
\]</span></p>
<p>对于样本中的147个观察值，有147（146）/ 2 = 10731种不同的方式将它们配对（不将观察值与自身配对）。 其中，5881对在因变量中要么都为1，要么都为0。 我们忽略了这些，留下了4850对，其中一个案例的值为1，另一案例的值为0。对于每个对，我们提出一个问题：“具有1的案例是否具有比模型更高的预测值（基于模型）？ 是0的情况？” 如果答案是肯定的，我们称该对为一致。 如果否，则该对不和谐。 如果两个案例的预测值相同，我们将其称为平局。 令C为一致对的数量，D为不一致对的数量，T为关系的数量，N为对的总数（在消除任何对之前）。 然后定义了四个关联度量：</p>
<blockquote>
<p>If the answer is yes, we call that pair concordant. If no, the pair is discordant. If the two cases have the same predicted value, we call it a tie. Let C be the number of concordant pairs, D the number of discordant pairs, T the number of ties, and N the total number of pairs (before eliminating any).</p>
</blockquote>
<p><span class="math display">\[
\begin{array}{c}
\text { Tau }-a=\frac{C-D}{N} \\
G a m m a=\frac{C-D}{C+D} \\
\text { Somer }^{\prime} s D=\frac{C-D}{C+D+T} \\
c=.5(1+\text { Somer&#39;s } D)
\end{array}
\]</span></p>
<p>所有这四个量度在0和1之间变化，较大的值对应于预测值和观察值之间的较强关联。 在这四个统计量中，Tau-a倾向于最接近广义R2。 另一方面，c统计量非常流行，因为它对应于ROC曲线下的面积，</p>
</div>
</div>
<div id="roc-curves" class="section level3" number="17.2.8">
<h3><span class="header-section-number">17.2.8</span> ROC Curves</h3>
<p>Another way to evaluate the predictive ability of a model for binary outcomes is the ROC curve. ROC is the abbreviation of Receiver Operating Characteristic. Let pi be the predicted probability of yi = 1 for individual i. If you want to use the predicted probability to generate an actual forecast for y = 1, you need some pointcut values. The natural choice is .5. If i pˆ≥.5, we predict yi =1. If i pˆ &lt;.5, we predict yi = 0. Then we can build the following classification table:</p>
<p><span class="math display">\[
\begin{array}{l|c|c|c} 
&amp; \hat{p}_{i} \geq .5 &amp; \hat{p}_{i}&lt;.5 &amp; \text { Total } \\
y_{i}=1 &amp; 35 &amp; 15 &amp; 50 \\
y_{i}=0 &amp; 10 &amp; 87 &amp; 97 \\
\hline
\end{array}
\]</span>
&gt; 敏感度是正确预测的事件的比例，在这种情况下为35/50 = .70。特异性是正确预测的非事件所占的比例，即87/97 = .90。理想的情况是这两个比例都很高。ROC曲线仅是一条图，在垂直轴上具有灵敏度，在水平轴上具有1减去特异性，两者都随着切点从1减小到0而增加。</p>
<pre><code>PROC LOGISTIC DATA=penalty PLOTS(ONLY)=ROC;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp ;
RUN;</code></pre>
<p>The 45-degree line represents the expected ROC curve of a model with only intercept (ie, no predictive power). The farther the curve is from the 45-degree line, the greater the predictive power. The standard statistic for summarizing deviations is the area under the curve</p>
<blockquote>
<p>45度线代表仅具有截距（即没有预测能力）的模型的预期ROC曲线。曲线与45度线的距离越远，预测能力就越大。汇总偏离的标准统计量是曲线下的面积</p>
</blockquote>
<p>ROC曲线有很多选择，一个方便的选项使您可以将切点放置在曲线上。 可以通过将PLOTS选项更改为PLOTS（ONLY）= ROC（ID = CUTPOINT）来实现，</p>
<div class="figure" style="text-align: center">
<img src="02_Plots/ROC_Logistic.png" alt="Figure: ROC PLOTS(ONLY)= ROC(ID = CUTPOINT)" width="100%" />
<p class="caption">
(#fig:ROC logistic)Figure: ROC PLOTS(ONLY)= ROC(ID = CUTPOINT)
</p>
</div>
<p>Compare the ROC curve and c statistics of different models. In the following code, I request the ROC curve and c statistics of the basic model and three different sub-models</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp;
 ROC &#39;omit culp&#39; blackd whitvic;
 ROC &#39;omit blackd&#39; whitvic culp;
 ROC &#39;omit whitvic&#39; blackd culp;
 ROCCONTRAST / ESTIMATE=ALLPAIRS;
RUN; </code></pre>
</div>
<div id="predicted-values-residuals-and-influence-statistics" class="section level3" number="17.2.9">
<h3><span class="header-section-number">17.2.9</span> Predicted Values, Residuals, and Influence Statistics</h3>
<p>PROC LOGISTIC can use the OUTPUT statement to generate a large number of case statistics, which writes the selected diagnostic statistics into the SAS data set. Here are some statistics that can be selected:</p>
<ul>
<li>Linear predictor- Predicted log-odds for each case. In matrix notation, this is <span class="math inline">\(\mathbf{x} \boldsymbol{\beta}\)</span>, so it’s commonly
referred to as XBETA.</li>
<li>Standard error of linear predictor-Used in generating confidence intervals.</li>
<li>Predicted values-Predicted probability of the event, based on the estimated model and values of the explanatory variables. For grouped data, this is the expected number of events.</li>
<li>Confidence intervals for predicted values -Confidence intervals are first calculated for the linear predictor by adding and subtracting an appropriate multiple of the standard error. Then, to get confidence intervals around the predicted values, the upper and lower bounds on the linear predictor
are substituted into <span class="math inline">\(1 /\left(1+e^{-x}\right)\)</span>, where <span class="math inline">\(x\)</span> is either an upper or a lower bound.</li>
<li>Deviance residuals - Contribution of each observation to the deviance chi-square.</li>
<li>Pearson residuals - Contribution of each observation to the Pearson chi-square.</li>
</ul>
<blockquote>
<p>OUTPUT语句还可以产生多个统计数据, 这些统计数据旨在测量每个观察结果的影响。基本上，影响力统计 信息会告诉您, 当从数据集中删除特定观察值时，模型的某些功能会发生多少变化。对于用PROC REG估计 的线性模型，影响统计是准确的。但是，逻辑模型中的精确计算将非常耗时, 因此仅使用近似值。 LOGISTIC中可用的影响力统计数据为</p>
</blockquote>
<ul>
<li>DFBETAS-删除特定观察值时每个回归系数有多少变化,实际变化除以系数的标准误差。</li>
<li>DIFDEV-实际变化除以系数的标准误差。</li>
<li>DIFCHISQ一删除观察值后皮尔逊卡方的变化</li>
<li><span class="math inline">\(\mathrm{C}\)</span> and <span class="math inline">\(\mathrm{CBAR}\)</span> 度量回归系数的总体变化, 类似于线性回归中的库克距离</li>
<li>LEVERAGE-测量在解释变量空间中观察值的极端程度。杜杆作用是“帽子”矩阵的对角线。</li>
</ul>
<blockquote>
<p>可以通过在OUTPUT语句上指定适当的选项来获取任何这些统计信息。但是您可能会发现，使用PROC语句 上的PLOTS选项来请求ODS图形更有用。此选项产生的许多图具有三个变体, 根据水平轴上绘制的变量而 有所不同。对于INFLUENCE和DFBETAS图, 水平轴仅是案例编号。对于PHAT和DPC图, 水平轴是预测的 概率。 对于LEVERAGE, 水平轴是杜杆。</p>
</blockquote>
<p>Here is the <a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_logistic_examples06.htm">example</a></p>
<pre><code>PROC LOGISTIC DATA=penalty PLOTS(UNPACK LABEL)=
 (INFLUENCE DFBETAS PHAT DPC LEVERAGE);
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp ;
RUN; </code></pre>
</div>
<div id="unobserved-heterogeneity" class="section level3" number="17.2.10">
<h3><span class="header-section-number">17.2.10</span> Unobserved Heterogeneity</h3>
<p>σ is the coefficient disturbance term ε. The random disturbance term can be regarded as representing all omitted explanatory variables that have nothing to do with the measured x variable, usually referred to as unobserved heterogeneity</p>
<p><span class="math display">\[\log \left[\frac{\operatorname{Pr}(y=1 \mid \varepsilon)}{\operatorname{Pr}(y=0 \mid \varepsilon)}\right]=\beta_{0}+\beta_{1} x_{1}+\beta_{2} x_{2}+\ldots+\beta_{k} x_{k}+\sigma \varepsilon\]</span>
We assume that ε has nothing to do with x and has a standard logarithmic distribution, (Allison 1987) the result is approximately</p>
<p><span class="math display">\[\log \left[\frac{\operatorname{Pr}(y=1)}{\operatorname{Pr}(y=0)}\right]=\beta_{0}^{*}+\beta_{1}^{*} x_{1}+\beta_{2}^{*} x_{2}+\ldots+\beta_{k}^{*} x_{k}\]</span>
<span class="math display">\[\beta_{i}^{*}=\frac{\beta_{j}}{\sqrt{1+\sigma^{2}}}\]</span></p>
<blockquote>
<p>显然，我们永远无法测量并包含影响因变量的所有变量，因此总会有一些异质性缩小。有什么实际意义
首先，在解释逻辑回归的结果时，我们应记住，系数的大小和相应的优势比可能在某种程度上是保守的。
其次，为了使收缩最小化，总是希望在模型中包括重要的解释变量，即使我们认为这些变量与模型中已经存在的变量不相关。该建议尤其适用于随机实验，在随机实验中，有忽略协变量的趋势，而仅关注治疗对反应的影响。对于线性模型可能没关系，但是当包括所有相关的协变量时，logit模型可得出对治疗效果的出色估计。
第三，差分异质性可能会混淆不同组之间的logit系数比较。例如，如果要比较分别针对男性和女性估算的对数系数，则必须隐含地假设两组中未观察到的异质性程度相同。</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>First, in interpreting the results of a logistic regression, we should keep in mind that the magnitudes of the coefficients and the corresponding odds ratios are likely to be conservative to some degree.</li>
<li>Second, to keep such shrinkage to a minimum, it’s always desirable to include important explanatory variables in the model—even if we think those variables are not correlated with the variables already in the model. This advice is especially relevant to randomized experiments where there is a tendency to ignore covariates and look only at the effect of the treatment on the response. That may be okay for linear models, but logit models yield superior estimates of the treatment effect when all relevant covariates are included.</li>
<li>A third problem is that differential heterogeneity can confound comparisons of logit coefficients across different groups. If, for example, you want to compare logit coefficients estimated separately for men and women, you must implicitly assume that the degree of unobserved heterogeneity is the same in both groups.</li>
</ol>
<p><strong>Adjusting for differential heterogeneity using HETERO in Proc QLIM</strong></p>
<pre><code>PROC QLIM DATA=promo;
 ENDOGENOUS promo~DISCRETE(DIST=LOGISTIC);
 MODEL promo = female dur dur*dur select arts prestige
arts*female;
 HETERO promo~female / NOCONST;
run; 

####################################################
Parameter DF   Estimate   StandardError    t Value   Approx Pr &gt; |t|
_H.FEMALE 1    0.354838   0.325341         1.09      0.2754

我们也没有太多证据显示性别差异异质性：FEMALE对σ的影响的p值为.28。
尽管与0没有显着差异，但可以通过计算exp（.354838）= 1.43来解释该影响的大小。 
因此，我们说女性的差异估计比男性的差异高43％。</code></pre>
</div>
<div id="plotting-effects-of-predictor-variables" class="section level3" number="17.2.11">
<h3><span class="header-section-number">17.2.11</span> Plotting Effects of Predictor Variables</h3>
<blockquote>
<p>由于逻辑回归模型具有固有的非线性，因此通常很难直观地看到预测变量对事件概率的影响。 EFFECTPLOT语句为该问题提供了一种优雅的解决方案。 在检查交互作用和多项式函数时特别有用。</p>
</blockquote>
<blockquote>
<p>EFFECTPLOT语句要求根据ARTS（已发表文章的数量）绘制促销的预测概率图，同时将所有其他变量设置为其平均值。 如果模型中有任何CLASS变量，则将它们设置为参考级别。水平轴包括ARTS观测值的整个范围。 如果将选项/ LINK放在EFFECTPLOT语句上，则会得到在垂直轴上带有线性预测变量（几率的对数）的图形，在这种情况下，该线性预测变量将是一条直线。 水平轴上0和1处的小圆圈代表因变量在预测变量的不同值处的实际值。 在这种情况下，一个圆圈可以代表许多数据点</p>
</blockquote>
<pre><code>## 从不包含相互作用或多项式函数的模型开始
PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts;
 EFFECTPLOT FIT(X=arts);
run; 

PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts arts*arts;
 EFFECTPLOT FIT(X=arts);
run;

## SLICEFIT option to produce curves for men and women: 
PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts prestige
arts*female ;
 EFFECTPLOT SLICEFIT(X=arts SLICEBY=female=0 1);
run;</code></pre>
</div>
</div>
<div id="probit-modell" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> Probit Modell</h2>
<div id="introduction-11" class="section level3" number="17.3.1">
<h3><span class="header-section-number">17.3.1</span> Introduction</h3>
<p>The latent variable model we examined in the last section should help to motivate these models. The equation for the continuous latent variable z was
<span class="math display">\[z=\alpha_{0}+\alpha_{1} x_{1}+\alpha_{2} x_{2}+\ldots+\alpha_{k} x_{k}+\sigma \varepsilon\]</span>
* 如果ε具有标准的logistic分布，则y对x的依赖性由logit模型给出。
* 现在假设ε具有标准正态分布。这意味着y通过概率模型依赖于x。
* 如果ε具有标准的极值分布（也称为Gumbel或双指数分布），我们将获得互补的log-log模型。</p>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Probit-Modell:
<span class="math display">\[\pi=\Phi(\eta) \Longleftrightarrow \Phi^{-1}(\pi)=\eta\]</span>
<span class="math display">\[\pi=\Phi(\eta)=\Phi\left(\boldsymbol{x}^{\prime} \boldsymbol{\beta}\right)\]</span>
So the probit model is often written as
<span class="math display">\[\Phi^{-1}\left(p_{i}\right)=\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span></p>
</div>
<div id="r-implemetation" class="section level3" number="17.3.2">
<h3><span class="header-section-number">17.3.2</span> R Implemetation</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="logistic-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./01_Datasets/binary.csv&quot;</span>)</span>
<span id="cb57-2"><a href="logistic-regression.html#cb57-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>rank)</span>
<span id="cb57-3"><a href="logistic-regression.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>rank <span class="sc">+</span> admit, <span class="at">data =</span> mydata)</span></code></pre></div>
<pre><code>##     admit
## rank  0  1
##    1 28 33
##    2 97 54
##    3 93 28
##    4 55 12</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="logistic-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a>myprobit <span class="ot">&lt;-</span> <span class="fu">glm</span>(admit <span class="sc">~</span> gre <span class="sc">+</span> gpa <span class="sc">+</span> rank, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb59-2"><a href="logistic-regression.html#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mydata)</span>
<span id="cb59-3"><a href="logistic-regression.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myprobit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = admit ~ gre + gpa + rank, family = binomial(link = &quot;probit&quot;), 
##     data = mydata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6163  -0.8710  -0.6389   1.1560   2.1035  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.386836   0.673946  -3.542 0.000398 ***
## gre          0.001376   0.000650   2.116 0.034329 *  
## gpa          0.477730   0.197197   2.423 0.015410 *  
## rank2       -0.415399   0.194977  -2.131 0.033130 *  
## rank3       -0.812138   0.208358  -3.898 9.71e-05 ***
## rank4       -0.935899   0.245272  -3.816 0.000136 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 499.98  on 399  degrees of freedom
## Residual deviance: 458.41  on 394  degrees of freedom
## AIC: 470.41
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="logistic-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(myprobit)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept) -3.7201050682 -1.076327713
## gre          0.0001104101  0.002655157
## gpa          0.0960654793  0.862610221
## rank2       -0.7992113929 -0.032995019
## rank3       -1.2230955861 -0.405008112
## rank4       -1.4234218227 -0.459538829</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="logistic-regression.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Wald test</span></span>
<span id="cb63-2"><a href="logistic-regression.html#cb63-2" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb63-3"><a href="logistic-regression.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(myprobit), <span class="at">Sigma =</span> <span class="fu">vcov</span>(myprobit), <span class="at">L =</span> l)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 5.6, df = 1, P(&gt; X2) = 0.018</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="logistic-regression.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(myprobit), <span class="at">Sigma =</span> <span class="fu">vcov</span>(myprobit), <span class="at">Terms =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 21.4, df = 3, P(&gt; X2) = 8.9e-05</code></pre>
</div>
<div id="sas-implementation-8" class="section level3" number="17.3.3">
<h3><span class="header-section-number">17.3.3</span> SAS Implementation</h3>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = culp blackd whitvic / LINK=PROBIT
 STB;
RUN; </code></pre>
<p>For logit and probit models, the chi-square, p-value, and standardized coefficient are usually very close, although they will never be exactly the same. On the other hand, compared with the logit model, the <strong>parameter estimates and standard errors</strong> of the probit model are much lower.</p>
</div>
</div>
<div id="complementary-log-log-modell" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> Complementary log-log-Modell</h2>
<p>The complementary log-log model has important applications in the field of <strong>survival analysis</strong>.</p>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Complementary log-log model:
<span class="math display">\[\pi=1-\exp (-\exp (\eta)) \quad \Longleftrightarrow \quad \log (-\log (1-\pi))=\eta\]</span>
<span class="math display">\[\log \left[-\log \left(1-p_{i}\right)\right]=\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
<span class="math display">\[p_{i}=1-\exp \left\{-\exp \left[\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right]\right\}\]</span></p>
<ul>
<li>互补对数对数模型与logit和probit模型有一个主要区别。logit和probit变换在p = .50附近是对称的，但互补的log-log变换是不对称的。它是一条S形曲线，但逼近1的速度比逼近0的速度快得多。</li>
<li>生存分析中最流行的方法是Cox回归方法，该方法基于一种称为比例风险模型的模型（Cox 1972）。 该模型的特殊情况包括Weibull回归模型和指数回归模型。 比例风险模型可以写成
<span class="math display">\[\log h(t)=\alpha(t)+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
where <span class="math inline">\(h(t)\)</span> is something called the hazard of an event at time <span class="math inline">\(t\)</span> and <span class="math inline">\(\alpha(t)\)</span> is an unspecified function of time.</li>
</ul>
<div id="r-implemetation-1" class="section level3" number="17.4.1">
<h3><span class="header-section-number">17.4.1</span> R Implemetation</h3>
</div>
</div>
<div id="multi-category-logit-model" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> Multi-category logit model</h2>
<div id="multinomialverteilung" class="section level3" number="17.5.1">
<h3><span class="header-section-number">17.5.1</span> Multinomialverteilung</h3>
<p><span class="math display">\[
f(\boldsymbol{y} \mid \boldsymbol{\pi})=\pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{q}^{y_{q}}\left(1-\pi_{1}-\ldots-\pi_{q}\right)^{1-y_{1}-\ldots-y_{q}}
\]</span>
given in generalization of the Bernoulli distribution. For m independent repetitions, in generalization to the binomial distribution,<span class="math inline">\(y r, r=1, \ldots, c\)</span> now the number of repetitions in which the category r occurred. Then <span class="math inline">\(\boldsymbol{y}=\left(y 1, \ldots, y_{q}\right)^{\prime}\)</span> has the probability function
<span class="math display">\[
\begin{aligned}
f(\boldsymbol{y} \mid \boldsymbol{\pi}) &amp;=\frac{m !}{y_{1} ! \cdot \ldots \cdot y_{q} !\left(m-y_{1}-\ldots-y_{q}\right) !} \pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{q}^{y_{q}}\left(1-\pi_{1}-\ldots-\pi_{q}\right)^{1-y_{1}-\ldots-y_{q}} \\
&amp;=\frac{m !}{y_{1} ! \cdot \ldots \cdot y_{c} !} \pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{c}^{y_{c}}
\end{aligned}
\]</span>
a multinomial distribution, in short
<span class="math display">\[
\boldsymbol{y} \sim M(m, \boldsymbol{\pi})
\]</span>
mit den Parametern <span class="math inline">\(\mathrm{m}\)</span> und <span class="math inline">\(\boldsymbol{\pi}=(\pi 1, \ldots, \pi q)^{\prime}\)</span>. Für die ersten beiden Momente ergibt sich
<span class="math display">\[
\mathrm{E}(\boldsymbol{y})=m \boldsymbol{\pi}=\left(\begin{array}{c}
m \pi_{1} \\
\vdots \\
m \pi_{q}
\end{array}\right), \quad \operatorname{Cov}(\boldsymbol{y})=\left(\begin{array}{ccc}
m \pi_{1}\left(1-\pi_{1}\right) &amp; \cdots &amp; -\pi_{1} \pi_{q} \\
\vdots &amp; \ddots &amp; \vdots \\
-\pi_{q} \pi_{1} &amp; \cdots &amp; m \pi_{q}\left(1-\pi_{q}\right)
\end{array}\right)
\]</span>
### Mehrkategoriales Logit-Modell</p>
<p><span class="math display">\[\mathrm{P}\left(Y_{i}=r \mid \boldsymbol{x}_{i}\right)=\pi_{i r}=\frac{\exp \left(\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}_{r}\right)}{1+\sum_{s=1}^{q} \exp \left(\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}_{s}\right)} \quad r=1, \ldots, q\]</span>
<span class="math display">\[\log \frac{\pi_{i r}}{\pi_{i c}}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}_{r} \quad b z w \cdot \frac{\pi_{i r}}{\pi_{i c}}=\exp \left(\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}_{r}\right), \quad r=1, \ldots, c\]</span></p>
</div>
<div id="r-implementation-10" class="section level3" number="17.5.2">
<h3><span class="header-section-number">17.5.2</span> R Implementation</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="logistic-regression.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb68-2"><a href="logistic-regression.html#cb68-2" aria-hidden="true" tabindex="-1"></a>ml <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;./01_Datasets/hsbdemo.dta&quot;</span>)</span>
<span id="cb68-3"><a href="logistic-regression.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ml, <span class="fu">table</span>(ses, prog))</span></code></pre></div>
<pre><code>##         prog
## ses      general academic vocation
##   low         16       19       12
##   middle      20       44       31
##   high         9       42        7</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="logistic-regression.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ml, <span class="fu">do.call</span>(rbind, <span class="fu">tapply</span>(write, prog, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">M =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x)))))</span></code></pre></div>
<pre><code>##                 M       SD
## general  51.33333 9.397775
## academic 56.25714 7.943343
## vocation 46.76000 9.318754</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="logistic-regression.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Multinomial logistic regression</span></span>
<span id="cb72-2"><a href="logistic-regression.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb72-3"><a href="logistic-regression.html#cb72-3" aria-hidden="true" tabindex="-1"></a>ml<span class="sc">$</span>prog2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(ml<span class="sc">$</span>prog, <span class="at">ref =</span> <span class="st">&quot;academic&quot;</span>)</span>
<span id="cb72-4"><a href="logistic-regression.html#cb72-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">multinom</span>(prog2 <span class="sc">~</span> ses <span class="sc">+</span> write, <span class="at">data =</span> ml)</span></code></pre></div>
<pre><code>## # weights:  15 (8 variable)
## initial  value 219.722458 
## iter  10 value 179.982880
## final  value 179.981726 
## converged</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="logistic-regression.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test)</span></code></pre></div>
<pre><code>## Call:
## multinom(formula = prog2 ~ ses + write, data = ml)
## 
## Coefficients:
##          (Intercept)  sesmiddle    seshigh      write
## general     2.852198 -0.5332810 -1.1628226 -0.0579287
## vocation    5.218260  0.2913859 -0.9826649 -0.1136037
## 
## Std. Errors:
##          (Intercept) sesmiddle   seshigh      write
## general     1.166441 0.4437323 0.5142196 0.02141097
## vocation    1.163552 0.4763739 0.5955665 0.02221996
## 
## Residual Deviance: 359.9635 
## AIC: 375.9635</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="logistic-regression.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract the coefficients from the model and exponentiate</span></span>
<span id="cb76-2"><a href="logistic-regression.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(test))</span></code></pre></div>
<pre><code>##          (Intercept) sesmiddle   seshigh     write
## general     17.32582 0.5866769 0.3126026 0.9437172
## vocation   184.61262 1.3382809 0.3743123 0.8926116</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="logistic-regression.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## does not include the calculation of the p-value of the regression coefficient, so the Wald test (here z-test) is used to calculate the p-value</span></span>
<span id="cb78-2"><a href="logistic-regression.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 2-tailed z test</span></span>
<span id="cb78-3"><a href="logistic-regression.html#cb78-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">summary</span>(test)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(test)<span class="sc">$</span>standard.errors</span>
<span id="cb78-4"><a href="logistic-regression.html#cb78-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z), <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb78-5"><a href="logistic-regression.html#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="logistic-regression.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a fitting function to calculate the probability of each result level</span></span>
<span id="cb78-7"><a href="logistic-regression.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(test))</span></code></pre></div>
<pre><code>##    academic   general  vocation
## 1 0.1482764 0.3382454 0.5134781
## 2 0.1202017 0.1806283 0.6991700
## 3 0.4186747 0.2368082 0.3445171
## 4 0.1726885 0.3508384 0.4764731
## 5 0.1001231 0.1689374 0.7309395
## 6 0.3533566 0.2377976 0.4088458</code></pre>
<p><strong>Interpretation</strong></p>
<p><span class="math display">\[\begin{aligned} ln\left(\frac{P(prog=general)}{P(prog=academic)}\right) = b_{10} + b_{11}(ses=2) + b_{12}(ses=3) + b_{13}write\\ ln\left(\frac{P(prog=vocation)}{P(prog=academic)}\right) = b_{20} + b_{21}(ses=2) + b_{22}(ses=3) + b_{23}write \end{aligned}\]</span>
### SAS Implementation</p>
<p>The unordered multinomial model is invoked by the LINK=GLOGIT option. If this option is omitted, LOGISTIC estimates the cumulative logit, which assumes that the response levels are ordered.</p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
RUN; </code></pre>
<p>There are three types of wallet, (1) keep the wallet and the money, (2) keep the money and return the wallet, or (3) return both the wallet and the money. The default setting category 3 is the reference category. You can specify category 2 as the reference category</p>
<p><code>MODEL wallet(REF='2') = male business punish explain / LINK=GLOGIT;</code></p>
<p><strong>Test the null hypothesis using TEST</strong></p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
 TEST male_1=male_2, business_1=business_2,
 punish_1=punish_2, explain_1=explain_2;
RUN; </code></pre>
<p><strong>Goodness-of-fit statistics using the AGGREGATE and SCALE=NONE options</strong></p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT
 AGGREGATE SCALE=NONE;
 OUTPUT OUT=predicted PREDPROBS=I;
RUN; </code></pre>
<p>出现OUTPUT语句。它生成一个数据集（名为PREDICTED），其中包含在因变量的每个类别中的预测概率。 该数据集针对195个案例中的每个案例都有一个记录。 PREDPROBS = I选项要求生成三个新变量：IP_1是属于类别1的预测概率，IP_2是属于类别2的预测概率，IP_3是属于类别3的预测概率。 在每个配置文件中这些预测的概率，我们可以获得预期的频率。 我们可以使用PROC TABULATE完成</p>
<pre><code>PROC TABULATE DATA=predicted;
 CLASS male business punish explain;
 var IP_1 IP_2 IP_3;
 TABLE male*business*punish*explain, IP_1 IP_2 IP_3;
RUN; </code></pre>
<div class="figure" style="text-align: center">
<img src="02_Plots/Logistic_AGGREGATE.png" alt="Figure: Goodness-of-fit statistics" width="100%" />
<p class="caption">
(#fig:Logistic AGGREGATE)Figure: Goodness-of-fit statistics
</p>
</div>
<p><strong>Visualizing the effect of a variable</strong></p>
<p>NOLIMITS option suppresses the 95% confidence bands around the plots</p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
 EFFECTPLOT FIT(X=punish) / NOOBS NOLIMITS GRIDSIZE=3;
RUN; </code></pre>
</div>
</div>
<div id="ordinal-cumulative-logit-model" class="section level2" number="17.6">
<h2><span class="header-section-number">17.6</span> Ordinal Cumulative Logit Model</h2>
<p>Cumulative odds logit models are also called proportional odds model or ordinal logit model (Scott et al, 1997), The odds of being less than or equal a particular category can be defined as <span class="math inline">\(\frac{P(Y \le j)}{P(Y&gt;j)}\)</span>
<span class="math display">\[log \frac{P(Y \le j)}{P(Y&gt;j)} = logit (P(Y \le j)).\]</span>
<span class="math display">\[logit (P(Y \le j)) = \beta_{j0} – \eta_{1}x_1 – \cdots – \eta_{p} x_p.\]</span>
<strong>Proportional odds assumption</strong></p>
<p>The proportional odds assumption is that the number added to each of these logarithms to get the next is the same in every case. In other words, these logarithms form an arithmetic sequence.[2] The model states that the number in the last column of the table—the number of times that that logarithm must be added—is some linear combination of the other observed variables.</p>
<p>Ordinal logistic regression assumes that the coefficients that describe the relationship between the lowest versus all higher categories of the response variable</p>
<div id="r-implementation-11" class="section level3" number="17.6.1">
<h3><span class="header-section-number">17.6.1</span> R Implementation</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="logistic-regression.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(foreign)</span>
<span id="cb85-2"><a href="logistic-regression.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb85-3"><a href="logistic-regression.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb85-4"><a href="logistic-regression.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Hmisc)</span>
<span id="cb85-5"><a href="logistic-regression.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(reshape2)</span>
<span id="cb85-6"><a href="logistic-regression.html#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="logistic-regression.html#cb85-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;./01_Datasets/ologit.dta&quot;</span>)</span>
<span id="cb85-8"><a href="logistic-regression.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="do">## three way cross tabs (xtabs) and flatten the table</span></span>
<span id="cb85-9"><a href="logistic-regression.html#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> public <span class="sc">+</span> apply <span class="sc">+</span> pared, <span class="at">data =</span> dat))</span></code></pre></div>
<pre><code>##                        pared   0   1
## public apply                        
## 0      unlikely              175  14
##        somewhat likely        98  26
##        very likely            20  10
## 1      unlikely               25   6
##        somewhat likely        12   4
##        very likely             7   3</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="logistic-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 检查每个申请级别的gpa分布</span></span>
<span id="cb87-2"><a href="logistic-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> apply, <span class="at">y =</span> gpa)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="logistic-regression.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="logistic-regression.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="logistic-regression.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(pared <span class="sc">~</span> public, <span class="at">margins =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb87-6"><a href="logistic-regression.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb87-7"><a href="logistic-regression.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Cumulative%20Logit%20Model-1.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="logistic-regression.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fit ordered logit model and store results &#39;m&#39;</span></span>
<span id="cb88-2"><a href="logistic-regression.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="do">## proportional odds logistic regression,</span></span>
<span id="cb88-3"><a href="logistic-regression.html#cb88-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(apply <span class="sc">~</span> pared <span class="sc">+</span> public <span class="sc">+</span> gpa, <span class="at">data =</span> dat, </span>
<span id="cb88-4"><a href="logistic-regression.html#cb88-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb88-5"><a href="logistic-regression.html#cb88-5" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Hess = TRUE，以使模型从优化中返回观察到的信息矩阵（称为Hessian）</span></span>
<span id="cb88-6"><a href="logistic-regression.html#cb88-6" aria-hidden="true" tabindex="-1"></a>          <span class="do">## 该矩阵用于获取标准误差</span></span>
<span id="cb88-7"><a href="logistic-regression.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## Call:
## polr(formula = apply ~ pared + public + gpa, data = dat, Hess = TRUE)
## 
## Coefficients:
##           Value Std. Error t value
## pared   1.04769     0.2658  3.9418
## public -0.05879     0.2979 -0.1974
## gpa     0.61594     0.2606  2.3632
## 
## Intercepts:
##                             Value   Std. Error t value
## unlikely|somewhat likely     2.2039  0.7795     2.8272
## somewhat likely|very likely  4.2994  0.8043     5.3453
## 
## Residual Deviance: 717.0249 
## AIC: 727.0249</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="logistic-regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store p values</span></span>
<span id="cb90-2"><a href="logistic-regression.html#cb90-2" aria-hidden="true" tabindex="-1"></a>ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m))</span>
<span id="cb90-3"><a href="logistic-regression.html#cb90-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ctable[, <span class="st">&quot;t value&quot;</span>]), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb90-4"><a href="logistic-regression.html#cb90-4" aria-hidden="true" tabindex="-1"></a>ctable <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ctable, <span class="st">&quot;p value&quot;</span> <span class="ot">=</span> p)    <span class="do">## combined table</span></span>
<span id="cb90-5"><a href="logistic-regression.html#cb90-5" aria-hidden="true" tabindex="-1"></a>ctable</span></code></pre></div>
<pre><code>##                                   Value Std. Error    t value      p value
## pared                        1.04769010  0.2657894  3.9418050 8.087072e-05
## public                      -0.05878572  0.2978614 -0.1973593 8.435464e-01
## gpa                          0.61594057  0.2606340  2.3632399 1.811594e-02
## unlikely|somewhat likely     2.20391473  0.7795455  2.8271792 4.696004e-03
## somewhat likely|very likely  4.29936315  0.8043267  5.3452947 9.027008e-08</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="logistic-regression.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## KI und odds ratios</span></span>
<span id="cb92-2"><a href="logistic-regression.html#cb92-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m)                          <span class="do">## default method gives profiled CIs</span></span>
<span id="cb92-3"><a href="logistic-regression.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(m)                        <span class="do">## CIs assuming normality</span></span></code></pre></div>
<pre><code>##             2.5 %    97.5 %
## pared   0.5267524 1.5686278
## public -0.6425833 0.5250119
## gpa     0.1051074 1.1267737</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="logistic-regression.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m))                              </span></code></pre></div>
<pre><code>##     pared    public       gpa 
## 2.8510579 0.9429088 1.8513972</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="logistic-regression.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(m), ci))  </span></code></pre></div>
<pre><code>##               OR     2.5 %   97.5 %
## pared  2.8510579 1.6958376 4.817114
## public 0.9429088 0.5208954 1.680579
## gpa    1.8513972 1.1136247 3.098490</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="logistic-regression.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict and marginal effects</span></span>
<span id="cb98-2"><a href="logistic-regression.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="do">## predicted probabilities</span></span>
<span id="cb98-3"><a href="logistic-regression.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Use &quot;probs&quot; for predicted probabilities</span></span>
<span id="cb98-4"><a href="logistic-regression.html#cb98-4" aria-hidden="true" tabindex="-1"></a>m1.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">type=</span><span class="st">&quot;probs&quot;</span>) </span>
<span id="cb98-5"><a href="logistic-regression.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.pred)</span></code></pre></div>
<pre><code>##     unlikely      somewhat likely   very likely     
##  Min.   :0.2294   Min.   :0.2205   Min.   :0.04192  
##  1st Qu.:0.5220   1st Qu.:0.3053   1st Qu.:0.06839  
##  Median :0.5806   Median :0.3378   Median :0.08160  
##  Mean   :0.5498   Mean   :0.3498   Mean   :0.10040  
##  3rd Qu.:0.6263   3rd Qu.:0.3767   3rd Qu.:0.10123  
##  Max.   :0.7376   Max.   :0.4807   Max.   :0.29242</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="logistic-regression.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## marginal effects</span></span>
<span id="cb100-2"><a href="logistic-regression.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(erer)</span>
<span id="cb100-3"><a href="logistic-regression.html#cb100-3" aria-hidden="true" tabindex="-1"></a>m.marginal <span class="ot">&lt;-</span> <span class="fu">ocME</span>(m, <span class="at">rev.dum   =</span><span class="cn">TRUE</span>)</span>
<span id="cb100-4"><a href="logistic-regression.html#cb100-4" aria-hidden="true" tabindex="-1"></a>m.marginal</span></code></pre></div>
<pre><code>##        effect.unlikely effect.somewhat likely effect.very likely
## pared           -0.255                  0.137              0.117
## public           0.015                 -0.010             -0.005
## gpa             -0.152                  0.101              0.051</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="logistic-regression.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## want t and p-values</span></span>
<span id="cb102-2"><a href="logistic-regression.html#cb102-2" aria-hidden="true" tabindex="-1"></a>m.marginal<span class="sc">$</span>out</span></code></pre></div>
<pre><code>## $ME.unlikely
##        effect error t.value p.value
## pared  -0.255 0.060  -4.237   0.000
## public  0.015 0.073   0.198   0.843
## gpa    -0.152 0.064  -2.364   0.019
## 
## $`ME.somewhat likely`
##        effect error t.value p.value
## pared   0.137 0.029   4.820   0.000
## public -0.010 0.049  -0.196   0.844
## gpa     0.101 0.044   2.305   0.022
## 
## $`ME.very likely`
##        effect error t.value p.value
## pared   0.117 0.039   3.025   0.003
## public -0.005 0.024  -0.201   0.841
## gpa     0.051 0.022   2.301   0.022
## 
## $ME.all
##        effect.unlikely effect.somewhat likely effect.very likely
## pared           -0.255                  0.137              0.117
## public           0.015                 -0.010             -0.005
## gpa             -0.152                  0.101              0.051</code></pre>
</div>
<div id="sas-implementation-9" class="section level3" number="17.6.2">
<h3><span class="header-section-number">17.6.2</span> SAS Implementation</h3>
<p>cumulative logit model—also known as the ordered logit or ordinal logit model 是应用最广泛的方法，也是最容易在SAS中使用的模型(default)。</p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain;
RUN;</code></pre>
<p><strong>“Score Test for the Proportional Odds Assumption”</strong></p>
<p>This is the Chi-Square Score Test for the Proportional Odds Assumption. Since the ordered logit model estimates one equation over all levels of the dependent variable (as compared to the multinomial logit model, which models, assuming low ses is our referent level, an equation for medium ses versus low ses, and an equation for high ses versus low ses), the test for proportional odds tests whether our one-equation model is valid. If we were to reject the null hypothesis, we would conclude that ordered logit coefficients are not equal across the levels of the outcome and we would fit a less restrictive model (i.e., multinomial logit model). If we fail to reject the null hypothesis, we conclude that the assumption holds. For our model, the Proportional Odds Assumption appears to have held.</p>
</div>
</div>
<div id="adjacent-categories-model" class="section level2" number="17.7">
<h2><span class="header-section-number">17.7</span> Adjacent Categories Model</h2>
<p>排序类别数据的另一个通用模型是相邻类别模型。如前所述，我们将 <span class="math inline">\(p_{i j}\)</span> 设为个体 <span class="math inline">\(i\)</span> 进入因变量类别 <span class="math inline">\(j\)</span> 的 概率，并假设类别按序列 <span class="math inline">\(j=1, \ldots, J\)</span> 排序。现在取相邻的任何类别对，例如 <span class="math inline">\(j\)</span> 和 <span class="math inline">\(j+1\)</span> 。我们可 以根据解释变量来针对这两个类别之间的对比编写一个logit模型:
<span class="math display">\[
\begin{array}{c}
\log \left(\frac{p_{i, j+1}}{p_{i j}}\right)=\alpha_{j}+\boldsymbol{\beta}_{j} \mathbf{x}_{i} \quad j=1, \ldots, J-1 \\
\boldsymbol{\beta}_{j} \mathbf{x}_{i}=\beta_{j 1} x_{i 1}+\ldots+\beta_{j k} x_{i k}
\end{array}
\]</span>
为了获得有序数据的相邻类别模型，我们在这组方程上施加了约束。具体而言，我们假设所有的 <span class="math inline">\(\beta_{j}=\beta\)</span> for all <span class="math inline">\(j\)</span> 。换句话说, 不是每个相邻对都有一组不同的系数，而是只有一组。</p>
<p>尽管相邻类别模型是多项式logit模型的特例，但PROC LOGISTIC不允许施加适当的约束。如果可以将数 据分组到列联表中，则可以使用PROC CATMOD估计模型。但是，CATMOD使用加权最小二乘法而不是 最大似然法。</p>
<p>CATMOD没有FREQ语句，但是WEIGHT语句执行相同的功能。带有ALOGIT选项的RESPONSE语句为因变 量调用相邻类别的函数。将RESPONSE放在MODEL语句将通知CATMOD估计一组系数，而不是为每对类 别估计一组系数。默认情况下, CATMOD将所有预测变量视为CLASS变量。但是像LOGISTIC一样, CATMOD也使用“效果参数化”对这些变量进行编码。PARAM = REF选项将覆盖默认值以产生指示符变量编 码. 与LOGISTIC不同, CATMOD对模型进行参数化以预测响应变量的较高值而不是较低值。但是, 因为 MARRIED被视为CLASS变量，所以引用类别为1而不是0.</p>
<p>尽管累积对数模型和相邻类别模型在公式和解释上存在明显差异，但在实践中，这两种模型往往会得出非常相似的结论。我通常更喜欢累积模型，因为它具有吸引人的潜在变量解释能力，并且易于在软件中使用。但是相邻类别模型至少在原则上具有一个优势：容易制定对系数有选择性约束的模型</p>
<pre><code>PROC CATMOD DATA=happy;
 WEIGHT count;
 RESPONSE ALOGIT;
 MODEL happy = _RESPONSE_ married year / PARAM=REF;
RUN;</code></pre>
</div>
<div id="continuation-ratio-model" class="section level2" number="17.8">
<h2><span class="header-section-number">17.8</span> Continuation Ratio Model</h2>
<p>when the ordered categories represent a progression through stages, so that individuals must pass through each lower stage before they go on to higher stages.</p>
<blockquote>
<p>当排序的类别代表各个阶段的进展时，这是最合适的，这样个人就必须先经过每个较低的阶段，然后才能进入较高的阶段。 在那些情况下，延续比率模型比其他两个模型更具吸引力。</p>
</blockquote>
<p>Formalize the model for J categories on the dependent variable
将 <span class="math inline">\(A_{i j}\)</span> 定义为个人进入 <span class="math inline">\(j+1\)</span> 阶段的概率
<span class="math display">\[
\begin{array}{c}
A_{i j}=\operatorname{Pr}\left(y_{i}&gt;j \mid y_{i} \geq j\right) \\
\log \left(\frac{A_{i j}}{1-A_{i j}}\right)=\alpha_{j}+\boldsymbol{\beta} \mathbf{x}_{i} \quad j=1, \ldots, J-1
\end{array}
\]</span>
where <span class="math inline">\(\boldsymbol{\beta} \mathbf{x}_{i}=\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}\)</span>.
<span class="math display">\[
\log \left(\frac{A_{i j}}{1-A_{i j}}\right)=\log \left[\frac{\sum_{m=j+1}^{J} p_{i m}}{p_{i j}}\right]
\]</span></p>
<p>我们可以使用普通的二进制logit过程来估算这个模型。 诀窍在于构建数据集。对于每个阶段，您都将构建一个数据集，该数据集将所有未进入该阶段的个人排除在外，并使用一个虚拟因变量来指示该个人是否进入下一阶段。 现在，我们将这些数据集合并为一个单独的集合，而不是进行单独的分析，其中包括一个指示数据来自哪个阶段的变量。 最后，我们估计组合数据上的单个二进制logit模型。</p>
<p><span class="math display">\[
\begin{array}{lcc|ccc}
\hline &amp; &amp; \text { Father&#39;s } &amp; \text { Grammar } &amp; \text { Some High } &amp; \text { High School } \\
\text { Race } &amp; \text { Age } &amp; \text { Education* } &amp; \text { School } &amp; \text { School } &amp; \text { Graduate } \\
\hline \text { White } &amp; &lt;22 &amp; 1 &amp; 39 &amp; 29 &amp; 8 \\
&amp; &amp; 2 &amp; 4 &amp; 8 &amp; 1 \\
&amp; &amp; 3 &amp; 11 &amp; 9 &amp; 6 \\
&amp; &amp; 4 &amp; 48 &amp; 17 &amp; 8 \\
&amp; \geq 22 &amp; 1 &amp; 231 &amp; 115 &amp; 51 \\
&amp; &amp; 2 &amp; 17 &amp; 21 &amp; 13 \\
&amp; &amp; 3 &amp; 18 &amp; 28 &amp; 45 \\
&amp; &amp; 4 &amp; 197 &amp; 111 &amp; 35 \\
\text { Black } &amp; &lt;22 &amp; 1 &amp; 19 &amp; 40 &amp; 19 \\
&amp; &amp; 2 &amp; 5 &amp; 17 &amp; 7 \\
&amp; &amp; 3 &amp; 2 &amp; 14 &amp; 3 \\
&amp; \geq 22 &amp; 4 &amp; 49 &amp; 79 &amp; 24 \\
&amp; &amp; 1 &amp; 110 &amp; 133 &amp; 103 \\
&amp; &amp; 2 &amp; 18 &amp; 38 &amp; 25 \\
&amp; &amp; 3 &amp; 11 &amp; 25 &amp; 18 \\
&amp; &amp; 4 &amp; 178 &amp; 206 &amp; 81 \\
\hline
\end{array}
\]</span></p>
<pre><code>DATA afqt;
 INPUT white old faed ed count @@;
 DATALINES;
1 0 1 1 39
1 0 1 2 29
1 0 1 3 8
1 0 2 1 4
1 0 2 2 8
1 0 2 3 1
1 0 3 1 11
1 0 3 2 9
1 0 3 3 6
1 0 4 1 48
1 0 4 2 17
1 0 4 3 8
1 1 1 1 231
1 1 1 2 115
1 1 1 3 51
1 1 2 1 17
1 1 2 2 21
1 1 2 3 13
1 1 3 1 18
1 1 3 2 28
1 1 3 3 45
1 1 4 1 197
1 1 4 2 111
1 1 4 3 35
0 0 1 1 19
0 0 1 2 40
0 0 1 3 19
0 0 2 1 5
0 0 2 2 17
0 0 2 3 7
0 0 3 1 2
0 0 3 2 14
0 0 3 3 3
0 0 4 1 49
0 0 4 2 79
0 0 4 3 24
0 1 1 1 110
0 1 1 2 133
0 1 1 3 103
0 1 2 1 18
0 1 2 2 38
0 1 2 3 25
0 1 3 1 11
0 1 3 2 25
0 1 3 3 18
0 1 4 1 178
0 1 4 2 206
0 1 4 3 81
;

##  first stage
DATA first;
 SET afqt;
 stage=1;
 advance = ed GE 2;
RUN; 

## second stage
DATA second;
 SET afqt;
 stage=2;
 IF ed=1 THEN DELETE;
 advance = ed EQ 3;
RUN; 

## concatenated into a single set
DATA concat;
 SET first second;
RUN; 

## Alternatively
DATA combined;
 SET afqt;
 stage=1;
 advance = ed GE 2;
 OUTPUT;
 stage=2;
 IF ed=1 THEN DELETE;
 advance = ed EQ 3;
 OUTPUT;
RUN; 

## estimate the model with PROC LOGISTIC:
PROC LOGISTIC DATA=combined;
 FREQ count;
 CLASS faed / PARAM=REF;
 MODEL advance(EVENT=&#39;1&#39;)=stage white old faed / AGGREGATE
 SCALE=NONE;
RUN;</code></pre>
<p>关于延续比率方法，还有其他几点值得注意。</p>
<ul>
<li>首先，在合并的数据集中，同一个人可能会出现多次。对于教育示例，每个拥有高中的人都对合并后的数据集做出了两个观察。通常，由于多个观测值之间可能存在依赖关系，因此会产生危险信号。但是绝对没有依赖性的问题。对于每个人，将特定结果的概率计入一组条件概率，这些条件概率的结构与独立观察的结构相同。</li>
<li>其次，延续比率法与离散时间法用于生存分析密切相关。在这种情况下，目标是建模直到发生某个事件为止的时间长度，并以离散单位（例如年）为单位来测量时间。</li>
<li>第三，正如存在累积概率和累积互补对数-对数模型一样，人们可以使用概率或互补对数-对数函数轻松估计延续比率模型(probit or complementary log-log functions)。互补对数对数模型对于事件历史记录应用特别有吸引力，因为它是Cox回归中使用的比例风险模型的离散时间等效项</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/20-Logistic-Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
