<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Sample Size Calculation | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Sample Size Calculation | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Sample Size Calculation | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2021-06-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive-statistics-in-r.html"/>
<link rel="next" href="parametric-test.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="input-and-format.html"><a href="input-and-format.html"><i class="fa fa-check"></i><b>2</b> Input and Format</a>
<ul>
<li class="chapter" data-level="2.1" data-path="input-and-format.html"><a href="input-and-format.html#input-data-into-sas"><i class="fa fa-check"></i><b>2.1</b> Input data into SAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="input-and-format.html"><a href="input-and-format.html#reading-free-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.1</b> Reading free formatted data instream</a></li>
<li class="chapter" data-level="2.1.2" data-path="input-and-format.html"><a href="input-and-format.html#reading-fixed-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.2</b> Reading fixed formatted data instream</a></li>
<li class="chapter" data-level="2.1.3" data-path="input-and-format.html"><a href="input-and-format.html#infile-reading-fixed-formatted-data-from-an-external-file"><i class="fa fa-check"></i><b>2.1.3</b> INFILE: Reading fixed formatted data from an external file</a></li>
<li class="chapter" data-level="2.1.4" data-path="input-and-format.html"><a href="input-and-format.html#write-the-sas-file"><i class="fa fa-check"></i><b>2.1.4</b> Write the SAS File</a></li>
<li class="chapter" data-level="2.1.5" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data"><i class="fa fa-check"></i><b>2.1.5</b> Import csv data</a></li>
<li class="chapter" data-level="2.1.6" data-path="input-and-format.html"><a href="input-and-format.html#import"><i class="fa fa-check"></i><b>2.1.6</b> %Import</a></li>
<li class="chapter" data-level="2.1.7" data-path="input-and-format.html"><a href="input-and-format.html#infile-read-multiple-raw-data-files"><i class="fa fa-check"></i><b>2.1.7</b> Infile Read multiple raw data files</a></li>
<li class="chapter" data-level="2.1.8" data-path="input-and-format.html"><a href="input-and-format.html#generate-automatic-file-name"><i class="fa fa-check"></i><b>2.1.8</b> Generate automatic file name</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="input-and-format.html"><a href="input-and-format.html#input-and-import-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Input and import data in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data-1"><i class="fa fa-check"></i><b>2.2.1</b> Import csv data</a></li>
<li class="chapter" data-level="2.2.2" data-path="input-and-format.html"><a href="input-and-format.html#import-txt-data"><i class="fa fa-check"></i><b>2.2.2</b> Import txt data</a></li>
<li class="chapter" data-level="2.2.3" data-path="input-and-format.html"><a href="input-and-format.html#import-excel-data"><i class="fa fa-check"></i><b>2.2.3</b> Import excel data</a></li>
<li class="chapter" data-level="2.2.4" data-path="input-and-format.html"><a href="input-and-format.html#import-stata-data"><i class="fa fa-check"></i><b>2.2.4</b> Import stata data</a></li>
<li class="chapter" data-level="2.2.5" data-path="input-and-format.html"><a href="input-and-format.html#import-sas-data"><i class="fa fa-check"></i><b>2.2.5</b> Import SAS data</a></li>
<li class="chapter" data-level="2.2.6" data-path="input-and-format.html"><a href="input-and-format.html#copy-from-clipboard"><i class="fa fa-check"></i><b>2.2.6</b> Copy from clipboard</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="input-and-format.html"><a href="input-and-format.html#save-and-write-objective-in-r"><i class="fa fa-check"></i><b>2.3</b> Save and write objective in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="input-and-format.html"><a href="input-and-format.html#save-as-r-datei"><i class="fa fa-check"></i><b>2.3.1</b> Save as R-Datei</a></li>
<li class="chapter" data-level="2.3.2" data-path="input-and-format.html"><a href="input-and-format.html#write.table-and-write.csv"><i class="fa fa-check"></i><b>2.3.2</b> write.table and write.csv</a></li>
<li class="chapter" data-level="2.3.3" data-path="input-and-format.html"><a href="input-and-format.html#write.foreign"><i class="fa fa-check"></i><b>2.3.3</b> write.foreign</a></li>
<li class="chapter" data-level="2.3.4" data-path="input-and-format.html"><a href="input-and-format.html#write.xlsx"><i class="fa fa-check"></i><b>2.3.4</b> write.xlsx</a></li>
<li class="chapter" data-level="2.3.5" data-path="input-and-format.html"><a href="input-and-format.html#save-the-plot"><i class="fa fa-check"></i><b>2.3.5</b> Save the plot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="input-and-format.html"><a href="input-and-format.html#format-in-sas"><i class="fa fa-check"></i><b>2.4</b> Format in SAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="input-and-format.html"><a href="input-and-format.html#proc-format"><i class="fa fa-check"></i><b>2.4.1</b> Proc format</a></li>
<li class="chapter" data-level="2.4.2" data-path="input-and-format.html"><a href="input-and-format.html#copy-and-combine-sas-format-libraries"><i class="fa fa-check"></i><b>2.4.2</b> Copy and combine SAS format libraries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html"><i class="fa fa-check"></i><b>3</b> Data Management in SAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#array"><i class="fa fa-check"></i><b>3.1</b> Array</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#defining"><i class="fa fa-check"></i><b>3.1.1</b> Defining</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#format-multiple-variables"><i class="fa fa-check"></i><b>3.1.2</b> Format multiple variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#arrays"><i class="fa fa-check"></i><b>3.1.3</b> 2*2 arrays</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables"><i class="fa fa-check"></i><b>3.1.4</b> Dynamic Element List using Macro Variables</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#carry-over-values"><i class="fa fa-check"></i><b>3.1.5</b> Carry over values</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#retain"><i class="fa fa-check"></i><b>3.2</b> Retain</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#change-from-basilne"><i class="fa fa-check"></i><b>3.2.1</b> Change from Basilne</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#variable-names-and-types"><i class="fa fa-check"></i><b>3.3</b> Variable Names and Types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#convert-all-numeric-to-char"><i class="fa fa-check"></i><b>3.3.1</b> Convert all numeric to char*</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#get-all-the-numeric-variable-names"><i class="fa fa-check"></i><b>3.3.2</b> Get all the numeric variable names</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-variable-names-as-macro-variables"><i class="fa fa-check"></i><b>3.3.3</b> Write all variable names as macro variables</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-observations-as-macro-variable"><i class="fa fa-check"></i><b>3.3.4</b> Write all observations as macro variable</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-some-variables"><i class="fa fa-check"></i><b>3.3.5</b> Rename some variables</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-with-suffix"><i class="fa fa-check"></i><b>3.3.6</b> Rename with suffix</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-array-variables"><i class="fa fa-check"></i><b>3.3.7</b> Rename array variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-exists-for-validation"><i class="fa fa-check"></i><b>3.4</b> Check exists for validation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-exists"><i class="fa fa-check"></i><b>3.4.1</b> Check datasets exists</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-and-variables"><i class="fa fa-check"></i><b>3.4.2</b> Check datasets and Variables</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-if-empty"><i class="fa fa-check"></i><b>3.4.3</b> Check datasets if empty</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#sysfunc-get-the-observations"><i class="fa fa-check"></i><b>3.4.4</b> %sysfunc get the observations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#proc-transpose"><i class="fa fa-check"></i><b>3.5</b> Proc Transpose</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#numeric"><i class="fa fa-check"></i><b>3.5.1</b> <em>numeric</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#in-processing"><i class="fa fa-check"></i><b>3.5.2</b> In processing</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#clean-up"><i class="fa fa-check"></i><b>3.6</b> Clean Up</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#basic-setting"><i class="fa fa-check"></i><b>3.6.1</b> Basic setting</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-datasets"><i class="fa fa-check"></i><b>3.6.2</b> Delete datasets</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#deleting-formats"><i class="fa fa-check"></i><b>3.6.3</b> Deleting Formats</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#remove-assigned-formats"><i class="fa fa-check"></i><b>3.6.4</b> Remove assigned formats</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro-variables"><i class="fa fa-check"></i><b>3.6.5</b> Delete macro variables</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro"><i class="fa fa-check"></i><b>3.6.6</b> Delete Macro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management-in-r.html"><a href="data-management-in-r.html"><i class="fa fa-check"></i><b>4</b> Data Management in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-tidyr"><i class="fa fa-check"></i><b>4.1</b> Package tidyr</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet"><i class="fa fa-check"></i><b>4.1.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#pivoting"><i class="fa fa-check"></i><b>4.1.2</b> Pivoting</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#gather-and-spread"><i class="fa fa-check"></i><b>4.1.3</b> gather and spread</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#separate-and-unite"><i class="fa fa-check"></i><b>4.1.4</b> separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-dplyr"><i class="fa fa-check"></i><b>4.2</b> Package dplyr</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-1"><i class="fa fa-check"></i><b>4.2.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#across"><i class="fa fa-check"></i><b>4.2.2</b> across</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#arrange"><i class="fa fa-check"></i><b>4.2.3</b> arrange</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#coalesce"><i class="fa fa-check"></i><b>4.2.4</b> coalesce</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#filter"><i class="fa fa-check"></i><b>4.2.5</b> filter</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#if_else"><i class="fa fa-check"></i><b>4.2.6</b> if_else</a></li>
<li class="chapter" data-level="4.2.7" data-path="data-management-in-r.html"><a href="data-management-in-r.html#join"><i class="fa fa-check"></i><b>4.2.7</b> join</a></li>
<li class="chapter" data-level="4.2.8" data-path="data-management-in-r.html"><a href="data-management-in-r.html#mutate"><i class="fa fa-check"></i><b>4.2.8</b> mutate</a></li>
<li class="chapter" data-level="4.2.9" data-path="data-management-in-r.html"><a href="data-management-in-r.html#select"><i class="fa fa-check"></i><b>4.2.9</b> select</a></li>
<li class="chapter" data-level="4.2.10" data-path="data-management-in-r.html"><a href="data-management-in-r.html#summarise"><i class="fa fa-check"></i><b>4.2.10</b> summarise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-readr"><i class="fa fa-check"></i><b>4.3</b> Package readr</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-2"><i class="fa fa-check"></i><b>4.3.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-stringr"><i class="fa fa-check"></i><b>4.4</b> Package stringr</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-3"><i class="fa fa-check"></i><b>4.4.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-forcats"><i class="fa fa-check"></i><b>4.5</b> Package forcats</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-4"><i class="fa fa-check"></i><b>4.5.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-lubridate"><i class="fa fa-check"></i><b>4.6</b> Package lubridate</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-5"><i class="fa fa-check"></i><b>4.6.1</b> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>5</b> SQL</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sql.html"><a href="sql.html#mysql-management"><i class="fa fa-check"></i><b>5.1</b> MySQL: Management</a></li>
<li class="chapter" data-level="5.2" data-path="sql.html"><a href="sql.html#mysql-php-in-processing"><i class="fa fa-check"></i><b>5.2</b> MySQL PHP (In processing)</a></li>
<li class="chapter" data-level="5.3" data-path="sql.html"><a href="sql.html#proc-sql-in-sas"><i class="fa fa-check"></i><b>5.3</b> PROC SQL in SAS</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sql.html"><a href="sql.html#inreoduction"><i class="fa fa-check"></i><b>5.3.1</b> Inreoduction</a></li>
<li class="chapter" data-level="5.3.2" data-path="sql.html"><a href="sql.html#create-normal-table"><i class="fa fa-check"></i><b>5.3.2</b> Create Normal Table</a></li>
<li class="chapter" data-level="5.3.3" data-path="sql.html"><a href="sql.html#creating-tables-like-an-existing-table"><i class="fa fa-check"></i><b>5.3.3</b> Creating Tables like an Existing Table</a></li>
<li class="chapter" data-level="5.3.4" data-path="sql.html"><a href="sql.html#inserting-rows"><i class="fa fa-check"></i><b>5.3.4</b> Inserting Rows</a></li>
<li class="chapter" data-level="5.3.5" data-path="sql.html"><a href="sql.html#delete-rows-and-table"><i class="fa fa-check"></i><b>5.3.5</b> Delete Rows and Table</a></li>
<li class="chapter" data-level="5.3.6" data-path="sql.html"><a href="sql.html#new-columns-using-summary-function"><i class="fa fa-check"></i><b>5.3.6</b> New Columns using Summary Function</a></li>
<li class="chapter" data-level="5.3.7" data-path="sql.html"><a href="sql.html#aggregation-summary"><i class="fa fa-check"></i><b>5.3.7</b> Aggregation: Summary</a></li>
<li class="chapter" data-level="5.3.8" data-path="sql.html"><a href="sql.html#conditionality-if"><i class="fa fa-check"></i><b>5.3.8</b> Conditionality (If)</a></li>
<li class="chapter" data-level="5.3.9" data-path="sql.html"><a href="sql.html#filtering-aggregated-data-having"><i class="fa fa-check"></i><b>5.3.9</b> Filtering Aggregated Data (HAVING)</a></li>
<li class="chapter" data-level="5.3.10" data-path="sql.html"><a href="sql.html#select-operator-union"><i class="fa fa-check"></i><b>5.3.10</b> Select Operator (Union…)</a></li>
<li class="chapter" data-level="5.3.11" data-path="sql.html"><a href="sql.html#loap"><i class="fa fa-check"></i><b>5.3.11</b> Loap</a></li>
<li class="chapter" data-level="5.3.12" data-path="sql.html"><a href="sql.html#join-1"><i class="fa fa-check"></i><b>5.3.12</b> Join</a></li>
<li class="chapter" data-level="5.3.13" data-path="sql.html"><a href="sql.html#reordering-rows-proc-sort"><i class="fa fa-check"></i><b>5.3.13</b> Reordering Rows (Proc Sort)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sql.html"><a href="sql.html#package-dbi-in-processing"><i class="fa fa-check"></i><b>5.4</b> Package DBI (In processing)</a></li>
<li class="chapter" data-level="5.5" data-path="sql.html"><a href="sql.html#package-sparklyr-in-processing"><i class="fa fa-check"></i><b>5.5</b> Package sparklyr (In processing)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>6</b> ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ggplot2.html"><a href="ggplot2.html#parametric-rendering"><i class="fa fa-check"></i><b>6.1</b> Parametric Rendering</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ggplot2.html"><a href="ggplot2.html#grammar"><i class="fa fa-check"></i><b>6.1.1</b> Grammar</a></li>
<li class="chapter" data-level="6.1.2" data-path="ggplot2.html"><a href="ggplot2.html#coord"><i class="fa fa-check"></i><b>6.1.2</b> coord</a></li>
<li class="chapter" data-level="6.1.3" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>6.1.3</b> facet</a></li>
<li class="chapter" data-level="6.1.4" data-path="ggplot2.html"><a href="ggplot2.html#geom"><i class="fa fa-check"></i><b>6.1.4</b> geom</a></li>
<li class="chapter" data-level="6.1.5" data-path="ggplot2.html"><a href="ggplot2.html#position"><i class="fa fa-check"></i><b>6.1.5</b> position</a></li>
<li class="chapter" data-level="6.1.6" data-path="ggplot2.html"><a href="ggplot2.html#scale"><i class="fa fa-check"></i><b>6.1.6</b> scale</a></li>
<li class="chapter" data-level="6.1.7" data-path="ggplot2.html"><a href="ggplot2.html#stat"><i class="fa fa-check"></i><b>6.1.7</b> stat</a></li>
<li class="chapter" data-level="6.1.8" data-path="ggplot2.html"><a href="ggplot2.html#color"><i class="fa fa-check"></i><b>6.1.8</b> Color</a></li>
<li class="chapter" data-level="6.1.9" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>6.1.9</b> Thema</a></li>
<li class="chapter" data-level="6.1.10" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>6.1.10</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ggplot2.html"><a href="ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>6.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ggplot2.html"><a href="ggplot2.html#grouping-aesthetic"><i class="fa fa-check"></i><b>6.2.1</b> Grouping Aesthetic</a></li>
<li class="chapter" data-level="6.2.2" data-path="ggplot2.html"><a href="ggplot2.html#facet-1"><i class="fa fa-check"></i><b>6.2.2</b> facet</a></li>
<li class="chapter" data-level="6.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_smooth"><i class="fa fa-check"></i><b>6.2.3</b> geom_smooth</a></li>
<li class="chapter" data-level="6.2.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-plot"><i class="fa fa-check"></i><b>6.2.4</b> Dot Plot</a></li>
<li class="chapter" data-level="6.2.5" data-path="ggplot2.html"><a href="ggplot2.html#label-and-title"><i class="fa fa-check"></i><b>6.2.5</b> Label and Title</a></li>
<li class="chapter" data-level="6.2.6" data-path="ggplot2.html"><a href="ggplot2.html#residuals"><i class="fa fa-check"></i><b>6.2.6</b> Residuals</a></li>
<li class="chapter" data-level="6.2.7" data-path="ggplot2.html"><a href="ggplot2.html#encircling"><i class="fa fa-check"></i><b>6.2.7</b> Encircling</a></li>
<li class="chapter" data-level="6.2.8" data-path="ggplot2.html"><a href="ggplot2.html#dumbbell-plot"><i class="fa fa-check"></i><b>6.2.8</b> Dumbbell Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>6.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ggplot2.html"><a href="ggplot2.html#general-appearance"><i class="fa fa-check"></i><b>6.3.1</b> General appearance</a></li>
<li class="chapter" data-level="6.3.2" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>6.3.2</b> Themes</a></li>
<li class="chapter" data-level="6.3.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_freqpoly"><i class="fa fa-check"></i><b>6.3.3</b> geom_freqpoly()</a></li>
<li class="chapter" data-level="6.3.4" data-path="ggplot2.html"><a href="ggplot2.html#marginal-histogram-boxplot"><i class="fa fa-check"></i><b>6.3.4</b> Marginal Histogram / Boxplot</a></li>
<li class="chapter" data-level="6.3.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>6.3.5</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>6.4</b> Bar plot</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic"><i class="fa fa-check"></i><b>6.4.1</b> Aesthetic</a></li>
<li class="chapter" data-level="6.4.2" data-path="ggplot2.html"><a href="ggplot2.html#proportion"><i class="fa fa-check"></i><b>6.4.2</b> Proportion</a></li>
<li class="chapter" data-level="6.4.3" data-path="ggplot2.html"><a href="ggplot2.html#coord-1"><i class="fa fa-check"></i><b>6.4.3</b> coord</a></li>
<li class="chapter" data-level="6.4.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity"><i class="fa fa-check"></i><b>6.4.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.4.5" data-path="ggplot2.html"><a href="ggplot2.html#ranking"><i class="fa fa-check"></i><b>6.4.5</b> Ranking</a></li>
<li class="chapter" data-level="6.4.6" data-path="ggplot2.html"><a href="ggplot2.html#means-and-error-bars"><i class="fa fa-check"></i><b>6.4.6</b> Means and error bars</a></li>
<li class="chapter" data-level="6.4.7" data-path="ggplot2.html"><a href="ggplot2.html#waffle-chart"><i class="fa fa-check"></i><b>6.4.7</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ggplot2.html"><a href="ggplot2.html#box-plot"><i class="fa fa-check"></i><b>6.5</b> Box plot</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="ggplot2.html"><a href="ggplot2.html#varwidth"><i class="fa fa-check"></i><b>6.5.1</b> varwidth</a></li>
<li class="chapter" data-level="6.5.2" data-path="ggplot2.html"><a href="ggplot2.html#reorder"><i class="fa fa-check"></i><b>6.5.2</b> Reorder</a></li>
<li class="chapter" data-level="6.5.3" data-path="ggplot2.html"><a href="ggplot2.html#fill"><i class="fa fa-check"></i><b>6.5.3</b> Fill</a></li>
<li class="chapter" data-level="6.5.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity-1"><i class="fa fa-check"></i><b>6.5.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.5.5" data-path="ggplot2.html"><a href="ggplot2.html#dot-box-plot"><i class="fa fa-check"></i><b>6.5.5</b> Dot + Box Plot</a></li>
<li class="chapter" data-level="6.5.6" data-path="ggplot2.html"><a href="ggplot2.html#violin-plot"><i class="fa fa-check"></i><b>6.5.6</b> Violin Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ggplot2.html"><a href="ggplot2.html#other-rendering"><i class="fa fa-check"></i><b>6.6</b> Other rendering</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i><b>6.6.1</b> Annotation</a></li>
<li class="chapter" data-level="6.6.2" data-path="ggplot2.html"><a href="ggplot2.html#text-ggtext"><i class="fa fa-check"></i><b>6.6.2</b> Text: ggtext</a></li>
<li class="chapter" data-level="6.6.3" data-path="ggplot2.html"><a href="ggplot2.html#text-ggrepel"><i class="fa fa-check"></i><b>6.6.3</b> Text: ggrepel</a></li>
<li class="chapter" data-level="6.6.4" data-path="ggplot2.html"><a href="ggplot2.html#arrage-gridextra"><i class="fa fa-check"></i><b>6.6.4</b> Arrage: gridExtra</a></li>
<li class="chapter" data-level="6.6.5" data-path="ggplot2.html"><a href="ggplot2.html#interactive-charts-plotly"><i class="fa fa-check"></i><b>6.6.5</b> Interactive charts: plotly</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ggplot2.html"><a href="ggplot2.html#diagrammer"><i class="fa fa-check"></i><b>6.7</b> DiagrammeR</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-flowchart-using-grviz"><i class="fa fa-check"></i><b>6.7.1</b> Basic flowchart using <code>grViz</code></a></li>
<li class="chapter" data-level="6.7.2" data-path="ggplot2.html"><a href="ggplot2.html#graphviz-attributes"><i class="fa fa-check"></i><b>6.7.2</b> Graphviz Attributes</a></li>
<li class="chapter" data-level="6.7.3" data-path="ggplot2.html"><a href="ggplot2.html#gantt-chart"><i class="fa fa-check"></i><b>6.7.3</b> Gantt chart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html"><i class="fa fa-check"></i><b>7</b> Proc Sqplot (In Processing)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#ods"><i class="fa fa-check"></i><b>7.1</b> ODS</a></li>
<li class="chapter" data-level="7.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#scatter-plot-1"><i class="fa fa-check"></i><b>7.3</b> Scatter Plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#vector-in-scatter-plot"><i class="fa fa-check"></i><b>7.3.1</b> Vector in scatter Plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#add-predict-curve"><i class="fa fa-check"></i><b>7.3.2</b> Add predict curve</a></li>
<li class="chapter" data-level="7.3.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#grouping"><i class="fa fa-check"></i><b>7.3.3</b> grouping</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#bar-chart"><i class="fa fa-check"></i><b>7.4</b> Bar chart</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#group-and-using-freq"><i class="fa fa-check"></i><b>7.4.1</b> Group and using freq</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#histogram-1"><i class="fa fa-check"></i><b>7.5</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html"><i class="fa fa-check"></i><b>8</b> Descriptive Statistics in SAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-freq"><i class="fa fa-check"></i><b>8.1</b> PROC FREQ</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-table-names"><i class="fa fa-check"></i><b>8.1.1</b> ODS Table Names</a></li>
<li class="chapter" data-level="8.1.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-plots"><i class="fa fa-check"></i><b>8.1.2</b> ODS Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-univariate"><i class="fa fa-check"></i><b>8.2</b> PROC UNIVARIATE</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#histogram-statement"><i class="fa fa-check"></i><b>8.2.1</b> HISTOGRAM Statement</a></li>
<li class="chapter" data-level="8.2.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#cdfplot-statement"><i class="fa fa-check"></i><b>8.2.2</b> CDFPLOT Statement</a></li>
<li class="chapter" data-level="8.2.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ppplot-statement"><i class="fa fa-check"></i><b>8.2.3</b> PPPLOT Statement</a></li>
<li class="chapter" data-level="8.2.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#probplot-and-qqplot-statement"><i class="fa fa-check"></i><b>8.2.4</b> PROBPLOT and QQPLOT Statement</a></li>
<li class="chapter" data-level="8.2.5" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-tables"><i class="fa fa-check"></i><b>8.2.5</b> ODS Tables</a></li>
<li class="chapter" data-level="8.2.6" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-graphics"><i class="fa fa-check"></i><b>8.2.6</b> ODS Graphics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-means"><i class="fa fa-check"></i><b>8.3</b> PROC MEANS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-summary-statistics"><i class="fa fa-check"></i><b>8.3.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="8.3.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#autoname-option"><i class="fa fa-check"></i><b>8.3.2</b> AUTONAME Option</a></li>
<li class="chapter" data-level="8.3.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#chartype-option"><i class="fa fa-check"></i><b>8.3.3</b> CHARTYPE Option</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-tabulate"><i class="fa fa-check"></i><b>8.4</b> PROC TABULATE</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-syntax-for-proc-tabulate"><i class="fa fa-check"></i><b>8.4.1</b> Basic Syntax for PROC TABULATE</a></li>
<li class="chapter" data-level="8.4.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#identification-of-desired-statistics"><i class="fa fa-check"></i><b>8.4.2</b> Identification of Desired Statistics</a></li>
<li class="chapter" data-level="8.4.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#in-processing-1"><i class="fa fa-check"></i><b>8.4.3</b> In processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>9</b> Descriptive Statistics in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-pape"><i class="fa fa-check"></i><b>9.1</b> Package pape</a></li>
<li class="chapter" data-level="9.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-summarytools"><i class="fa fa-check"></i><b>9.2</b> Package summarytools</a></li>
<li class="chapter" data-level="9.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-comparegroups"><i class="fa fa-check"></i><b>9.3</b> Package compareGroups</a></li>
<li class="chapter" data-level="9.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary"><i class="fa fa-check"></i><b>9.4</b> Package sjPlot for Models Summary</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#tab_model-and-options"><i class="fa fa-check"></i><b>9.4.1</b> tab_model and options</a></li>
<li class="chapter" data-level="9.4.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#mixed-models"><i class="fa fa-check"></i><b>9.4.2</b> Mixed Models</a></li>
<li class="chapter" data-level="9.4.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#plot_model"><i class="fa fa-check"></i><b>9.4.3</b> plot_model</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-kableextra"><i class="fa fa-check"></i><b>9.5</b> Package kableExtra</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#kable_styling"><i class="fa fa-check"></i><b>9.5.1</b> kable_styling</a></li>
<li class="chapter" data-level="9.5.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#columnrow-specification"><i class="fa fa-check"></i><b>9.5.2</b> Column/Row Specification</a></li>
<li class="chapter" data-level="9.5.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#grouping-columnsrows"><i class="fa fa-check"></i><b>9.5.3</b> Grouping columns/rows</a></li>
<li class="chapter" data-level="9.5.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#add-footnote"><i class="fa fa-check"></i><b>9.5.4</b> Add Footnote</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html"><i class="fa fa-check"></i><b>10</b> Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#distribution"><i class="fa fa-check"></i><b>10.1</b> Distribution</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#quantile-function-in-sas"><i class="fa fa-check"></i><b>10.1.1</b> Quantile Function in SAS</a></li>
<li class="chapter" data-level="10.1.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>10.1.3</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="10.1.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multinomial-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Multinomial distribution</a></li>
<li class="chapter" data-level="10.1.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#normal-distribution"><i class="fa fa-check"></i><b>10.1.5</b> Normal Distribution</a></li>
<li class="chapter" data-level="10.1.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>10.1.6</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="10.1.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#poisson-distribution"><i class="fa fa-check"></i><b>10.1.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="10.1.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#exponential-distribution"><i class="fa fa-check"></i><b>10.1.8</b> Exponential distribution</a></li>
<li class="chapter" data-level="10.1.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#gamma-distribution"><i class="fa fa-check"></i><b>10.1.9</b> Gamma distribution</a></li>
<li class="chapter" data-level="10.1.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#weibull-distribution"><i class="fa fa-check"></i><b>10.1.10</b> Weibull Distribution</a></li>
<li class="chapter" data-level="10.1.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#beta-distribution"><i class="fa fa-check"></i><b>10.1.11</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#point-estimates"><i class="fa fa-check"></i><b>10.2</b> Point Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-proportions"><i class="fa fa-check"></i><b>10.3</b> Test Proportion(s)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-ci-for-small-samples"><i class="fa fa-check"></i><b>10.3.1</b> Binomial CI for Small Samples</a></li>
<li class="chapter" data-level="10.3.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-binom"><i class="fa fa-check"></i><b>10.3.2</b> Package binom</a></li>
<li class="chapter" data-level="10.3.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#ci_single_proportion"><i class="fa fa-check"></i><b>10.3.3</b> %CI_Single_Proportion</a></li>
<li class="chapter" data-level="10.3.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#incidence-rate-ci"><i class="fa fa-check"></i><b>10.3.4</b> Incidence rate CI</a></li>
<li class="chapter" data-level="10.3.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-pwr"><i class="fa fa-check"></i><b>10.3.5</b> Package: pwr</a></li>
<li class="chapter" data-level="10.3.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportion-2-sided-equality-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.6</b> 1-Sample Proportion, 2-Sided Equality based on Wald CI</a></li>
<li class="chapter" data-level="10.3.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportion-equivalence"><i class="fa fa-check"></i><b>10.3.7</b> 1-Sample Proportion Equivalence</a></li>
<li class="chapter" data-level="10.3.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-2-sided-equality-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.8</b> 2-Sample Proportions, 2-Sided Equality based on Wald CI</a></li>
<li class="chapter" data-level="10.3.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>10.3.9</b> 2-Sample Proportions Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="10.3.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-equivalence"><i class="fa fa-check"></i><b>10.3.10</b> 2-Sample Proportions Equivalence</a></li>
<li class="chapter" data-level="10.3.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test"><i class="fa fa-check"></i><b>10.3.11</b> Paired Proportions: McNemar’s Z-test</a></li>
<li class="chapter" data-level="10.3.12" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#chi-square-test"><i class="fa fa-check"></i><b>10.3.12</b> Chi-square test</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-means"><i class="fa fa-check"></i><b>10.4</b> Test Mean(s)</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality"><i class="fa fa-check"></i><b>10.4.1</b> One Sample Mean 2-Sided Equality</a></li>
<li class="chapter" data-level="10.4.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>10.4.2</b> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="10.4.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-mean-equivalence"><i class="fa fa-check"></i><b>10.4.3</b> 1-Sample Mean Equivalence</a></li>
<li class="chapter" data-level="10.4.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-2-sided-equality"><i class="fa fa-check"></i><b>10.4.4</b> 2-Sample Means, 2-Sided Equality</a></li>
<li class="chapter" data-level="10.4.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-1-sided"><i class="fa fa-check"></i><b>10.4.5</b> 2-Sample Means, 1-Sided</a></li>
<li class="chapter" data-level="10.4.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>10.4.6</b> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="10.4.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-equivalence"><i class="fa fa-check"></i><b>10.4.7</b> 2-Sample Means Equivalence</a></li>
<li class="chapter" data-level="10.4.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test"><i class="fa fa-check"></i><b>10.4.8</b> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li class="chapter" data-level="10.4.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-k-means"><i class="fa fa-check"></i><b>10.4.9</b> Test k Means</a></li>
<li class="chapter" data-level="10.4.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#anova-using-pwr.anova.test"><i class="fa fa-check"></i><b>10.4.10</b> Anova using <code>pwr.anova.test</code></a></li>
<li class="chapter" data-level="10.4.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#average-bioequivalence"><i class="fa fa-check"></i><b>10.4.11</b> Average Bioequivalence</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#other-methods"><i class="fa fa-check"></i><b>10.5</b> Other Methods</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#odds-ratio"><i class="fa fa-check"></i><b>10.5.1</b> Odds Ratio</a></li>
<li class="chapter" data-level="10.5.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlation"><i class="fa fa-check"></i><b>10.5.2</b> Correlation</a></li>
<li class="chapter" data-level="10.5.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies"><i class="fa fa-check"></i><b>10.5.3</b> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multiple-test"><i class="fa fa-check"></i><b>10.6</b> Multiple test</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#definitions-of-power"><i class="fa fa-check"></i><b>10.6.1</b> Definitions of Power</a></li>
<li class="chapter" data-level="10.6.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#bonferroni-tests-individual-power"><i class="fa fa-check"></i><b>10.6.2</b> Bonferroni Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#tukeys-method-individual-power"><i class="fa fa-check"></i><b>10.6.3</b> Tukey’s method (Individual Power)</a></li>
<li class="chapter" data-level="10.6.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power"><i class="fa fa-check"></i><b>10.6.4</b> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower"><i class="fa fa-check"></i><b>10.6.5</b> Combined Power %SimPower and %PlotSimPower</a></li>
<li class="chapter" data-level="10.6.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r"><i class="fa fa-check"></i><b>10.6.6</b> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#time-to-event-data"><i class="fa fa-check"></i><b>10.7</b> Time-To-Event Data</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#cox-ph-2-sided-equality"><i class="fa fa-check"></i><b>10.7.1</b> Cox PH, 2-Sided Equality</a></li>
<li class="chapter" data-level="10.7.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks"><i class="fa fa-check"></i><b>10.7.2</b> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#estimation-in-diagnostic-test"><i class="fa fa-check"></i><b>10.8</b> Estimation in diagnostic test</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#adequate-sensitivityspecificity"><i class="fa fa-check"></i><b>10.8.1</b> Adequate sensitivity/specificity</a></li>
<li class="chapter" data-level="10.8.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#testing-sensitivity-or-specificity"><i class="fa fa-check"></i><b>10.8.2</b> Testing sensitivity (or specificity)</a></li>
<li class="chapter" data-level="10.8.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#likelihood-ratio-estimation"><i class="fa fa-check"></i><b>10.8.3</b> Likelihood ratio estimation</a></li>
<li class="chapter" data-level="10.8.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#roc-index-of-accuracy"><i class="fa fa-check"></i><b>10.8.4</b> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="parametric-test.html"><a href="parametric-test.html"><i class="fa fa-check"></i><b>11</b> Parametric Test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="parametric-test.html"><a href="parametric-test.html#binomial-test"><i class="fa fa-check"></i><b>11.1</b> Binomial test</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula"><i class="fa fa-check"></i><b>11.1.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="11.1.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation"><i class="fa fa-check"></i><b>11.1.2</b> R implementation</a></li>
<li class="chapter" data-level="11.1.3" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation"><i class="fa fa-check"></i><b>11.1.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="parametric-test.html"><a href="parametric-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>11.2</b> Fisher’s Exact Test</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-2"><i class="fa fa-check"></i><b>11.2.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-1"><i class="fa fa-check"></i><b>11.2.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.2.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-1"><i class="fa fa-check"></i><b>11.2.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="parametric-test.html"><a href="parametric-test.html#mcnemars-test"><i class="fa fa-check"></i><b>11.3</b> McNemar’s test</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-3"><i class="fa fa-check"></i><b>11.3.1</b> introduction</a></li>
<li class="chapter" data-level="11.3.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-2"><i class="fa fa-check"></i><b>11.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="11.3.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-2"><i class="fa fa-check"></i><b>11.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="parametric-test.html"><a href="parametric-test.html#cochranmantelhaenszel-test"><i class="fa fa-check"></i><b>11.4</b> Cochran–Mantel–Haenszel Test</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-3"><i class="fa fa-check"></i><b>11.4.1</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="parametric-test.html"><a href="parametric-test.html#correlation-test"><i class="fa fa-check"></i><b>11.5</b> Correlation Test</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="parametric-test.html"><a href="parametric-test.html#pearson-correlation"><i class="fa fa-check"></i><b>11.5.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="11.5.2" data-path="parametric-test.html"><a href="parametric-test.html#spearman-correlation"><i class="fa fa-check"></i><b>11.5.2</b> Spearman correlation</a></li>
<li class="chapter" data-level="11.5.3" data-path="parametric-test.html"><a href="parametric-test.html#kendall-correlation"><i class="fa fa-check"></i><b>11.5.3</b> Kendall correlation</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="parametric-test.html"><a href="parametric-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two Sample T-Test</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="parametric-test.html"><a href="parametric-test.html#inreoduction-1"><i class="fa fa-check"></i><b>11.6.1</b> Inreoduction</a></li>
<li class="chapter" data-level="11.6.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-3"><i class="fa fa-check"></i><b>11.6.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.6.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-4"><i class="fa fa-check"></i><b>11.6.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="parametric-test.html"><a href="parametric-test.html#normality-test"><i class="fa fa-check"></i><b>11.7</b> Normality test</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-4"><i class="fa fa-check"></i><b>11.7.1</b> SAS implementation</a></li>
<li class="chapter" data-level="11.7.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-5"><i class="fa fa-check"></i><b>11.7.2</b> R implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>12</b> ANOVA</a>
<ul>
<li class="chapter" data-level="12.1" data-path="anova.html"><a href="anova.html#unstructured-models"><i class="fa fa-check"></i><b>12.1</b> Unstructured Models</a></li>
<li class="chapter" data-level="12.2" data-path="anova.html"><a href="anova.html#balanced-one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>12.2</b> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="anova.html"><a href="anova.html#modeling-assumptions-and-basic-analysis"><i class="fa fa-check"></i><b>12.2.1</b> Modeling Assumptions and Basic Analysis</a></li>
<li class="chapter" data-level="12.2.2" data-path="anova.html"><a href="anova.html#parameter-estimates"><i class="fa fa-check"></i><b>12.2.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="12.2.3" data-path="anova.html"><a href="anova.html#r-implementation-6"><i class="fa fa-check"></i><b>12.2.3</b> R Implementation</a></li>
<li class="chapter" data-level="12.2.4" data-path="anova.html"><a href="anova.html#sas-implementation-5"><i class="fa fa-check"></i><b>12.2.4</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.2.5" data-path="anova.html"><a href="anova.html#model-diagnosis"><i class="fa fa-check"></i><b>12.2.5</b> Model Diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="anova.html"><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>12.3</b> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="12.4" data-path="anova.html"><a href="anova.html#two-ways-anova-test"><i class="fa fa-check"></i><b>12.4</b> Two-Ways ANOVA Test</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="anova.html"><a href="anova.html#introduction-4"><i class="fa fa-check"></i><b>12.4.1</b> Introduction</a></li>
<li class="chapter" data-level="12.4.2" data-path="anova.html"><a href="anova.html#r-implementation-7"><i class="fa fa-check"></i><b>12.4.2</b> R implementation</a></li>
<li class="chapter" data-level="12.4.3" data-path="anova.html"><a href="anova.html#sas-implementation-6"><i class="fa fa-check"></i><b>12.4.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.4.4" data-path="anova.html"><a href="anova.html#unbalanced-design"><i class="fa fa-check"></i><b>12.4.4</b> Unbalanced design</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="anova.html"><a href="anova.html#heteroscedastic-responses"><i class="fa fa-check"></i><b>12.5</b> Heteroscedastic Responses</a></li>
<li class="chapter" data-level="12.6" data-path="anova.html"><a href="anova.html#repeated-measures-anova-data"><i class="fa fa-check"></i><b>12.6</b> Repeated Measures ANOVA Data</a></li>
<li class="chapter" data-level="12.7" data-path="anova.html"><a href="anova.html#multivariate-responses-with-normally-distributed-data"><i class="fa fa-check"></i><b>12.7</b> Multivariate Responses with Normally Distributed Data</a></li>
<li class="chapter" data-level="12.8" data-path="anova.html"><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.8</b> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li class="chapter" data-level="12.9" data-path="anova.html"><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.9</b> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-comparison.html"><a href="multiple-comparison.html"><i class="fa fa-check"></i><b>13</b> Multiple-Comparison</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-5"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiplicity-problem"><i class="fa fa-check"></i><b>13.1.1</b> Multiplicity Problem</a></li>
<li class="chapter" data-level="13.1.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#error-rates"><i class="fa fa-check"></i><b>13.1.2</b> Error Rates</a></li>
<li class="chapter" data-level="13.1.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-adjusted-p"><i class="fa fa-check"></i><b>13.1.3</b> The adjusted P</a></li>
<li class="chapter" data-level="13.1.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#basic-statistical-concepts"><i class="fa fa-check"></i><b>13.1.4</b> Basic Statistical Concepts</a></li>
<li class="chapter" data-level="13.1.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#functions-in-glht-package-in-r"><i class="fa fa-check"></i><b>13.1.5</b> Functions in glht package in R</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-and-šidák-methods"><i class="fa fa-check"></i><b>13.2</b> Bonferroni and Šidák Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#lsd-least-significance-difference"><i class="fa fa-check"></i><b>13.2.1</b> LSD (least significance difference)</a></li>
<li class="chapter" data-level="13.2.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák"><i class="fa fa-check"></i><b>13.2.2</b> Šidák</a></li>
<li class="chapter" data-level="13.2.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni"><i class="fa fa-check"></i><b>13.2.3</b> Bonferroni</a></li>
<li class="chapter" data-level="13.2.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot"><i class="fa fa-check"></i><b>13.2.4</b> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova"><i class="fa fa-check"></i><b>13.3</b> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#ls-means"><i class="fa fa-check"></i><b>13.3.1</b> LS-Means</a></li>
<li class="chapter" data-level="13.3.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-multivariate-t-distribution"><i class="fa fa-check"></i><b>13.3.2</b> The Multivariate t Distribution</a></li>
<li class="chapter" data-level="13.3.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha"><i class="fa fa-check"></i><b>13.3.3</b> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li class="chapter" data-level="13.3.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution"><i class="fa fa-check"></i><b>13.3.4</b> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li class="chapter" data-level="13.3.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons"><i class="fa fa-check"></i><b>13.3.5</b> Tukey’s Method for All Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically"><i class="fa fa-check"></i><b>13.3.6</b> Displaying Pairwise Comparisons Graphically</a></li>
<li class="chapter" data-level="13.3.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><i class="fa fa-check"></i><b>13.3.7</b> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li class="chapter" data-level="13.3.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control"><i class="fa fa-check"></i><b>13.3.8</b> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li class="chapter" data-level="13.3.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><i class="fa fa-check"></i><b>13.3.9</b> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><i class="fa fa-check"></i><b>13.4</b> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-model-and-estimates"><i class="fa fa-check"></i><b>13.4.1</b> The Model and Estimates</a></li>
<li class="chapter" data-level="13.4.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukey-kramer-method"><i class="fa fa-check"></i><b>13.4.2</b> Tukey-Kramer Method</a></li>
<li class="chapter" data-level="13.4.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#alternative-simulation-based-method"><i class="fa fa-check"></i><b>13.4.3</b> Alternative Simulation-Based Method</a></li>
<li class="chapter" data-level="13.4.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#pairwise-comparisons-with-control"><i class="fa fa-check"></i><b>13.4.4</b> Pairwise Comparisons with Control</a></li>
<li class="chapter" data-level="13.4.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom"><i class="fa fa-check"></i><b>13.4.5</b> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>13.5</b> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation"><i class="fa fa-check"></i><b>13.5.1</b> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li class="chapter" data-level="13.5.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method"><i class="fa fa-check"></i><b>13.5.2</b> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li class="chapter" data-level="13.5.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction"><i class="fa fa-check"></i><b>13.5.3</b> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters"><i class="fa fa-check"></i><b>13.6</b> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#scheffés-method"><i class="fa fa-check"></i><b>13.6.1</b> Scheffés Method</a></li>
<li class="chapter" data-level="13.6.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#finding-the-maximal-contrast"><i class="fa fa-check"></i><b>13.6.2</b> Finding the Maximal Contrast</a></li>
<li class="chapter" data-level="13.6.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#working-hotelling-method"><i class="fa fa-check"></i><b>13.6.3</b> Working-Hotelling method</a></li>
<li class="chapter" data-level="13.6.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#discrete-approximation-method"><i class="fa fa-check"></i><b>13.6.4</b> Discrete approximation method</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7</b> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-of-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.1</b> Introduction of heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#satterthwaite-approximation"><i class="fa fa-check"></i><b>13.7.2</b> Satterthwaite Approximation</a></li>
<li class="chapter" data-level="13.7.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.3</b> MaxT Method under Heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#minp-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.4</b> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-and-stepwise-testing-methods"><i class="fa fa-check"></i><b>13.8</b> Closed and Stepwise Testing Methods</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-family-of-hypotheses"><i class="fa fa-check"></i><b>13.8.1</b> Closed Family of Hypotheses</a></li>
<li class="chapter" data-level="13.8.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-holm-method"><i class="fa fa-check"></i><b>13.8.2</b> Bonferroni-Holm Method</a></li>
<li class="chapter" data-level="13.8.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák-holm-method"><i class="fa fa-check"></i><b>13.8.3</b> Šidák-Holm Method</a></li>
<li class="chapter" data-level="13.8.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-fisher-combination-method"><i class="fa fa-check"></i><b>13.8.4</b> Closed Fisher Combination Method</a></li>
<li class="chapter" data-level="13.8.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#simes-hommel-method"><i class="fa fa-check"></i><b>13.8.5</b> Simes-Hommel Method</a></li>
<li class="chapter" data-level="13.8.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hochbergs-ok-step-up"><i class="fa fa-check"></i><b>13.8.6</b> Hochberg’s O(k) Step-Up</a></li>
<li class="chapter" data-level="13.8.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences"><i class="fa fa-check"></i><b>13.8.7</b> Sequential Testing with Fixed Sequences</a></li>
<li class="chapter" data-level="13.8.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods"><i class="fa fa-check"></i><b>13.8.8</b> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts"><i class="fa fa-check"></i><b>13.9</b> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#incorporating-logical-constraints"><i class="fa fa-check"></i><b>13.9.1</b> Incorporating Logical Constraints</a></li>
<li class="chapter" data-level="13.9.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#shaffers-method"><i class="fa fa-check"></i><b>13.9.2</b> Shaffer’s Method</a></li>
<li class="chapter" data-level="13.9.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#extended-shaffer-royen-method"><i class="fa fa-check"></i><b>13.9.3</b> Extended Shaffer-Royen Method</a></li>
<li class="chapter" data-level="13.9.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#step-down-dunnett-test"><i class="fa fa-check"></i><b>13.9.4</b> Step-down Dunnett test</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-with-binary-data"><i class="fa fa-check"></i><b>13.10</b> Multiple Comparisons with Binary Data</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-6"><i class="fa fa-check"></i><b>13.10.1</b> Introduction</a></li>
<li class="chapter" data-level="13.10.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes"><i class="fa fa-check"></i><b>13.10.2</b> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>14</b> Non-Parametric Test</a>
<ul>
<li class="chapter" data-level="14.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#two-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.1</b> Two Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples"><i class="fa fa-check"></i><b>14.1.1</b> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li class="chapter" data-level="14.1.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched"><i class="fa fa-check"></i><b>14.1.2</b> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li class="chapter" data-level="14.1.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.3</b> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.4</b> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions"><i class="fa fa-check"></i><b>14.1.5</b> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#several-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.2</b> Several Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples"><i class="fa fa-check"></i><b>14.2.1</b> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter"><i class="fa fa-check"></i><b>14.2.2</b> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#tests-for-categorical-data"><i class="fa fa-check"></i><b>14.3</b> Tests for Categorical Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test"><i class="fa fa-check"></i><b>14.3.1</b> Spearman Rank Correlation Coefficient Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#fisher-exact-test"><i class="fa fa-check"></i><b>14.3.2</b> Fisher Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-test"><i class="fa fa-check"></i><b>14.4</b> Permutation test</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#introduction-7"><i class="fa fa-check"></i><b>14.4.1</b> Introduction</a></li>
<li class="chapter" data-level="14.4.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#package-coin"><i class="fa fa-check"></i><b>14.4.2</b> Package: coin</a></li>
<li class="chapter" data-level="14.4.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.3</b> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.4</b> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles"><i class="fa fa-check"></i><b>14.4.5</b> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#nonparametric-regression"><i class="fa fa-check"></i><b>14.5</b> Nonparametric Regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>15</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation-1"><i class="fa fa-check"></i><b>15.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.1</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="15.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.2</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.3</b> Kendall rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#intraclass-correlation"><i class="fa fa-check"></i><b>15.1.4</b> Intraclass correlation</a></li>
<li class="chapter" data-level="15.1.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualize-the-correlation-in-r"><i class="fa fa-check"></i><b>15.1.5</b> Visualize the correlation in R</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>15.2</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#assumpions"><i class="fa fa-check"></i><b>15.2.1</b> Assumpions</a></li>
<li class="chapter" data-level="15.2.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#interpretation"><i class="fa fa-check"></i><b>15.2.2</b> Interpretation</a></li>
<li class="chapter" data-level="15.2.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#matrix-solution"><i class="fa fa-check"></i><b>15.2.3</b> Matrix Solution</a></li>
<li class="chapter" data-level="15.2.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>15.2.4</b> Gauss-Markov Theorem</a></li>
<li class="chapter" data-level="15.2.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#limitation"><i class="fa fa-check"></i><b>15.2.5</b> limitation</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-statistics"><i class="fa fa-check"></i><b>15.3</b> Model Statistics</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#residuals-standard-error"><i class="fa fa-check"></i><b>15.3.1</b> Residuals Standard Error</a></li>
<li class="chapter" data-level="15.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>15.3.2</b> R-Squared and Adjusted R-Squared</a></li>
<li class="chapter" data-level="15.3.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#t-statistic"><i class="fa fa-check"></i><b>15.3.3</b> T Statistic</a></li>
<li class="chapter" data-level="15.3.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#f-statistic"><i class="fa fa-check"></i><b>15.3.4</b> F Statistic</a></li>
<li class="chapter" data-level="15.3.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>15.3.5</b> Confidence Intervals</a></li>
<li class="chapter" data-level="15.3.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>15.3.6</b> Likelihood-ratio test</a></li>
<li class="chapter" data-level="15.3.7" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#accuracy"><i class="fa fa-check"></i><b>15.3.7</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>15.4</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-error-assumptions"><i class="fa fa-check"></i><b>15.4.1</b> Checking Error Assumptions</a></li>
<li class="chapter" data-level="15.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#finding-unusual-observations"><i class="fa fa-check"></i><b>15.4.2</b> Finding Unusual Observations</a></li>
<li class="chapter" data-level="15.4.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-the-structure-of-the-model"><i class="fa fa-check"></i><b>15.4.3</b> Checking the Structure of the Model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#sas-implementation-proc-reg"><i class="fa fa-check"></i><b>15.5</b> SAS implementation Proc Reg</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#options"><i class="fa fa-check"></i><b>15.5.1</b> Options</a></li>
<li class="chapter" data-level="15.5.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#diagnose"><i class="fa fa-check"></i><b>15.5.2</b> Diagnose</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-implementation-8"><i class="fa fa-check"></i><b>15.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html"><i class="fa fa-check"></i><b>16</b> Advanced Linear Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#model-selection"><i class="fa fa-check"></i><b>16.1</b> Model Selection</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-methods"><i class="fa fa-check"></i><b>16.1.1</b> Selection Methods</a></li>
<li class="chapter" data-level="16.1.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-criteria"><i class="fa fa-check"></i><b>16.1.2</b> Selection Criteria</a></li>
<li class="chapter" data-level="16.1.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#k--fold-cross-validation"><i class="fa fa-check"></i><b>16.1.3</b> k- Fold Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#practical-difficulties-using-ols"><i class="fa fa-check"></i><b>16.2</b> Practical Difficulties using OLS</a></li>
<li class="chapter" data-level="16.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#skewness"><i class="fa fa-check"></i><b>16.3</b> Skewness</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#introduction-8"><i class="fa fa-check"></i><b>16.3.1</b> Introduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#baisc-transformation"><i class="fa fa-check"></i><b>16.3.2</b> Baisc Transformation</a></li>
<li class="chapter" data-level="16.3.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#box-cox-power-transformation"><i class="fa fa-check"></i><b>16.3.3</b> Box-Cox Power Transformation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#scale-1"><i class="fa fa-check"></i><b>16.4</b> Scale</a></li>
<li class="chapter" data-level="16.5" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#interaction"><i class="fa fa-check"></i><b>16.5</b> Interaction</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>16.5.1</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="16.5.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#plotting-interactions"><i class="fa fa-check"></i><b>16.5.2</b> Plotting Interactions</a></li>
<li class="chapter" data-level="16.5.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#check-linearity-assumption"><i class="fa fa-check"></i><b>16.5.3</b> Check linearity assumption</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#collinearity"><i class="fa fa-check"></i><b>16.6</b> Collinearity</a></li>
<li class="chapter" data-level="16.7" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#problems-with-the-error"><i class="fa fa-check"></i><b>16.7</b> Problems with the Error</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#generalized-least-squares"><i class="fa fa-check"></i><b>16.7.1</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="16.7.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>16.7.2</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="16.7.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#robust-regression"><i class="fa fa-check"></i><b>16.7.3</b> Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#shrinkage-methods"><i class="fa fa-check"></i><b>16.8</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#principal-components-analzsis"><i class="fa fa-check"></i><b>16.8.1</b> Principal Components Analzsis</a></li>
<li class="chapter" data-level="16.8.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#partial-least-squares"><i class="fa fa-check"></i><b>16.8.2</b> Partial Least Squares</a></li>
<li class="chapter" data-level="16.8.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>16.8.3</b> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>17</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-9"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>17.1.1</b> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li class="chapter" data-level="17.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#more-fundamental-problem-outside-01"><i class="fa fa-check"></i><b>17.1.2</b> More fundamental problem outside [0,1]</a></li>
<li class="chapter" data-level="17.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-model"><i class="fa fa-check"></i><b>17.1.3</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="17.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-of-the-logistic-model"><i class="fa fa-check"></i><b>17.1.4</b> Estimation of the Logistic Model</a></li>
<li class="chapter" data-level="17.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#convergence-problems"><i class="fa fa-check"></i><b>17.1.5</b> Convergence Problems</a></li>
<li class="chapter" data-level="17.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#use-exact-methods."><i class="fa fa-check"></i><b>17.1.6</b> Use exact methods.</a></li>
<li class="chapter" data-level="17.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#use-penalized-likelihood"><i class="fa fa-check"></i><b>17.1.7</b> Use penalized likelihood</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-modell"><i class="fa fa-check"></i><b>17.2</b> Logit Modell</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-10"><i class="fa fa-check"></i><b>17.2.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-9"><i class="fa fa-check"></i><b>17.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="17.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-7"><i class="fa fa-check"></i><b>17.2.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="17.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#multicollinearity"><i class="fa fa-check"></i><b>17.2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="17.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance"><i class="fa fa-check"></i><b>17.2.5</b> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li class="chapter" data-level="17.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.2.6</b> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="17.2.7" data-path="logistic-regression.html"><a href="logistic-regression.html#statistics-measuring-predictive-power-r2"><i class="fa fa-check"></i><b>17.2.7</b> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="17.2.8" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>17.2.8</b> ROC Curves</a></li>
<li class="chapter" data-level="17.2.9" data-path="logistic-regression.html"><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics"><i class="fa fa-check"></i><b>17.2.9</b> Predicted Values, Residuals, and Influence Statistics</a></li>
<li class="chapter" data-level="17.2.10" data-path="logistic-regression.html"><a href="logistic-regression.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>17.2.10</b> Unobserved Heterogeneity</a></li>
<li class="chapter" data-level="17.2.11" data-path="logistic-regression.html"><a href="logistic-regression.html#plotting-effects-of-predictor-variables"><i class="fa fa-check"></i><b>17.2.11</b> Plotting Effects of Predictor Variables</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="logistic-regression.html"><a href="logistic-regression.html#probit-modell"><i class="fa fa-check"></i><b>17.3</b> Probit Modell</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-11"><i class="fa fa-check"></i><b>17.3.1</b> Introduction</a></li>
<li class="chapter" data-level="17.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation"><i class="fa fa-check"></i><b>17.3.2</b> R Implemetation</a></li>
<li class="chapter" data-level="17.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-8"><i class="fa fa-check"></i><b>17.3.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="logistic-regression.html"><a href="logistic-regression.html#complementary-log-log-modell"><i class="fa fa-check"></i><b>17.4</b> Complementary log-log-Modell</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation-1"><i class="fa fa-check"></i><b>17.4.1</b> R Implemetation</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multi-category-logit-model"><i class="fa fa-check"></i><b>17.5</b> Multi-category logit model</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomialverteilung"><i class="fa fa-check"></i><b>17.5.1</b> Multinomialverteilung</a></li>
<li class="chapter" data-level="17.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#mehrkategoriales-logit-modell"><i class="fa fa-check"></i><b>17.5.2</b> Mehrkategoriales Logit-Modell</a></li>
<li class="chapter" data-level="17.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-10"><i class="fa fa-check"></i><b>17.5.3</b> R Implementation</a></li>
<li class="chapter" data-level="17.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-9"><i class="fa fa-check"></i><b>17.5.4</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="logistic-regression.html"><a href="logistic-regression.html#ordinal-cumulative-logit-model"><i class="fa fa-check"></i><b>17.6</b> Ordinal Cumulative Logit Model</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-11"><i class="fa fa-check"></i><b>17.6.1</b> R Implementation</a></li>
<li class="chapter" data-level="17.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-10"><i class="fa fa-check"></i><b>17.6.2</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="logistic-regression.html"><a href="logistic-regression.html#adjacent-categories-model"><i class="fa fa-check"></i><b>17.7</b> Adjacent Categories Model</a></li>
<li class="chapter" data-level="17.8" data-path="logistic-regression.html"><a href="logistic-regression.html#continuation-ratio-model"><i class="fa fa-check"></i><b>17.8</b> Continuation Ratio Model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html"><i class="fa fa-check"></i><b>18</b> Advanced Logistic Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.1</b> Logit Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table"><i class="fa fa-check"></i><b>18.1.1</b> Two-Way Table</a></li>
<li class="chapter" data-level="18.1.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#three-way-table"><i class="fa fa-check"></i><b>18.1.2</b> Three-Way Table</a></li>
<li class="chapter" data-level="18.1.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#four-way-table"><i class="fa fa-check"></i><b>18.1.3</b> Four-Way Table</a></li>
<li class="chapter" data-level="18.1.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#overdispersion"><i class="fa fa-check"></i><b>18.1.4</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.2</b> Loglinear Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table-1"><i class="fa fa-check"></i><b>18.2.1</b> Two-way Table</a></li>
<li class="chapter" data-level="18.2.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#problem-of-zeros"><i class="fa fa-check"></i><b>18.2.2</b> Problem of Zeros</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#discrete-choice-analysis"><i class="fa fa-check"></i><b>18.3</b> Discrete Choice Analysis</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logistic-strata"><i class="fa fa-check"></i><b>18.3.1</b> Logistic Strata</a></li>
<li class="chapter" data-level="18.3.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#conditional-logit-model"><i class="fa fa-check"></i><b>18.3.2</b> Conditional logit model</a></li>
<li class="chapter" data-level="18.3.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#ranked-data"><i class="fa fa-check"></i><b>18.3.3</b> Ranked Data</a></li>
<li class="chapter" data-level="18.3.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model"><i class="fa fa-check"></i><b>18.3.4</b> Heteroscedastic extreme value (HEV) Model</a></li>
<li class="chapter" data-level="18.3.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#nested-logit-model"><i class="fa fa-check"></i><b>18.3.5</b> Nested logit model</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data"><i class="fa fa-check"></i><b>18.4</b> Longitudinal and Other Clustered Data</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#introduction-12"><i class="fa fa-check"></i><b>18.4.1</b> Introduction</a></li>
<li class="chapter" data-level="18.4.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#robust-standard-errors"><i class="fa fa-check"></i><b>18.4.2</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="18.4.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod"><i class="fa fa-check"></i><b>18.4.3</b> GEE Estimation with PROC GENMOD</a></li>
<li class="chapter" data-level="18.4.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix"><i class="fa fa-check"></i><b>18.4.4</b> Mixed Models with PROC GLIMMIX</a></li>
<li class="chapter" data-level="18.4.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression"><i class="fa fa-check"></i><b>18.4.5</b> Fixed-Effects with Conditional Logistic Regression</a></li>
<li class="chapter" data-level="18.4.6" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#hybrid-method"><i class="fa fa-check"></i><b>18.4.6</b> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>19</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="survival-analysis.html"><a href="survival-analysis.html#preliminary"><i class="fa fa-check"></i><b>19.1</b> Preliminary</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="survival-analysis.html"><a href="survival-analysis.html#probability-density-function"><i class="fa fa-check"></i><b>19.1.1</b> Probability density function</a></li>
<li class="chapter" data-level="19.1.2" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-distribution-function"><i class="fa fa-check"></i><b>19.1.2</b> Cumulative distribution function</a></li>
<li class="chapter" data-level="19.1.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-function"><i class="fa fa-check"></i><b>19.1.3</b> Survival function</a></li>
<li class="chapter" data-level="19.1.4" data-path="survival-analysis.html"><a href="survival-analysis.html#hazard-function"><i class="fa fa-check"></i><b>19.1.4</b> Hazard function</a></li>
<li class="chapter" data-level="19.1.5" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-hazard-function"><i class="fa fa-check"></i><b>19.1.5</b> Cumulative hazard function</a></li>
<li class="chapter" data-level="19.1.6" data-path="survival-analysis.html"><a href="survival-analysis.html#mean-residual-life"><i class="fa fa-check"></i><b>19.1.6</b> Mean Residual Life</a></li>
<li class="chapter" data-level="19.1.7" data-path="survival-analysis.html"><a href="survival-analysis.html#relation-between-functions"><i class="fa fa-check"></i><b>19.1.7</b> Relation between functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>19.2</b> Kaplan-Meier estimator</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="survival-analysis.html"><a href="survival-analysis.html#km-introduction"><i class="fa fa-check"></i><b>19.2.1</b> KM Introduction</a></li>
<li class="chapter" data-level="19.2.2" data-path="survival-analysis.html"><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function"><i class="fa fa-check"></i><b>19.2.2</b> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li class="chapter" data-level="19.2.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-curve-in-sas"><i class="fa fa-check"></i><b>19.2.3</b> Survival curve in SAS</a></li>
<li class="chapter" data-level="19.2.4" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-sas"><i class="fa fa-check"></i><b>19.2.4</b> KM Survival Plots in SAS</a></li>
<li class="chapter" data-level="19.2.5" data-path="survival-analysis.html"><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r"><i class="fa fa-check"></i><b>19.2.5</b> Convert Personal-level to Personal-period in R</a></li>
<li class="chapter" data-level="19.2.6" data-path="survival-analysis.html"><a href="survival-analysis.html#package-survfit-in-r"><i class="fa fa-check"></i><b>19.2.6</b> Package survfit in R</a></li>
<li class="chapter" data-level="19.2.7" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-r"><i class="fa fa-check"></i><b>19.2.7</b> KM Survival Plots in R</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="survival-analysis.html"><a href="survival-analysis.html#compare-the-survival-function"><i class="fa fa-check"></i><b>19.3</b> Compare the survival function</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="survival-analysis.html"><a href="survival-analysis.html#tests-of-equality-of-the-survival-function"><i class="fa fa-check"></i><b>19.3.1</b> Tests of equality of the survival function</a></li>
<li class="chapter" data-level="19.3.2" data-path="survival-analysis.html"><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement"><i class="fa fa-check"></i><b>19.3.2</b> Other nonparametric tests for STRATA statement</a></li>
<li class="chapter" data-level="19.3.3" data-path="survival-analysis.html"><a href="survival-analysis.html#multiple-comparisons"><i class="fa fa-check"></i><b>19.3.3</b> Multiple comparisons</a></li>
<li class="chapter" data-level="19.3.4" data-path="survival-analysis.html"><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr"><i class="fa fa-check"></i><b>19.3.4</b> Comparing survival functions using Log-Rank HR</a></li>
<li class="chapter" data-level="19.3.5" data-path="survival-analysis.html"><a href="survival-analysis.html#mantel-haenszel-hr"><i class="fa fa-check"></i><b>19.3.5</b> Mantel-Haenszel HR</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>19.4</b> Cox Proportional Hazards Model</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-13"><i class="fa fa-check"></i><b>19.4.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html"><i class="fa fa-check"></i><b>20</b> Advanced Survival Analysis</a></li>
<li class="chapter" data-level="21" data-path="count-data-regression.html"><a href="count-data-regression.html"><i class="fa fa-check"></i><b>21</b> Count Data Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="count-data-regression.html"><a href="count-data-regression.html#introduction-of-count-data-regression"><i class="fa fa-check"></i><b>21.1</b> Introduction of Count Data Regression</a></li>
<li class="chapter" data-level="21.2" data-path="count-data-regression.html"><a href="count-data-regression.html#poisson-regression"><i class="fa fa-check"></i><b>21.2</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model"><i class="fa fa-check"></i><b>21.2.1</b> Model</a></li>
<li class="chapter" data-level="21.2.2" data-path="count-data-regression.html"><a href="count-data-regression.html#interpretation-of-estimated-coefficients"><i class="fa fa-check"></i><b>21.2.2</b> Interpretation of Estimated Coefficients</a></li>
<li class="chapter" data-level="21.2.3" data-path="count-data-regression.html"><a href="count-data-regression.html#overdispersion-1"><i class="fa fa-check"></i><b>21.2.3</b> Overdispersion</a></li>
<li class="chapter" data-level="21.2.4" data-path="count-data-regression.html"><a href="count-data-regression.html#adjustment-for-varying-time-spans"><i class="fa fa-check"></i><b>21.2.4</b> Adjustment for Varying Time Spans</a></li>
<li class="chapter" data-level="21.2.5" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-using-proc-genmod"><i class="fa fa-check"></i><b>21.2.5</b> SAS implementation using PROC GENMOD</a></li>
<li class="chapter" data-level="21.2.6" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-12"><i class="fa fa-check"></i><b>21.2.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="count-data-regression.html"><a href="count-data-regression.html#negative-binomial-regression"><i class="fa fa-check"></i><b>21.3</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-1"><i class="fa fa-check"></i><b>21.3.1</b> Model</a></li>
<li class="chapter" data-level="21.3.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-11"><i class="fa fa-check"></i><b>21.3.2</b> SAS implementation</a></li>
<li class="chapter" data-level="21.3.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-13"><i class="fa fa-check"></i><b>21.3.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-truncated-poisson-regression-model"><i class="fa fa-check"></i><b>21.4</b> Zero-truncated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-2"><i class="fa fa-check"></i><b>21.4.1</b> Model</a></li>
<li class="chapter" data-level="21.4.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-12"><i class="fa fa-check"></i><b>21.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="21.4.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-14"><i class="fa fa-check"></i><b>21.4.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-insflated-model"><i class="fa fa-check"></i><b>21.5</b> Zero-Insflated Model</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-3"><i class="fa fa-check"></i><b>21.5.1</b> Model</a></li>
<li class="chapter" data-level="21.5.2" data-path="count-data-regression.html"><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1"><i class="fa fa-check"></i><b>21.5.2</b> Interpretation of Estimated Coefficients</a></li>
<li class="chapter" data-level="21.5.3" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-13"><i class="fa fa-check"></i><b>21.5.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="21.5.4" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-15"><i class="fa fa-check"></i><b>21.5.4</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="count-data-regression.html"><a href="count-data-regression.html#hurdle-models"><i class="fa fa-check"></i><b>21.6</b> Hurdle models</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-4"><i class="fa fa-check"></i><b>21.6.1</b> Model</a></li>
<li class="chapter" data-level="21.6.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-14"><i class="fa fa-check"></i><b>21.6.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="21.6.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-16"><i class="fa fa-check"></i><b>21.6.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html"><i class="fa fa-check"></i><b>22</b> Proportion Response Regression</a>
<ul>
<li class="chapter" data-level="22.1" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#beta-regression"><i class="fa fa-check"></i><b>22.1</b> Beta Regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#model-5"><i class="fa fa-check"></i><b>22.1.1</b> Model</a></li>
<li class="chapter" data-level="22.1.2" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#sas-implementation-15"><i class="fa fa-check"></i><b>22.1.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.1.3" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#r-implementation-betareg"><i class="fa fa-check"></i><b>22.1.3</b> R Implementation “betareg”</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#zero-inflated-beta-regression"><i class="fa fa-check"></i><b>22.2</b> Zero-inflated Beta Regression</a></li>
<li class="chapter" data-level="22.3" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#one-inflated-beta-regression"><i class="fa fa-check"></i><b>22.3</b> One-inflated Beta Regression</a></li>
<li class="chapter" data-level="22.4" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#zero-one-inflated-beta-regression"><i class="fa fa-check"></i><b>22.4</b> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="mixed-model.html"><a href="mixed-model.html"><i class="fa fa-check"></i><b>23</b> Mixed Model</a>
<ul>
<li class="chapter" data-level="23.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-14"><i class="fa fa-check"></i><b>23.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="mixed-model.html"><a href="mixed-model.html#correlated-response-data"><i class="fa fa-check"></i><b>23.1.1</b> Correlated response data</a></li>
<li class="chapter" data-level="23.1.2" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-and-marginal-model"><i class="fa fa-check"></i><b>23.1.2</b> Hierarchical and Marginal model</a></li>
<li class="chapter" data-level="23.1.3" data-path="mixed-model.html"><a href="mixed-model.html#mle-in-marginal-model"><i class="fa fa-check"></i><b>23.1.3</b> MLE in Marginal model</a></li>
<li class="chapter" data-level="23.1.4" data-path="mixed-model.html"><a href="mixed-model.html#reml-in-marginal-model"><i class="fa fa-check"></i><b>23.1.4</b> REML in Marginal model</a></li>
<li class="chapter" data-level="23.1.5" data-path="mixed-model.html"><a href="mixed-model.html#variance-correction"><i class="fa fa-check"></i><b>23.1.5</b> Variance correction</a></li>
<li class="chapter" data-level="23.1.6" data-path="mixed-model.html"><a href="mixed-model.html#hypothesis-tests"><i class="fa fa-check"></i><b>23.1.6</b> Hypothesis tests</a></li>
<li class="chapter" data-level="23.1.7" data-path="mixed-model.html"><a href="mixed-model.html#residual-structure"><i class="fa fa-check"></i><b>23.1.7</b> Residual Structure</a></li>
<li class="chapter" data-level="23.1.8" data-path="mixed-model.html"><a href="mixed-model.html#converge-problems"><i class="fa fa-check"></i><b>23.1.8</b> Converge problems</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model"><i class="fa fa-check"></i><b>23.2</b> Random Slope and Intercept Model</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction"><i class="fa fa-check"></i><b>23.2.1</b> Model Introduction</a></li>
<li class="chapter" data-level="23.2.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-16"><i class="fa fa-check"></i><b>23.2.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="23.2.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-17"><i class="fa fa-check"></i><b>23.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model-with-covariance-structure"><i class="fa fa-check"></i><b>23.3</b> Random Slope and Intercept Model with Covariance Structure</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction-1"><i class="fa fa-check"></i><b>23.3.1</b> Model Introduction</a></li>
<li class="chapter" data-level="23.3.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-17"><i class="fa fa-check"></i><b>23.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="23.3.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-18"><i class="fa fa-check"></i><b>23.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="mixed-model.html"><a href="mixed-model.html#generalized-estimating-equation"><i class="fa fa-check"></i><b>23.4</b> Generalized Estimating Equation</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-of-gee"><i class="fa fa-check"></i><b>23.4.1</b> Introduction of GEE</a></li>
<li class="chapter" data-level="23.4.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-18"><i class="fa fa-check"></i><b>23.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="23.4.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-19"><i class="fa fa-check"></i><b>23.4.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-regression-model-for-normal-response"><i class="fa fa-check"></i><b>23.5</b> Hierarchical Regression Model for Normal Response</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-15"><i class="fa fa-check"></i><b>23.5.1</b> Introduction</a></li>
<li class="chapter" data-level="23.5.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-19"><i class="fa fa-check"></i><b>23.5.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="23.5.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-20"><i class="fa fa-check"></i><b>23.5.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="generalized-linear-mixed-model.html"><a href="generalized-linear-mixed-model.html"><i class="fa fa-check"></i><b>24</b> Generalized Linear (Mixed) Model</a></li>
<li class="chapter" data-level="25" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>25</b> Meta Analysis</a>
<ul>
<li class="chapter" data-level="25.1" data-path="meta-analysis.html"><a href="meta-analysis.html#introduction-16"><i class="fa fa-check"></i><b>25.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-for-different-data"><i class="fa fa-check"></i><b>25.1.1</b> meta-analysis for different data</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes"><i class="fa fa-check"></i><b>25.2</b> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="meta-analysis.html"><a href="meta-analysis.html#effect-measures"><i class="fa fa-check"></i><b>25.2.1</b> Effect Measures</a></li>
<li class="chapter" data-level="25.2.2" data-path="meta-analysis.html"><a href="meta-analysis.html#standardized-mean-difference"><i class="fa fa-check"></i><b>25.2.2</b> Standardized Mean Difference</a></li>
<li class="chapter" data-level="25.2.3" data-path="meta-analysis.html"><a href="meta-analysis.html#inverse-variance-weighted-average-method"><i class="fa fa-check"></i><b>25.2.3</b> Inverse variance-weighted average method</a></li>
<li class="chapter" data-level="25.2.4" data-path="meta-analysis.html"><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen"><i class="fa fa-check"></i><b>25.2.4</b> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li class="chapter" data-level="25.2.5" data-path="meta-analysis.html"><a href="meta-analysis.html#weighted-sum-of-z-scores"><i class="fa fa-check"></i><b>25.2.5</b> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="meta-analysis.html"><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes"><i class="fa fa-check"></i><b>25.3</b> Random Effects Model for Continuous Outcomes</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="meta-analysis.html"><a href="meta-analysis.html#introduction-17"><i class="fa fa-check"></i><b>25.3.1</b> Introduction</a></li>
<li class="chapter" data-level="25.3.2" data-path="meta-analysis.html"><a href="meta-analysis.html#implementation"><i class="fa fa-check"></i><b>25.3.2</b> Implementation</a></li>
<li class="chapter" data-level="25.3.3" data-path="meta-analysis.html"><a href="meta-analysis.html#hartung-knapp-adjustment"><i class="fa fa-check"></i><b>25.3.3</b> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-regression"><i class="fa fa-check"></i><b>25.4</b> Meta-Regression</a></li>
<li class="chapter" data-level="25.5" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-with-binary-outcomes"><i class="fa fa-check"></i><b>25.5</b> Meta-Analysis with Binary Outcomes</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="meta-analysis.html"><a href="meta-analysis.html#effect-measures-1"><i class="fa fa-check"></i><b>25.5.1</b> Effect Measures</a></li>
<li class="chapter" data-level="25.5.2" data-path="meta-analysis.html"><a href="meta-analysis.html#implementation-1"><i class="fa fa-check"></i><b>25.5.2</b> Implementation</a></li>
<li class="chapter" data-level="25.5.3" data-path="meta-analysis.html"><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction"><i class="fa fa-check"></i><b>25.5.3</b> Estimation in Sparse Data - Continuity correction</a></li>
<li class="chapter" data-level="25.5.4" data-path="meta-analysis.html"><a href="meta-analysis.html#peto-odds-ratio"><i class="fa fa-check"></i><b>25.5.4</b> Peto Odds Ratio</a></li>
<li class="chapter" data-level="25.5.5" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method"><i class="fa fa-check"></i><b>25.5.5</b> Fixed Effect Model: Inverse Variance Method</a></li>
<li class="chapter" data-level="25.5.6" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method"><i class="fa fa-check"></i><b>25.5.6</b> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li class="chapter" data-level="25.5.7" data-path="meta-analysis.html"><a href="meta-analysis.html#random-effects-model"><i class="fa fa-check"></i><b>25.5.7</b> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html"><i class="fa fa-check"></i><b>26</b> Group (Adaptive) Sequential Design</a>
<ul>
<li class="chapter" data-level="26.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#classical-designs-without-futility-stopping"><i class="fa fa-check"></i><b>26.1</b> Classical Designs without futility stopping</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#pocock-method"><i class="fa fa-check"></i><b>26.1.1</b> Pocock Method</a></li>
<li class="chapter" data-level="26.1.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#obrien-fleming-method"><i class="fa fa-check"></i><b>26.1.2</b> O’Brien &amp; Fleming Method</a></li>
<li class="chapter" data-level="26.1.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#wang-tsiatis-method"><i class="fa fa-check"></i><b>26.1.3</b> Wang &amp; Tsiatis Method</a></li>
<li class="chapter" data-level="26.1.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#rejection-bounds-and-local-p-values"><i class="fa fa-check"></i><b>26.1.4</b> Rejection bounds and Local p-values</a></li>
<li class="chapter" data-level="26.1.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#power-and-sample-size"><i class="fa fa-check"></i><b>26.1.5</b> Power and Sample size</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#classical-designs-with-binding-futility-stopping"><i class="fa fa-check"></i><b>26.2</b> Classical Designs with binding futility stopping</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#symmetric-designs"><i class="fa fa-check"></i><b>26.2.1</b> Symmetric designs</a></li>
<li class="chapter" data-level="26.2.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#one-sided-designs"><i class="fa fa-check"></i><b>26.2.2</b> One-Sided Designs</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#alpha-spending-function-approach"><i class="fa fa-check"></i><b>26.3</b> Alpha Spending Function Approach</a></li>
<li class="chapter" data-level="26.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#r-implementation-using-rpact"><i class="fa fa-check"></i><b>26.4</b> R Implementation using rpact</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#basic-functions"><i class="fa fa-check"></i><b>26.4.1</b> Basic Functions</a></li>
<li class="chapter" data-level="26.4.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries"><i class="fa fa-check"></i><b>26.4.2</b> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
<li class="chapter" data-level="26.4.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#futilitybounds-defining-futility-boundaries"><i class="fa fa-check"></i><b>26.4.3</b> <code>futilityBounds</code> defining futility boundaries</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#sample-size"><i class="fa fa-check"></i><b>26.5</b> Sample Size</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia"><i class="fa fa-check"></i><b>26.5.1</b> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li class="chapter" data-level="26.5.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#two-groups-continuous-endpoint-without-ia"><i class="fa fa-check"></i><b>26.5.2</b> Two groups continuous endpoint (without IA)</a></li>
<li class="chapter" data-level="26.5.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#two-groups-binary-endpoint-without-ia"><i class="fa fa-check"></i><b>26.5.3</b> Two groups binary endpoint (without IA)</a></li>
<li class="chapter" data-level="26.5.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#group-sequential-designs-for-conti-and-binary"><i class="fa fa-check"></i><b>26.5.4</b> Group-sequential designs for conti and binary</a></li>
<li class="chapter" data-level="26.5.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#survival-endpoint"><i class="fa fa-check"></i><b>26.5.5</b> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="adaptive-designs.html"><a href="adaptive-designs.html"><i class="fa fa-check"></i><b>27</b> Adaptive designs</a>
<ul>
<li class="chapter" data-level="27.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#introduction-18"><i class="fa fa-check"></i><b>27.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#early-termination-due-to-futility"><i class="fa fa-check"></i><b>27.1.1</b> Early termination due to futility</a></li>
<li class="chapter" data-level="27.1.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#early-termination-due-to-efficacy"><i class="fa fa-check"></i><b>27.1.2</b> Early termination due to efficacy</a></li>
<li class="chapter" data-level="27.1.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#sample-size-reassessment"><i class="fa fa-check"></i><b>27.1.3</b> Sample size reassessment</a></li>
<li class="chapter" data-level="27.1.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint"><i class="fa fa-check"></i><b>27.1.4</b> Change or modification of the primary endpoint</a></li>
<li class="chapter" data-level="27.1.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#discontinuing-treatment-arms"><i class="fa fa-check"></i><b>27.1.5</b> Discontinuing treatment arms</a></li>
<li class="chapter" data-level="27.1.6" data-path="adaptive-designs.html"><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority"><i class="fa fa-check"></i><b>27.1.6</b> Switching between superiority and non-inferiority</a></li>
<li class="chapter" data-level="27.1.7" data-path="adaptive-designs.html"><a href="adaptive-designs.html#selection-of-the-patient-population"><i class="fa fa-check"></i><b>27.1.7</b> Selection of the patient population</a></li>
<li class="chapter" data-level="27.1.8" data-path="adaptive-designs.html"><a href="adaptive-designs.html#methods"><i class="fa fa-check"></i><b>27.1.8</b> Methods</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#general-theory"><i class="fa fa-check"></i><b>27.2</b> General Theory</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#stopping-boundary"><i class="fa fa-check"></i><b>27.2.1</b> Stopping Boundary</a></li>
<li class="chapter" data-level="27.2.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#power-and-adjusted-p-value"><i class="fa fa-check"></i><b>27.2.2</b> Power and Adjusted p-value</a></li>
<li class="chapter" data-level="27.2.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#stopping-probabilities-design-evaluation"><i class="fa fa-check"></i><b>27.2.3</b> Stopping Probabilities (Design Evaluation)</a></li>
<li class="chapter" data-level="27.2.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation"><i class="fa fa-check"></i><b>27.2.4</b> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li class="chapter" data-level="27.2.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation"><i class="fa fa-check"></i><b>27.2.5</b> Expected Sample Sizes (Design Evaluation)</a></li>
<li class="chapter" data-level="27.2.6" data-path="adaptive-designs.html"><a href="adaptive-designs.html#conditional-power-and-futility-index"><i class="fa fa-check"></i><b>27.2.6</b> Conditional Power and futility index</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-with-direct-combination-of-p-values"><i class="fa fa-check"></i><b>27.3</b> Method with Direct Combination of p-values</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-based-on-individual-p-values"><i class="fa fa-check"></i><b>27.3.1</b> Method Based on Individual p-values</a></li>
<li class="chapter" data-level="27.3.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values"><i class="fa fa-check"></i><b>27.3.2</b> Method Based on the Sum of p-values</a></li>
<li class="chapter" data-level="27.3.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-with-product-of-p-values"><i class="fa fa-check"></i><b>27.3.3</b> Method with Product of p-values</a></li>
<li class="chapter" data-level="27.3.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#fishers-product-test-combination-tests"><i class="fa fa-check"></i><b>27.3.4</b> Fisher’s product test (Combination Tests)</a></li>
<li class="chapter" data-level="27.3.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#fishers-product-test-with-early-rej.-and-acceptance"><i class="fa fa-check"></i><b>27.3.5</b> Fisher’s product test with early rej. and acceptance</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#inverse-normal-combination-function"><i class="fa fa-check"></i><b>27.4</b> Inverse normal combination function</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="propensity-score.html"><a href="propensity-score.html"><i class="fa fa-check"></i><b>28</b> Propensity Score</a></li>
<li class="chapter" data-level="29" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>29</b> Missing Data</a>
<ul>
<li class="chapter" data-level="29.1" data-path="missing-data.html"><a href="missing-data.html#missing-mechanisms"><i class="fa fa-check"></i><b>29.1</b> Missing mechanisms</a></li>
<li class="chapter" data-level="29.2" data-path="missing-data.html"><a href="missing-data.html#compatibility-and-congeniality"><i class="fa fa-check"></i><b>29.2</b> Compatibility and Congeniality</a></li>
<li class="chapter" data-level="29.3" data-path="missing-data.html"><a href="missing-data.html#single-imputation"><i class="fa fa-check"></i><b>29.3</b> Single imputation</a></li>
<li class="chapter" data-level="29.4" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>29.4</b> Multiple imputation</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="missing-data.html"><a href="missing-data.html#joint-modeling-jm"><i class="fa fa-check"></i><b>29.4.1</b> Joint Modeling (JM)</a></li>
<li class="chapter" data-level="29.4.2" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice"><i class="fa fa-check"></i><b>29.4.2</b> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="missing-data.html"><a href="missing-data.html#bayesian-linear-regression"><i class="fa fa-check"></i><b>29.5</b> Bayesian linear regression</a></li>
<li class="chapter" data-level="29.6" data-path="missing-data.html"><a href="missing-data.html#predictive-mean-matching"><i class="fa fa-check"></i><b>29.6</b> Predictive Mean Matching</a></li>
<li class="chapter" data-level="29.7" data-path="missing-data.html"><a href="missing-data.html#mice-using-random-forest"><i class="fa fa-check"></i><b>29.7</b> MICE using random forest</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sample-size-calculation" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Sample Size Calculation</h1>
<div id="htmlwidget-f561a01e83a192cd773d" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-f561a01e83a192cd773d">{"x":{"data":"# \n## Sample Size Calculation\n### Distribution\n#### Quantile Function in SAS\n#### Binomial distribution\n#### Negative binomial distribution\n#### Multinomial distribution\n#### Normal Distribution\n#### Multivariate normal distribution\n#### Poisson distribution\n#### Exponential distribution\n#### Gamma distribution\n#### Weibull Distribution\n#### Beta Distribution\n##### Beta分布及其函数公式推导\n##### Beta 函数和 Gamma 函数\n##### Beta 分布的期望与方差\n### Point Estimates\n### Test Proportion(s)\n#### Binomial CI for Small Samples\n##### Wald CI\n##### Clopper-Pearson or “Exact” CI\n##### Wilson score CI\n##### Adjusted Wald CI\n#### Package binom\n#### %CI_Single_Proportion \n#### Incidence rate CI\n#### Package: pwr\n#### 1-Sample Proportion, 2-Sided Equality based on Wald CI\n#### 1-Sample Proportion Non-Inferiority or Superiority\n#### 1-Sample Proportion Equivalence\n#### 2-Sample Proportions, 2-Sided Equality based on Wald CI\n#### 2-Sample Proportions Non-Inferiority or Superiority\n#### 2-Sample Proportions Equivalence\n#### Paired Proportions: McNemar's Z-test\n#### Chi-square test\n### Test Mean(s)\n#### One Sample Mean 2-Sided Equality\n#### 1-Sample Mean Non-Inferiority or Superiority\n#### 1-Sample Mean Equivalence\n#### 2-Sample Means, 2-Sided Equality\n#### 2-Sample Means, 1-Sided\n#### 2-Sample Means Non-Inferiority or Superiority\n#### 2-Sample Means Equivalence\n#### T-Test using `pwr.t.test` or `pwr.t2n.test`\n#### Test k Means\n#### Anova using `pwr.anova.test`\n#### Average Bioequivalence\n### Other Methods\n#### Odds Ratio\n#### Correlation\n#### Correlated Binary Data: Ophthalmologic Studies\n### Multiple test\n#### Definitions of Power \n#### Bonferroni Tests (Individual Power)\n#### Tukey's method (Individual Power)\n#### Dunnett's Two-Sided Tests (Individual Power)\n#### Combined Power %SimPower and %PlotSimPower\n##### **All Pairwise Comparisons**\n##### **logically constrained step-down tests**\n##### **DUNNETT Comparisons with a Control Two-Sided**\n##### **Step-down Dunnett**\n#### Dunnett Set up Close Tests in R\n### Time-To-Event Data\n#### Cox PH, 2-Sided Equality\n#### Log-Rank Tests for Competing Risks\n### Estimation in diagnostic test \n#### Adequate sensitivity/specificity\n#### Testing sensitivity (or specificity) \n#### Likelihood ratio estimation\n#### ROC index of accuracy","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<p>Using the usual method for determination of the appropriate sample size, the following
items should be specified:</p>
<ul>
<li>a primary endpoint</li>
<li>the applied statistical test</li>
<li>the null and alternative hypothesis</li>
<li>the probability of erroneously rejecting the null hypothesis (the type I error)</li>
<li>the probability of erroneously failing to reject the null hypothesis (the type II error)</li>
<li>the expected drop-out rate</li>
<li>the software used for sample size calculation</li>
<li>assumptions made for the sample size calculation as well as their sources</li>
</ul>
<p>In some instances, such as time-to-event analyses, the event rate is of primary interest for evaluating power, and assumptions should be made to extrapolate from the required number of events to the eventual sample size of the trial.</p>
<div id="distribution" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Distribution</h2>
<div id="quantile-function-in-sas" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Quantile Function in SAS</h3>
<table>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Argument</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bernoulli</td>
<td>BERNOULLI</td>
</tr>
<tr class="even">
<td>Beta</td>
<td>BETA</td>
</tr>
<tr class="odd">
<td>Binomial</td>
<td>BINOMIAL</td>
</tr>
<tr class="even">
<td>Cauchy</td>
<td>CAUCHY</td>
</tr>
<tr class="odd">
<td>Chi-Square</td>
<td>CHISQUARE</td>
</tr>
<tr class="even">
<td>Conway-Maxwell-Poisson</td>
<td>CONMAXPOI</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>EXPONENTIAL</td>
</tr>
<tr class="even">
<td>F</td>
<td>F</td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td>GAMMA</td>
</tr>
<tr class="even">
<td>Generalized Poisson</td>
<td>GENPOISSON</td>
</tr>
<tr class="odd">
<td>Geometric</td>
<td>GEOMETRIC</td>
</tr>
<tr class="even">
<td>Hypergeometric</td>
<td>HYPERGEOMETRIC</td>
</tr>
<tr class="odd">
<td>Laplace</td>
<td>LAPLACE</td>
</tr>
<tr class="even">
<td>Logistic</td>
<td>LOGISTIC</td>
</tr>
<tr class="odd">
<td>Lognormal</td>
<td>LOGNORMAL</td>
</tr>
<tr class="even">
<td>Negative binomial</td>
<td>NEGBINOMIAL</td>
</tr>
<tr class="odd">
<td>Normal</td>
<td>NORMAL|GAUSS</td>
</tr>
<tr class="even">
<td>Normal mixture</td>
<td>NORMALMIX</td>
</tr>
<tr class="odd">
<td>Pareto</td>
<td>PARETO</td>
</tr>
<tr class="even">
<td>Poisson</td>
<td>POISSON</td>
</tr>
<tr class="odd">
<td>T</td>
<td>T</td>
</tr>
<tr class="even">
<td>Tweedie</td>
<td>TWEEDIE</td>
</tr>
<tr class="odd">
<td>Uniform</td>
<td>UNIFORM</td>
</tr>
<tr class="even">
<td>Wald (inverse Gaussian)</td>
<td>WALD|IGAUSS</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td>WEIBULL</td>
</tr>
</tbody>
</table>
<pre><code>data new;                                                                                                                       
   a=quantile(&#39;BERN&#39;, .75, .25);   
   b=quantile(&#39;BETA&#39;, 0.1, 3, 4);    
   c=quantile(&#39;BINOM&#39;, .4, .5, 10);   
   d=quantile(&#39;CAUCHY&#39;, .85);    
   e=quantile(&#39;CHISQ&#39;, .6, 11);     
   f=quantile(&#39;CONMAXPOI&#39;, .2, 2.3, .4);   
   g=quantile(&#39;EXPO&#39;, .6);   
   h=quantile(&#39;F&#39;, .8, 2, 3); 
   i=quantile(&#39;GAMMA&#39;, .4, 3);  
   j=quantile(&#39;GENPOISSON&#39;, .9, 1, .7);   
   k=quantile(&#39;HYPER&#39;, .5, 200, 50, 10);  
   l=quantile(&#39;LAPLACE&#39;, .8);  
   m=quantile(&#39;LOGISTIC&#39;, .7);     
   n=quantile(&#39;LOGNORMAL&#39;, .5);  
   o=quantile(&#39;NEGB&#39;, .5, .5, 2);     
   p=quantile(&#39;NORMAL&#39;, .975);    
   q=quantile(&#39;NORMALMIX&#39;, 0.5, 1, 0.2, 1.1, 0.1);   
   r=quantile(&#39;PARETO&#39;, .01, 1);  
   s=quantile(&#39;POISSON&#39;, .9, 1);    
   t=quantile(&#39;T&#39;, .8, 5);   
   u=quantile(&#39;TWEEDIE&#39;, .8, 5);      
   v=quantile(&#39;UNIFORM&#39;, 0.25);       
   w=quantile(&#39;WALD&#39;, .6, 2);                                                                                                  
   x=quantile(&#39;WEIBULL&#39;, .6, 2); 
run;</code></pre>
</div>
<div id="binomial-distribution" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Binomial distribution</h3>
<p>In probability theory and statistics, the binomial distribution with parameters n and p is the discrete probability distribution of the number of successes in a sequence of n independent experiments, each asking a yes–no question, and each with its own Boolean-valued outcome: success (with probability p) or failure (with probability q = 1 − p).</p>
<p><span class="math display">\[
\begin{array}{l}
f(k, n, p)=\operatorname{Pr}(k ; n, p)=\operatorname{Pr}(X=k)=\left(\begin{array}{l}
n \\
k
\end{array}\right) p^{k}(1-p)^{n-k} \\\\
 \begin{array}{l}
k=0,1,2, \ldots, n, \text { where } \\\\
\left(\begin{array}{l}
n \\
k
\end{array}\right)=\frac{n !}{k !(n-k) !}
\end{array}
\end{array}
\]</span></p>
<p><strong>Expected value and variance</strong></p>
<p><span class="math display">\[{\displaystyle \operatorname {E} (X)=\operatorname {E} (X_{1}+\dotsb +X_{n})=\operatorname {E} (X_{1})+\dotsb +\operatorname {E} (X_{n})=np.}\]</span>
<span class="math display">\[
{\displaystyle {\begin{aligned}\mu &amp;=\sum _{k=0}^{n}k{\binom {n}{k}}p^{k}(1-p)^{n-k}\\&amp;=np\sum _{k=0}^{n}k{\frac {(n-1)!}{(n-k)!k!}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{k=1}^{n}{\frac {(n-1)!}{(n-k)!(k-1)!}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{k=1}^{n}{\binom {n-1}{k-1}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{\ell =0}^{n-1}{\binom {n-1}{\ell }}p^{\ell }(1-p)^{(n-1)-\ell }\quad {\text{mit }}\ell :=k-1\\&amp;=np\sum _{\ell =0}^{m}{\binom {m}{\ell }}p^{\ell }(1-p)^{m-\ell }\qquad {\text{mit }}m:=n-1\\&amp;=np\left(p+\left(1-p\right)\right)^{m}=np1^{m}=np.\end{aligned}}}
\]</span></p>
<p><span class="math display">\[
{\displaystyle \operatorname {Var} (X)=\operatorname {Var} (X_{1}+\dotsb +X_{n})=\operatorname {Var} (X_{1})+\dotsb +\operatorname {Var} (X_{n})=n\operatorname {Var} (X_{1})=np\left(1-p\right)=npq.}
\]</span></p>
<p><span class="math display">\[
\begin{array}{l}
\operatorname{Var}(X)\\=\sum_{k=0}^{n} k^{2} \cdot P(X=k)-(n p)^{2} \\
=\sum_{k=0}^{n} k^{2} \cdot\left(\begin{array}{c}
n \\
k
\end{array}\right) p^{k}(1-p)^{n-k}-n^{2} p^{2} \\
=n^{2} {p}^{2}-n p^{2}+n p-x^{2} p^{2} \\
=n p(1-p)=n p q
\end{array}
\]</span></p>
<pre><code>dbinom(x, size, prob)
pbinom(x, size, prob)
qbinom(p, size, prob)
rbinom(n, size, prob)

x - 是数字的向量
p - 是概率向量
n - 是观察次数
size - 是试验的次数
prob - 是每次试验成功的概率</code></pre>
</div>
<div id="negative-binomial-distribution" class="section level3" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Negative binomial distribution</h3>
<p>满足以下条件的称为负二项分布 <span class="math inline">\(X \sim \mathrm{NB}(r, p)\)</span>
1. 实验包含一系列独立的实验。
2. 每个实验都有成功、失败两种结果。
3. 成功的概率是恒定的。
4. 实验持续到次失败, r可以为任意正数。</p>
<p>Probability mass function
<span class="math display">\[
f(k ; r, p) \equiv \operatorname{Pr}(X=k)=\left(\begin{array}{c}
k+r-1 \\
k
\end{array}\right) p^{r}(1-p)^{k}
\]</span>
The binomial coefficient, and is equal to
<span class="math display">\[
\left(\begin{array}{c}
k+r-1 \\
k
\end{array}\right)=\frac{(k+r-1) !}{(r-1) !(k) !}=\frac{(k+r-1)(k+r-2) \cdots(r)}{(k) !}
\]</span></p>
<ul>
<li><strong>Expectation</strong>: <span class="math inline">\(r /(1-p)-r=r p /(1-p)\)</span>.</li>
<li><strong>Variance</strong>: <span class="math inline">\(r(1-p) / p^{2}\)</span>.</li>
</ul>
</div>
<div id="multinomial-distribution" class="section level3" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Multinomial distribution</h3>
<p><span class="math display">\[
{\displaystyle {\begin{aligned}f(x_{1},\ldots ,x_{k};n,p_{1},\ldots ,p_{k})&amp;{}=\Pr(X_{1}=x_{1}{\text{ and }}\dots {\text{ and }}X_{k}=x_{k})\\&amp;{}={\begin{cases}{\displaystyle {n! \over x_{1}!\cdots x_{k}!}p_{1}^{x_{1}}\times \cdots \times p_{k}^{x_{k}}},\quad &amp;{\text{when }}\sum _{i=1}^{k}x_{i}=n\\\\0&amp;{\text{otherwise,}}\end{cases}}\end{aligned}}}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sample-size-calculation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 其中p, x均为向量，分别代表各试验结果的概率和发生次数</span></span>
<span id="cb3-2"><a href="sample-size-calculation.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## p=c(p1, p2, ..., pk), x=c(x1, x2, ..., xk)</span></span>
<span id="cb3-3"><a href="sample-size-calculation.html#cb3-3" aria-hidden="true" tabindex="-1"></a>multi <span class="ot">&lt;-</span> <span class="cf">function</span>(p, x) {</span>
<span id="cb3-4"><a href="sample-size-calculation.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)                      <span class="do">##试验次数</span></span>
<span id="cb3-5"><a href="sample-size-calculation.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> <span class="fu">prod</span>(p<span class="sc">^</span>x)</span>
<span id="cb3-6"><a href="sample-size-calculation.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">factorial</span>(x))</span>
<span id="cb3-7"><a href="sample-size-calculation.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factorial</span>(n)<span class="sc">*</span>f1<span class="sc">/</span>f2               <span class="do">##返回值</span></span>
<span id="cb3-8"><a href="sample-size-calculation.html#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="sample-size-calculation.html#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="sample-size-calculation.html#cb3-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">71</span>, <span class="dv">35</span>, <span class="dv">72</span>)<span class="sc">/</span><span class="dv">178</span></span>
<span id="cb3-11"><a href="sample-size-calculation.html#cb3-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb3-12"><a href="sample-size-calculation.html#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">multi</span>(p, x)</span></code></pre></div>
<pre><code>## [1] 0.1225009</code></pre>
</div>
<div id="normal-distribution" class="section level3" number="10.1.5">
<h3><span class="header-section-number">10.1.5</span> Normal Distribution</h3>
<p><span class="math display">\[{\displaystyle f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}}\]</span>
<span class="math display">\[
F(x;\mu,\sigma)
=
\frac{1}{\sigma\sqrt{2\pi}}
\int_{-\infty}^x
 \exp
 \left( -\frac{(t - \mu)^2}{2\sigma^2}
\ \right)\, dt.
\]</span></p>
<p><strong>Moment generating function</strong></p>
<p>设 <span class="math inline">\(x\)</span> 为随机变量, 若存在正实数 <span class="math inline">\(h\)</span>, 使得对于 <span class="math inline">\((-h, h)\)</span> 中任一实数 <span class="math inline">\(t, \quad E\left(e^{t \Sigma}\right)\)</span> 均存在, 则称 <span class="math inline">\(m_{x}(t)=E\left(e^{t x}\right)\)</span> 为 <span class="math inline">\(x\)</span> 的矩母函数(moment generating function), 通过它可以比较方便的求出随机变量各阶原点矩,若 <span class="math inline">\(x \sim N\left(\mu, \sigma^{2}\right)\)</span>, 即其概率密度函数为 <span class="math inline">\(f(x)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)\)</span>, 它的矩母函数是
<span class="math display">\[M_{y}(t)=e^{t \mu+t^{2} \sigma^{2} / 2}\]</span></p>
<p><strong>Prove</strong></p>
<p><span class="math display">\[\begin{align}
M_{x}(t)&amp;=\int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}+t x\right) d \\
&amp;=\int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{\left[x-\left(\mu+t \sigma^{2}\right)\right]^{2}}{2 \sigma^{2}}+t \mu+\frac{t^{2} \sigma^{2}}{2}\right) d x \\
&amp;=e^{t \mu+t^{2} \sigma^{2} / 2}
\end{align}\]</span>
注意其中 <span class="math inline">\(\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{\left[x-\left(\mu+t \sigma^{2}\right)\right]^{2}}{2 \sigma^{2}}\right)\)</span> 是 <span class="math inline">\(N\left(\mu+t \sigma^{2}, \sigma^{2}\right)\)</span> 的概率密度函数, 它在 <span class="math inline">\((-\infty, \infty)\)</span>上的积分值为 1</p>
<p><span class="math display">\[M_{x}^{(k)}(0)=E\left(x^{k}\right)\]</span></p>
<p><strong>Prove</strong></p>
<p><span class="math display">\[M_{x}^{(k)}(0)=\int_{-\infty}^{\infty} x^{k} f(x) d x=E\left(x^{k}\right)\]</span></p>
</div>
<div id="multivariate-normal-distribution" class="section level3" number="10.1.6">
<h3><span class="header-section-number">10.1.6</span> Multivariate normal distribution</h3>
<p>The multivariate normal distribution of a k-dimensional random vector <span class="math inline">\(\mathbf{X}=\left(X_{1}, \ldots, X_{k}\right)^{\mathrm{T}}\)</span> can be written in the following notation:
<span class="math display">\[
\mathbf{X} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})
\]</span>
or to make it explicitly known that <span class="math inline">\(\mathrm{X}\)</span> is <span class="math inline">\(\mathrm{k}\)</span> -dimensional.
<span class="math display">\[
\mathbf{X} \sim \mathcal{N}_{k}(\boldsymbol{\mu}, \boldsymbol{\Sigma})
\]</span>
with k-dimensional mean vector
<span class="math display">\[
\boldsymbol{\mu}=\mathrm{E}[\mathbf{X}]=\left(\mathrm{E}\left[X_{1}\right], \mathrm{E}\left[X_{2}\right], \ldots, \mathrm{E}\left[X_{k}\right]\right)^{\mathrm{T}}
\]</span>
and {ldisplaystyle k(times k}k <span class="math inline">\(\mathrm{k}\)</span> covariance matrix
<span class="math display">\[
\Sigma_{i, j}:=\mathrm{E}\left[\left(X_{i}-\mu_{i}\right)\left(X_{j}-\mu_{j}\right)\right]=\operatorname{Cov}\left[X_{i}, X_{j}\right]
\]</span></p>
<p><strong>For the Bivariate case</strong></p>
<p><span class="math display">\[{\displaystyle f(x,y)={\frac {1}{2\pi \sigma _{X}\sigma _{Y}{\sqrt {1-\rho ^{2}}}}}\mathrm {e} ^{-{\frac {1}{2(1-\rho ^{2})}}\left[({\frac {x-\mu _{X}}{\sigma _{X}}})^{2}-2\rho ({\frac {x-\mu _{X}}{\sigma _{X}}})({\frac {y-\mu _{Y}}{\sigma _{Y}}})+({\frac {y-\mu _{Y}}{\sigma _{Y}}})^{2}\right]}}\]</span>
<span class="math display">\[{\displaystyle {\boldsymbol {\mu }}={\begin{pmatrix}\mu _{X}\\\mu _{Y}\end{pmatrix}},\quad {\boldsymbol {\Sigma }}={\begin{pmatrix}\sigma _{X}^{2}&amp;\rho \sigma _{X}\sigma _{Y}\\\rho \sigma _{X}\sigma _{Y}&amp;\sigma _{Y}^{2}\end{pmatrix}}.}\]</span></p>
<p>The <strong>conditional expectation</strong> of <span class="math inline">\(X_1\)</span> given <span class="math inline">\(X_2\)</span> is:
<span class="math display">\[\operatorname{E}(X_1 \mid X_2=x_2) = \mu_1 + \rho \frac{\sigma_1}{\sigma_2}(x_2 - \mu_2)\]</span></p>
</div>
<div id="poisson-distribution" class="section level3" number="10.1.7">
<h3><span class="header-section-number">10.1.7</span> Poisson distribution</h3>
<p>The Poisson distribution is popular for modeling the number of times an event occurs in an interval of time or space.</p>
<p><span class="math display">\[\!f(k;\lambda )=\Pr(X=k)={\frac {\lambda ^{k}e^{-\lambda }}{k!}},\]</span>
<span class="math display">\[\lambda =\operatorname {E} (X)=\operatorname {Var} (X).\]</span></p>
</div>
<div id="exponential-distribution" class="section level3" number="10.1.8">
<h3><span class="header-section-number">10.1.8</span> Exponential distribution</h3>
<blockquote>
<p>指数分布是在泊松点过程中，即事件以恒定的平均速率连续且独立发生的过程中，事件之间时间间隔的概率分布。 这是<strong>伽玛分布的一种特殊情况</strong>。 它是几何分布的连续模拟，并且具有无记忆的关键特性。
从意义来看：指数分布解决的问题是“要等到一个随机事件发生，需要经历多久时间”，伽玛分布解决的问题是“要等到n个随机事件都发生，需要经历多久时间”。</p>
</blockquote>
<p><span class="math display">\[{\displaystyle f(x;\lambda )={\begin{cases}\lambda e^{-\lambda x}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}\]</span></p>
<p>The cumulative distribution function is given by
<span class="math display">\[{\displaystyle F(x;\lambda )={\begin{cases}1-e^{-(\lambda x)}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}{\displaystyle F(x;\lambda )={\begin{cases}1-e^{-(\lambda x)}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}\]</span></p>
<p><strong>Mean, variance, moments and median</strong></p>
<p>The mean or expected value of an exponentially (distributed random variable <span class="math inline">\(X\)</span> with rate parameter <span class="math inline">\(\lambda\)</span>
is given by
<span class="math display">\[
\mathrm{E}[X]=\frac{1}{\lambda}
\]</span>
The variance of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
\operatorname{Var}[X]=\frac{1}{\lambda^{2}}
\]</span>
The moments of <span class="math inline">\(X\)</span>, for <span class="math inline">\(n \in \mathbb{N}\)</span> are given by
<span class="math display">\[
\mathrm{E}\left[X^{n}\right]=\frac{n !}{\lambda^{n}} \cdot \mathrm{E}\left[X^{n}\right]=\frac{n !}{\lambda^{n}}
\]</span>
The median of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
\mathrm{m}[X]=\frac{\ln (2)}{\lambda}&lt;\mathrm{E}[X]
\]</span>
where In refers to the natural logarithm. Thus the absolute difference between the mean and median
is
<span class="math display">\[
|\mathrm{E}[X]-\mathrm{m}[X]|=\frac{1-\ln (2)}{\lambda}&lt;\frac{1}{\lambda}=\sigma[X]
\]</span></p>
</div>
<div id="gamma-distribution" class="section level3" number="10.1.9">
<h3><span class="header-section-number">10.1.9</span> Gamma distribution</h3>
</div>
<div id="weibull-distribution" class="section level3" number="10.1.10">
<h3><span class="header-section-number">10.1.10</span> Weibull Distribution</h3>
</div>
<div id="beta-distribution" class="section level3" number="10.1.11">
<h3><span class="header-section-number">10.1.11</span> Beta Distribution</h3>
<div id="beta分布及其函数公式推导" class="section level4" number="10.1.11.1">
<h4><span class="header-section-number">10.1.11.1</span> Beta分布及其函数公式推导</h4>
</div>
<div id="beta-函数和-gamma-函数" class="section level4" number="10.1.11.2">
<h4><span class="header-section-number">10.1.11.2</span> Beta 函数和 Gamma 函数</h4>
</div>
<div id="beta-分布的期望与方差" class="section level4" number="10.1.11.3">
<h4><span class="header-section-number">10.1.11.3</span> Beta 分布的期望与方差</h4>
</div>
</div>
</div>
<div id="point-estimates" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Point Estimates</h2>
<ol style="list-style-type: decimal">
<li>MLE (Maximum Likelihood Estimate)</li>
<li>LaPlace point estimates</li>
<li>Wilson point estimates</li>
<li>Jeffreys point estimates</li>
</ol>
<p><strong>MLE (Maximum Likelihood Estimate)</strong></p>
<p>MLE是样本比例或成功用户数除以总尝试次数。这是所报告的最常见的点估计。</p>
<p><span class="math display">\[\hat p=x/n\]</span></p>
<p><strong>LaPlace point estimates</strong></p>
<p>一个著名的大样本问题来自拉普拉斯在1800年代初期的开创性工作。他提出了一个问题，即您可以确定明天的太阳会升起，因为您知道过去的5000年（1,825,000天）每天都在升起。您可以确定它会上升，但不能完全确定。太阳可能会爆炸，或者大的小行星可能会将地球粉碎成碎片。为了回答这个问题，他提出了拉普拉斯继承定律，即在分子上加一个，在分母上加两个（（x + 1）/（n + 2））。应用此过程，您将确定99.999945％的明天明天会升起-接近100％，但略微偏离了那个极端。当样本量较小时，调整幅度会更大。</p>
<p><span class="math display">\[\hat p=(x+1)/(n+2)\]</span>
<strong>Wilson point estimates</strong></p>
<p>Wilson’s点估计值是调整后的Wald CI的中点。 它是通过将分子的临界值平方和分子分母的临界值平方相加而得出的。 Wilson’s方法更为保守。</p>
<p><span class="math display">\[\hat p=\frac{x+\frac{1}{2} z^{2}}{n+z^{2}}\]</span></p>
<p><strong>Jeffreys point estimates</strong></p>
<p>Jeffreys（1961）在LaPlace和MLE方法之间进行了折衷。Jeffreys区间是在对二项式比例p使用非信息性Jeffreys之前获得的贝叶斯可信区间。这个问题的Jeffreys先验是带有参数（1/2，1/2）的Beta分布，它是共轭先验。在n次试验中观察到x次成功之后，p的后验分布是带有参数（x + 1/2，n – x + 1/2）的Beta分布。</p>
<p><span class="math display">\[\hat p=(x+0.5)/(n+1)\]</span></p>
</div>
<div id="test-proportions" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Test Proportion(s)</h2>
<div id="binomial-ci-for-small-samples" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Binomial CI for Small Samples</h3>
<div id="wald-ci" class="section level4" number="10.3.1.1">
<h4><span class="header-section-number">10.3.1.1</span> Wald CI</h4>
<p>Wald方法是计算二项式置信区间的最常用公式, 不幸的是，当样本量较小时，尤其是当完成率不接近50％时，它产生的间隔太窄。</p>
<p><span class="math display">\[\hat{p} \pm z_{\alpha / 2} \sqrt{\hat{p}(1-\hat{p}) / n}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sample-size-calculation.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span>
<span id="cb5-2"><a href="sample-size-calculation.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests of proportions</span></span>
<span id="cb5-3"><a href="sample-size-calculation.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="fl">0.65</span>, <span class="fl">0.6</span>), <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1033347
##               n = 1604.007
##       sig.level = 0.05
##           power = 0.9
##     alternative = greater
## 
## NOTE: same sample sizes</code></pre>
</div>
<div id="clopper-pearson-or-exact-ci" class="section level4" number="10.3.1.2">
<h4><span class="header-section-number">10.3.1.2</span> Clopper-Pearson or “Exact” CI</h4>
<p>为了改善Wald区间的较差平均覆盖率，更为复杂的方法，称为Clopper-Pearson或“精确”方法. 精确方法使用小样本可提供更可靠的置信区间（Clopper和Pearson，1934）。但是，在实际实践中，
当标称置信度为95％时，“精确”区间会产生过于保守的置信区间，其真实覆盖率接近99％。
当样本量较小（n &lt;15）时，这种过度保守的性质尤其容易受到伤害（Agresti and Coull，1996）</p>
<p><span class="math display">\[\begin{aligned}
\left[1+\frac{n-x+1}{x F_{2 x, 2(n-x+1), 1-\alpha / 2}}\right]^{-1} &amp; 
&lt;p&lt;\left[1+\frac{n-x}{(x+1) F_{2(x+1), 2(n-x), \alpha / 2}}\right]^{-1}
\end{aligned}\]</span></p>
</div>
<div id="wilson-score-ci" class="section level4" number="10.3.1.3">
<h4><span class="header-section-number">10.3.1.3</span> Wilson score CI</h4>
<p>精确间隔太宽而Wald间隔太窄。第三种方法称为“得分”间隔（Wilson，1927年）并不过分保守，对于标称95％的间隔，其平均覆盖率接近95％。不幸的是，它的计算与精确方法一样繁琐，并且当完成率接近0或1时，它存在一些严重的覆盖问题（Agresti和Coull，1998）</p>
<p><span class="math display">\[\left(\hat{p}+\frac{z_{\alpha / 2}^{2}}{2 n} \pm z_{\alpha / 2} \sqrt{\left[\hat{p}(1-\hat{p})+z_{\alpha / 2}^{2} / 4 n\right] / n}\right) /\left(1+z_{\alpha / 2}^{2} / n\right)\]</span></p>
</div>
<div id="adjusted-wald-ci" class="section level4" number="10.3.1.4">
<h4><span class="header-section-number">10.3.1.4</span> Adjusted Wald CI</h4>
<p>另一种可供选择的方法，由Agresti and Coull. 命名为Adjusted Wald方法，
仅要求在95％的置信区间内，将观察到的完成率加两个成功和两个失败，然后使用Wald公式计算95％的二项式置信区间。
对于大多数p值，它的覆盖范围与Score方法一样好，并且通常在完成率接近0或1时更好。
该方法非常简单，并且在统计文献中已被推荐, 相加两次成功和两次失败”（或分子加上两个，分母增加四个）是从正态分布的临界值中得出的。</p>
<p><span class="math display">\[\frac{\hat{p}+\frac{z_{1-\alpha / 2}^{2}}{2 n}+z_{1-\alpha / 2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{1-\alpha / 2}^{2}}{4 n^{2}}}}{1+\frac{z_{1-\alpha / 2}^{2}}{n}}  &lt; \hat{p} &lt;\frac{\hat{p}+\frac{z_{\alpha / 2}^{2}}{2 n}+z_{\alpha / 2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{\alpha / 2}^{2}}{4 n^{2}}}}{1+\frac{z_{\alpha / 2}^{2}}{n}}\]</span></p>
</div>
</div>
<div id="package-binom" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Package binom</h3>
<p>Package <a href="https://cran.r-project.org/web/packages/binom/binom.pdf">binom</a> can provide different binomial CI and Test such as</p>
<ul>
<li>exact - Pearson-Klopper method. See also binom.test.</li>
<li>asymptotic - the text-book definition for confidence limits on a single proportion using the Central Limit Theorem.</li>
<li>wilson - Wilson method.</li>
<li>prop.test - equivalent to prop.test(x = x, n = n, conf.level = conf.level)$conf.int.</li>
<li>bayes - see binom.bayes.</li>
<li>logit - see binom.logit.</li>
<li>cloglog - see binom.cloglog.</li>
<li>probit - see binom.probit.</li>
<li>profile - see binom.profile.</li>
</ul>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>binom.bayes</td>
<td>Binomial confidence intervals using Bayesian inference</td>
</tr>
<tr class="even">
<td></td>
<td>二项式分布概率上使用beta优先级，从beta的后验确定两侧置信区间。 二项式实验中使用先于p分布（成功概率）的共轭beta，从β后验构造一个置信区间。根据贝叶斯定理，给定数据x的p的后验分布为：p | x〜Beta（x + prior.shape1，n-x +prior.shape2)默认的priority是Jeffrey′sprior，它是Beta（0.5，0.5）分布 。 因此，后验均值为（x +0.5）/（n + 1）。</td>
</tr>
<tr class="odd">
<td>binom.logit</td>
<td>Binomial confidence intervals using the logit parameterization</td>
</tr>
<tr class="even">
<td>binom.probit</td>
<td>Binomial confidence intervals using the probit parameterization</td>
</tr>
<tr class="odd">
<td>binom.cloglog</td>
<td>在观察到的比例上（cloglog）参数化来构造置信区间 The complementary-log-log link function says that <span class="math display">\[\eta(x) = \log(-\log(1-\pi_x))=\mathbf{x}\beta\]</span></td>
</tr>
<tr class="even">
<td>binom.lrt</td>
<td>Binomial confidence intervals using the lrt likelihood – likelihood ratio test (LRT) 置信区间基于对MLE附近的二项式偏差进行分析。</td>
</tr>
<tr class="odd">
<td>binom.profile</td>
<td>Binomial confidence intervals using the profile likelihood 当使用标准方法难以获得准确的间隔估计值时，例如，当对数似然函数的形状高度非正态或有大量麻烦参数时，通常使用轮廓似然.当似然函数具有多个参数时，只关注其中一部分参数，而将其他参数视为常数，此时似然函数就被称为profile likelihood。</td>
</tr>
<tr class="even">
<td>binom.sim</td>
<td>Simulates confidence intervals for binomial data</td>
</tr>
<tr class="odd">
<td>binom.confint</td>
<td>Binomial confidence intervals</td>
</tr>
<tr class="even">
<td>binom.coverage</td>
<td>Probability coverage for binomial confidence intervals</td>
</tr>
<tr class="odd">
<td>binom.plot</td>
<td>Coverage plots for binomial confidence intervals</td>
</tr>
<tr class="even">
<td>binom.length</td>
<td>Expected length for binomial confidence intervals</td>
</tr>
<tr class="odd">
<td>binom.power</td>
<td>Power curves for binomial parameterizations</td>
</tr>
<tr class="even">
<td>cloglog.sample.size</td>
<td>Power and sample size for a binomial proportion using the cloglog parameterization</td>
</tr>
<tr class="odd">
<td>cloglog.sample.size</td>
<td>Power and sample size for a binomial proportion using the cloglog parameterization</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sample-size-calculation.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Which method to use to construct the interval. Any combination of </span></span>
<span id="cb7-2"><a href="sample-size-calculation.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   c(&quot;exact&quot;, &quot;ac&quot;, &quot;asymptotic&quot;, &quot;wilson&quot;, &quot;prop.test&quot;, &quot;bayes&quot;, </span></span>
<span id="cb7-3"><a href="sample-size-calculation.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    &quot;logit&quot;, &quot;cloglog&quot;, &quot;probit&quot;) </span></span>
<span id="cb7-4"><a href="sample-size-calculation.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   is allowed. Default is &quot;all&quot;.</span></span>
<span id="cb7-5"><a href="sample-size-calculation.html#cb7-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-6"><a href="sample-size-calculation.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;binom&quot;</span>)</span>
<span id="cb7-7"><a href="sample-size-calculation.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.confint</span>(<span class="at">x=</span><span class="dv">26</span>, <span class="at">n=</span><span class="dv">79</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">methods =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<pre><code>##           method  x  n      mean     lower     upper
## 1  agresti-coull 26 79 0.3291139 0.2352474 0.4388288
## 2     asymptotic 26 79 0.3291139 0.2254967 0.4327312
## 3          bayes 26 79 0.3312500 0.2304097 0.4344362
## 4        cloglog 26 79 0.3291139 0.2287076 0.4329294
## 5          exact 26 79 0.3291139 0.2274809 0.4439939
## 6          logit 26 79 0.3291139 0.2347861 0.4395694
## 7         probit 26 79 0.3291139 0.2330656 0.4380425
## 8        profile 26 79 0.3291139 0.2321350 0.4370161
## 9            lrt 26 79 0.3291139 0.2321076 0.4370015
## 10     prop.test 26 79 0.3291139 0.2299875 0.4450313
## 11        wilson 26 79 0.3291139 0.2355420 0.4385342</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sample-size-calculation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span>
<span id="cb9-2"><a href="sample-size-calculation.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;binomSamSize&quot;</span>)</span>
<span id="cb9-3"><a href="sample-size-calculation.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="sample-size-calculation.html#cb9-4" aria-hidden="true" tabindex="-1"></a>one_propotion1 <span class="ot">&lt;-</span> <span class="cf">function</span>(seq,p0,h1,corr,power){</span>
<span id="cb9-5"><a href="sample-size-calculation.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p1=</span>seq,<span class="at">p0=</span><span class="fu">rep</span>(p0,<span class="fu">length</span>(seq)))</span>
<span id="cb9-6"><a href="sample-size-calculation.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(seq)) {</span>
<span id="cb9-7"><a href="sample-size-calculation.html#cb9-7" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>n[i] <span class="ot">&lt;-</span> <span class="fu">pwr.p.test</span>(<span class="at">h=</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> seq[i], <span class="at">p2 =</span> p0),<span class="at">power=</span>power,<span class="at">sig.level=</span><span class="fl">0.025</span>,<span class="at">alternative=</span>h1)<span class="sc">$</span>n</span>
<span id="cb9-8"><a href="sample-size-calculation.html#cb9-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-9"><a href="sample-size-calculation.html#cb9-9" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i])</span>
<span id="cb9-10"><a href="sample-size-calculation.html#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="sample-size-calculation.html#cb9-11" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length[i] <span class="ot">&lt;-</span> <span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>wald.ne[i], </span>
<span id="cb9-12"><a href="sample-size-calculation.html#cb9-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;asymptotic&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb9-13"><a href="sample-size-calculation.html#cb9-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-14"><a href="sample-size-calculation.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-15"><a href="sample-size-calculation.html#cb9-15" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne[i] <span class="ot">&lt;-</span> <span class="fu">ciss.agresticoull</span>(seq[i],data<span class="sc">$</span>wd.Length[i], <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb9-16"><a href="sample-size-calculation.html#cb9-16" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length[i] <span class="ot">&lt;-</span> <span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>ac.ne[i], </span>
<span id="cb9-17"><a href="sample-size-calculation.html#cb9-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;ac&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb9-18"><a href="sample-size-calculation.html#cb9-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-19"><a href="sample-size-calculation.html#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="sample-size-calculation.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne.drop[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i]<span class="sc">/</span><span class="fl">0.9</span>)</span>
<span id="cb9-21"><a href="sample-size-calculation.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne.drop[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>ac.ne[i]<span class="sc">/</span><span class="fl">0.9</span>) </span>
<span id="cb9-22"><a href="sample-size-calculation.html#cb9-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-23"><a href="sample-size-calculation.html#cb9-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-24"><a href="sample-size-calculation.html#cb9-24" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ns[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i]<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-25"><a href="sample-size-calculation.html#cb9-25" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ns[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>ac.ne[i]<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-26"><a href="sample-size-calculation.html#cb9-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-27"><a href="sample-size-calculation.html#cb9-27" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>wd.Length[i],<span class="dv">3</span>)</span>
<span id="cb9-28"><a href="sample-size-calculation.html#cb9-28" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>ac.Length[i],<span class="dv">3</span>)</span>
<span id="cb9-29"><a href="sample-size-calculation.html#cb9-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-30"><a href="sample-size-calculation.html#cb9-30" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne.cor[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">+</span>corr)<span class="sc">*</span>data<span class="sc">$</span>n[i])</span>
<span id="cb9-31"><a href="sample-size-calculation.html#cb9-31" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne.cor[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">+</span>corr)<span class="sc">*</span>data<span class="sc">$</span>ac.ne[i])</span>
<span id="cb9-32"><a href="sample-size-calculation.html#cb9-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-33"><a href="sample-size-calculation.html#cb9-33" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length.cor[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>wald.ne.cor[i], </span>
<span id="cb9-34"><a href="sample-size-calculation.html#cb9-34" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;asymptotic&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb9-35"><a href="sample-size-calculation.html#cb9-35" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length.cor[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>ac.ne.cor[i], </span>
<span id="cb9-36"><a href="sample-size-calculation.html#cb9-36" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;ac&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb9-37"><a href="sample-size-calculation.html#cb9-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-38"><a href="sample-size-calculation.html#cb9-38" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)]</span>
<span id="cb9-39"><a href="sample-size-calculation.html#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb9-40"><a href="sample-size-calculation.html#cb9-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-41"><a href="sample-size-calculation.html#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="sample-size-calculation.html#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="fu">one_propotion1</span>(<span class="at">seq=</span><span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.02</span>,<span class="fl">0.005</span>),<span class="at">p0=</span><span class="fl">0.05</span>,<span class="at">h1=</span><span class="st">&quot;less&quot;</span>,<span class="at">corr=</span><span class="fl">0.5</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>##      p1   p0 wald.ne ac.ne wald.ne.drop ac.ne.drop wald.ns ac.ns wd.Length
## 1 0.005 0.05      82   250           92        278      41   125     0.009
## 2 0.010 0.05     125   184          139        205      63    92     0.014
## 3 0.015 0.05     186   210          207        234      93   105     0.016
## 4 0.020 0.05     281   293          312        326     141   147     0.016
##   ac.Length wald.ne.cor ac.ne.cor wd.Length.cor ac.Length.cor
## 1     0.013         123       375         0.008         0.010
## 2     0.020         188       276         0.013         0.015
## 3     0.020         279       315         0.014         0.015
## 4     0.018         421       440         0.013         0.014</code></pre>
</div>
<div id="ci_single_proportion" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> %CI_Single_Proportion</h3>
<ol style="list-style-type: decimal">
<li>Simple asymptotic, Without CC | Wald</li>
<li>Simple asymptotic, With CC</li>
<li>Score method, Without CC | Wilson</li>
<li>Score method, With CC</li>
<li>Binomial-based, ‘Exact’ | Clopper-Pearson</li>
<li>Binomial-based, Mid-p</li>
<li>Likelihood-based</li>
<li>Jeffreys</li>
<li>Agresti-Coull, pseudo frequency, z^2/2 successes| psi = z^2/2</li>
<li>Agresti-Coull, pseudo frequency, 2 successes and 2 fail| psi = 2</li>
<li>Agresti-Coull, pseudo frequency, psi = 1</li>
<li>Agresti-Coull, pseudo frequency, psi = 3</li>
<li>Logit</li>
</ol>
<pre><code>%macro CI_Single_Proportion(r=,n=,alpha=0.05);

proc fcmp outlib=work.func.CI;
   function acceptbin(r, n, p) label = &quot;computes the Blaker acceptability of p when x is observed and X is bin(n, p)&quot;;
        p1 = 1 - CDF(&#39;BINOMIAL&#39;, r - 1,p,n);
        p2 = CDF(&#39;BINOMIAL&#39;, r,p,n);

        a1 = p1 + CDF(&#39;BINOMIAL&#39;, quantile(&#39;BINOM&#39;, p1, p, n)-1,  p, n) ;
        a2 = p2 + 1 -  CDF(&#39;BINOMIAL&#39;, quantile(&#39;BINOM&#39;, 1-p2, p, n),  p, n) ;
        return (min(a1,a2));
   endsub;
run;

options cmplib=work.func;

data param;
    do i=1 to 14;
          r = &amp;r;
          n = &amp;n;
          alpha = &amp;alpha;
          p = r/n;
          q = 1 - p;
          z = probit (1-alpha/2);
    output;
    end; 
run;

/*method 1-5,8-14;*/
data CI5;
    length method $75.;
    set param(where=(i not in (6 7)));

    if i=1 then do;
          Method = &quot;1. Simple asymptotic, Without CC | Wald&quot;;
          se = (sqrt(&amp;n*p*(1-p)))/n; *standard error;
          p_CI_low = p - z * se;
          p_CI_up  = p + z * se;  
    end;

    if i=2 then do;
          Method = &quot;2. Simple asymptotic, With CC&quot;;
          se = (sqrt(&amp;n*p*(1-p)))/n; *standard error;
          cc = 1/(2*&amp;n);             *continuity correction;
          p_CI_low = p - (z * se + cc);
          p_CI_up  = p + (z * se + cc);
          
/*          if r=0 then p_CI_low=0;*/
/*          if r=n then p_CI_up =1;*/
    end;
    
    if i=3 then do;
          Method = &quot;3. Score method, Without CC | Wilson&quot;;
          *n1=2*r+z**2;
          *n2=z*sqrt(z**2+4*r*q);
          *d=2*(n+z**2);
          *p_CI_low = (n1 - n2)/d;
          *p_CI_up = (n1 + n2)/d;

          p_CI_low = ( 2*r+z**2 - (z*sqrt(z**2+4*r*q)) ) / (2*(n+z**2));
          p_CI_up  = ( 2*r+z**2 + (z*sqrt(z**2+4*r*q)) ) / (2*(n+z**2));        
    end;
    
    if i=4 then do;
          Method = &quot;4. Score method, With CC&quot;;
          *n1=2*r+z**2;
          *n12=z*sqrt(z**2 - 2- 1/n + 4*p*(n*q+1));
          *n22=z*sqrt(z**2 + 2- 1/n + 4*p*(n*q-1));
          *d=2*(n+z**2);
          *p_CI_low = ( n1 -1 - n12) / d;
          *p_CI_up  = ( n1 +1 + n22) / d;

          p_CI_low = ( 2*r+z**2 -1 - z*sqrt(z**2 - 2- 1/n + 4*p*(n*q+1))) / (2*(n+z**2));
          p_CI_up  = ( 2*r+z**2 +1 + z*sqrt(z**2 + 2- 1/n + 4*p*(n*q-1))) / (2*(n+z**2));  
          
/*          if r=0 then p_CI_low=0;*/
/*          if r=n then p_CI_up =1;  */
    end;
    
    if i=5 then do;
          Method = &quot;5. Binomial-based, &#39;Exact&#39; | Clopper-Pearson&quot;;
          p_CI_low =1 - betainv(1 - alpha/2,n-r+1,r);
          p_CI_up  =    betainv(1 - alpha/2,r+1  ,n-r);  
          
/*          if r=0 then p_CI_low=0;*/
/*          if r=n then p_CI_up =1;*/
    end;
    
    if i=8 then do;
          Method = &quot;8. Jeffreys&quot;;   
          p_CI_low = betainv(  alpha/2, r+0.5,n-r+0.5);
          p_CI_up  = betainv(1-alpha/2, r+0.5,n-r+0.5);
    end;
    
    if i=9 then do;
          Method = &quot;9. Agresti-Coull, pseudo frequency, z^2/2 successes| psi = z^2/2&quot;;        
          psi = z**2/2;
          p2=(r+psi)/(n+2*psi);       

          p_CI_low =p2 - z*(sqrt(p2*(1-p2)/(n+2*psi)));
          p_CI_up  =p2 + z*(sqrt(p2*(1-p2)/(n+2*psi)));
          
          if p_CI_low&lt;0 then p_CI_low=0;
          if p_CI_up&gt;1  then p_CI_up =1; 
    end;
    
    if i=10 then do;
          Method = &quot;10. Agresti-Coull, pseudo frequency, 2 successes and 2 failures| psi = 2&quot;;

          psi = 2;
          p2=(r+psi)/(n+2*psi);       

          p_CI_low =p2 - z*(sqrt(p2*(1-p2)/(n+2*psi)));
          p_CI_up  =p2 + z*(sqrt(p2*(1-p2)/(n+2*psi)));
          
          if p_CI_low&lt;0 then p_CI_low=0;
          if p_CI_up&gt;1  then p_CI_up =1;
    end;

    if i=11 then do;
          Method = &quot;11. Agresti-Coull, pseudo frequency, psi = 1&quot;;

          psi = 1;
          p2=(r+psi)/(n+2*psi);       

          p_CI_low =p2 - z*(sqrt(p2*(1-p2)/(n+2*psi)));
          p_CI_up  =p2 + z*(sqrt(p2*(1-p2)/(n+2*psi)));
          
          if p_CI_low&lt;0 then p_CI_low=0;
          if p_CI_up&gt;1  then p_CI_up =1;
    end;

    if i=12 then do;
          Method = &quot;12. Agresti-Coull, pseudo frequency, psi = 3&quot;;

          psi = 3;
          p2=(r+psi)/(n+2*psi);       

          p_CI_low =p2 - z*(sqrt(p2*(1-p2)/(n+2*psi)));
          p_CI_up  =p2 + z*(sqrt(p2*(1-p2)/(n+2*psi)));
          
          if p_CI_low&lt;0 then p_CI_low=0;
          if p_CI_up&gt;1  then p_CI_up =1;
    end;
    
    if i=13 then do;
          Method = &quot;13. Logit&quot;;             
          p_CI_low=exp(log(p/(1-p)) - z*sqrt(n/(r*(n-r))))/(1+exp(log(p/(1-p)) - z*sqrt(n/(r*(n-r)))));
          p_CI_up =exp(log(p/(1-p)) + z*sqrt(n/(r*(n-r))))/(1+exp(log(p/(1-p)) + z*sqrt(n/(r*(n-r)))));
    end;

    if i=14 then do;
          Method = &quot;14. Blaker&quot;;  
          tolerance=1e-05;
          lower = 0;
          upper = 1;

          if r ^= 0 then do;
             lower = quantile(&#39;BETA&#39;,alpha/2, r, n-r+1);
             do while (acceptbin(r, n, lower + tolerance) &lt; (alpha));
                   lower = lower + tolerance;
             end;
          end;


          if r ^= n then do;      
            upper = quantile(&#39;BETA&#39;,1 - alpha/2, r+1, n-r);
            do while (acceptbin(r, n, upper - tolerance) &lt; (alpha));
                      upper = upper - tolerance;
            end;
          end; 

          p_CI_low=lower;
          p_CI_up =upper;
    end;
run;

/*method 6;*/
data param6;
    set param(where=(i=6));
    max_idx=alpha/2;
    min_idx=1-alpha/2;

    do j=0.000001 to 0.999999 by 0.00001;
        if (r&gt;0 and r&lt;n) then a2=0.5*probbnml(j,n,r-1) + 0.5*probbnml(j,n,r);
        output;
    end;
run;

proc sql;
    create table max as
        select max(j) as p_CI_up
        from param6     
        where a2 &gt; max_idx and r&gt;0 and r&lt;n
        ;

    create table min as
        select min(j) as p_CI_low
        from param6     
        where a2 &lt;= min_idx and r&gt;0 and r&lt;n
        ;

    create table param6_2 as
        select *
        from param
        where i=6
        ;
quit;

data CI6;
    merge param6_2 min max;
    Method = &quot;6. Binomial-based, Mid-p&quot;;
    
    if r=0 then do;
        p_CI_low=0;
        p_CI_up = 1-alpha**(1/n);
    end;

    if r=n then do;
        p_CI_low=alpha**(1/n);
        p_CI_up = 1;
    end;
run;

/*method 7;*/
data param7;
    set param(where=(i=7));

    k=-cinv(1-alpha,1)/2;

    do j=0.000001 to 0.999999 by 0.00001;
        lik=pdf(&#39;Binomial&#39;,r,j,n);       
        output;
    end;
run;

proc sql;   
    create table max as
        select i,max(lik) as max
        from param7
    ;
quit;

data test1;
    merge param7 max;
    by i;

    if lik ^= 0 then
    logLR = log(lik/max);
run;

proc sql;
    create table max2 as
        select min(j) as p_CI_low,max(j) as p_CI_up
        from test1      
        where logLR&gt;k
        ;

    create table param7_2 as
        select distinct *
        from param
        where i=7
        ;
quit;

data CI7;
    merge param7_2 max2;
    Method = &quot;7. Likelihood-based&quot;;
    
    if r=0 then p_CI_low=0;
    if r=n then p_CI_up =1;
run;

/*put together,1-12;*/
data CI_SP;
    set CI5 CI6 CI7;
    p_CI=compress(catx(&quot;&quot;,&quot;[&quot;,put(round(p_CI_low,0.0001),6.4),&quot;,&quot;,put(round(p_CI_up,0.0001),6.4),&quot;]&quot;));
run;

proc sort; by i;run;
           
proc print data=CI_SP;
    var r n p method p_ci;
run;
      
%mend CI_Single_Proportion;</code></pre>
<pre><code>%CI_Single_Proportion(r=81,n=263);

** Cheak with SAS;

data test;
input grp outcome $ count;
datalines;
1 f 81
1 u 182
;

proc freq data=test;
    tables outcome / binomial;
    weight Count;
run;

ods select BinomialCLs;
proc freq data=test;
    tables outcome / binomial (CL=ALL);
    weight Count;
run;

ods select BinomialCLs;
proc freq data=test;
    tables outcome / binomial (CL=
                               WALD
                               WILSON
                               CLOPPERPEARSON
                               MIDP
                               LIKELIHOODRATIO
                               JEFFREYS
                               AGRESTICOULL
                               LOGIT
                               BLAKER  
                              );
    weight Count;
run;

ods select BinomialCLs; 
proc freq data=test; 
    tables outcome / binomial (CL = 
                              WILSON(CORRECT) 
                              WALD(CORRECT)
                              ); 
    weight Count; 
run;</code></pre>
</div>
<div id="incidence-rate-ci" class="section level3" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> Incidence rate CI</h3>
<p>Incidence rate is the rate at which new clinical events occur in a population. It is the number of new events divided by the population at risk of an event in a specific time period, sometimes it is the person-time at risk.</p>
<p><span class="math display">\[r=\frac{a}{N}\]</span>
<span class="math display">\[\mathrm{SE}=\sqrt{\frac{1-r}{\mathrm{a}}}\]</span>
<span class="math inline">\(100(1-\mathrm{a}) \%\)</span> confidence interval is defined as:
<span class="math display">\[
(\mathrm{e}^{\ln \mathrm{r}-\mathrm{z}_{1-\frac{\alpha}{2}} \mathrm{SE}}, \mathrm{e}^{\ln \mathrm{r}+\mathrm{z}_{1-\frac{\alpha}{2}} \mathrm{SE}})
\]</span></p>
</div>
<div id="package-pwr" class="section level3" number="10.3.5">
<h3><span class="header-section-number">10.3.5</span> Package: pwr</h3>
<p><a href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">Basic Functions for Power Analysis</a></p>
<table>
<thead>
<tr class="header">
<th>方法</th>
<th>功效计算的对象</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pwr.2p.test()</td>
<td>两比例(n相等)</td>
</tr>
<tr class="even">
<td>pwr.2p2n.test()</td>
<td>两比例(n不相等)</td>
</tr>
<tr class="odd">
<td>pwr.anova.test()</td>
<td>平衡的单因素ANOVA</td>
</tr>
<tr class="even">
<td>pwr.chisq.test()</td>
<td>卡方检验</td>
</tr>
<tr class="odd">
<td>pwr.f2.test()</td>
<td>广义线性模型</td>
</tr>
<tr class="even">
<td>pwr.p.test()</td>
<td>比例(单样本)</td>
</tr>
<tr class="odd">
<td>pwr.r.test()</td>
<td>相关系数</td>
</tr>
<tr class="even">
<td>pwr.t.test()</td>
<td>t检验(单样本、两样本、配对)</td>
</tr>
<tr class="odd">
<td>pwr.t2n.test()</td>
<td>t检验(n不相等的两样本)</td>
</tr>
</tbody>
</table>
</div>
<div id="sample-proportion-2-sided-equality-based-on-wald-ci" class="section level3" number="10.3.6">
<h3><span class="header-section-number">10.3.6</span> 1-Sample Proportion, 2-Sided Equality based on Wald CI</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p=p_{0} \\
H_{1}: p \neq p_{0}
\end{array}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{p-p_{0}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p-p_{0}}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span>
### 1-Sample Proportion Non-Inferiority or Superiority</p>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p-p_{0} \leq \delta \\
H_{1}: p-p_{0}&gt;\delta
\end{array}
\]</span>
and <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin.</p>
<p>Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{p-p_{0}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{p-p_{0}-\delta}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sample-size-calculation.html#cb13-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb13-2"><a href="sample-size-calculation.html#cb13-2" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">=</span><span class="fl">0.3</span></span>
<span id="cb13-3"><a href="sample-size-calculation.html#cb13-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb13-4"><a href="sample-size-calculation.html#cb13-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb13-5"><a href="sample-size-calculation.html#cb13-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb13-6"><a href="sample-size-calculation.html#cb13-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(p<span class="sc">-</span>p0<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 17.17377</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sample-size-calculation.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sample-size-calculation.html#cb17-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(p<span class="sc">-</span>p0<span class="sc">-</span>delta)<span class="sc">/</span><span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb17-2"><a href="sample-size-calculation.html#cb17-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))</span></code></pre></div>
<pre><code>## [1] 0.800018</code></pre>
</div>
<div id="sample-proportion-equivalence" class="section level3" number="10.3.7">
<h3><span class="header-section-number">10.3.7</span> 1-Sample Proportion Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|p-p_{0}\right| \geq \delta \\
H_{1}:\left|p-p_{0}\right|&lt;\delta
\end{array}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|p-p_{0}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|p-p_{0}\right|-\delta}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span></p>
</div>
<div id="sample-proportions-2-sided-equality-based-on-wald-ci" class="section level3" number="10.3.8">
<h3><span class="header-section-number">10.3.8</span> 2-Sample Proportions, 2-Sided Equality based on Wald CI</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p_{A}-p_{B}=0 \\
H_{1}: p_{A}-p_{B} \neq 0
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{p_{A}-p_{B}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p_{A}-p_{B}}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sample-size-calculation.html#cb19-1" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.65</span></span>
<span id="cb19-2"><a href="sample-size-calculation.html#cb19-2" aria-hidden="true" tabindex="-1"></a>pB<span class="ot">=</span><span class="fl">0.85</span></span>
<span id="cb19-3"><a href="sample-size-calculation.html#cb19-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb19-4"><a href="sample-size-calculation.html#cb19-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb19-5"><a href="sample-size-calculation.html#cb19-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb19-6"><a href="sample-size-calculation.html#cb19-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">/</span>kappa<span class="sc">+</span>pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB))<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(pA<span class="sc">-</span>pB))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 69.65881</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sample-size-calculation.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 70</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sample-size-calculation.html#cb23-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(pA<span class="sc">-</span>pB)<span class="sc">/</span><span class="fu">sqrt</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">/</span>nB<span class="sc">/</span>kappa<span class="sc">+</span>pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)<span class="sc">/</span>nB)</span>
<span id="cb23-2"><a href="sample-size-calculation.html#cb23-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="sample-proportions-non-inferiority-or-superiority" class="section level3" number="10.3.9">
<h3><span class="header-section-number">10.3.9</span> 2-Sample Proportions Non-Inferiority or Superiority</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p_{A}-p_{B} \leq \delta \\
H_{1}: p_{A}-p_{B}&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{p_{A}-p_{B}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p_{A}-p_{B}-\delta}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
</div>
<div id="sample-proportions-equivalence" class="section level3" number="10.3.10">
<h3><span class="header-section-number">10.3.10</span> 2-Sample Proportions Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|p_{A}-p_{B}\right| \geq \delta \\
H_{1}:\left|p_{A}-p_{B}\right|&lt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|p_{A}-p_{B}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|p_{A}-p_{B}\right|-\delta}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
<p><strong>Equivalence Trial with Binary Endpoint</strong></p>
<pre><code>%Macro TwoSamZTest(nSims=100000, nPerGrp=100, px=0.3, py=0.4, delta=0.3, alpha=0.05);
  Data TwoGVars;
  KEEP powerCI powerTest;
  powerCI=0; powerTest=0;
  Do iSim=1 To &amp;nSims;
  PxObs=Ranbin(733,&amp;nPerGrp,&amp;px)/&amp;nPerGrp;
  PyObs=Ranbin(236,&amp;nPerGrp,&amp;py)/&amp;nPerGrp;
  se=((PxObs*(1-PxObs)+PyObs*(1-PyObs))/&amp;nPerGrp)**0.5;
  *CI method;
  ICW=Probit(1-&amp;alpha)*se;
  IF Abs(PxObs-PyObs)+ICW &lt; &amp;delta Then
  powerCI=powerCI+1/&amp;nSims;
  *Two one-sided tests method;
  T1=(PyObs-PxObs-&amp;delta)/se;
  T2=(PyObs-PxObs+&amp;delta)/se;
  IF T1=Probit(1-&amp;alpha) &amp; T2&gt;Probit(1-&amp;alpha) Then
  powerTest=powerTest+1/&amp;nSims;
  End;
  Output;
  Run;
  Proc Print; Run;
%Mend TwoSamZTest;

Title “Equivalence test with binary response: Alpha under Ho”;
%TwoSamZTest(nPerGrp=100, px=0.1, py=0.2, delta=0.1, alpha=0.05);

Title “Equivalence test with binary response: Power under Ha”;
%TwoSamZTest(nPerGrp=100, px=0.3, py=0.3, delta=0.2, alpha=0.05);</code></pre>
</div>
<div id="paired-proportions-mcnemars-z-test" class="section level3" number="10.3.11">
<h3><span class="header-section-number">10.3.11</span> Paired Proportions: McNemar’s Z-test</h3>
<p>Compare the probability that an event occurs in group ‘A’ to that in group ‘B.’ Example study designs include matched case-control studies and cross-over studies.
<span class="math display">\[
\begin{array}{cl} 
&amp; &amp; \text { Group &#39;B&#39; } \\
&amp; &amp; \text { Success} &amp; \text { Failure } \\
\text { Group &#39;A&#39; } &amp;\text { Success } &amp; p_{11} &amp; p_{10} \\
&amp;\text { Failure } &amp; p_{01} &amp; p_{00}
\end{array}
\]</span>
Interest is in comparing the following hypotheses:</p>
<ul>
<li><span class="math inline">\(H_{0}:\)</span> Both groups have the same success probability</li>
<li><span class="math inline">\(H_{1}\)</span> :The success probability is not equal between the Groups</li>
</ul>
<p>Mathematically, this can be represented as
<span class="math display">\[
\begin{array}{l}
H_{0}: p_{10}=p_{01} \\
H_{1}: p_{10} \neq p_{01}
\end{array}
\]</span></p>
<p>In the formulas below, we use the notation that
<span class="math display">\[
p_{d i s c}=p_{10}+p_{01}
\]</span>
and
<span class="math display">\[
p_{d i f f}=p_{10}-p_{01}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=\left(\frac{z_{1-\alpha / 2} \sqrt{p_{d i s c}}+z_{1-\beta} \sqrt{p_{d i s c}-p_{d i f f}^{2}}}{p_{d i f f}}\right)^{2} \\
\quad 1-\beta=\Phi\left(\frac{p_{d i f f} \sqrt{n}-z_{1-\alpha / 2} \sqrt{p_{d i s c}}}{\sqrt{p_{d i s c}-p_{d i f f}^{2}}}\right)
\end{array}
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sample-size-calculation.html#cb26-1" aria-hidden="true" tabindex="-1"></a>p01<span class="ot">=</span><span class="fl">0.45</span></span>
<span id="cb26-2"><a href="sample-size-calculation.html#cb26-2" aria-hidden="true" tabindex="-1"></a>p10<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb26-3"><a href="sample-size-calculation.html#cb26-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span><span class="sc">*</span><span class="dv">2</span> <span class="co"># *2 to convert cited example&#39;s 1-sided test to 2-sided test</span></span>
<span id="cb26-4"><a href="sample-size-calculation.html#cb26-4" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.10</span></span>
<span id="cb26-5"><a href="sample-size-calculation.html#cb26-5" aria-hidden="true" tabindex="-1"></a>pdisc<span class="ot">=</span>p10<span class="sc">+</span>p01</span>
<span id="cb26-6"><a href="sample-size-calculation.html#cb26-6" aria-hidden="true" tabindex="-1"></a>pdiff<span class="ot">=</span>p10<span class="sc">-</span>p01</span>
<span id="cb26-7"><a href="sample-size-calculation.html#cb26-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>pdiff)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 22.80907</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sample-size-calculation.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sample-size-calculation.html#cb30-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span>( pdiff<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc))<span class="sc">/</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb30-2"><a href="sample-size-calculation.html#cb30-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span>(<span class="sc">-</span>pdiff<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc))<span class="sc">/</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb30-3"><a href="sample-size-calculation.html#cb30-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power =</span> <span class="fu">pnorm</span>(x1)<span class="sc">+</span><span class="fu">pnorm</span>(x2))</span></code></pre></div>
<pre><code>## [1] 0.9000001</code></pre>
</div>
<div id="chi-square-test" class="section level3" number="10.3.12">
<h3><span class="header-section-number">10.3.12</span> Chi-square test</h3>
<p>Chi-square test is often used to evaluate the relationship between two categorical variables. The typical null hypothesis is independence between variables, and the alternative hypothesis is not independence. The pwr.chisq.test() function can evaluate the power, effect size and required sample size of the chi-square test</p>
<blockquote>
<p>想研究人种与工作晋升的关系。你预期样本中70%是白种人，10% 是美国黑人，20%西班牙裔人。而且，你认为相比30%的美国黑人和50%的西班牙裔人，60%的 白种人更容易晋升。研究假设的晋升概率如表所示。</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>人 种</th>
<th>晋升比例</th>
<th>未晋升者比例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>白种人</td>
<td>0.42</td>
<td>0.28</td>
</tr>
<tr class="even">
<td>美国黑人</td>
<td>0.03</td>
<td>0.07</td>
</tr>
<tr class="odd">
<td>西班牙裔</td>
<td>0.10</td>
<td>0.10</td>
</tr>
</tbody>
</table>
<blockquote>
<p>预期总人数的42%是晋升的白种人(0.42 = 0.70 × 0.60)，总人数的7%是未 晋升的美国黑人(0.07 = 0.10 × 0.70)。让我们取0.05的显著性水平和0.90的预期功效水平。双因 素列联表的自由度为(r-1)(c-1)，r是行数，c是列数</p>
</blockquote>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sample-size-calculation.html#cb32-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.42</span>, <span class="fl">0.28</span>, <span class="fl">0.03</span>, <span class="fl">0.07</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb32-2"><a href="sample-size-calculation.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ES.w2</span>(prob)</span></code></pre></div>
<pre><code>## [1] 0.1853198</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sample-size-calculation.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.chisq.test</span>(<span class="at">w =</span><span class="fu">ES.w2</span>(prob), <span class="at">df =</span> <span class="dv">3</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.1853198
##               N = 412.6404
##              df = 3
##       sig.level = 0.05
##           power = 0.9
## 
## NOTE: N is the number of observations</code></pre>
</div>
</div>
<div id="test-means" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Test Mean(s)</h2>
<div id="one-sample-mean-2-sided-equality" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> One Sample Mean 2-Sided Equality</h3>
<p>The Null and Alternative hypotheses are
<span class="math display">\[
\begin{array}{l}
H_{0}: \mu=\mu_{0} \\
H_{1}: \mu \neq \mu_{0}
\end{array}
\]</span>
Formulas compute sample size and power, respectively:
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha / 2}+z_{1-\beta}}{\mu-\mu_{0}}\right)^{2}\]</span>
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{\mu-\mu_{0}}{\sigma / \sqrt{n}}
\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sample-size-calculation.html#cb36-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb36-2"><a href="sample-size-calculation.html#cb36-2" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="fl">1.5</span></span>
<span id="cb36-3"><a href="sample-size-calculation.html#cb36-3" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb36-4"><a href="sample-size-calculation.html#cb36-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb36-5"><a href="sample-size-calculation.html#cb36-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb36-6"><a href="sample-size-calculation.html#cb36-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(mu<span class="sc">-</span>mu0))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 31.39552</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sample-size-calculation.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sample-size-calculation.html#cb40-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(mu<span class="sc">-</span>mu0)<span class="sc">/</span>sd<span class="sc">*</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-2"><a href="sample-size-calculation.html#cb40-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="sample-mean-non-inferiority-or-superiority" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> 1-Sample Mean Non-Inferiority or Superiority</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu-\mu_{0} \leq \delta \\
H_{1}: \mu-\mu_{0}&gt;\delta
\end{array}
\]</span>
Sample Size
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta}}{\mu-\mu_{0}-\delta}\right)^{2}\]</span>
Power
<span class="math display">\[1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{\mu-\mu_{0}-\delta}{\sigma / \sqrt{n}}\]</span></p>
</div>
<div id="sample-mean-equivalence" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> 1-Sample Mean Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|\mu-\mu_{0}\right| \geq \delta \\
H_{1}:\left|\mu-\mu_{0}\right|&lt;\delta
\end{array}
\]</span>
Sample Size
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta / 2}}{\delta-\left|\mu-\mu_{0}\right|}\right)^{2}\]</span>
Power
<span class="math display">\[1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|\mu-\mu_{0}\right|-\delta}{\sigma / \sqrt{n}}\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sample-size-calculation.html#cb42-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb42-2"><a href="sample-size-calculation.html#cb42-2" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb42-3"><a href="sample-size-calculation.html#cb42-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb42-4"><a href="sample-size-calculation.html#cb42-4" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="fl">0.10</span></span>
<span id="cb42-5"><a href="sample-size-calculation.html#cb42-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb42-6"><a href="sample-size-calculation.html#cb42-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb42-7"><a href="sample-size-calculation.html#cb42-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(delta<span class="sc">-</span><span class="fu">abs</span>(mu<span class="sc">-</span>mu0)))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 34.25539</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sample-size-calculation.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 35</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sample-size-calculation.html#cb46-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">abs</span>(mu<span class="sc">-</span>mu0)<span class="sc">-</span>delta)<span class="sc">/</span>sd<span class="sc">*</span><span class="fu">sqrt</span>(n)</span>
<span id="cb46-2"><a href="sample-size-calculation.html#cb46-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000048</code></pre>
</div>
<div id="sample-means-2-sided-equality" class="section level3" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> 2-Sample Means, 2-Sided Equality</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}-\mu_{B}=0 \\
H_{1}: \mu_{A}-\mu_{B} \neq 0
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span></p>
<p>Sample size
<span class="math display">\[
n_{A}=\kappa n_{B}
\]</span>
<span class="math display">\[
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha / 2}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2}
\]</span>
Power
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\]</span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sample-size-calculation.html#cb48-1" aria-hidden="true" tabindex="-1"></a>muA<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb48-2"><a href="sample-size-calculation.html#cb48-2" aria-hidden="true" tabindex="-1"></a>muB<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb48-3"><a href="sample-size-calculation.html#cb48-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb48-4"><a href="sample-size-calculation.html#cb48-4" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb48-5"><a href="sample-size-calculation.html#cb48-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb48-6"><a href="sample-size-calculation.html#cb48-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb48-7"><a href="sample-size-calculation.html#cb48-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">*</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(muA<span class="sc">-</span>muB))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 62.79104</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="sample-size-calculation.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 63</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sample-size-calculation.html#cb52-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(muA<span class="sc">-</span>muB)<span class="sc">/</span>(sd<span class="sc">*</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">/</span>nB))</span>
<span id="cb52-2"><a href="sample-size-calculation.html#cb52-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="sample-means-1-sided" class="section level3" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> 2-Sample Means, 1-Sided</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}=\mu_{B} \\
H_{1}: \mu_{A}&gt;\mu_{B}
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{B}}{n_{A}}
\]</span>
Sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\left(\sigma_{A}^{2}+\sigma_{B}^{2} / \kappa\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2} \\
n_{B}=\kappa n_{A} \\
1-\beta=\Phi\left(\frac{\left|\mu_{A}-\mu_{B}\right| \sqrt{n_{A}}}{\sqrt{\sigma_{A}^{2}+\sigma_{B}^{2} / \kappa}}-z_{1-\alpha}\right)
\end{array}
\]</span></p>
</div>
<div id="sample-means-non-inferiority-or-superiority" class="section level3" number="10.4.6">
<h3><span class="header-section-number">10.4.6</span> 2-Sample Means Non-Inferiority or Superiority</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}-\mu_{B} \leq \delta \\
H_{1}: \mu_{A}-\mu_{B}&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta}}{\mu_{A}-\mu_{B}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}-\delta}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\end{array}
\]</span></p>
</div>
<div id="sample-means-equivalence" class="section level3" number="10.4.7">
<h3><span class="header-section-number">10.4.7</span> 2-Sample Means Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|\mu_{A}-\mu_{B}\right| \geq \delta \\
H_{1}:\left|\mu_{A}-\mu_{B}\right|&lt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{1}}{n_{2}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|\mu_{A}-\mu_{B}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|\mu_{A}-\mu_{B}\right|-\delta}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sample-size-calculation.html#cb54-1" aria-hidden="true" tabindex="-1"></a>muA<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb54-2"><a href="sample-size-calculation.html#cb54-2" aria-hidden="true" tabindex="-1"></a>muB<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb54-3"><a href="sample-size-calculation.html#cb54-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb54-4"><a href="sample-size-calculation.html#cb54-4" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb54-5"><a href="sample-size-calculation.html#cb54-5" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb54-6"><a href="sample-size-calculation.html#cb54-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb54-7"><a href="sample-size-calculation.html#cb54-7" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb54-8"><a href="sample-size-calculation.html#cb54-8" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">*</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">abs</span>(muA<span class="sc">-</span>muB)<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 107.0481</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="sample-size-calculation.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB)</span></code></pre></div>
<pre><code>## [1] 108</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sample-size-calculation.html#cb58-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">abs</span>(muA<span class="sc">-</span>muB)<span class="sc">-</span>delta)<span class="sc">/</span>(sd<span class="sc">*</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">/</span>nB))</span>
<span id="cb58-2"><a href="sample-size-calculation.html#cb58-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000048</code></pre>
<p><strong>SAS Implementation</strong></p>
<pre><code>*** Equivalence Trial with Normal Endpoin;

%Macro EquivCI(nSims=1000, nPerGrp=200, ux=0, uy=1, delta=1.2, sigmax=1, sigmay=1.2, alpha=0.05);
  Data TwoGVars;
  Keep xMean yMean powerCI powerTest;
  powerCI=0; powerTest=0;
  Do iSim=1 To &amp;nSims;
  xMean=0; yMean=0; s2x=0; s2y=0;
  Do iObs=1 To &amp;nPerGrp;
  xNOR=Rannor(7362); xMean=xMean+xNor; s2x=s2x+xNor**2;
  yNOR=Rannor(2637); yMean=yMean+yNor; s2y=s2y+yNor**2;
  End;
  xMean=xMean*&amp;sigmax/&amp;nPerGrp+&amp;ux;
  yMean=yMean*&amp;sigmay/&amp;nPerGrp+&amp;uy;
  sp=((s2x*&amp;sigmax**2+s2y*&amp;sigmay**2)/(2*&amp;nPerGrp-2))**0.5;
  se=sp/(&amp;nPerGrp/2)**0.5;
  * CI method;
  ICW=Probit(1-&amp;alpha)*se;
  If Abs(yMean-xMean)+ICW &lt; &amp;delta Then
  powerCI=powerCI+1/&amp;nSims;
  *Two one-sided test method;
  T1=(xMean-yMean-&amp;delta)/se;
  T2=(xMean-yMean+&amp;delta)/se;
  If T1=Probit(1-&amp;alpha) &amp; T2&gt;Probit(1-&amp;alpha) Then
  powerTest=powerTest+1/&amp;nSims;
  End;
  Output;
  Run;
  Proc Print Data=TwoGVars(obs=1); Run;
%Mend EquivCI;

Title “Equivalence test with normal response: Alpha under Ho”;
%EquivCI(nSims=10000, nPerGrp=1000, ux=0.2, uy=0, delta=0.2, sigmax=1, sigmay=1, alpha=0.05);

Title “Equivalence test with normal response: Power under Ha”;
%EquivCI(nSims=10000, nPerGrp=198, ux=0, uy=1, delta=1.2, sigmax=0.8, sigmay=0.8, alpha=0.05);</code></pre>
</div>
<div id="t-test-using-pwr.t.test-or-pwr.t2n.test" class="section level3" number="10.4.8">
<h3><span class="header-section-number">10.4.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></h3>
<ul>
<li><code>pwr.t.test</code>: Power calculations for t-tests of means (one sample, two samples and paired samples)</li>
<li><code>pwr.t2n.test</code>: Power calculations for two samples (different sizes) t-tests of means</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sample-size-calculation.html#cb61-1" aria-hidden="true" tabindex="-1"></a>TTest <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,mean,std,power,side){</span>
<span id="cb61-2"><a href="sample-size-calculation.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> mean<span class="sc">/</span>std</span>
<span id="cb61-3"><a href="sample-size-calculation.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># d: Effect size (Cohen&#39;s d) - difference between the means divided by the pooled standard deviation</span></span>
<span id="cb61-4"><a href="sample-size-calculation.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  samplesize <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d=</span>d, <span class="at">power=</span>power, <span class="at">sig.level=</span>alpha, <span class="at">type=</span><span class="st">&quot;two.sample&quot;</span>,<span class="at">alternative=</span>side)</span>
<span id="cb61-5"><a href="sample-size-calculation.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  CI.Left  <span class="ot">&lt;-</span> mean<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>std<span class="sc">/</span><span class="fu">sqrt</span>(samplesize<span class="sc">$</span>n)</span>
<span id="cb61-6"><a href="sample-size-calculation.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  CI.Right <span class="ot">&lt;-</span> mean<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>std<span class="sc">/</span><span class="fu">sqrt</span>(samplesize<span class="sc">$</span>n)</span>
<span id="cb61-7"><a href="sample-size-calculation.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;[&quot;</span>,<span class="fu">round</span>(CI.Left,<span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(CI.Right,<span class="dv">3</span>), <span class="st">&quot;]&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>,<span class="at">collapse =</span> <span class="cn">NULL</span>)</span>
<span id="cb61-8"><a href="sample-size-calculation.html#cb61-8" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">alpha =</span> alpha,</span>
<span id="cb61-9"><a href="sample-size-calculation.html#cb61-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean =</span> mean,</span>
<span id="cb61-10"><a href="sample-size-calculation.html#cb61-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sd =</span> std,</span>
<span id="cb61-11"><a href="sample-size-calculation.html#cb61-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">power =</span> samplesize<span class="sc">$</span>power,</span>
<span id="cb61-12"><a href="sample-size-calculation.html#cb61-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">side =</span> samplesize<span class="sc">$</span>alternative,</span>
<span id="cb61-13"><a href="sample-size-calculation.html#cb61-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n =</span> samplesize<span class="sc">$</span>n,</span>
<span id="cb61-14"><a href="sample-size-calculation.html#cb61-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CI =</span> CI)</span>
<span id="cb61-15"><a href="sample-size-calculation.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb61-16"><a href="sample-size-calculation.html#cb61-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-17"><a href="sample-size-calculation.html#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="sample-size-calculation.html#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="fu">TTest</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.42</span>, <span class="at">std =</span> <span class="fl">0.7</span>, <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">side =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##   alpha  mean  sd power      side        n              CI
## 1  0.05 -0.42 0.7   0.8 two.sided 44.58577 [-0.625,-0.215]</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sample-size-calculation.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TTest</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.42</span>, <span class="at">std =</span> <span class="fl">0.748</span>, <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">side =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>##   alpha  mean    sd power side        n              CI
## 1  0.05 -0.42 0.748   0.8 less 39.91355 [-0.652,-0.188]</code></pre>
</div>
<div id="test-k-means" class="section level3" number="10.4.9">
<h3><span class="header-section-number">10.4.9</span> Test k Means</h3>
<p><strong>1-Way ANOVA Pairwise, 2-Sided Equality using Bonferroni Adjustment</strong></p>
<p>In more general terms, we may have <span class="math inline">\(k\)</span> groups, meaning there are a total of <span class="math inline">\(K \equiv\left(\begin{array}{c}k \\ 2\end{array}\right)=k(k-1) / 2\)</span> possible pairwise comparisons. When we test <span class="math inline">\(\tau \leq K\)</span> of these pairwise comparisons, we have <span class="math inline">\(\tau\)</span> hypotheses of the form
<span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}=\mu_{B} \\
H_{1}: \mu_{A} \neq \mu_{B}
\end{array}
\]</span>
where <span class="math inline">\(\mu_{A}\)</span> and <span class="math inline">\(\mu_{B}\)</span> represent the means of two of the <span class="math inline">\(k\)</span> groups, groups ‘A’ and ‘B.’ We’ll compute the required sample size for each of the <span class="math inline">\(\tau\)</span> comparisons, and total sample size needed is the largest of these. In the formula below, <span class="math inline">\(n\)</span> represents the sample size in any one of these <span class="math inline">\(\tau\)</span> comparisons; that is, there are <span class="math inline">\(n / 2\)</span> people in the ‘A’ group, and <span class="math inline">\(n / 2\)</span> people in the ‘B’ group.</p>
<p>Formulas to compute sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=2\left(\sigma \frac{z_{1-\alpha /(2 \tau)}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha /(2 \tau)}\right)+\Phi\left(-z-z_{1-\alpha /(2 \tau)}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}}{\sigma \sqrt{\frac{2}{n}}}
\end{array}
\]</span></p>
<p>See more under multiple tests.</p>
</div>
<div id="anova-using-pwr.anova.test" class="section level3" number="10.4.10">
<h3><span class="header-section-number">10.4.10</span> Anova using <code>pwr.anova.test</code></h3>
<p>Perform power analysis on balanced one-way analysis of variance, where k is the number of groups, and n is the sample size in each group.</p>
<p>Now do a one-way analysis of variance for the five groups to achieve a power of 0.8, an <strong>effect value</strong> of 0.25, and a significance level of 0.05 to calculate the sample size required for each group</p>
<p>Where <strong>effect value</strong> is calculated using <span class="math display">\[f=\sqrt{\frac{\sum_{i=1}^k p_i \times (\mu_i - \mu)^2}{\sigma^2}}\]</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sample-size-calculation.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">f =</span> <span class="fl">0.25</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 5
##               n = 39.1534
##               f = 0.25
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="sample-size-calculation.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample sizes for detecting significant effects in a One-Way ANOVA</span></span>
<span id="cb67-2"><a href="sample-size-calculation.html#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="sample-size-calculation.html#cb67-3" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>)</span>
<span id="cb67-4"><a href="sample-size-calculation.html#cb67-4" aria-hidden="true" tabindex="-1"></a>nes <span class="ot">&lt;-</span> <span class="fu">length</span>(es)</span>
<span id="cb67-5"><a href="sample-size-calculation.html#cb67-5" aria-hidden="true" tabindex="-1"></a>samsize <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb67-6"><a href="sample-size-calculation.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nes) {</span>
<span id="cb67-7"><a href="sample-size-calculation.html#cb67-7" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">f =</span> es[i], </span>
<span id="cb67-8"><a href="sample-size-calculation.html#cb67-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb67-9"><a href="sample-size-calculation.html#cb67-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">power =</span> <span class="fl">0.9</span>)</span>
<span id="cb67-10"><a href="sample-size-calculation.html#cb67-10" aria-hidden="true" tabindex="-1"></a>    samsize[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb67-11"><a href="sample-size-calculation.html#cb67-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-12"><a href="sample-size-calculation.html#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samsize, es, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb67-13"><a href="sample-size-calculation.html#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Effect Size&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Sample Size (per cell)&quot;</span>, </span>
<span id="cb67-14"><a href="sample-size-calculation.html#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;One Way ANOVA with Power=.90 and Alpha=.05&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Anova%20test-1.png" width="672" /></p>
</div>
<div id="average-bioequivalence" class="section level3" number="10.4.11">
<h3><span class="header-section-number">10.4.11</span> Average Bioequivalence</h3>
<p>Pharmacokinetics (PK) is the study of the body’s absorption, distribution, metabolism, and elimination of a drug. An important outcome of a PK study is the bioavailability of the drug. The bioavailability of a drug is defined as the rate and extent to which the active drug ingredient or therapeutic moiety is absorbed and becomes available at the site of drug action. As bioavailability cannot be easily measured directly, the concentration of the drug that reaches the circulating bloodstream is taken as a surrogate. Therefore, bioavailability can be viewed as the concentration of the drug that is in the blood. Two drugs are bioequivalent if they have the same bioavailability.</p>
<blockquote>
<p>药代动力学（PK）是人体对药物的吸收，分布，代谢和消除的研究。 PK 研究的一个重要结果是药物的生物利用度。
药物的生物利用度被定义为活性药物成分或治疗部分被吸收并在药物作用部位变得可用的速率和程度。由于不能轻易直接测量生物利用度，因此将到达循环血流的药物浓度作为替代指标。因此，生物利用度可以看作是血液中药物的浓度。如果两种药物具有相同的生物利用度，则它们是生物等效的。</p>
</blockquote>
<p>At the present time, average bioequivalence (ABE) serves as the current international standard for bioequivalence (BE) testing using a 2 × 2 crossover design (Chow and Liu, 2008). The PK parameters used for assessing ABE are area under the curve (AUC) and peak concentration (Cmax). The recommended statistical method is the two one-sided tests procedure to determine if the average values for the PK measures determined after administration of the T (test) and R (reference) products were comparable. This approach is termed ABE. It is equivalent to the so-called confidence interval method, which involves the calculation of a 90% confidence interval for the ratio of the averages (population geometric means) of the measures for the T and R products. To establish BE, the calculated confidence interval should fall within a BE limit, usually 80%–125% for the ratio of the product averages. The 1992 FDA guidance has also provided specific recommendations for logarithmic transformation of PK data, methods to evaluate sequence effects, and methods to evaluate outlier data. In practice, people also use parallel designs and the 90% confidence interval for nontransformed data. To establish BE, the calculated confidence interval should fall within a BE limit, usually 80%–120% for the difference of the product averages.</p>
<blockquote>
<p>目前，平均生物等效性 (ABE) 是使用 2 × 2 交叉设计进行生物等效性 (BE) 测试的当前国际标准（Chow 和 Liu，2008 年）。用于评估 ABE 的 PK 参数是曲线下面积 (AUC) 和峰值浓度 (Cmax)。推荐的统计方法是两个单面测试程序，以确定在施用T（测试）和R（参考）产品后确定的PK度量的平均值是否可比。这种方法称为 ABE。它等效于所谓的置信区间方法，它涉及计算 T 和 R 产品度量的平均值（总体几何平均值）之比的 90% 置信区间。要建立 BE，计算出的置信区间应落在 BE 限值内，通常产品平均值的比率为 80% -125%。 1992 年的 FDA 指南还为 PK 数据的对数转换、评估序列效应的方法和评估离群数据的方法提供了具体建议。在实践中，人们还使用平行设计和未转换数据的 90% 置信区间。要建立 BE，计算的置信区间应落在 BE 限制内，通常产品平均值的差异为 80% -120%。</p>
</blockquote>
<p>The hypothesis for ABE in a 2×2 crossover design with log-transformed data can be written as
<span class="math display">\[
\begin{array}{l}
H_{01}: \mu_{T}-\mu_{R} \leq-\ln 1.25 \\
H_{02}: \mu_{T}-\mu_{R} \geq \ln 1.25
\end{array}
\]</span>
The asymptotic sample size is given by (Chow et al., 2003 )
<span class="math display">\[
n=\frac{\left(z_{1-\alpha}+z_{1-\beta / 2}\right)^{2} \sigma_{1,1}^{2}}{2(\ln 1.25-|\varepsilon|)^{2}}
\]</span>
where the variance for the intrasubject comparison is estimated using
<span class="math display">\[
\hat{\sigma}_{1,1}^{2}=\frac{1}{n_{1}+n_{2}-2} \sum_{j=1}^{2} \sum_{i=1}^{n_{j}}\left(y_{i 1 j}-y_{i 2 j}-\bar{y}_{1 j}+\bar{y}_{2 j}\right)^{2}
\]</span>
<span class="math inline">\(y_{i k j}\)</span> is the log-transformed <span class="math inline">\(\mathrm{PK}\)</span> measure from the <span class="math inline">\(i\)</span> th subject in the <span class="math inline">\(j\)</span> th sequence at the <span class="math inline">\(k\)</span> th dosing period, and <span class="math inline">\(\bar{y}_{k j}\)</span> is the sample mean of the observations in the <span class="math inline">\(j\)</span> th sequence at the <span class="math inline">\(k\)</span> th period.</p>
<p><strong>Crossover Bioequivalence Trial SAS</strong></p>
<p>The <span class="math inline">\(\mathrm{PK}\)</span> parameter chosen for this bioequivalence test is a log-transformation of the 24 -hour AUC (i.e., the raw data is log-normal). Assume that the difference between the two formulations in <span class="math inline">\(\log (\mathrm{AUC})\)</span> is <span class="math inline">\(\varepsilon=0.04\)</span> and the standard deviation for the intrasubject comparison is <span class="math inline">\(\sigma_{1,1}^{2}=0.55\)</span> with <span class="math inline">\(\alpha=0.05\)</span> and <span class="math inline">\(\beta=0.2\)</span>, the sample size per sequence is given by
<span class="math display">\[
n=\frac{(1.96+0.84)^{2}(0.55)^{2}}{2(0.223-0.04)^{2}}=36
\]</span></p>
<pre><code>%Macro Power2By2ABE(totalN=24, sWithin=0.355, uRatio=1);
  Data ABE; Keep sWithin uRatio n power;
  n=&amp;totalN; sWithin=&amp;sWithin; uRatio=&amp;uRatio;
  * Err df for AB/BA crossover design;
  n2=n-2;
  t1=tinv(1-0.05,n-2); t2=-t1;
  nc1=Sqrt(n)*log(uRatio/0.8)/Sqrt(2)/sWithin;
  nc2=Sqrt(n)*log(uRatio/1.25)/Sqrt(2)/sWithin;
  df=Sqrt(n-2)*(nc1-nc2)/(2*t1);
  Power=Probt(t2,df,nc2)-Probt(t1,df,nc1);
  Run;
  Proc Print; Run;
%Mend Power2By2ABE;

%Power2By2ABE(totalN=58, sWithin=0.355, uRatio=1)</code></pre>
</div>
</div>
<div id="other-methods" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Other Methods</h2>
<div id="odds-ratio" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Odds Ratio</h3>
<p><strong>Non-Inferiority or Superiority</strong></p>
<p><span class="math display">\[
O R=\frac{p_{A}\left(1-p_{B}\right)}{p_{B}\left(1-p_{A}\right)}
\]</span>
The hypotheses to test are
<span class="math display">\[
\begin{array}{l}
H_{0}: \ln (O R) \leq \delta \\
H_{1}: \ln (O R)&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin on the log scale, and the ratio between the sample sizes of the two
groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{l}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{1}{\kappa p_{A}\left(1-p_{A}\right)}+\frac{1}{p_{B}\left(1-p_{B}\right)}\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{\ln (O R)-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{(\ln (O R)-\delta) \sqrt{n_{B}}}{\sqrt{\frac{1}{\kappa p_{A}\left(1-p_{A}\right)}+\frac{1}{p_{B}\left(1-p_{B}\right)}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="sample-size-calculation.html#cb69-1" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.40</span></span>
<span id="cb69-2"><a href="sample-size-calculation.html#cb69-2" aria-hidden="true" tabindex="-1"></a>pB<span class="ot">=</span><span class="fl">0.25</span></span>
<span id="cb69-3"><a href="sample-size-calculation.html#cb69-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb69-4"><a href="sample-size-calculation.html#cb69-4" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb69-5"><a href="sample-size-calculation.html#cb69-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb69-6"><a href="sample-size-calculation.html#cb69-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb69-7"><a href="sample-size-calculation.html#cb69-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">OR=</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)<span class="sc">/</span>pB<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pA)) <span class="co"># 2</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="sample-size-calculation.html#cb71-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">/</span>(kappa<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>(pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)))<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(<span class="fu">log</span>(OR)<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 241.512</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="sample-size-calculation.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 242</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="sample-size-calculation.html#cb75-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">log</span>(OR)<span class="sc">-</span>delta)<span class="sc">*</span><span class="fu">sqrt</span>(nB)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(kappa<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>(pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)))</span>
<span id="cb75-2"><a href="sample-size-calculation.html#cb75-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))</span></code></pre></div>
<pre><code>## [1] 0.800018</code></pre>
</div>
<div id="correlation" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Correlation</h3>
<p><span class="math display">\[
H_0: \rho \leq 0.25 \text { and } H_1: \rho&gt;0.25
\]</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="sample-size-calculation.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.r.test</span>(<span class="at">r =</span> <span class="fl">0.25</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      approximate correlation power calculation (arctangh transformation) 
## 
##               n = 133.2803
##               r = 0.25
##       sig.level = 0.05
##           power = 0.9
##     alternative = greater</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="sample-size-calculation.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate a series of correlation coefficients and power values</span></span>
<span id="cb79-2"><a href="sample-size-calculation.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb79-3"><a href="sample-size-calculation.html#cb79-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>)</span>
<span id="cb79-4"><a href="sample-size-calculation.html#cb79-4" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">length</span>(r)</span>
<span id="cb79-5"><a href="sample-size-calculation.html#cb79-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb79-6"><a href="sample-size-calculation.html#cb79-6" aria-hidden="true" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p)</span>
<span id="cb79-7"><a href="sample-size-calculation.html#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="sample-size-calculation.html#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取样本大小</span></span>
<span id="cb79-9"><a href="sample-size-calculation.html#cb79-9" aria-hidden="true" tabindex="-1"></a>samsize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nr <span class="sc">*</span> np), <span class="at">dim =</span> <span class="fu">c</span>(nr, np))</span>
<span id="cb79-10"><a href="sample-size-calculation.html#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="sample-size-calculation.html#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np) {</span>
<span id="cb79-12"><a href="sample-size-calculation.html#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nr) {</span>
<span id="cb79-13"><a href="sample-size-calculation.html#cb79-13" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">pwr.r.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">r =</span> r[j], <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb79-14"><a href="sample-size-calculation.html#cb79-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">power =</span> p[i], <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb79-15"><a href="sample-size-calculation.html#cb79-15" aria-hidden="true" tabindex="-1"></a>        samsize[j, i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb79-16"><a href="sample-size-calculation.html#cb79-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-17"><a href="sample-size-calculation.html#cb79-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-18"><a href="sample-size-calculation.html#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="sample-size-calculation.html#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建图形</span></span>
<span id="cb79-20"><a href="sample-size-calculation.html#cb79-20" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(r)</span>
<span id="cb79-21"><a href="sample-size-calculation.html#cb79-21" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samsize))</span>
<span id="cb79-22"><a href="sample-size-calculation.html#cb79-22" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb79-23"><a href="sample-size-calculation.html#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb79-24"><a href="sample-size-calculation.html#cb79-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Correlation Coefficient (r)&quot;</span>, </span>
<span id="cb79-25"><a href="sample-size-calculation.html#cb79-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Sample Size (n)&quot;</span>)</span>
<span id="cb79-26"><a href="sample-size-calculation.html#cb79-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-27"><a href="sample-size-calculation.html#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加功效曲线</span></span>
<span id="cb79-28"><a href="sample-size-calculation.html#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np) {</span>
<span id="cb79-29"><a href="sample-size-calculation.html#cb79-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(r, samsize[, i], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> colors[i])</span>
<span id="cb79-30"><a href="sample-size-calculation.html#cb79-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-31"><a href="sample-size-calculation.html#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fu">seq</span>(<span class="dv">0</span>, yrange[<span class="dv">2</span>], <span class="dv">50</span>), <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb79-32"><a href="sample-size-calculation.html#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb79-33"><a href="sample-size-calculation.html#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="fu">seq</span>(xrange[<span class="dv">1</span>], xrange[<span class="dv">2</span>], <span class="fl">0.02</span>), </span>
<span id="cb79-34"><a href="sample-size-calculation.html#cb79-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb79-35"><a href="sample-size-calculation.html#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Sample Size Estimation for Correlation Studies</span><span class="sc">\n</span><span class="st">Sig=0.05 (Two-tailed)&quot;</span>)</span>
<span id="cb79-36"><a href="sample-size-calculation.html#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Power&quot;</span>, <span class="fu">as.character</span>(p), </span>
<span id="cb79-37"><a href="sample-size-calculation.html#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> colors)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Correlation%20test-1.png" width="672" /></p>
</div>
<div id="correlated-binary-data-ophthalmologic-studies" class="section level3" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> Correlated Binary Data: Ophthalmologic Studies</h3>
<ul>
<li><a href="https://sci-hub.se/10.1016/s0197-2456(01)00131-3">Sample Size and Power Calculations with Correlated Binary Data</a></li>
<li><a href="https://sci-hub.do/10.1001/archopht.1992.01080170112036">Sample Size Calculations for Ophthalmologic Studies</a></li>
</ul>
<p>It is assumed that one eye of each subject will be randomly assigned to receive eye-specific experimental treatments (such as extraocular muscle surgery), and the other eye will receive control treatments. This design will be very powerful when the correlation in the outcome measure between the eyes is reasonably high. However, this design assumes that the treatment of both eyes is pollution-free, and there is no generalized patient response, such as sympathetic ophthalmia. Such effects tend to obscure the differences between treatments.</p>
<p><strong>Two Eyes per Subject, Systemic Treatments</strong></p>
<p>Suppose that each patient will be random¬ ized to receive either a systemic, experimen¬ tal treatment (eg, oral steroids) or a placebo. Each subject will contribute two eyes to the analysis, and the within-subject outcomes are likely to be correlated. A measure of the correlation between eyes is the intraclass correlation coefficient, r, which has range of -1 to 1. Usually r is positive, indicating, for example, that the amount of visual field loss is high or low in both eyes, simultaneously. Most readers are familiar with the Pear¬ son Correlation Coefficient, commonly used and reported. Unlike the Pearson measure, the intraclass correlation coefficient is appli¬ cable only when both values for each subject are measured on the same scale and both have the same mean and SD.</p>
<ul>
<li>If all eyes are uncorrelated, a standard two-sample t-test can be used to detect group differences.</li>
<li>However, if there is a correlation between the eyes, the test will give invalid results, thereby making the null hypothesis more rejected. 5 Just divide the standard t-statistic by the square root of (1 + r) to calculate a valid t-test. In order to calculate the number of eyes required for each treatment group, we can use the following formula to calculate and then simply multiply it by the number (1 + r)</li>
</ul>
<p><span class="math display">\[n=(1+r)\left[2 s^{2}\left(z_{\alpha / 2}+z_{\beta}\right)^{2}\right] / d^{2}\]</span></p>
<p><strong>Mixed Single-Eye and Double-Eye Eligible Patients</strong></p>
<p>For systemic treatments, both one- and two-eye eligible patients could be included in the study. Sample size computation in this situation is only slightly more difficult. One computes the sample
size with formula (1) or formula (2) given above, as appropriate, and then multiplies the resulting
value by the factor
<span class="math display">\[
1+2 r p_{2} /\left(p_{1}+2 p_{2}\right)
\]</span>
where pi is the proportion of patients ex- pected to have one eye eligible, and <span class="math inline">\(\mathrm{p} 2=1\)</span> - pi is the
proportion of two-eye eligi- ble patients. This formula assumes that both treatment groups will
have the same ratio of unilateral to bilateral eligible patients</p>
</div>
</div>
<div id="multiple-test" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Multiple test</h2>
<p>Multiple comparisons and multiple testing procedures is their <strong>reduced power</strong>. Adjusted p-values are larger and simultaneous confidence intervals are wider, making it more difficult to reach firm conclusions. However, if you design your study with multiple inferences in mind, you can ensure that meaningful differences will be flagged as “statistically significant” with high probability, even when you use an MCP.</p>
<p>Power is <strong>not so easily defined</strong> in multiple testing situations as it is in single testing situations; there are multiple definitions, each of which is useful for different situations. Another difficulty lies in the complexity of the methods themselves: with complex closure-based methods, simply analyzing the data is difficult enough, let alone calculating power.</p>
<div id="definitions-of-power" class="section level3" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Definitions of Power</h3>
<p>In single testing situations, power is defined as the probability of correctly rejecting a false null hypothesis, that is, the probability of correctly “finding significance.” More precisely,</p>
<p>Power <span class="math inline">\(=P\left(\right.\)</span> reject <span class="math inline">\(H_{0} \mid H_{0}\)</span> is false).</p>
<p>To perform this calculation, you must specify the condition " <span class="math inline">\(H_{0}\)</span> is false" precisely.</p>
<p>In multiple testing and multiple comparisons applications, power is more complex since there are multiple parameters with multiple null hypotheses <span class="math inline">\(H_{0 i}\)</span>. Definitions include</p>
<ul>
<li>Complete Power <span class="math inline">\(=P\left(\right.\)</span> reject all <span class="math inline">\(H_{0 i}\)</span> that are false)</li>
<li>Minimal Power <span class="math inline">\(=P\left(\right.\)</span> reject at least one <span class="math inline">\(H_{0 i}\)</span> that is false)</li>
<li>Individual Power <span class="math inline">\(=P\left(\right.\)</span> reject a particular <span class="math inline">\(H_{0 i}\)</span> that is false)</li>
<li>Proportional Power = Expected Proportion of false <span class="math inline">\(H_{0 i}\)</span> that are rejected.</li>
</ul>
<p>A simple example illustrates that these power measures vary greatly. Suppose you plan to test hypotheses <span class="math inline">\(H_{1}, H_{2}, H_{3}\)</span>, and <span class="math inline">\(H_{4}\)</span> using independent tests whose powers (individually) are <span class="math inline">\(0.5,0.5\)</span>, <span class="math inline">\(0.8\)</span>, and <span class="math inline">\(0.8\)</span> respectively. Then</p>
<ul>
<li>Complete Power <span class="math inline">\(=0.5 \times 0.5 \times 0.8 \times 0.8=0.16\)</span></li>
<li>Minimal Power <span class="math inline">\(=1-(1-0.5) \times(1-0.5) \times(1-0.8) \times(1-0.8)=0.99\)</span></li>
<li>Individual Power <span class="math inline">\(=0.5\)</span> (say, assuming <span class="math inline">\(H_{1}\)</span> is the test of interest)</li>
<li>Proportional Power <span class="math inline">\(=(0.5+0.5+0.8+0.8) / 4=0.65\)</span></li>
</ul>
<p><strong>Complete Power</strong></p>
<p>Complete power appears the most attractive, since you obviously would like to reject all false hypotheses. However, compared to the rejection probability for an individual false hypothesis, it is relatively unlikely that you will reject all false hypotheses.</p>
<p>Nevertheless, complete power is required in some cases. For example, if a combination of two pharmaceutical products is to be approved for general use, it should be shown as superior to both individual products. Thus, both null hypotheses must be rejected. As discussed in a report from the International Conference for Harmonisation Guidelines on Statistical Principles for Clinical Trials (ICH, 1998), “If the purpose of the trial is to demonstrate effects on all of the designated primary variables, then there is no need for adjustment of the type I error, but the impact on type II error and sample size should be carefully considered.”</p>
<p><strong>Minimal Power</strong></p>
<p>Minimal power tells you the probability that you will find at least one significant result in your study, among hypotheses that are truly false. If your study only requires that at least one effect be demonstrated, then you should use minimal power.</p>
<p>This might occur, for example, in an <strong>early phase of development of a pharmaceutical product</strong>, where only a “proof of concept” is needed. If it can be shown that the product has at least some effect, then proof of concept is shown. Minimal power is also useful because it corresponds to the FWE rate: when the alternative differences all tend toward zero, the minimal power tends toward FWE. As with the complete power, computing the minimal power requires that you specify all the alternatives precisely; and again, while exact computations are infeasible, simulation yields results that are accurate enough for design purposes.</p>
<p><strong>Individual Power</strong></p>
<p>Among the various methods, individual power is the easiest to calculate, since it is just like “ordinary” power, except with multiplicity-adjusted critical values. Also, it can be calculated exactly, without resorting to simulations.</p>
<ul>
<li>Tests use critical points from MCPs: primary endpoint.</li>
<li>Just interested in one hypothesis, then you can test that one without any multiplicity adjustment, and you can use ordinary power calculations.</li>
</ul>
</div>
<div id="bonferroni-tests-individual-power" class="section level3" number="10.6.2">
<h3><span class="header-section-number">10.6.2</span> Bonferroni Tests (Individual Power)</h3>
<p>Bonferroni <span class="math inline">\(\alpha / k\)</span> rather than the usual <span class="math inline">\(\alpha\)</span> is used for Test. Suppose you have a number <span class="math inline">\((k)\)</span> of <span class="math inline">\(t\)</span> statistics of the form
<span class="math display">\[
t=\frac{\bar{y}-\bar{x}}{\hat{\sigma} \sqrt{2 / n}}
\]</span>
so that a Bonferroni rejection is given by
<span class="math display">\[
|t|&gt;t_{1-\alpha^{\prime} / 2, d f e}
\]</span>
where <span class="math inline">\(\alpha=\alpha / k\)</span> and <span class="math inline">\(d f e=2 n-2\)</span>. To calculate the rejection probability, use the fact that <span class="math inline">\(t\)</span> has the noncentral Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(d f e=2 n-2\)</span> and noncentrality parameter
<span class="math display">\[
\Delta=(\delta / \sigma) \sqrt{n / 2}
\]</span>
where <span class="math inline">\(\delta=\mu_{y}-\mu_{x}\)</span>.</p>
<pre><code>%let MuDiff = 5;
%let Sigma = 10.0;
%let alpha = .05;
%let k = 4;
ods graphics on;
proc power;
 twosamplemeans
 meandiff = &amp;MuDiff
 stddev = &amp;Sigma
 alpha = %sysevalf(&amp;alpha / &amp;k)
 npergroup = 2 to 100 by 2
 power = .;
 plot x=n markers=analysis
 yopts=(ref=.8 crossref=yes);
run;
ods graphics off; </code></pre>
</div>
<div id="tukeys-method-individual-power" class="section level3" number="10.6.3">
<h3><span class="header-section-number">10.6.3</span> Tukey’s method (Individual Power)</h3>
<blockquote>
<p>in balanced one-way ANOVA for all pairwise comparisons</p>
</blockquote>
<p>To detect a significant difference between <span class="math inline">\(\mu_{i}\)</span> and <span class="math inline">\(\mu_{i^{\prime}}\)</span>, you must have
<span class="math display">\[
\left|t_{i, i^{\prime}}\right|=\left|\frac{\bar{y}_{i}-\bar{y}_{i^{\prime}}}{\hat{\sigma} \sqrt{2 / n}}\right|&gt;c_{\alpha}
\]</span>
where
<span class="math display">\[
c_{\alpha}=\frac{q_{1-\alpha, g, g(n-1)}^{R}}{\sqrt{2}}
\]</span>
is the critical value used for Tukey’s method. To calculate these probabilities, again note that <span class="math inline">\(t_{i, i^{\prime}}\)</span> has the noncentral Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(d f e=g(n-1)\)</span> and noncentrality parameter
<span class="math display">\[
\Delta=(\delta / \sigma) \sqrt{n / 2}
\]</span>
In order to compute the individual power for single-step Tukey tests, you need to specify the following:</p>
<ul>
<li><span class="math inline">\(d\)</span> is the “meaningful difference”</li>
<li><span class="math inline">\(\sigma\)</span> is an estimate (or guess) of the within-group standard deviation of the response</li>
<li><span class="math inline">\(g\)</span> is the number of groups</li>
<li><span class="math inline">\(n\)</span> is the within-group sample size</li>
<li><span class="math inline">\(\alpha\)</span> is the desired FWE level</li>
</ul>
<pre><code>%IndividualPower(
MCP = RANGE, /* RANGE, DUNNETT2, DUNNETT1, OR MAXMOD */
g = 5, /* number of groups (exclude control for DUNNETT) */
d = 4, /* meaningful mean difference */
s = 3 /* estimate (guess) of standard deviation */
 ); </code></pre>
</div>
<div id="dunnetts-two-sided-tests-individual-power" class="section level3" number="10.6.4">
<h3><span class="header-section-number">10.6.4</span> Dunnett’s Two-Sided Tests (Individual Power)</h3>
<p>In order to detect a significant difference for a particular <span class="math inline">\(\mu_{i}-\mu_{0}\)</span> comparison when <span class="math inline">\(\mu_{i}-\mu_{0}=d\)</span>. Again, the value <span class="math inline">\(d\)</span> is a specified number that is a “meaningful” difference in the particular problem context. Then you need
<span class="math display">\[
\left|t_{i 0}\right|=\left|\frac{\bar{y}_{i}-\bar{y}_{0}}{\hat{\sigma} \sqrt{2 / n}}\right|&gt;q_{1-\alpha, g,(g+1)(n-1)}^{D 2}
\]</span>
to reject a hypothesis, and the power of the test, using the Individual Power definition, is the probability of this event. To calculate these probabilities, use the fact that the distribution of <span class="math inline">\(\left|t_{i 0}\right|\)</span> is non-central Student’s <span class="math inline">\(t\)</span> with <span class="math inline">\(d f e=(g+1)(n-1)\)</span> and noncentrality parameter as given above by <span class="math inline">\(\Delta\)</span>.</p>
<p>For example, suppose that you have <span class="math inline">\(g=6\)</span> groups (excluding control), and you want to detect a difference of <span class="math inline">\(\mu_{i}-\mu_{0}=5\)</span> for a particular comparison, and guess that the standard deviation of the measurement is <span class="math inline">\(\sigma=3.5\)</span>.</p>
<pre><code>%IndividualPower(MCP = DUNNETT2,
 G = 6 ,
 D = 5 ,
 S = 3.5 ); </code></pre>
</div>
<div id="combined-power-simpower-and-plotsimpower" class="section level3" number="10.6.5">
<h3><span class="header-section-number">10.6.5</span> Combined Power %SimPower and %PlotSimPower</h3>
<p>Complete, minimal, and proportional power involve several hypotheses simultaneously. As such, their calculations are complicated by the fact that they depend on the <strong>specific alternative settings for all non-null hypotheses</strong>, not just the alternative setting for a particular test of interest. Calculations are further complicated for complete and proportional power because they require the <strong>multivariate non-central distribution of the test statistics</strong>. The result of this complication is that calculating the power analytically is often infeasible for the combined power definitions. However, as in the case of computing the tests themselves, <strong>simulation</strong> can yield useful, if slightly imprecise, results.</p>
<pre><code>%SimPower(method = &lt;value&gt; ,
 nrep = &lt;number&gt; ,
 n = &lt;number&gt; or &lt;(n1,n2,...)&gt; ,
 s = &lt;number&gt; ,
 FWE = &lt;number&gt; ,
 TrueMeans = &lt;(m1,m2,...)&gt; ,
 seed = &lt;value&gt; );</code></pre>
<ul>
<li>METHOD is the multiple comparisons method, whether
<ul>
<li>all pairwise comparisons (METHOD = TUKEY, the default)</li>
<li>two-sided comparisons with control (METHOD = DUNNETT)</li>
<li>one-sided comparisons with a control (either METHOD = DUNNETTL or METHOD = DUNNETTU) or REGWQ</li>
<li>specify SIMULATE, so long as you also specify DIFF= to say what types of diffs, and you can also include STEPDOWN(TYPE= ), where the TYPE= variable is LOGICAL, LOGICAL(0), LOGICAL(1),…, or FREE</li>
</ul></li>
<li>NREP is the number of simulations, with 1000 as the default.</li>
<li>N is the within-group sample size (if equal) or list of within-group sample sizes (if unequal).</li>
<li>S is the underlying population standard deviation</li>
<li>FWE is the desired FWE, with 0.05 as the default.</li>
<li>TRUEMEANS lists the true group means.</li>
<li>SEED is the seed value, with 0 (computer clock time) as the default.</li>
</ul>
<p>%PlotSimPower macro to Simulate and Graph Combined Power</p>
<pre><code>%PlotSimPower(method = &lt;value&gt; ,
 nrep = &lt;number&gt; ,
 s = &lt;number&gt; ,
 FWE = &lt;number&gt; ,
 TrueMeans = &lt;(m1,m2,...)&gt; ,
 seed = &lt;value&gt; ,
 stop = &lt;value&gt;/&lt;number&gt; ,
 target = &lt;value&gt; ); </code></pre>
<ul>
<li>STOP specifies the target value of a given type of power that will be used as a stopping criterion. The syntax is type/max, where type is either Complete, Minimal, or Proportional, and where max is a maximum power at which to stop the simulation. The default is Complete/0.9, meaning that the simulation stops at the sample size n for which the complete power is greater than or equal to 0.9 (with 95% confidence).</li>
<li>TARGET is the desired power level. The default is 0.8.</li>
</ul>
<div id="all-pairwise-comparisons" class="section level4" number="10.6.5.1">
<h4><span class="header-section-number">10.6.5.1</span> <strong>All Pairwise Comparisons</strong></h4>
<pre><code>%SimPower(TrueMeans = (10, 5, 5, 0, 0),
 S = 5 ,
 N = 10 ,
 Seed = 12345 );</code></pre>
</div>
<div id="logically-constrained-step-down-tests" class="section level4" number="10.6.5.2">
<h4><span class="header-section-number">10.6.5.2</span> <strong>logically constrained step-down tests</strong></h4>
<pre><code>%SimPower(TrueMeans = (10,5,5,0,0) ,
 S = 5 ,
 N = 20 ,
 Seed = 12345 ,
 method = Simulate diff=All Stepdown(Type=Logical));</code></pre>
</div>
<div id="dunnett-comparisons-with-a-control-two-sided" class="section level4" number="10.6.5.3">
<h4><span class="header-section-number">10.6.5.3</span> <strong>DUNNETT Comparisons with a Control Two-Sided</strong></h4>
<pre><code>%SimPower(TrueMeans =(10,5,5,0,0),
 S = 5 ,
 N = 10 ,
 Seed = 12345 ,
 Method = DUNNETT );
 
*** Method = DUNNETTL One-Sided Comparisons with a Control</code></pre>
<p>Method=TUKEY, Nominal FWE=0.05, Seed=12345, True means = (-.1, -.2, .1, .05), n=2, s=500 Seed=12345, nrep=4000</p>
<p><span class="math display">\[
\begin{array}{lcc}
\hline \text { Quantity } &amp; \text { Estimate } &amp; --95 \% \mathrm{Cl}-\mathrm{-}- \\
\text { Complete Power } &amp; 0.00000 &amp; (0.000,0.000) \\
\text { Minimal Power } &amp; 0.04525 &amp; (0.039,0.052) \\
\text { Proportional Power } &amp; 0.01425 &amp; (0.012,0.017) \\
\text { Directional FWE } &amp; 0.02775 &amp; (0.023,0.033) \\
\hline
\end{array}
\]</span></p>
<pre><code>%PlotSimPower(TrueMeans = (10,5,5,0,0),
 S = 5 ,
 Seed = 12345 ,
 Method = Dunnett ); </code></pre>
<div class="figure" style="text-align: center">
<img src="02_Plots/Dunnett_Power.PNG" alt="Figure: Plotting Simulated Complete Power of Two-Sided Comparisons with a Control" width="100%" />
<p class="caption">
(#fig:Plotting Simulated Complete Power)Figure: Plotting Simulated Complete Power of Two-Sided Comparisons with a Control
</p>
</div>
</div>
<div id="step-down-dunnett" class="section level4" number="10.6.5.4">
<h4><span class="header-section-number">10.6.5.4</span> <strong>Step-down Dunnett</strong></h4>
<pre><code>%SimPower(TrueMeans = (10,5,5,0,0) ,
 S = 5 ,
 N = 20 ,
 Seed = 12345 ,
 Method = SIMULATE DIFF=CONTROLL STEPDOWN); </code></pre>
</div>
</div>
<div id="dunnett-set-up-close-tests-in-r" class="section level3" number="10.6.6">
<h3><span class="header-section-number">10.6.6</span> Dunnett Set up Close Tests in R</h3>
<p><strong>Assumptions</strong>:</p>
<ol style="list-style-type: decimal">
<li>The k treatment groups have identical treatment effect size.</li>
<li>The sample allocation ratio is pre-specified, and meanwhile the samples to be assigned to each of the k treatment groups are expected to be equal at size n. </li>
<li>The alternative hypotheses are one-sided.</li>
</ol>
<p>With the violations assumption 2, the sample size could not be evaluated numerically, and with the violation of assumption 1 and 3, the evaluation of sample size needs great computational effort and thus not implemented. In the situation, simulation-based evaluation is suggested.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="sample-size-calculation.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## https://cran.r-project.org/web/packages/DunnettTests/DunnettTests.pdf</span></span>
<span id="cb90-2"><a href="sample-size-calculation.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;DunnettTests&#39;</span>)</span>
<span id="cb90-3"><a href="sample-size-calculation.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="do">## comparing means of k treatment groups to the mean of one control group</span></span>
<span id="cb90-4"><a href="sample-size-calculation.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The k treatment groups have identical treatment effect size.</span></span>
<span id="cb90-5"><a href="sample-size-calculation.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="do">## The alternative hypotheses are one-sided.</span></span>
<span id="cb90-6"><a href="sample-size-calculation.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nvDT</span>(<span class="at">ratio=</span><span class="dv">1</span>, <span class="at">power=</span><span class="fl">0.9</span>, <span class="at">r=</span><span class="dv">1</span>, <span class="at">k=</span><span class="dv">2</span>, <span class="at">mu=</span><span class="fl">0.0606</span>, <span class="at">mu0=</span><span class="sc">-</span><span class="fl">0.039</span>, <span class="at">contrast=</span><span class="st">&quot;means&quot;</span>, </span>
<span id="cb90-7"><a href="sample-size-calculation.html#cb90-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">sigma =</span> <span class="fl">0.1188</span>,</span>
<span id="cb90-8"><a href="sample-size-calculation.html#cb90-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">dist=</span><span class="st">&quot;zdist&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">testcall=</span><span class="st">&quot;SU&quot;</span>)</span></code></pre></div>
<pre><code>## $`least sample size required in each treatment groups`
## [1] 25
## 
## $`least sample size required in the control group`
## [1] 25</code></pre>
</div>
</div>
<div id="time-to-event-data" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Time-To-Event Data</h2>
<div id="cox-ph-2-sided-equality" class="section level3" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Cox PH, 2-Sided Equality</h3>
<p>The hazard ratio is then the ratio of the hazards between two groups. Letting <span class="math inline">\(\theta\)</span> represent the hazard ratio, the hypotheses of interest are
<span class="math display">\[
\begin{array}{l}
H_{0}: \theta=\theta_{0} \\
H_{1}: \theta \neq \theta_{0}
\end{array}
\]</span>
where <span class="math inline">\(\theta_{0}\)</span> is the hazard ratio hypothesized under the null hypothesis. <span class="math inline">\(p_E\)</span> is the overall probability of the event occurring within the study period. <span class="math inline">\(p_{A}\)</span> and <span class="math inline">\(p_{B}\)</span> are the proportions of the sample size allotted to the two groups, named ‘A’ and ‘B’</p>
<p><span class="math display">\[
n=\frac{1}{p_{A} p_{B} p_{E}}\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\ln (\theta)-\ln \left(\theta_{0}\right)}\right)^{2} 
\]</span>
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\left(\ln (\theta)-\ln \left(\theta_{0}\right)\right) \sqrt{n p_{A} p_{B} p_{E}}
\]</span></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="sample-size-calculation.html#cb92-1" aria-hidden="true" tabindex="-1"></a>hr<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb92-2"><a href="sample-size-calculation.html#cb92-2" aria-hidden="true" tabindex="-1"></a>hr0<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb92-3"><a href="sample-size-calculation.html#cb92-3" aria-hidden="true" tabindex="-1"></a>pE<span class="ot">=</span><span class="fl">0.8</span></span>
<span id="cb92-4"><a href="sample-size-calculation.html#cb92-4" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb92-5"><a href="sample-size-calculation.html#cb92-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb92-6"><a href="sample-size-calculation.html#cb92-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb92-7"><a href="sample-size-calculation.html#cb92-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(<span class="fu">log</span>(hr)<span class="sc">-</span><span class="fu">log</span>(hr0)))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">*</span>pE))</span></code></pre></div>
<pre><code>## [1] 81.68207</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="sample-size-calculation.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 82</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="sample-size-calculation.html#cb96-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>((<span class="fu">log</span>(hr)<span class="sc">-</span><span class="fu">log</span>(hr0))<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">*</span>pE)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
</div>
<div id="log-rank-tests-for-competing-risks" class="section level3" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> Log-Rank Tests for Competing Risks</h3>
<p><a href="https://ncss-wpengine.netdna-ssl.com/wp-content/themes/ncss/pdf/Procedures/PASS/Logrank_Tests_Accounting_for_Competing_Risks.pdf">Logrank Tests Accounting for Competing Risks</a>: Clinical trials are often designed to test the equality of two survival distributions. The two-sample t-test is not appropriate in this case because time-to-event data is usually not normally distributed and many individuals survive past the end of the study, resulting in censored observations. Instead, the logrank test is used to compare the two survival distributions because it is easy to apply and is usually more powerful than an analysis based simply on proportions. It compares survival across the whole spectrum of time, not at just one or two points, and accounts for censoring. When analyzing time-to-event data and calculating power and sample size, a complication arises when individuals in the study die from risk factors that are not directly related to the risk factor of interest. For example, a researcher may wish to determine if a new drug for some disease improves patient survival time when compared to a standard treatment. Therefore, the researchers would be interested to know how long each patient lives until he or she dies from the disease. However, during the course of the study, patients may also die from other risks such as myocardial infarction, diabetes, or even an accident. When a patient dies from one of these other risk factors, then the main event of interest cannot be observed, so the true time-to-event of the disease for that patient can never be determined. In this example the main event of interest would be death directly attributable to the disease. All of the other types of death are called competing risks.</p>
<p><strong>Assumptions</strong></p>
<p>The power and sample size calculations in the module for the logrank test are based on the following assumptions:</p>
<ul>
<li>Failure times for the event of interest and competing risks are independent.</li>
<li>Failure times are exponentially distributed.</li>
<li>Uniform entry of subjects into the trial during the accrual period</li>
</ul>
<p><strong>Cumulative Incidence Function</strong></p>
<ol style="list-style-type: decimal">
<li><p>在没有竞争风险且没有指数假设的情况下，在时间 <span class="math inline">\(T_{0}\)</span>, 第 <span class="math inline">\(i\)</span> 组的兴趣事件为
<span class="math display">\[
F_{e v, i}\left(T_{0}\right)=1-\exp \left\{-T_{0} \times h_{e v, i}\right\}
\]</span>
where <span class="math inline">\(h_{e v, i}\)</span> is the hazard rate for the event of interest in group <span class="math inline">\(i\)</span>.
注意, 在没有竞争风险的情况下
<span class="math display">\[
F_{e v, i}\left(T_{0}\right)=1-S_{e v, i}\left(T_{0}\right)
\]</span>
<span class="math inline">\(S_{e v, i}\left(T_{0}\right)\)</span> is the cumulative survival function</p></li>
<li><p>在存在竞争风险的情况下，在时间 <span class="math inline">\(T_{0}\)</span> 的第 <span class="math inline">\(i\)</span> 组中
感兴趣事件的累积发生率函数为
<span class="math display">\[
F_{e v, i}(T 0)=\frac{h_{e v, i}}{h_{e v, i}+h_{c r, i}}\left(1-\exp \left\{-T 0 \times\left(h_{e v, i}+h_{c r, i}\right)\right\}\right)
\]</span>
<span class="math inline">\(h_{c r, i}\)</span> is the hazard rate for competing risks in group <span class="math inline">\(i\)</span>.
竞争风险的累积发生率函数为
<span class="math display">\[
F_{c r, i}(T 0)=\frac{h_{c r, i}}{h_{e v, i}+h_{c r, i}}\left(1-\exp \left\{-T 0 \times\left(h_{e v, i}+h_{c r, i}\right)\right\}\right)
\]</span>
<span class="math inline">\(h_{e v, i}\)</span> is the hazard rate for the event of interest in group <span class="math inline">\(i\)</span>.</p></li>
<li><p>通过求解该方程组, 可从累积发生率计算 <span class="math inline">\(i\)</span> 组中的危险率
<span class="math display">\[
\begin{array}{l}
h_{e v, i}=F_{e v, i}(T 0) \times\left(\frac{-\ln \left(1-F_{e v, i}(T 0)-F_{c r, i}(T 0)\right)}{T 0 \times\left(F_{e v, i}(T 0)+F_{c r, i}(T 0)\right)}\right) \\
h_{c r, i}=F_{c r, i}(T 0) \times\left(\frac{-\ln \left(1-F_{e v, i}(T 0)-F_{c r, i}(T 0)\right)}{T 0 \times\left(F_{e v, i}(T 0)+F_{c r, i}(T 0)\right)}\right)
\end{array}
\]</span></p></li>
</ol>
<p><strong>Cumulative Survival Function</strong></p>
<p><span class="math display">\[
\begin{array}{l}
S_{e v, i}(T 0)=\exp \left\{-T 0 \times h_{e v, i}\right\} \\
S_{c r, i}(T 0)=\exp \left\{-T 0 \times h_{c r, i}\right\}
\end{array}
\]</span>
The cumulative survival function is often estimated non-parametrically using the Kaplan-Meier curve. The
hazard rates for the event of interest and competing risks in group <span class="math inline">\(i\)</span> are calculated from the cumulative
survival functions as
<span class="math display">\[
\begin{array}{l}
h_{e v, i}=\left(\frac{-\ln \left(S_{e v, i}(T 0)\right)}{T 0}\right) \\
h_{c r, i}=\left(\frac{-\ln \left(S_{c r, i}(T 0)\right)}{T 0}\right)
\end{array}
\]</span></p>
<p><strong>Hazard Ratio</strong></p>
<p>Hazard rate for the treatment group divided by the hazard rate for the control group.
<span class="math display">\[H R=\left(\frac{h_{e v, 2}}{h_{e v, 1}}\right)\]</span></p>
<p><strong>Probability of Event</strong></p>
<p>With the risk rate of the event of interest and the competitive risk, the probability of observing the event of interest in the <span class="math inline">\(i\)</span> group<span class="math inline">\(\operatorname{Pr}_{e v, i}\)</span> 为:
<span class="math display">\[
\operatorname{Pr}_{e v, i}=\frac{h_{e v, i}}{h_{e v, i}+h_{c r, i}}\left(1-\frac{\exp \left\{-(T-R) \times\left(h_{e v, i}+h_{c r, i}\right)\right\}-\exp \left\{-T \times\left(h_{e v, i}+h_{c r, i}\right)\right\}}{R \times\left(h_{e v, i}+h_{c r, i}\right)}\right)
\]</span>
- <span class="math inline">\(T\)</span> is the total time of trial
- <span class="math inline">\(R\)</span> is the accrual time.
- The follow-up time is calculated as <span class="math inline">\(T-R\)</span>.
The overall probability of observing the event of interest during the study in both groups is given as
<span class="math display">\[
\operatorname{Pr}_{e v}=p_{1} \operatorname{Pr}_{e v, 1}+\left(1-p_{1}\right) \operatorname{Pr}_{e v, 2}
\]</span>
where <span class="math inline">\(p_{1}\)</span> is the proportion of subjects in the group <span class="math inline">\(\$ 1, \$\)</span> the control group.</p>
<p><strong>Number of Events</strong></p>
<ul>
<li>The total required number of events (for the event of interest), <span class="math inline">\(E\)</span></li>
<li>The number of events in group <span class="math inline">\(i\)</span> is <span class="math inline">\(E_{i}\)</span>
<span class="math display">\[
\begin{array}{l}
E=N \times \operatorname{Pr}_{e v} \\
E_{i}=n_{i} \times \operatorname{Pr}_{e v, i}
\end{array}
\]</span></li>
</ul>
<p><strong>Logrank Test Statistic</strong></p>
<p>The power and sample size formulas presented below are for the logrank test statistic, which is given by
<span class="math display">\[
L=\frac{\sum_{k=1}^{E}\left(I_{k}-\frac{Y_{1 i}}{Y_{1 i}+Y_{2 i}}\right)}{\left[\sum_{k=1}^{E}\left(\frac{Y_{1 i} Y_{2 i}}{\left(Y_{1 i}+Y_{2 i}\right)^{2}}\right)\right]^{-1 / 2}}
\]</span></p>
<ul>
<li><span class="math inline">\(E\)</span> 感兴趣类型的事件数</li>
<li><span class="math inline">\(Y_{i j}\)</span> 观察到的事件之前处于风险中的主体数prior to the <span class="math inline">\(j^{\text {th }}\)</span> in the <span class="math inline">\(i^{\text {th }}\)</span> group,</li>
<li><span class="math inline">\(I_{k}\)</span> is is a binary variable indicating whether the <span class="math inline">\(k^{\text {th }}\)</span> event of the type of interest is from group 1 or
not.</li>
<li><span class="math inline">\(L\)</span> 遵循标准正态分布</li>
</ul>
<p><strong>Power and Sample Size Calculations</strong></p>
<p>The power can be calculated using</p>
<p><span class="math display">\[
z_{1-\beta}=(-) \sqrt{E \times p_{1}\left(1-p_{1}\right)} \log (H R)-z_{1-\alpha / 2}
\]</span>
- <span class="math inline">\(p_{1}\)</span> proportion of subjects in group 1, the control group
- <span class="math inline">\(E\)</span> total number of events for the risk factor of interest</p>
<p><span class="math display">\[
E=\left(\frac{1}{p_{1}\left(1-p_{1}\right)}\right) \times\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\log (H R)}\right)^{2}
\]</span>
The overall sample size can be computed from <span class="math inline">\(E\)</span> and <span class="math inline">\(\operatorname{Pr}_{e v}\)</span> as
<span class="math display">\[
N=\frac{E}{\operatorname{Pr}_{e v}}=\left(\frac{1}{p_{1}\left(1-p_{1}\right) \times \operatorname{Pr}_{e v}}\right) \times\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\log (H R)}\right)^{2}
\]</span>
The individual group sample sizes are calculated as
<span class="math display">\[
\begin{array}{l}
n_{1}=N \times p_{1} \\
n_{2}=N \times\left(1-p_{1}\right)
\end{array}
\]</span></p>
<p>Considering the loss to Follow-Up, <span class="math inline">\(W\)</span> is the proportion lost to follow-up.
<span class="math display">\[
N_{\text {adjusted }}=\frac{N}{(1-W)}
\]</span></p>
<p><strong>R Implementation</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="sample-size-calculation.html#cb98-1" aria-hidden="true" tabindex="-1"></a>LogrankCR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(local, beta, S_ev1, S_ev2, S_cr, P1, P2, T, R, w, alpha_2){</span>
<span id="cb98-2"><a href="sample-size-calculation.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Quantile from standard normal distribution</span></span>
<span id="cb98-3"><a href="sample-size-calculation.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  z_power <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb98-4"><a href="sample-size-calculation.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  z_local <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>local, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb98-5"><a href="sample-size-calculation.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-6"><a href="sample-size-calculation.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Hazard Ratio</span></span>
<span id="cb98-7"><a href="sample-size-calculation.html#cb98-7" aria-hidden="true" tabindex="-1"></a>  H_ev1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_ev1)<span class="sc">/</span>T</span>
<span id="cb98-8"><a href="sample-size-calculation.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  H_ev2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_ev2)<span class="sc">/</span>T</span>
<span id="cb98-9"><a href="sample-size-calculation.html#cb98-9" aria-hidden="true" tabindex="-1"></a>  H_cr <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_cr)<span class="sc">/</span>T</span>
<span id="cb98-10"><a href="sample-size-calculation.html#cb98-10" aria-hidden="true" tabindex="-1"></a>  HR <span class="ot">&lt;-</span> H_ev2<span class="sc">/</span>H_ev1</span>
<span id="cb98-11"><a href="sample-size-calculation.html#cb98-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-12"><a href="sample-size-calculation.html#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Probability of observing event of interest in the group</span></span>
<span id="cb98-13"><a href="sample-size-calculation.html#cb98-13" aria-hidden="true" tabindex="-1"></a>  P_ev1 <span class="ot">&lt;-</span> (H_ev1<span class="sc">/</span>(H_ev1<span class="sc">+</span>H_cr))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>((<span class="fu">exp</span>(<span class="sc">-</span>(T<span class="sc">-</span>R)<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr))<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>T<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr)))<span class="sc">/</span>(R<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr))))</span>
<span id="cb98-14"><a href="sample-size-calculation.html#cb98-14" aria-hidden="true" tabindex="-1"></a>  P_ev2 <span class="ot">&lt;-</span> (H_ev2<span class="sc">/</span>(H_ev2<span class="sc">+</span>H_cr))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>((<span class="fu">exp</span>(<span class="sc">-</span>(T<span class="sc">-</span>R)<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr))<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>T<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr)))<span class="sc">/</span>(R<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr))))</span>
<span id="cb98-15"><a href="sample-size-calculation.html#cb98-15" aria-hidden="true" tabindex="-1"></a>  P_ev <span class="ot">&lt;-</span> P1<span class="sc">*</span>P_ev1<span class="sc">+</span>P2<span class="sc">*</span>P_ev2</span>
<span id="cb98-16"><a href="sample-size-calculation.html#cb98-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-17"><a href="sample-size-calculation.html#cb98-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sample size without follow up lost</span></span>
<span id="cb98-18"><a href="sample-size-calculation.html#cb98-18" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(P1<span class="sc">*</span>P2<span class="sc">*</span>P_ev))<span class="sc">*</span>(((z_local<span class="sc">+</span>z_power)<span class="sc">/</span><span class="fu">log</span>(HR))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb98-19"><a href="sample-size-calculation.html#cb98-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-20"><a href="sample-size-calculation.html#cb98-20" aria-hidden="true" tabindex="-1"></a>  N_Total <span class="ot">&lt;-</span> N<span class="sc">/</span>t</span>
<span id="cb98-21"><a href="sample-size-calculation.html#cb98-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## total number of events for the risk factor of interest</span></span>
<span id="cb98-22"><a href="sample-size-calculation.html#cb98-22" aria-hidden="true" tabindex="-1"></a>  E <span class="ot">&lt;-</span> N_Total<span class="sc">*</span>P_ev</span>
<span id="cb98-23"><a href="sample-size-calculation.html#cb98-23" aria-hidden="true" tabindex="-1"></a>  Z_final_Power <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sqrt</span>(E<span class="sc">*</span>P1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>P1))<span class="sc">*</span><span class="fu">log</span>(HR)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha_2, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb98-24"><a href="sample-size-calculation.html#cb98-24" aria-hidden="true" tabindex="-1"></a>  final_Power <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(Z_final_Power, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb98-25"><a href="sample-size-calculation.html#cb98-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-26"><a href="sample-size-calculation.html#cb98-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-27"><a href="sample-size-calculation.html#cb98-27" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">ceiling</span>(N<span class="sc">*</span>P1<span class="sc">*</span>P_ev1), <span class="fu">ceiling</span>(N<span class="sc">*</span>P2<span class="sc">*</span>P_ev2),</span>
<span id="cb98-28"><a href="sample-size-calculation.html#cb98-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">*</span>P1), <span class="fu">ceiling</span>(N<span class="sc">*</span>P2),</span>
<span id="cb98-29"><a href="sample-size-calculation.html#cb98-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">*</span>P1)<span class="sc">+</span> <span class="fu">ceiling</span>(N<span class="sc">*</span>P2), </span>
<span id="cb98-30"><a href="sample-size-calculation.html#cb98-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">*</span>P1<span class="sc">/</span>t)<span class="sc">+</span><span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">*</span>P2<span class="sc">/</span>t),</span>
<span id="cb98-31"><a href="sample-size-calculation.html#cb98-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">round</span>(final_Power<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),</span>
<span id="cb98-32"><a href="sample-size-calculation.html#cb98-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1), <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2),</span>
<span id="cb98-33"><a href="sample-size-calculation.html#cb98-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1)<span class="sc">+</span> <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2),</span>
<span id="cb98-34"><a href="sample-size-calculation.html#cb98-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1<span class="sc">/</span>t)<span class="sc">+</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2<span class="sc">/</span>t))</span>
<span id="cb98-35"><a href="sample-size-calculation.html#cb98-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb98-36"><a href="sample-size-calculation.html#cb98-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-37"><a href="sample-size-calculation.html#cb98-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-38"><a href="sample-size-calculation.html#cb98-38" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="cf">function</span>(final_alpha, IIIA, IIIB, IIIC_HR, IIIC_LR){</span>
<span id="cb98-39"><a href="sample-size-calculation.html#cb98-39" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.0083</span></span>
<span id="cb98-40"><a href="sample-size-calculation.html#cb98-40" aria-hidden="true" tabindex="-1"></a>  local <span class="ot">&lt;-</span> alpha<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>t)</span>
<span id="cb98-41"><a href="sample-size-calculation.html#cb98-41" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(<span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIA,    <span class="at">S_ev2=</span><span class="fl">0.90</span>,    <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.4</span>, <span class="at">P2=</span><span class="fl">0.6</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha),</span>
<span id="cb98-42"><a href="sample-size-calculation.html#cb98-42" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIB,    <span class="at">S_ev2=</span><span class="fl">0.90</span>,    <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.6</span>, <span class="at">P2=</span><span class="fl">0.4</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha),</span>
<span id="cb98-43"><a href="sample-size-calculation.html#cb98-43" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIC_HR, <span class="at">S_ev2=</span>IIIC_LR, <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.9</span>, <span class="at">P2=</span><span class="fl">0.1</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha))</span>
<span id="cb98-44"><a href="sample-size-calculation.html#cb98-44" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(out_table)</span>
<span id="cb98-45"><a href="sample-size-calculation.html#cb98-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(out_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Event HR&quot;</span>,<span class="st">&quot;Event LR&quot;</span>,<span class="st">&quot;NIA HR&quot;</span>,<span class="st">&quot;NIA LR&quot;</span>,<span class="st">&quot;NIA&quot;</span>,<span class="st">&quot;NRc&quot;</span>,<span class="st">&quot;Power&quot;</span>,<span class="st">&quot;FU HR&quot;</span>,<span class="st">&quot;FU LR&quot;</span>, <span class="st">&quot;FU IA&quot;</span>, <span class="st">&quot;FU Rc&quot;</span>)</span>
<span id="cb98-46"><a href="sample-size-calculation.html#cb98-46" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(out_table)</span>
<span id="cb98-47"><a href="sample-size-calculation.html#cb98-47" aria-hidden="true" tabindex="-1"></a>  sum[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb98-48"><a href="sample-size-calculation.html#cb98-48" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(out_table,sum)</span>
<span id="cb98-49"><a href="sample-size-calculation.html#cb98-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_table)</span>
<span id="cb98-50"><a href="sample-size-calculation.html#cb98-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-51"><a href="sample-size-calculation.html#cb98-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-52"><a href="sample-size-calculation.html#cb98-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-53"><a href="sample-size-calculation.html#cb98-53" aria-hidden="true" tabindex="-1"></a><span class="do">### If interim analysis is required</span></span>
<span id="cb98-54"><a href="sample-size-calculation.html#cb98-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rpact&quot;</span>)</span>
<span id="cb98-55"><a href="sample-size-calculation.html#cb98-55" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(<span class="at">sided =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.0083</span>, </span>
<span id="cb98-56"><a href="sample-size-calculation.html#cb98-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">informationRates =</span> <span class="fu">c</span>(<span class="dv">500</span><span class="sc">/</span><span class="dv">600</span>, <span class="dv">1</span>), </span>
<span id="cb98-57"><a href="sample-size-calculation.html#cb98-57" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">typeOfDesign =</span> <span class="st">&quot;asP&quot;</span>)</span>
<span id="cb98-58"><a href="sample-size-calculation.html#cb98-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb98-59"><a href="sample-size-calculation.html#cb98-59" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">500</span><span class="sc">/</span><span class="dv">700</span></span>
<span id="cb98-60"><a href="sample-size-calculation.html#cb98-60" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">out</span>(<span class="fl">0.003544</span>, <span class="fl">0.650</span>, <span class="fl">0.642</span>, <span class="fl">0.521</span>, <span class="fl">0.9</span>), </span>
<span id="cb98-61"><a href="sample-size-calculation.html#cb98-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Sample size calculation for Scenario 2.2 t= 500/700&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 10.1: </span>Sample size calculation for Scenario 2.2 t= 500/700</caption>
<thead>
<tr class="header">
<th align="right">Event HR</th>
<th align="right">Event LR</th>
<th align="right">NIA HR</th>
<th align="right">NIA LR</th>
<th align="right">NIA</th>
<th align="right">NRc</th>
<th align="right">Power</th>
<th align="right">FU HR</th>
<th align="right">FU LR</th>
<th align="right">FU IA</th>
<th align="right">FU Rc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">21</td>
<td align="right">9</td>
<td align="right">61</td>
<td align="right">92</td>
<td align="right">153</td>
<td align="right">62</td>
<td align="right">96.02</td>
<td align="right">82</td>
<td align="right">122</td>
<td align="right">204</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">5</td>
<td align="right">69</td>
<td align="right">46</td>
<td align="right">115</td>
<td align="right">47</td>
<td align="right">96.02</td>
<td align="right">92</td>
<td align="right">62</td>
<td align="right">154</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">47</td>
<td align="right">2</td>
<td align="right">99</td>
<td align="right">11</td>
<td align="right">110</td>
<td align="right">45</td>
<td align="right">96.02</td>
<td align="right">132</td>
<td align="right">15</td>
<td align="right">147</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">378</td>
<td align="right">154</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">505</td>
<td align="right">203</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="estimation-in-diagnostic-test" class="section level2" number="10.8">
<h2><span class="header-section-number">10.8</span> Estimation in diagnostic test</h2>
<p>Source <a href="https://www.sciencedirect.com/science/article/pii/S1532046414000501#s0030">Sample size estimation in diagnostic test studies of biomedical informatics</a></p>
<div id="adequate-sensitivityspecificity" class="section level3" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Adequate sensitivity/specificity</h3>
<p>Determine the number of cases to estimate sensitivity <span class="math inline">\((\mathrm{Se})\)</span> of new diagnostic test. Similarly, one may estimate specificity <span class="math inline">\((\mathrm{Sp})\)</span>. Since sensitivity (or specificity) is a proportion, for estimation of sensitivity (or specificity) alone when the diseased status is known, the formula for sampler size with <span class="math inline">\((1-\alpha) \%\)</span> confidence level and with maximum marginal error of estimate of <span class="math inline">\(d\)</span> for constructing confidence interval of true value of sensitivity (or specificity) using normal approximation is driven as follows:
<span class="math display">\[n=\frac{Z_{\frac{\alpha}{2}}^{2} \widehat{P}(1-\widehat{P})}{d^{2}}\]</span>
Simply one can drive the proportion of cases to controls as follows
<span class="math display">\[\frac{n_{\text {casss }}}{n_{\text {coutrols }}}=\frac{\text { Prev }}{1-\text { Prev }}\]</span>
Thus, the total sample sizes based on sensitivity and specificity respectively are
<span class="math display">\[n_{\mathrm{Se}}=\frac{Z_{\frac{\alpha}{2}}^{3} \widehat{\operatorname{Se}}(1-\widehat{\mathrm{Se}})}{d^{2} \times \mathrm{Prev}}\]</span>
<span class="math display">\[n_{\mathrm{Sp}}=\frac{Z_{\frac{\alpha}{2}}^{2} \widehat{\operatorname{Sp}}(1-\widehat{\mathrm{Sp}})}{d^{2} \times(1-\mathrm{Prev})}\]</span></p>
<p>For example, if the Se is primary interested in diagnostic screening purpose and lets the pre-determined values of Se and prevalence of disease as 80% and 10% respectively. In order the maximum marginal error of estimate does not exceed from 7% with 95% confidence level, the total required sample size can be driven by plugging the above values as follows:
<span class="math display">\[
n_{\mathrm{Se}}=\frac{1.96^{2} \times 0.8 \times 0.20}{0.07^{2} \times 0.10}=1254
\]</span></p>
<p><strong>R Implementation with Person CI</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="sample-size-calculation.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb99-2"><a href="sample-size-calculation.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb99-3"><a href="sample-size-calculation.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb99-4"><a href="sample-size-calculation.html#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="sample-size-calculation.html#cb99-5" aria-hidden="true" tabindex="-1"></a>SE_v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.85</span>,<span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb99-6"><a href="sample-size-calculation.html#cb99-6" aria-hidden="true" tabindex="-1"></a>SP_v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.90</span>,<span class="fl">0.97</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb99-7"><a href="sample-size-calculation.html#cb99-7" aria-hidden="true" tabindex="-1"></a>SampleSize <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(SE_v,SP_v)</span>
<span id="cb99-8"><a href="sample-size-calculation.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(SampleSize) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SE_v&quot;</span>,<span class="st">&quot;SP_v&quot;</span>)</span>
<span id="cb99-9"><a href="sample-size-calculation.html#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="sample-size-calculation.html#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="do">### the maximum marginal error of estimate does not exceed from 5% with 95% confidence level</span></span>
<span id="cb99-11"><a href="sample-size-calculation.html#cb99-11" aria-hidden="true" tabindex="-1"></a>d_SE <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb99-12"><a href="sample-size-calculation.html#cb99-12" aria-hidden="true" tabindex="-1"></a>d_SP <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb99-13"><a href="sample-size-calculation.html#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="sample-size-calculation.html#cb99-14" aria-hidden="true" tabindex="-1"></a>SampleSize_table <span class="ot">&lt;-</span> SampleSize <span class="sc">%&gt;%</span></span>
<span id="cb99-15"><a href="sample-size-calculation.html#cb99-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb99-16"><a href="sample-size-calculation.html#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">### prevalence for COVID cases is 1/3</span></span>
<span id="cb99-17"><a href="sample-size-calculation.html#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_SE =</span> <span class="fu">ceiling</span>((<span class="fu">qnorm</span>(<span class="fl">0.025</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> SE_v<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SE_v))<span class="sc">/</span>(d_SE<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb99-18"><a href="sample-size-calculation.html#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="do">### prevalence for non COVID cases is 1-1/3</span></span>
<span id="cb99-19"><a href="sample-size-calculation.html#cb99-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_SP =</span> <span class="fu">ceiling</span>((<span class="fu">qnorm</span>(<span class="fl">0.025</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> SP_v<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SP_v))<span class="sc">/</span>(d_SP<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1-1</span><span class="sc">/</span><span class="dv">3</span>))),</span>
<span id="cb99-20"><a href="sample-size-calculation.html#cb99-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> n_SE)</span>
<span id="cb99-21"><a href="sample-size-calculation.html#cb99-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-22"><a href="sample-size-calculation.html#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="do">### Calculation the CI based on clopper-pearson method</span></span>
<span id="cb99-23"><a href="sample-size-calculation.html#cb99-23" aria-hidden="true" tabindex="-1"></a>SampleSize_table<span class="sc">$</span>LL <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.data.frame</span>(<span class="fu">BinomCI</span>(SampleSize_table<span class="sc">$</span>N<span class="sc">*</span>SampleSize_table<span class="sc">$</span>SE_v, </span>
<span id="cb99-24"><a href="sample-size-calculation.html#cb99-24" aria-hidden="true" tabindex="-1"></a>                                               SampleSize_table<span class="sc">$</span>N, <span class="at">conf.level =</span> <span class="fl">0.975</span>, <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>), <span class="at">method =</span> <span class="fu">c</span>( <span class="st">&quot;clopper-pearson&quot;</span>),<span class="at">tol =</span> <span class="fl">0.0001</span>))[<span class="dv">2</span>],<span class="dv">3</span>)</span>
<span id="cb99-25"><a href="sample-size-calculation.html#cb99-25" aria-hidden="true" tabindex="-1"></a>SampleSize_table<span class="sc">$</span>UL <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">BinomCI</span>(SampleSize_table<span class="sc">$</span>N<span class="sc">*</span>SampleSize_table<span class="sc">$</span>SE_v, </span>
<span id="cb99-26"><a href="sample-size-calculation.html#cb99-26" aria-hidden="true" tabindex="-1"></a>                                            SampleSize_table<span class="sc">$</span>N, <span class="at">conf.level =</span> <span class="fl">0.975</span>, <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>),  <span class="at">method =</span> <span class="fu">c</span>( <span class="st">&quot;clopper-pearson&quot;</span>),<span class="at">tol =</span> <span class="fl">0.0001</span>))[<span class="dv">3</span>]</span>
<span id="cb99-27"><a href="sample-size-calculation.html#cb99-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-28"><a href="sample-size-calculation.html#cb99-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(SampleSize_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">SE_v</th>
<th align="right">SP_v</th>
<th align="right">n_SE</th>
<th align="right">n_SP</th>
<th align="right">N</th>
<th align="left">LL</th>
<th align="left">UL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.85</td>
<td align="right">0.9</td>
<td align="right">588</td>
<td align="right">208</td>
<td align="right">588</td>
<td align="left">0.819</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">0.86</td>
<td align="right">0.9</td>
<td align="right">556</td>
<td align="right">208</td>
<td align="right">556</td>
<td align="left">0.828</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="right">0.87</td>
<td align="right">0.9</td>
<td align="right">522</td>
<td align="right">208</td>
<td align="right">522</td>
<td align="left">0.838</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">0.88</td>
<td align="right">0.9</td>
<td align="right">487</td>
<td align="right">208</td>
<td align="right">487</td>
<td align="left">0.848</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="right">0.89</td>
<td align="right">0.9</td>
<td align="right">452</td>
<td align="right">208</td>
<td align="right">452</td>
<td align="left">0.857</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</div>
<div id="testing-sensitivity-or-specificity" class="section level3" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> Testing sensitivity (or specificity)</h3>
<p><strong>Sample size for testing sensitivity (or specificity) of single diagnostic test</strong></p>
<p>Suppose <span class="math inline">\(P_{0}\)</span> denote the pre-determined value of sensitivity or specificity of new diagnostic test. In comparing the test’s accuracy to fixed value of <span class="math inline">\(P_{0}\)</span>, the null and alternative hypothesis is
<span class="math display">\[\mathrm{H}_{0}: \mathrm{Se}=P_{0}$ versus $\mathrm{H}_{1}: \mathrm{Se} \neq P_{0}$ (or $\left.\mathrm{Se}=P_{1}\right)\]</span>
where <span class="math inline">\(P_{1}\)</span> is the value of sensitivity (or specificity) under alternative hypothesis. Using normal approximation as a general rule, Z-score under the null and alternative hypothesis can defined and thus the required sample size for cases is driven as follows:</p>
<p><span class="math display">\[
n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{P_{0}\left(1-P_{0}\right)}+Z_{\beta} \sqrt{P_{1}\left(1-P_{1}\right)}\right]^{2}}{\left(P_{1}-P_{0}\right)^{2}}
\]</span></p>
<p><strong>Sample size for comparing the sensitivity (or specificity) of two diagnostic tests</strong></p>
<p>For studies comparing sensitivity and/or specificity of two tests of unpaired design. In comparing the diagnostic accuracy of two alternative tasks for two independent samples, suppose <span class="math inline">\(P_{1}\)</span> and <span class="math inline">\(P_{2}\)</span> denote the expected proportion (Se or Sp) of two alternative diagnostic tests respectively. For testing hypothesis:
<span class="math display">\[\mathrm{H}_{0}: \mathrm{P}_{1}=\mathrm{P}_{2} \ \text{versus} \ \mathrm{H}_{1} :P_{1} \neq P_{2}\]</span>, the required sample size with equal size based on normal approximation of binomial data with <span class="math inline">\(1-\alpha\)</span> confidence level and <span class="math inline">\(1-\beta\)</span> power is
<span class="math display">\[n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{2 \times \bar{P}(1-\bar{P})}+Z_{\beta} \sqrt{P_{1}\left(1-P_{1}\right)+P_{2}\left(1-P_{2}\right)}\right]^{2}}{\left(P_{1}-P_{2}\right)^{2}}\]</span>
where <span class="math inline">\(\bar{P}\)</span> the average of <span class="math inline">\(P_{1}\)</span> and <span class="math inline">\(P_{2}\)</span> and <span class="math inline">\(Z_{\alpha}, Z_{\beta}\)</span> is are the standard normal <span class="math inline">\(Z\)</span> values corresponding to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (the probability of type I and type II errors respectively).</p>
</div>
<div id="likelihood-ratio-estimation" class="section level3" number="10.8.3">
<h3><span class="header-section-number">10.8.3</span> Likelihood ratio estimation</h3>
<p>As we described when test yields positive or negative results, sensitivity and specificity are the two inherent indexes of accuracy, but LR that <strong>combines the sensitivity and specificity of test as uni-dimensional index</strong>, is a greater of interest. A test with higher LR^+ has a greater value of rule in the disease while a test with lower value of LR<sup>−</sup> has a higher value of rule out disease. These two indexes are particularly interesting in comparative studies of two or multiple tests. The test with greater value of LR^+ and lower values of LR<sup>−</sup> has more diagnostic abilities in the classification of true status of diseased and nondiseased. Thus, positive LR and negative LR play an important rule for clinical decision and they can be used in estimating sample size in diagnostic test.</p>
<p>Suppose <span class="math inline">\(\widehat{P}_{1}\)</span> and <span class="math inline">\(\widehat{P}_{2}\)</span> denote the <strong>sensitivity and 1 -specificity</strong> of a test respectively and <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> denote the sample size for diseased and nondiseased. The ratio estimator of <span class="math inline">\(\mathrm{LR}^{\perp}=\frac{\widehat{P}_{1}}{\widehat{P}_{2}}\)</span> is skewed and the logarithm transformation can be used to convert its distribution to normal approximately. Thus, <span class="math inline">\(\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}}\)</span> can be assumed that asymptotically normally distributed with standard error of <span class="math inline">\(\sqrt{\frac{1-\widehat{P}_{1}}{n_{1} \hat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\)</span> and therefore <span class="math inline">\((1-\alpha) \%\)</span> confidence interval for <span class="math inline">\(\log \left(\mathrm{LR}^{+}\right)\)</span> is as
follows:
<span class="math display">\[\log \left(\mathrm{LR}^{+}\right)=\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}} \pm Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\hat{P}_{1}}{n_{1} \widehat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\]</span>
With the presumption of equal sample size for diseased and nondiseased (i.e. <span class="math inline">\(\left.n_{1}=n_{2}=n\right)\)</span>, then the required sample size for each group of cases and controls can be calculated by solving the Eq. (6.10) as follows:
<span class="math display">\[n=\frac{\left(Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\hat{P}_{1}}{\hat{P}_{1}}+\frac{1-\hat{P}_{2}}{\hat{P}_{2}}}\right)^{2}}{\left(\log (\mathrm{LR}+)-\log \frac{\hat{P}_{1}}{\hat{P}_{2}}\right)^{2}}\]</span></p>
<p>In another condition, a diagnostic test may be useful, if negative LR is lower than a pre-determined value. Then, the sample size would be calculated based on the confidence bond of negative LR. Similarly, one could drive a confidence interval for <span class="math inline">\(\mathrm{LR}^{-}\)</span> as follows:
<span class="math display">\[\log \left(\mathrm{LR}^{-}\right)=\left(\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}} \pm Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\widehat{P}_{1}}{n_{1} \widehat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\right)\]</span>
where <span class="math inline">\(\widehat{P}_{1}=\mathrm{Sp}\)</span> and <span class="math inline">\(\widehat{P}_{2}=1-\mathrm{Se}\)</span></p>
</div>
<div id="roc-index-of-accuracy" class="section level3" number="10.8.4">
<h3><span class="header-section-number">10.8.4</span> ROC index of accuracy</h3>
<p><strong>Sample size for estimating accuracy index</strong></p>
<p>ROC curves show the trade off between sensitivity and specificity and the area under the curve (AUC) is considered as an index of accuracy. The AUC can be estimated parametric (binormal model) and nonparametric (Wilcoxon statistic) approaches. Both approaches allow estimating the sampling variability of AUC. In diagnostic studies, involving ROC analysis, for the purpose of estimating or testing AUC, the clinicians should decide the number of patients and controls needed in study protocol. Suppose a clinical researcher wishes to estimate the diagnostic accuracy as defined by AUC in which the marginal error of estimate (i.e. the difference between true AUC and its estimate) does not exceed from a pre-determined value of <span class="math inline">\(d\)</span> with <span class="math inline">\((1-\alpha) \%\)</span> confidence level (e.g. <span class="math inline">\(95 \%)\)</span>. Using normal approximation in constructing confidence interval for AUC, we have
<span class="math display">\[Z_{\frac{\alpha}{2}} \mathrm{SE}(\widehat{\mathrm{AUC}}) \leqslant d\]</span>
By squaring two sides of equation, then
<span class="math display">\[Z_{\frac{\alpha}{2}}^{2} \operatorname{Var}(\widehat{\mathrm{AUC}})=d^{2}\]</span></p>
<p><strong>The variance of nonparametric AUC</strong></p>
<p>The variance of nonparametric AUC (Wilcoxon statistic) is estimated using the methods that proposed by Bamber [48] as
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\frac{\mathrm{AUC}(1-\mathrm{AUC})+\left(n_{1}-1\right)\left(Q_{1}-\mathrm{AUC}^{2}\right)+\left(n_{2}-1\right)\left(Q_{2}-\mathrm{AUC}^{2}\right)}{n_{1} n_{2}}\]</span>
Hanley and McNeil [7] used exponential approximation to estimate <span class="math inline">\(\mathrm{Q}_{1}\)</span> and <span class="math inline">\(\mathrm{Q}_{2}\)</span> as
<span class="math display">\[Q_{1}=\frac{\mathrm{AUC}}{2-\mathrm{AUC}} \quad\]</span> and <span class="math display">\[\quad Q_{2}=\frac{2 \mathrm{AUC}^{2}}{1+\mathrm{AUC}}\]</span>
that allows one to estimate the variance of AUC and its SE. Thus, the variance of AUC under the null and also alternative hypothesis can be estimated easily.
For studies with continuous test results <span class="math inline">\(\operatorname{Var}(\widehat{\mathrm{AUC}})\)</span> can be written approximately
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\frac{Q_{1}}{r}+Q_{2}-\operatorname{AUC}^{2}\left(\frac{1}{r}+1\right)\]</span>
where <span class="math inline">\(\mathrm{r}\)</span> the ratio of sample size of controls to cases <span class="math inline">\(\left(r=\frac{n_{2}}{n_{1}}\right)\)</span>.</p>
<p><strong>The variance of parametric AUC</strong></p>
<p>The two parameters of ROC curves based on binormal assumption are defined as <span class="math inline">\(a=\frac{\mu_{2}-\mu_{1}}{\sigma_{1}}\)</span> and <span class="math inline">\(b=\frac{\sigma_{1}}{\sigma_{2}}\)</span> where <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\sigma_{1}\)</span> the mean and standard deviation of distribution for nondiseased and <span class="math inline">\(\mu_{2}\)</span> and <span class="math inline">\(\sigma_{2}\)</span> are for diseased distribution respectively. The area under curve with binormal model is <span class="math inline">\(\mathrm{AUC}=\varphi\left[\frac{a}{1+b^{2}}\right]\)</span> where <span class="math inline">\(\varphi\)</span> is the cumulative distribution function. Delta method can be used to estimate
variance and SE of AUC. With an approximation when the ratio of SD is close to one (i.e. <span class="math inline">\(b=1\)</span> ) the binormal estimator of variance of <span class="math inline">\((\widehat{\mathrm{AUC}})\)</span> is
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\left(0.0099 \times e^{-a^{2} / 2}\right) \times\left(\frac{5 a^{2}+8}{n_{2}}+\frac{a^{2}+8}{n_{1}}\right)\]</span>
where <span class="math inline">\(a=\varphi^{-1}(\mathrm{AUC}) \times 1.414\)</span> and <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> are the sample size for nondiseased and diseased.</p>
<p>Lets <span class="math inline">\(V(\widehat{\mathrm{AUC}})=n \operatorname{Var}((\widehat{\mathrm{AUC}})\)</span>. Thus, the required sample size for each group of nondiseased and diseased is
<span class="math display">\[n=\frac{Z_{\frac{\alpha}{2}}^{2} V(\widehat{\mathrm{AUC}})}{d^{2}}\]</span></p>
<p><strong>Sample size for testing accuracy of quantitative diagnostic test of single modality</strong></p>
<p><span class="math display">\[
\begin{array}{l}
\mathrm{H}_{0}: \mathrm{AUC}=\mathrm{AUC}_{0} \text { versus } \mathrm{H}_{1}: \mathrm{AUC} \neq \mathrm{AUC}_{0} \\
\text { (i. e. } \left.\mathrm{AUC}=\mathrm{AUC}_{1}\right)
\end{array}
\]</span></p>
<p><span class="math display">\[
n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{V_{\mathrm{H} 0}(\widehat{\mathrm{AUC}})} \perp Z_{\beta} \sqrt{V_{\mathrm{Hl}}(\widehat{\mathrm{AUC}})}\right]^{2}}{\left[\mathrm{AUC}_{1}-\mathrm{AUC}_{0}\right]^{2}}
\]</span></p>
<p><strong>Sample size for comparing accuracy of two diagnostic tests</strong></p>
<p><span class="math display">\[\mathrm{H}_{0}: \mathrm{AUC}_{1}=\mathrm{AUC}_{2}$ versus $\mathrm{H}_{1}: \mathrm{AUC}_{1} \neq \mathrm{AUC}_{2}\]</span></p>
<p>The required sample sizes for each group are driven as
<span class="math display">\[n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{V_{\mathrm{H} 0}\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)} \perp Z_{\beta} \sqrt{V_{\mathrm{H} 1}\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)}\right]}{\left[\mathrm{AUC}_{1}-\mathrm{AUC}_{2}\right]^{2}}\]</span>
where
<span class="math display">\[V\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)=n \operatorname{Var}\left(\widehat{\mathrm{AUC}}_{1}\right)+n \operatorname{Var}\left(\widehat{\mathrm{AUC}}_{2}\right)-2 n \operatorname{Cov}\left(\widehat{\mathrm{AUC}}_{1}, \widehat{\mathrm{AUC}}_{2}\right)\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive-statistics-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="parametric-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/13-Sample-Size.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
