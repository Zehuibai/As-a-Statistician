[
["multiple-comparison.html", "Chapter 15 Multiple Comparison 15.1 One-Way ANOVA 15.2 ANOVA Model Diagnosis 15.3 Two-Ways ANOVA Test", " Chapter 15 Multiple Comparison 15.1 One-Way ANOVA 15.1.1 R implementation df.residual 返回残差的自由度 coef 返回被估计的系数(有时还包括他们的标准差) residuals 返回残差 deviance 返回方差 fitted 返回拟合值 logLik 计算对数似然值和返回参数数目 AIC 计算Akaike信息准则(Akaike information criterion, AIC) (依赖于logLik()) Intelligenz &lt;- data.frame(IQ.Werte=c(99, 131, 118, 112, 128, 136, 120, 107, 134, 122,134, 103, 127, 121, 139, 114, 121, 132,120, 133, 110, 141, 118, 124, 111, 138, 120,117, 125, 140, 109, 128, 137, 110, 138, 127, 141, 119, 148), Fach=c(rep(1,10),rep(2,8),rep(3,9),rep(4,12))) Intelligenz$Fach &lt;- factor(Intelligenz$Fach,labels=c(&quot;I&quot;, &quot;II&quot;, &quot;III&quot;,&quot;IV&quot;)) ## Compute summary statistics library(dplyr) group_by(Intelligenz, Fach) %&gt;% summarise( count = n(), mean = mean(IQ.Werte, na.rm = TRUE), sd = sd(IQ.Werte, na.rm = TRUE) ) ## # A tibble: 4 x 4 ## Fach count mean sd ## * &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 I 10 121. 12.1 ## 2 II 8 124. 11.7 ## 3 III 9 124. 11.2 ## 4 IV 12 128. 12.8 ## Visualize your data with ggpubr library(&quot;ggpubr&quot;) ggboxplot(Intelligenz, x = &quot;Fach&quot;, y = &quot;IQ.Werte&quot;, color = &quot;Fach&quot;, palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;,&quot;#E7298A&quot;), order = c(&quot;I&quot;,&quot;II&quot;,&quot;III&quot;,&quot;IV&quot;), ylab = &quot;IQ.Werte&quot;, xlab = &quot;Fach&quot;) ## Model Fitting Intelligenz.aov &lt;- aov(IQ.Werte~Fach, data=Intelligenz) summary(Intelligenz.aov) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## Fach 3 319 106.4 0.736 0.538 ## Residuals 35 5060 144.6 15.2 ANOVA Model Diagnosis Homogeneity Test Homogeneity of variance assumption using Plot Homogeneity of variance assumption using Levene’s test, which is less sensitive to departures from normal distribution. (对偏离正态分布不敏感) Homogeneity of variance assumption with no assumption of equal variances (放宽方差假设的同质性) Normality assumption Multiple Test 15.2.1 Homogeneity Test ## Check the homogeneity of variance assumption plot(Intelligenz.aov, 1) ## Levene’s test, Homogeneity of variance assumption library(car) leveneTest(IQ.Werte ~ Fach, data = Intelligenz) ## Levene&#39;s Test for Homogeneity of Variance (center = median) ## Df F value Pr(&gt;F) ## group 3 0.134 0.9392 ## 35 ## With no assumption of equal variances oneway.test(IQ.Werte~Fach, data=Intelligenz) ## ## One-way analysis of means (not assuming equal variances) ## ## data: IQ.Werte and Fach ## F = 0.64123, num df = 3.000, denom df = 18.758, p-value = 0.598 15.2.2 Normality assumption Using QQ Plot or Shapiro–Wilk test to test residuals ## Check the normality assumption plot(Intelligenz.aov, 2) ## Shapiro–Wilk test to test residuals ## Extract the residuals and run Shapiro-Wilk test aov_residuals &lt;- residuals(object = Intelligenz.aov ) shapiro.test(x = aov_residuals ) ## ## Shapiro-Wilk normality test ## ## data: aov_residuals ## W = 0.96021, p-value = 0.1813 15.2.3 Violation of assumptions 15.2.3.1 Random Effects Models \\[Y_{ij} = \\mu + \\alpha_i + \\epsilon_{ij},\\] We assume \\(\\alpha_i \\; \\textrm{i.i.d.} \\sim N(0, \\sigma_{\\alpha}^2).\\) and \\(E[Y_{ij}] = \\mu\\), \\(\\text{Var}(Y_{ij}) = \\sigma_{\\alpha}^2 + \\sigma^2\\), \\(\\text{Cor}(Y_{ij}, Y_{kl}) = \\left\\{ \\begin{array}{cc} 0 &amp; i \\neq k \\\\ \\sigma_{\\alpha}^2 / (\\sigma_{\\alpha}^2 + \\sigma^2) &amp; i = k, j \\neq l (\\text{intraclass correlation (ICC)})\\\\ 1 &amp; i = k, j = l \\end{array} \\right.\\) MLE is not usable for parameter estimation for the variance components \\(\\sigma_a^2\\) and \\(\\sigma^2\\), Restricted maximum likelihood (REML) is applied here. REML is less biased. The parameter \\(\\mu\\) is estimated with maximum-likelihood assuming that the variances are known. 15.2.3.2 Non-Parametric Test Non-parametric alternative to one-way ANOVA test, Kruskal-Wallis rank sum test, which can be used when ANOVA assumptions are not met. kruskal.test(IQ.Werte~Fach, data=Intelligenz) 15.3 Two-Ways ANOVA Test "]
]
