<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Logistic Regression | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Logistic Regression | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Logistic Regression | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-linear-regression.html"/>
<link rel="next" href="advanced-logistic-regression.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#coord" id="toc-coord"><span class="toc-section-number">4.4.3</span> coord</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.5</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.6</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.7</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#reorder" id="toc-reorder"><span class="toc-section-number">4.5.2</span> Reorder</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.3</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.5</span> Dot + Box Plot</a></li>
<li><a href="ggplot2.html#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.5.6</span> Violin Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.2</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Logistic Regression</h1>
<div id="htmlwidget-ca72e5d45807bce7b2f0" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca72e5d45807bce7b2f0">{"x":{"data":"# \n## Logistic Regression \n### Introduction\n#### Violation of assumptions of Ordinary least squares (OLS) \n#### More fundamental problem outside [0,1]\n#### Logistic Regression Model \n#### Estimation of the Logistic Model\n#### Convergence Problems\n#### Use exact methods. \n#### Use penalized likelihood\n### Logit Modell\n#### Introduction\n#### R Implementation\n#### SAS Implementation\n#### Multicollinearity\n#### Goodness-of-Fit Statistics Pearson deviance\n#### Hosmer and Lemeshow Goodness-of-Fit Test\n#### Statistics Measuring Predictive Power $R^2$\n##### Generalized $R^$\n##### McFadden $R^$\n##### Tjur's $R^$\n#### ROC Curves \n#### Predicted Values, Residuals, and Influence Statistics\n#### Unobserved Heterogeneity\n### Illustration in SAS\n#### Effects of Predictor Variables\n#### Odds ratio plot\n### Probit Modell\n#### Introduction\n#### R Implemetation\n#### SAS Implementation\n### Complementary log-log-Modell\n#### R Implemetation\n### Multicategory Logit Models \n#### Multinomialverteilung\n#### Nominal Response\n##### R Implementation\n##### SAS Implementation\n#### Ordinal Response: Cumulative Logit Model\n##### R Implementation\n##### SAS Implementation\n### Adjacent Categories Model\n### Continuation Ratio Model","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="introduction" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Introduction</h2>
<p>Use probability-based linear models to predict qualitative response variables, three methods:</p>
<ol style="list-style-type: decimal">
<li>Logistic regression</li>
<li>Linear discriminant analysis<br />
</li>
<li>Multivariate adaptive regression spline</li>
</ol>
<div id="violation-of-assumptions-of-ordinary-least-squares-ols" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</h3>
<p>The basic assumptions of OLS regression</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(y_{i}=\alpha+\beta x_{i}+\varepsilon_{i} \mid\)</span></li>
<li><span class="math inline">\(\mathrm{E}\left(\varepsilon_{i}\right)=0\)</span></li>
<li><span class="math inline">\(\operatorname{var}\left(\varepsilon_{i}\right)=\sigma^{2}\)</span></li>
<li><span class="math inline">\(\operatorname{cov}\left(\varepsilon_{i}, \varepsilon_{j}\right)=0\)</span></li>
<li><span class="math inline">\(\varepsilon_{i} \sim\)</span> Normal</li>
</ol>
<p><strong>Normal residuals assumption</strong></p>
<p>Assuming y is a dichotomy, the possible values are 1 or 0. Assume yi = 1. Then hypothesis 1 means εi = 1–α–βxi. On the other hand, if yi = 0, we have εi = –α–βxi. Since εi can only take two values, it is impossible to have a normal distribution</p>
<p><strong>Consistant variance assumption</strong></p>
<p><span class="math display">\[E\left(y_{i}\right)=1 \times \operatorname{Pr}\left(y_{i}=1\right)+0 \times \operatorname{Pr}\left(y_{i}=0\right)\]</span></p>
<p>If we define <span class="math inline">\(p i=\operatorname{Pr}(y i=1)\)</span>,Then
<span class="math display">\[E\left(y_{i}\right)=p_{i}\]</span></p>
<p><span class="math display">\[
\begin{array}{c}
E\left(y_{i}\right)=E\left(\alpha+\beta x_{i}+\varepsilon_{i}\right)
=E(\alpha)+E\left(\beta x_{i}\right)+E\left(\varepsilon_{i}\right)
=\alpha+\beta x_{i}
\end{array}
\]</span>
Putting these two results together, we get
<span class="math display">\[
\begin{array}{c}
p_{i}=\alpha+\beta x_{i} \\
\operatorname{var}\left(\varepsilon_{i}\right)=p_{i}\left(1-p_{i}\right)=\left(\alpha+\beta x_{i}\right)\left(1-\alpha-\beta x_{i}\right)
\end{array}
\]</span>
For different observations, the variance of <span class="math inline">\(ε_i\)</span> must be different, especially as it changes with changes in x. When pi = 0.5, the disturbance variance is the largest, and when pi is close to 1 or 0, the disturbance variance becomes smaller.</p>
<p><strong>Problems</strong></p>
<p>If the sample is quite large, the normality assumption is not required. The <strong>central limit theorem</strong> assures us that even if ε is not normally distributed, the coefficient estimates will have an approximately normal distribution. This means that we can still use ordinary tables to calculate p-values and confidence intervals. However, if the sample is small, these approximations may be poor.</p>
<!-- 如果样本相当大，则不需要正态假设。中心极限定理向我们保证，即使ε不呈正态分布，系数估计也将具有近似正态的分布。这意味着我们仍然可以使用普通表来计算p值和置信区间。但是，如果样本较小，则这些近似值可能会很差。 -->
<p><strong>Violation of the homoscedasticity assumption has two undesirable consequences.</strong></p>
<ol style="list-style-type: decimal">
<li>First, the coefficient estimates are no longer <strong>effective</strong>. In statistical terms, this means that there are other selection methods with smaller standard errors.</li>
<li>the standard error estimates are no longer consistent estimates of the true standard errors. That means that the estimated standard errors could be biased (either upward or downward) to unknown degrees. And because the standard errors are used in calculating test statistics, the test statistics could also be problematic.</li>
</ol>
<!-- 首先，系数估计不再有效。用统计术语来说，这意味着存在其他选择方法，它们的标准误差较小。 -->
<!-- 其次，更严重的是，标准误差估计不再是真实标准误差的一致估计。这意味着估计的标准误差可能会偏向（向上或向下）到未知程度。并且由于标准误差用于计算测试统计信息，因此测试统计信息也可能会出现问题。幸运的是，可以轻松解决标准错误和测试统计信息的潜在问题。 -->
<p><strong>Heteroscedasticity consistent covariance estimator “sandwich”</strong></p>
<p>Even if the homogeneity assumption is violated, this method will produce a consistent estimate of the standard error. To implement this method in PROC REG, just put the option HCC on the MODEL statement</p>
<pre><code>PROC REG DATA=penalty;
  MODEL death=blackd whitvic serious / HCC; 
RUN;</code></pre>
<!-- 尽管HCC标准误差很容易解决，但是请注意，它们固有地具有比常规标准误差更大的采样变异性（Kauermann和Carroll 2001），并且在小样本中可能尤其不可靠。但是，对于大样本，它们应该是令人满意的. -->
</div>
<div id="more-fundamental-problem-outside-01" class="section level3" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> More fundamental problem outside [0,1]</h3>
<p>For Linear probability model <span class="math inline">\(p_{i}=\alpha+\beta x_{i}\)</span>, If x has no upper or lower limit, then for any value of β, there is a value of x whose pi is greater than 1 or less than 0.</p>
</div>
<div id="logistic-regression-model" class="section level3" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Logistic Regression Model</h3>
<p>Probability is bounded by 0 and 1, while linear functions are inherently unbounded. The solution is to convert the probability so that it is no longer restricted. Converting probabilities to odds eliminates the upper limit. For k explanatory variables
<span class="math display">\[\log \left[\frac{p_{i}}{1-p_{i}}\right]=\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
<span class="math display">\[p_{i}=\frac{\exp \left(\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right)}{1+\exp \left(\alpha+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right)}\]</span>
<span class="math display">\[p_{i}=\frac{1}{1+\exp \left(-\alpha-\beta_{1} x_{i 1}-\beta_{2} x_{i 2}-\ldots-\beta_{k} x_{i k}\right)}\]</span></p>
<!-- 逻辑模型的方程式中没有随机扰动项。这并不意味着该模型是确定性的，因为pi和yi之间的概率关系仍然存在随机变化的空间。-->
<p>There is <strong>no random disturbance term</strong> in the equation of the logic model. This does not mean that the model is deterministic, because there is still room for random variation in the probability relationship between pi and yi.</p>
</div>
<div id="estimation-of-the-logistic-model" class="section level3" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> Estimation of the Logistic Model</h3>
<ul>
<li>ordinary least squares,</li>
<li>weighted least squares,</li>
<li>maximum likelihood.</li>
</ul>
<blockquote>
<p>假设分析单位是商业公司，并且因变量是员工是全职员工的概率。设Pi为在i公司中全职工作的可观察员工比例。
要通过OLS估计逻辑模型，我们可以简单地采用P的logit变换，即log [P/（1-P）]，然后将结果回归到公司特征和员工平均特征上。
加权最小二乘（WLS）分析将类似，不同之处在于将对数据进行加权以针对异方差进行调整。
最大似然（ML）是为分组数据估算逻辑模型的第三种方法，也是一般用于单个级别数据的唯一方法。
利用个人数据，我们只需观察每个人的二分因变量以及该人的测量特征即可。</p>
</blockquote>
<p><strong>ML</strong></p>
<blockquote>
<p>最大似然受欢迎程度有两个原因。
1. ML估计量是一致的，渐近有效的并且渐近正态的。
2. 在没有其他明显候选者的情况下，通常很容易得出ML估计量. 为此，有两个步骤：
（1）写下数据概率作为未知参数的函数的表达式，以及（2）找到使该表达式的值尽可能大的未知参数值。</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><strong>Consistency</strong> means that as the sample size gets larger the probability that the estimate is within some small distance of the true value also gets larger. No matter how small the distance or how high the specified probability, there is always a sample size that yields an even higher probability that the estimator is within that distance of the true value. One implication of consistency is that the ML estimator is approximately unbiased in large samples.</li>
<li><strong>Asymptotic efficiency</strong> means that, in large samples, the estimates will have standard errors that are, approximately, at least as small as those for any other estimation method. And, finally, the sampling distribution of the estimates will be approximately normal in large samples, which means that you can use the normal and chi-square distributions to compute confidence intervals and p-values. All these approximations get better as the sample size gets larger. The fact that these desirable properties have only been proven for large samples does not mean that ML has bad properties for small samples. It simply means that we usually don’t know exactly what the small-sample properties are. And in the absence of attractive alternatives, researchers routinely use ML estimation for both large and small samples.</li>
</ol>
<!-- 一致性意味着，随着样本数量的增加，估计值在真实值的一小段距离内的可能性也会随之增加。无论距离有多小或指定概率有多高，总有一个样本大小会产生更高的概率，即估计量在真实值的该距离内。一致性的一个暗示是，在大样本中ML估计量几乎是无偏的。 -->
<!-- 渐近效率意味着，在大样本中，估计将具有大约至少与任何其他估计方法一样小的标准误差。最后，在大样本中，估计值的采样分布将近似于正态，这意味着您可以使用正态分布和卡方分布来计算置信区间和p值。随着样本数量的增加，所有这些近似值都会变得更好。这些合意的特性仅在大样本中得到证明的事实并不意味着ML对于小样本具有不良的特性。这仅表示我们通常不确切知道小样本属性是什么。而且，在没有有吸引力的替代方案的情况下，研究人员通常对大型和小型样本都使用ML估计。 -->
<p><strong>Maximum Likelihood Estimation </strong></p>
<p>We have data for n individuals (i = 1, …, n), and these individuals are considered statistically independent. For each i, the data consists of yi and xi, where yi is a random variable with possible values 0 and 1, and xi = [1 xi1…xik]’ is a vector of explanatory variables (1 is the intercept).) Let pi The probability of yi = 1
<span class="math display">\[p_{i}=\frac{1}{1+e^{-\boldsymbol{\beta} \mathbf{x}_{i}}}\]</span></p>
<p>The likelihood of observing the values of <span class="math inline">\(y\)</span> for all the observations can be written as
<span class="math display">\[L=\operatorname{Pr}\left(y_{1}, y_{2,} \ldots, y_{n}\right)\]</span></p>
<p>Because we are assuming that observations are independent, the overall probability of observing all the <span class="math inline">\(y_{i}, \mathrm{~s}\)</span> can be factored into the product of the individual probabilities:
<span class="math display">\[
L=\operatorname{Pr}\left(y_{1}\right) \operatorname{Pr}\left(y_{2}\right) \ldots \operatorname{Pr}\left(y_{n}\right)=\prod_{i=1}^{n} \operatorname{Pr}\left(y_{i}\right)
\]</span>
By definition, <span class="math inline">\(\operatorname{Pr}\left(y_{i}=1\right)=p_{i}\)</span> and <span class="math inline">\(\operatorname{Pr}\left(y_{i}=0\right)=1-p_{i} .\)</span> That implies that we can write
<span class="math display">\[
\begin{array}{c}
\operatorname{Pr}\left(y_{i}\right)=p_{i}^{y_{i}}\left(1-p_{i}\right)^{1-y_{i}} \\
L=\prod_{i=1}^{n} p_{i}^{y_{i}}\left(1-p_{i}\right)^{1-y_{i}}=\prod_{i=1}^{n}\left(\frac{p_{i}}{1-p_{i}}\right)^{y_{i}}\left(1-p_{i}\right) .
\end{array}
\]</span>
At this point we take the logarithm of both sides of the equation to get
<span class="math display">\[
\log L=\sum_{i} y_{i} \log \left(\frac{p_{i}}{1-p_{i}}\right)+\sum_{i} \log \left(1-p_{i}\right)
\]</span>
And for equation
<span class="math display">\[
\log L=\sum_{i} \boldsymbol{\beta} \mathbf{x}_{i} y_{i}-\sum_{i} \log \left(1+e^{\boldsymbol{\beta} \mathbf{x}_{i}}\right)
\]</span>
Taking the derivative of equation and setting it equal to 0 gives us:
<span class="math display">\[
\begin{aligned}
\frac{\partial \log L}{\partial \boldsymbol{\beta}} &amp;=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i}\left(1+e^{-\boldsymbol{\beta} \mathbf{x}_{i}}\right)^{-1} \\
&amp;=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i}=0
\end{aligned}
\]</span>
<span class="math display">\[\hat{y}_{i}=\frac{1}{1+e^{-\beta \mathbf{x}_{i}}}\]</span>
<strong>Newton-Raphson iterative methods</strong></p>
<p>There is no clear solution to the equation. Instead, we must rely on iterative methods, which are equivalent to successive approximations to the solution until the approximation “converges” to the solution. Until the approximation “converges” to the correct value. Again, there are many different ways to do this. All methods produce the same solution, but they differ in factors such as convergence speed, sensitivity to initial values, and computational difficulty of each iteration. The Newton-Raphson algorithm is one of the most widely used iterative methods.
<span class="math display">\[
\begin{array}{l}
\mathbf{U}(\boldsymbol{\beta})=\frac{\partial \log L}{\partial \boldsymbol{\beta}}=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i} \\
\mathbf{I}(\boldsymbol{\beta})=\frac{\partial^{2} \log L}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^{\prime}}=-\sum_{i} \mathbf{x}_{i} \mathbf{x}_{i}^{\prime} \hat{y}_{i}\left(1-\hat{y}_{i}\right)
\end{array}
\]</span></p>
<!-- 方程没有明确的解决方案。 取而代之的是，我们必须依靠迭代方法，这些方法等于对解的逐次逼近，直到逼近“收敛”到解。直到逼近“收敛”到正确的值为止。同样，有许多不同的方法可以执行此操作。所有方法都产生相同的解决方案，但是它们在诸如收敛速度，对初始值的敏感性以及每次迭代的计算难度等因素方面有所不同。 牛顿-拉夫森（Newton-Raphson）算法是最广泛使用的迭代方法之一 -->
<p>The Newton-Raphson algorithm is then <span class="math display">\[\boldsymbol{\beta}_{j+1}=\boldsymbol{\beta}_{j}-\mathbf{I}^{-1}\left(\boldsymbol{\beta}_{j}\right) \mathbf{U}\left(\boldsymbol{\beta}_{j}\right)\]</span></p>
<p>We need a set of initial values <span class="math inline">\(\beta_0\)</span>. PROC LOGISTIC starts by setting all slope coefficients to 0. Set the intercept to be equal to log [p /(1-p)], where p is the total proportion of events. These initial values are substituted into the right side of the equation, resulting in the result of the first iteration <span class="math inline">\(\beta_1\)</span>. Then substitute these values into the right side, recalculate the first and second derivatives, and the result is <span class="math inline">\(\beta_2\)</span> Repeat this process until you get “convergence”.</p>
<p>This means that what is inserted on the right is obtained on the left. In fact, you will never get exactly the same thing, so it is necessary to adopt a convergence criterion to judge whether the proximity is close enough. But since every successful run of PROC LOGISTIC reports “Convergence criterion (GCONV=1E-8) satisfied,”
<span class="math display">\[\frac{\mathbf{U}\left(\boldsymbol{\beta}_{j}\right)^{\prime} \mathbf{I}^{-1}\left(\boldsymbol{\beta}_{j}\right) \mathbf{U}\left(\boldsymbol{\beta}_{j}\right)}{\left|\log L\left(\boldsymbol{\beta}_{j}\right)\right|+.000001}\]</span></p>
<p>If the number is less than .00000001, convergence is declared and the algorithm stops.</p>
</div>
<div id="convergence-problems" class="section level3" number="13.1.5">
<h3><span class="header-section-number">13.1.5</span> Convergence Problems</h3>
<blockquote>
<p>逻辑模型的最大似然估计是逐次逼近的迭代过程。通常，该过程会顺利进行，无需特别注意。很少需要超过10次迭代才能达到收敛。但是，有时迭代过程会中断，因此无法实现收敛。处理收敛失败可能是逻辑回归用户遇到的更令人沮丧的问题之一。 LOGISTIC的默认限制为25次迭代。如果算法尚未达到此限制，则LOGISTIC会发出警告消息，并在最后一次迭代时打印出结果。尽管可以提高迭代限制（使用MODEL语句中的MAXITER =选项），但这很少能解决问题。未进行25次迭代收敛的模型通常永远不会收敛。在大多数收敛失败的情况下，最大似然估计根本不存在。</p>
</blockquote>
<p><strong>Quasi-complete separation of data points detected.</strong></p>
<blockquote>
<p>准完全分离的最常见原因是虚拟预测变量具有以下属性：在虚拟变量的一个级别上，每种情况下因变量都为1或每种情况下都为0。查看任何分类自变量与因变量的交叉分类也非常有帮助。如果您在这些表中的任何一个中发现单元频率为0，则说明了造成准完全分离的原因。找到问题变量后，如何处理</p>
</blockquote>
<ul>
<li>Recode the problem variables</li>
<li>Collapse categories</li>
<li>Exclude cases from the model</li>
</ul>
<p><strong>Retain the model with quasi-complete separation but use likelihood-ratio tests.</strong></p>
<p>The reported standard error and Wald’s chi-square of this variable are also of no avail. Nevertheless, it is still possible to obtain a valid likelihood ratio test, <em>Profile Likelihood confidence interval.</em></p>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious / CLPARM=PL ALPHA=.01;
RUN;

##########################################
Parameter Estimate   99% Confidence Limits
culp 1    -15.5467          . -3.2344</code></pre>
</div>
<div id="use-exact-methods." class="section level3" number="13.1.6">
<h3><span class="header-section-number">13.1.6</span> Use exact methods.</h3>
<blockquote>
<p>尽管最大似然具有许多吸引人的属性，但请务必记住，最大似然产生的标准误差和p值是大样本近似值。 在小样本或分离的情况下，准确性可能不如我们想要的那样好。 具有良好的小样本属性的另一种估算方法是“精确逻辑回归”。 这种方法可以看作是费雪（Fisher）对双向列联表的精确检验的概括。 在这种方法中，p值是通过在原假设下枚举所有可能的样本结果来计算的。 即使在完全分离或准完全分离的情况下，精确方法也会产生有效的p值。</p>
</blockquote>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious;
 EXACT culp serious / ESTIMATE=BOTH;
RUN; </code></pre>
<p>These tests are conditional in the sense that they are based on the conditional distribution of the sufficient statistic for each parameter, conditioning on the sufficient statistics for all the other parameters. (The sufficient statistics are the sums of cross products for each x and the binary dependent variable y.) The tests are exact in the same sense that t-statistics are exact in normal-theory linear regression. That is, they are not large sample approximations, and they give the correct probability of getting a result that is at least as extreme as the one observed in the sample, under the null hypothesis that a variable has no effect.</p>
</div>
<div id="use-penalized-likelihood" class="section level3" number="13.1.7">
<h3><span class="header-section-number">13.1.7</span> Use penalized likelihood</h3>
<p>处理拟完全分离的最简单，最有效的方法之一是一种被称为惩罚似然估计的方法，该方法由Firth（1993）引入，因此通常被称为Firth方法。 众所周知，传统的最大似然估计可能会在小样本中产生偏差。 惩罚似然法旨在减少这种偏差，适用于最大似然的广泛应用。 Heinze和Schemper（2002）表明，这种方法在处理准完全分离的情况下特别有效。 运作方式如下。 在牛顿-拉夫森算法（方程3.7）中，一阶导数U（β）</p>
<p><span class="math display">\[\mathbf{U}(\boldsymbol{\beta})=\frac{\partial \log L}{\partial \boldsymbol{\beta}}=\sum_{i} \mathbf{x}_{i} y_{i}-\sum_{i} \mathbf{x}_{i} \hat{y}_{i}-\sum_{i} h_{i} \mathbf{x}_{i}\left(.5-\hat{y}_{i}\right)\]</span>
In PROC LOGISTIC, the method is implemented with the FIRTH option on the MODEL statement</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 WHERE blackd=0;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = culp serious / FIRTH
 CLPARM=PL;
RUN;</code></pre>
</div>
</div>
<div id="logit-modell" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Logit Modell</h2>
<div id="introduction-1" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Introduction</h3>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Complementary log-log model:
<span class="math display">\[\pi=1-\exp (-\exp (\eta)) \quad \Longleftrightarrow \quad \log (-\log (1-\pi))=\eta\]</span></p>
<p><strong>Interpretation</strong></p>
<p><span class="math display">\[\frac{\mathrm{P}\left(y_{i}=1 \mid \boldsymbol{x}_{i}\right)}{\mathrm{P}\left(y_{i}=0 \mid \boldsymbol{x}_{i}\right)}=\exp \left(\beta_{0}\right) \cdot \exp \left(x_{i 1} \beta_{1}\right) \cdot \ldots \cdot \exp \left(x_{i k} \beta_{k}\right)\]</span></p>
<p><span class="math display">\[\frac{\mathrm{P}\left(y_{i}=1 \mid x_{i 1}, \ldots\right)}{\mathrm{P}\left(y_{i}=0 \mid x_{i 1}, \ldots\right)} / \frac{\mathrm{P}\left(y_{i}=1 \mid x_{i 1}+1, \ldots\right)}{\mathrm{P}\left(y_{i}=0 \mid x_{i 1}+1, \ldots\right)}=\exp \left(\beta_{1}\right)\]</span></p>
<p><span class="math display">\[
\begin{array}{l}
\beta_{1}&gt;0: \text {Chance} $\mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text {wird größer},\\
\beta_{1}&lt;0: \text { Chance } \mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text { wird kleiner, } \\
\beta_{1}=0: \text { Chance } \mathrm{P}\left(y_{i}=1\right) / \mathrm{P}\left(y_{i}=0\right) \text { bleibt gleich. }
\end{array}
\]</span></p>
</div>
<div id="r-implementation" class="section level3" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> R Implementation</h3>
<ul>
<li>Compare models <code>anova(fit.model1, fit.model2, test = "Chisq")</code></li>
<li>Change Referenz <code>relevel(factor(school2$RANK),ref=4)</code></li>
<li>Interpret coefficients Odds <code>exp(coef(fit.reduced))</code></li>
<li>Predict using new datasets <code>predict(fit.model, newdata = testdata, type = "response")</code></li>
<li>CIs using profiled log-likelihood <code>confint(fit.model)</code></li>
<li>CIs using standard errors <code>confint.default(fit.model)</code></li>
<li>VIF statistics <code>library(car), vif(fit.model)</code></li>
<li>Wald Test <code>library(aod) ,wald.test()</code></li>
<li>Log likelihood ratio test <code>logLik()</code></li>
<li>Marginal effects <code>library(mfx), logitmfx</code></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="logistic-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get summary statistics </span></span>
<span id="cb5-2"><a href="logistic-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Affairs, <span class="at">package =</span> <span class="st">&quot;AER&quot;</span>)</span>
<span id="cb5-3"><a href="logistic-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Affairs)</span></code></pre></div>
<pre><code>##     affairs          gender         age         yearsmarried    children 
##  Min.   : 0.000   female:315   Min.   :17.50   Min.   : 0.125   no :171  
##  1st Qu.: 0.000   male  :286   1st Qu.:27.00   1st Qu.: 4.000   yes:430  
##  Median : 0.000                Median :32.00   Median : 7.000            
##  Mean   : 1.456                Mean   :32.49   Mean   : 8.178            
##  3rd Qu.: 0.000                3rd Qu.:37.00   3rd Qu.:15.000            
##  Max.   :12.000                Max.   :57.00   Max.   :15.000            
##  religiousness     education       occupation        rating     
##  Min.   :1.000   Min.   : 9.00   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:14.00   1st Qu.:3.000   1st Qu.:3.000  
##  Median :3.000   Median :16.00   Median :5.000   Median :4.000  
##  Mean   :3.116   Mean   :16.17   Mean   :4.195   Mean   :3.932  
##  3rd Qu.:4.000   3rd Qu.:18.00   3rd Qu.:6.000   3rd Qu.:5.000  
##  Max.   :5.000   Max.   :20.00   Max.   :7.000   Max.   :5.000</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="logistic-regression.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Affairs<span class="sc">$</span>affairs)</span></code></pre></div>
<pre><code>## 
##   0   1   2   3   7  12 
## 451  34  17  19  42  38</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="logistic-regression.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 感兴趣的是二值型结果(有过一次婚 外情/没有过婚外情),将affairs转化为二值型因子ynaffair。</span></span>
<span id="cb9-2"><a href="logistic-regression.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## create binary outcome variable</span></span>
<span id="cb9-3"><a href="logistic-regression.html#cb9-3" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair[Affairs<span class="sc">$</span>affairs <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="logistic-regression.html#cb9-4" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair[Affairs<span class="sc">$</span>affairs <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-5"><a href="logistic-regression.html#cb9-5" aria-hidden="true" tabindex="-1"></a>Affairs<span class="sc">$</span>ynaffair <span class="ot">&lt;-</span> <span class="fu">factor</span>(Affairs<span class="sc">$</span>ynaffair, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb9-6"><a href="logistic-regression.html#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb9-7"><a href="logistic-regression.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Affairs<span class="sc">$</span>ynaffair)</span></code></pre></div>
<pre><code>## 
##  No Yes 
## 451 150</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="logistic-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit full model</span></span>
<span id="cb11-2"><a href="logistic-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a>fit.full <span class="ot">&lt;-</span> <span class="fu">glm</span>(ynaffair <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> yearsmarried <span class="sc">+</span> </span>
<span id="cb11-3"><a href="logistic-regression.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    children <span class="sc">+</span> religiousness <span class="sc">+</span> education <span class="sc">+</span> occupation <span class="sc">+</span> rating, </span>
<span id="cb11-4"><a href="logistic-regression.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Affairs, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-5"><a href="logistic-regression.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.full)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ynaffair ~ gender + age + yearsmarried + children + 
##     religiousness + education + occupation + rating, family = &quot;binomial&quot;, 
##     data = Affairs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5713  -0.7499  -0.5690  -0.2539   2.5191  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.37726    0.88776   1.551 0.120807    
## gendermale     0.28029    0.23909   1.172 0.241083    
## age           -0.04426    0.01825  -2.425 0.015301 *  
## yearsmarried   0.09477    0.03221   2.942 0.003262 ** 
## childrenyes    0.39767    0.29151   1.364 0.172508    
## religiousness -0.32472    0.08975  -3.618 0.000297 ***
## education      0.02105    0.05051   0.417 0.676851    
## occupation     0.03092    0.07178   0.431 0.666630    
## rating        -0.46845    0.09091  -5.153 2.56e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 675.38  on 600  degrees of freedom
## Residual deviance: 609.51  on 592  degrees of freedom
## AIC: 627.51
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="logistic-regression.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从回归系数的p值(最后一栏)可以看到，性别、是否有孩子、学历和职业对方程的贡献都不显著(你无法拒绝参数为0的假设)。去除这些变量重新拟合模型，检验新模型是否拟合得好</span></span>
<span id="cb13-2"><a href="logistic-regression.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit reduced model</span></span>
<span id="cb13-3"><a href="logistic-regression.html#cb13-3" aria-hidden="true" tabindex="-1"></a>fit.reduced <span class="ot">&lt;-</span> <span class="fu">glm</span>(ynaffair <span class="sc">~</span> age <span class="sc">+</span> yearsmarried <span class="sc">+</span> </span>
<span id="cb13-4"><a href="logistic-regression.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    religiousness <span class="sc">+</span> rating, <span class="at">data =</span> Affairs, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb13-5"><a href="logistic-regression.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reduced)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ynaffair ~ age + yearsmarried + religiousness + 
##     rating, family = binomial(), data = Affairs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6278  -0.7550  -0.5701  -0.2624   2.3998  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.93083    0.61032   3.164 0.001558 ** 
## age           -0.03527    0.01736  -2.032 0.042127 *  
## yearsmarried   0.10062    0.02921   3.445 0.000571 ***
## religiousness -0.32902    0.08945  -3.678 0.000235 ***
## rating        -0.46136    0.08884  -5.193 2.06e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 675.38  on 600  degrees of freedom
## Residual deviance: 615.36  on 596  degrees of freedom
## AIC: 625.36
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="logistic-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb15-2"><a href="logistic-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.reduced, fit.full, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: ynaffair ~ age + yearsmarried + religiousness + rating
## Model 2: ynaffair ~ gender + age + yearsmarried + children + religiousness + 
##     education + occupation + rating
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1       596     615.36                     
## 2       592     609.51  4   5.8474   0.2108</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="logistic-regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果的卡方值不显著(p=0.21)，表明四个预测变量的新模型与九个完整预测变量的模型拟合程度一样好。这使得你更加坚信添加性别、孩子、学历和职业变量不会显著提高方程的预测精 度，因此可以依据更简单的模型进行解释。</span></span>
<span id="cb17-2"><a href="logistic-regression.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="logistic-regression.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 解释模型参数</span></span>
<span id="cb17-4"><a href="logistic-regression.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># interpret coefficients</span></span>
<span id="cb17-5"><a href="logistic-regression.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.reduced)</span></code></pre></div>
<pre><code>##   (Intercept)           age  yearsmarried religiousness        rating 
##    1.93083017   -0.03527112    0.10062274   -0.32902386   -0.46136144</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="logistic-regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit.reduced))</span></code></pre></div>
<pre><code>##   (Intercept)           age  yearsmarried religiousness        rating 
##     6.8952321     0.9653437     1.1058594     0.7196258     0.6304248</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="logistic-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CIs using profiled log-likelihood</span></span>
<span id="cb21-2"><a href="logistic-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit.reduced)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept)    0.75404303  3.150622807
## age           -0.07006400 -0.001854759
## yearsmarried   0.04388142  0.158562400
## religiousness -0.50637196 -0.155156981
## rating        -0.63741235 -0.288566411</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="logistic-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CIs using standard errors</span></span>
<span id="cb23-2"><a href="logistic-regression.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(fit.reduced)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept)    0.73463085  3.127029497
## age           -0.06928747 -0.001254761
## yearsmarried   0.04337199  0.157873491
## religiousness -0.50434371 -0.153703999
## rating        -0.63547499 -0.287247895</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="logistic-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 测试等级的总体效果。 在系数表中给出系数的顺序与模型中项的顺序相同</span></span>
<span id="cb25-2"><a href="logistic-regression.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Globale Test</span></span>
<span id="cb25-3"><a href="logistic-regression.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb25-4"><a href="logistic-regression.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(fit.reduced), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit.reduced), <span class="at">Terms =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 27.4, df = 4, P(&gt; X2) = 1.7e-05</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="logistic-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## the three terms for the levels of rank.</span></span>
<span id="cb27-2"><a href="logistic-regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(fit.reduced), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit.reduced), <span class="at">Terms =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 26.7, df = 3, P(&gt; X2) = 6.9e-06</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="logistic-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## likelihood ratio test</span></span>
<span id="cb29-2"><a href="logistic-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## An indicator to measure the degree of model fit. The test statistic is the residual deviation between the model with predictor variables and the zero model.</span></span>
<span id="cb29-3"><a href="logistic-regression.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## The degree of freedom of the chi-square distribution of the test statistic is equal to the degree of freedom difference between the current model and the zero model (that is, the number of predictors in the model)</span></span>
<span id="cb29-4"><a href="logistic-regression.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, null.deviance <span class="sc">-</span> deviance)            <span class="co"># 卡方值为41.46</span></span></code></pre></div>
<pre><code>## [1] 60.01915</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="logistic-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, df.null <span class="sc">-</span> df.residual)               <span class="co"># degrees of freedom </span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="logistic-regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(fit.reduced, <span class="fu">pchisq</span>(null.deviance <span class="sc">-</span> deviance, </span>
<span id="cb33-2"><a href="logistic-regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a>     df.null <span class="sc">-</span> df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))       <span class="co"># the p-value</span></span></code></pre></div>
<pre><code>## [1] 2.874106e-12</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="logistic-regression.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## called a likelihood ratio test (the deviance residual is -2*log likelihood).</span></span>
<span id="cb35-2"><a href="logistic-regression.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(fit.reduced)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -307.6789 (df=5)</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="logistic-regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 探究每一个预测变量对结果概率的影响</span></span>
<span id="cb37-2"><a href="logistic-regression.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个虚拟数据集，设定 年龄、婚龄和宗教信仰为它们的均值，婚姻评分的范围为1~5。</span></span>
<span id="cb37-3"><a href="logistic-regression.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probability of extramariatal affair by marital ratings</span></span>
<span id="cb37-4"><a href="logistic-regression.html#cb37-4" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rating =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), </span>
<span id="cb37-5"><a href="logistic-regression.html#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>age), <span class="at">yearsmarried =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>yearsmarried), </span>
<span id="cb37-6"><a href="logistic-regression.html#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">religiousness =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>religiousness))</span>
<span id="cb37-7"><a href="logistic-regression.html#cb37-7" aria-hidden="true" tabindex="-1"></a>testdata<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.reduced, <span class="at">newdata =</span> testdata, </span>
<span id="cb37-8"><a href="logistic-regression.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb37-9"><a href="logistic-regression.html#cb37-9" aria-hidden="true" tabindex="-1"></a>testdata</span></code></pre></div>
<pre><code>##   rating      age yearsmarried religiousness      prob
## 1      1 32.48752     8.177696      3.116473 0.5302296
## 2      2 32.48752     8.177696      3.116473 0.4157377
## 3      3 32.48752     8.177696      3.116473 0.3096712
## 4      4 32.48752     8.177696      3.116473 0.2204547
## 5      5 32.48752     8.177696      3.116473 0.1513079</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="logistic-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probabilites of extramariatal affair by age</span></span>
<span id="cb39-2"><a href="logistic-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rating =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>rating), </span>
<span id="cb39-3"><a href="logistic-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">seq</span>(<span class="dv">17</span>, <span class="dv">57</span>, <span class="dv">10</span>), <span class="at">yearsmarried =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>yearsmarried), </span>
<span id="cb39-4"><a href="logistic-regression.html#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">religiousness =</span> <span class="fu">mean</span>(Affairs<span class="sc">$</span>religiousness))</span>
<span id="cb39-5"><a href="logistic-regression.html#cb39-5" aria-hidden="true" tabindex="-1"></a>testdata<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.reduced, <span class="at">newdata =</span> testdata, </span>
<span id="cb39-6"><a href="logistic-regression.html#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb39-7"><a href="logistic-regression.html#cb39-7" aria-hidden="true" tabindex="-1"></a>testdata</span></code></pre></div>
<pre><code>##    rating age yearsmarried religiousness      prob
## 1 3.93178  17     8.177696      3.116473 0.3350834
## 2 3.93178  27     8.177696      3.116473 0.2615373
## 3 3.93178  37     8.177696      3.116473 0.1992953
## 4 3.93178  47     8.177696      3.116473 0.1488796
## 5 3.93178  57     8.177696      3.116473 0.1094738</code></pre>
</div>
<div id="sas-implementation" class="section level3" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> SAS Implementation</h3>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic serious;
RUN; </code></pre>
<blockquote>
<p>在MODEL语句中指定的一个选项是因变量之后的EVENT =‘1’。 LOGISTIC中的默认值是估计一个预测因变量最低值的模型。因此，如果我省略了EVENT =‘1’，则结果将是一个逻辑模型，预测因变量DEATH等于0的概率。EVENT=’1’选项将其反转，以便模型预测因变量等于1。</p>
</blockquote>
<blockquote>
<p>一种等效的（流行的）方法是使用选项DEATH （DESCENDING），它告诉LOGISTIC对DEATH的“较高”值进行建模，而不是对较低值进行建模。但是，较高而不是较低的值取决于所选的其他选项，因此明确建模哪个因变量值较为安全。如果您忘记了EVENT =’1’选项，则唯一的结果就是更改系数的符号。</p>
</blockquote>
<pre><code>*** For Multiplicative Terms in the MODEL Statement;

MODEL y = x|x|x;
MODEL y = x x*x x*x*x;</code></pre>
<p><strong>class</strong></p>
<blockquote>
<p>当CLASS变量作为解释变量包含在MODEL语句中时，LOGISTIC自动创建一组“设计变量”来表示CLASS变量的级别。当预测变量是指示变量（虚拟变量）时，例如仅具有0或1的值，则无需将其声明为CLASS变量。实际上，将指示符变量放在CLASS语句上可能会产生误导性的结果。这是因为CLASS语句可能会以意想不到的方式重新编码变量，正如我们将看到的那样。因此，CLASS语句应保留给具有两个以上类别的分类变量，或保留具有字符值（例如“是”和“否”）的二分变量。</p>
</blockquote>
<pre><code>PROC LOGISTIC DATA=penalty;
 CLASS culp /PARAM=REF;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp ;
RUN;</code></pre>
<p>Change the default reference category (5 in this example) and hope it is the minimum value of CULP instead of the maximum value</p>
<p><code>CLASS culp / PARAM=REF DESCENDING;</code></p>
<p>Particular value, say 3</p>
<p><code>CLASS culp(REF='3') / PARAM=REF;</code></p>
<p><strong>Confidence Intervals</strong></p>
<ul>
<li>Wald CI: <code>CLPARM = WALD</code></li>
<li>Profile likelihood CI: Can produce better approximations, especially in smaller samples using <code>CLPARM = PL</code></li>
<li>Two confidence intervals:</li>
</ul>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / CLPARM=BOTH;
RUN;</code></pre>
<p><strong>Marginal effect</strong></p>
<p>For each variable, we obtain the predicted change in the probability of death penalty for each additional unit of the variable according to the predicted probability of the person.
Get them easily with PROC QLIM</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic serious;
RUN; 

PROC QLIM DATA=penalty;
 ENDOGENOUS death~DISCRETE(DIST=LOGISTIC);
 MODEL death = blackd whitvic serious;
 OUTPUT OUT=a MARGINAL;
PROC PRINT DATA=a(OBS=10);
 VAR meff_p2_blackd meff_p2_whitvic meff_p2_serious;
RUN; </code></pre>
</div>
<div id="multicollinearity" class="section level3" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Multicollinearity</h3>
<p>当解释变量之间有很强的线性相关性时，就会发生多重共线性。基本要点是，如果两个或多个变量彼此高度相关，则很难很好地估计它们对某些因变量的不同影响。尽管多重共线性不会使系数产生偏差，但确实会使系数更加不稳定。标准误差可能会变得很大，并且看起来似乎单独具有较弱影响的变量实际上可能整体上具有相当强的影响。幸运的是，多重共线性的结果仅适用于共线性的那些变量。</p>
<p>当单个变量都不是重要变量，而整个变量集都很重要时，多重共线性很可能是罪魁祸首 When none of the individual variables is significant but the entire set is significant, multicollinearity is a likely culprit.</p>
<p><strong>How to diagnose multicollinearity</strong></p>
<ul>
<li>检查PROC CORR产生的相关矩阵可能会有所帮助，但还不够。没有一对变量之间具有高度相关性的数据是很有可能的，但是几个变量在一起可能是高度相互依存的。</li>
<li>PROC REG使用TOL，VIF和COLLINOINT选项可以产生更好的诊断结果。但是PROC LOGISTIC没有这些选项，
多重共线性是解释变量的属性，而不是因变量。因此，每当您怀疑logit模型中的多重共线性时，只需在PROC REG中估计等效模型并请求共线性选项即可</li>
</ul>
<pre><code>PROC REG DATA=penalty;
 MODEL death = blackd whitvic serious serious2 / TOL VIF;
RUN; </code></pre>
<p><span class="math display">\[
\begin{array}{|l|r|r|r|r|r|r|r|}
\hline \text { Variable } &amp; \text { DF } &amp; \text {Parameter} &amp; \text { Standard } &amp; \text { t Value } &amp; \text { Pr }&gt;\mid \text { |t| }&amp; \text { Tolerance }&amp; \text { Variance } \\
&amp; \text {   } &amp; \text {Estimate  } &amp; \text {Error  } &amp;  &amp; &amp; &amp; \text { Inflation } \\
\hline \text { Intercept } &amp; 1 &amp; -0.14164 &amp; 0.18229 &amp; -0.78 &amp; 0.4384 &amp; &amp; 0 \\
\hline \text { blackd } &amp; 1 &amp; 0.12093 &amp; 0.08242 &amp; 1.47 &amp; 0.1445 &amp; 0.85428 &amp; 1.17058 \\
\hline \text { whitvic } &amp; 1 &amp; 0.05739 &amp; 0.08451 &amp; 0.68 &amp; 0.4982 &amp; 0.84548 &amp; 1.18276 \\
\hline \text { serious } &amp; 1 &amp; 0.01924 &amp; 0.03165 &amp; 0.61 &amp; 0.5442 &amp; 0.14290 &amp; 6.99788 \\
\hline \text { serious2 } &amp; 1 &amp; 0.07044 &amp; 0.10759 &amp; 0.65 &amp; 0.5137 &amp; 0.14387 &amp; 6.95081 \\
\hline
\end{array}
\]</span>
在绝大多数情况下，这种诊断方法应该完全令人满意，但有时可能会漏掉严重的多重共线性（Davis等人，1986）。这是因为理想情况下，应通过最大似然算法中使用的权重矩阵来调整线性组合</p>
<p><strong>Weight matrix</strong></p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic serious serious2;
 OUTPUT OUT=a PRED=phat;
DATA b;
 SET a;
 w = phat*(1-phat);
PROC REG DATA=b;
 WEIGHT w;
 MODEL death = blackd whitvic serious1 serious2 / TOL VIF;
RUN; </code></pre>
<p>OUTPUT语句创建一个新的数据集，该数据集包含MODEL语句中的所有变量以及变量PHAT，该变量PHAT包含因变量的预测概率。然后，将这些预测值用于DATA步骤以构建权重变量W。最后，使用W作为权重变量执行加权最小二乘回归。对于这些数据，共线性诊断仅与显示的略有不同</p>
<p>可用于逻辑回归的解决方案范围与线性回归的解决方案范围几乎相同，例如删除变量，将变量组合到索引中以及测试关于变量集的假设。通常，没有一个潜在的解决办法是非常令人满意的。</p>
</div>
<div id="goodness-of-fit-statistics-pearson-deviance" class="section level3" number="13.2.5">
<h3><span class="header-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</h3>
<p>三种不同的“模型拟合统计量”：AIC，SC和-2 LogL。2 Log L的值越高，表示数据拟合越差。但是请记住，此统计信息的总体大小在很大程度上取决于观察值的数量。此外，对于适合的条件还没有绝对的标准，因此人们只能使用此统计信息来比较适合同一数据集的不同模型。-2 Log L的问题在于，协变量更多的模型仅靠偶然就趋于更好地拟合。其他两个拟合统计量通过惩罚具有更多协变量的模型来避免此问题。</p>
<ul>
<li>Akaike’s Information Criterion (AIC) <span class="math inline">\(A I C=-2 \log L+2 k\)</span></li>
<li>Schwarz Criterion (SC), also known as the Bayesian Information Criterion (BIC) <span class="math inline">\(S C=-2 \log L+k \log n\)</span></li>
</ul>
<p><strong>deviance</strong></p>
<p>deviance is a goodness-of-fit statistic for a statistical model; it is often used for statistical hypothesis testing. It is a generalization of the idea of using the sum of squares of residuals (RSS) in ordinary least squares to cases where model-fitting is achieved by maximum likelihood.</p>
<p><span class="math display">\[{\displaystyle D(y,{\hat {\mu }})=2{\Big (}\log {\big (}p(y\mid {\hat {\theta }}_{s}){\big )}-\log {\big (}p(y\mid {\hat {\theta }}_{0}){\big )}{\Big )}.\,}\]</span></p>
<p>LOGISTIC中的AGGREGATE和SCALE选项获得具有卡方分布的偏差, AGGREGATE选项告诉LOGISTIC汇总各个预测变量级别上的数据。 SCALE选项要求拟合优度统计信息，但是指定SCALE = NONE会告诉LOGISTIC不要针对过度分散调整拟合优度统计信息</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / AGGREGATE
SCALE=NONE;
RUN;</code></pre>
<p><strong>Saturated mode</strong></p>
<p>偏差将拟合模型与饱和模型进行了隐式对比。 我们可以使用以下程序拟合饱和模型：</p>
<pre><code>PROC LOGISTIC DATA=penalty;
    CLASS culp;
    MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp blackd*whitvic
    blackd*culp whitvic*culp blackd*whitvic*culp ;
RUN; 

*** The MODEL statement could also be abbreviated;
MODEL death(EVENT=&#39;1&#39;) = blackd|whitvic|culp;</code></pre>
</div>
<div id="hosmer-and-lemeshow-goodness-of-fit-test" class="section level3" number="13.2.6">
<h3><span class="header-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</h3>
<p>与偏差不同，皮尔逊（Pearson）的卡方在应用于个人级数据时没有卡方分布。 尽管SCALE和AGGREGATE选项通常很有用，但如果有很多解释变量，或者如果其中一些变量是按连续统来衡量的，那么它们就无济于事。 在这些情况下，轮廓将几乎与原始观测值一样多，并且通过汇总无法实现任何目的。 偏差和皮尔逊卡方均不会具有真实的卡方分布。 为了弥补这一缺陷，Hosmer和Lemeshow（2000）提出了一种已迅速得到广泛使用的测试。 可以使用MODEL语句中的LACKFIT选项在LOGISTIC中实现。 让我们将其应用于我们刚刚评估的模型。</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = blackd whitvic culp / LACKFIT;
RUN; </code></pre>
<p>Hosmer-Lemeshow（HL）统计信息的计算方法如下。基于估计的模型，将为所有观测值生成预测的概率。这些文件按大小排序，然后分成大约10个间隔。在每个时间间隔内，通过将预测的概率相加来获得预期的事件数。通过从间隔中的案例数中减去预期的事件数，可以得到预期的非事件数。通过常规的Pearson卡方统计，将这些预期频率与观察到的频率进行比较。自由度是间隔数减去2。高p值（如本例所示）表明拟合模型不能被拒绝，并得出结论：该模型拟合良好。也就是说，无法通过添加非线性和/或交互来显着改善它</p>
</div>
<div id="statistics-measuring-predictive-power-r2" class="section level3" number="13.2.7">
<h3><span class="header-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></h3>
<div id="generalized-r2" class="section level4" number="13.2.7.1">
<h4><span class="header-section-number">13.2.7.1</span> Generalized <span class="math inline">\(R^{2}\)</span></h4>
<p>which is the statistic reported by LOGISTIC under the heading “Testihg Global Null Hypothesis: BETA=0.” If we denote that statistic by <span class="math inline">\(L^{2}\)</span> and let <span class="math inline">\(n\)</span> be the sample size, the generalized <span class="math inline">\(R^{2}\)</span> is
<span class="math display">\[
R^{2}=1-\exp \left\{-\frac{L^{2}}{n}\right\}
\]</span>
将RSQ选项放在MODEL语句上, <span class="math inline">\(\mathrm{LOGISTIC}\)</span> 会为您完成。这是广义R2的原理。此公式可用于通过最大似然估 计的任何回归模型, 包括概率模型, 泊松回归模型和Cox回归模型。除了作为常规R2的泛化的吸引力之
外, 广义R2还具有以下几方面的作用:
- It’s based on the quantity being maximized, namely the log-likelihood. 基于最大化的数量, 即对数似然
- It’s invariant to grouping. You get the same <span class="math inline">\(\mathrm{R} 2\)</span> whether you’re working with grouped or individual-level data (as long as cases are only grouped together if they’re identical on all the independent variables). 分组不变。无论您使用分组数据还是个人数据, 您都将获得相同的R2
- It’s readily obtained with virtually all computer programs because the loglikelihood is nearly always
reported by default.
几乎所有计算机程序都可以轻松获得它, 因为默认情况下几乎总是报告对数可能性
- It never diminishes when you add variables to a model. 当您向模型添加变量时, 它永远不会减少。
- The calculated values are usually quite similar to the <span class="math inline">\(\mathrm{R} 2\)</span> obtained from fitting a linear probability model to dichotomous data by ordinary least squares. 计算得出的值通常与通过普通最小二乘法将线性概率模型拟合为二分数据所获得的R2十分相似。</p>
<p>尽管广义R2的行为可能与线性模型R2非常相似，但不能将其解释为自变量“解释”的方差比例。广义R2的一 个可能的缺点是它的上限小于1，因为因变量是离散的。为了解决这个问题, LOGISTIC还报告了一个标有“ Max-rescaled Rsquare”的字样, 它将原始R2除以上限 (Nagelkerke 1991) 。</p>
</div>
<div id="mcfadden-r2" class="section level4" number="13.2.7.2">
<h4><span class="header-section-number">13.2.7.2</span> McFadden <span class="math inline">\(R^{2}\)</span></h4>
<p>McFadden的 <span class="math inline">\(R^{2}\)</span> 也是基于对数似然法, 但公式有些不同。 <span class="math inline">\(L^{2}\)</span> 为检验所有系数均为0的零假设的似然比卡
方, <span class="math inline">\(\ell_{0}\)</span> 为无协变量模型的对数似然。
<span class="math display">\[
R_{M c F}^{2}=\frac{L^{2}}{-2 \log \ell_{0}}
\]</span>
与广义R2不同, McFadden的 <span class="math inline">\(R^{2}\)</span> 的上限不小于1。McFadden <span class="math inline">\(R^{2}\)</span> 和广义 <span class="math inline">\(R^{2}\)</span> 均基于最大化的数量, 即对 数似然。因此，可以将ML视为一种选择系数以使R2最大化的方法, 至少如这些措施所定义的那样。可以将 其视为一件好事，但是如果您想比较逻辑回归模型和其他不基于似然函数的方法 (例如神经网络模型) 的 预测能力，则不是一件好事。</p>
</div>
<div id="tjurs-r2" class="section level4" number="13.2.7.3">
<h4><span class="header-section-number">13.2.7.3</span> Tjur’s <span class="math inline">\(R^{2}\)</span></h4>
<p>一种方法是使用Tjur (2009) 提出的“model free” <span class="math inline">\(R^{2}\)</span> 。这很容易计算, 并具有一些吸引人的特性。通过计 算 <span class="math inline">\(\mathrm{y}=1\)</span> 的观测值的预测值的平均值和 <span class="math inline">\(\mathrm{y}=\)</span> 0的观测值的预测值的平均值来找到Tjur的 <span class="math inline">\(R^{2}\)</span> 。 <span class="math inline">\(R^{2}\)</span> 只是这两个平 均值之间的差。Tjur的 <span class="math inline">\(R^{2}\)</span> 上限为1.</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=culp whitvic blackd;
 OUTPUT OUT=a PRED=yhat;
PROC MEANS;
 CLASS death;
 VAR yhat;
RUN; </code></pre>
<p><strong>Whenever you run binary (or ordinal) logistic regression, PROC LOGISTIC reports four such metrics by default.</strong></p>
<p><span class="math display">\[
\begin{array}{|l|c|l|l|}
\hline \text { Percent Concordant } &amp; 88.3 &amp; \text { Somers&#39; } \mathbf{D} &amp; 0.800 \\
\hline \text { Percent Discordant } &amp; 8.4 &amp; \text { Gamma } &amp; 0.827 \\
\hline \text { Percent Tied } &amp; 3.3 &amp; \text { Tau-a } &amp; 0.361 \\
\hline \text { Pairs } &amp; 4850 &amp; \mathrm{C} &amp; 0.900 \\
\hline
\end{array}
\]</span></p>
<p>对于样本中的147个观察值，有147（146）/ 2 = 10731种不同的方式将它们配对（不将观察值与自身配对）。 其中，5881对在因变量中要么都为1，要么都为0。 我们忽略了这些，留下了4850对，其中一个案例的值为1，另一案例的值为0。对于每个对，我们提出一个问题：“具有1的案例是否具有比模型更高的预测值（基于模型）？ 是0的情况？” 如果答案是肯定的，我们称该对为一致。 如果否，则该对不和谐。 如果两个案例的预测值相同，我们将其称为平局。 令C为一致对的数量，D为不一致对的数量，T为关系的数量，N为对的总数（在消除任何对之前）。 然后定义了四个关联度量：</p>
<blockquote>
<p>If the answer is yes, we call that pair concordant. If no, the pair is discordant. If the two cases have the same predicted value, we call it a tie. Let C be the number of concordant pairs, D the number of discordant pairs, T the number of ties, and N the total number of pairs (before eliminating any).</p>
</blockquote>
<p><span class="math display">\[
\begin{array}{c}
\text { Tau }-a=\frac{C-D}{N} \\
G a m m a=\frac{C-D}{C+D} \\
\text { Somer }^{\prime} s D=\frac{C-D}{C+D+T} \\
c=.5(1+\text { Somer&#39;s } D)
\end{array}
\]</span></p>
<p>所有这四个量度在0和1之间变化，较大的值对应于预测值和观察值之间的较强关联。 在这四个统计量中，Tau-a倾向于最接近广义R2。 另一方面，c统计量非常流行，因为它对应于ROC曲线下的面积，</p>
</div>
</div>
<div id="roc-curves" class="section level3" number="13.2.8">
<h3><span class="header-section-number">13.2.8</span> ROC Curves</h3>
<p>Another way to evaluate the predictive ability of a model for binary outcomes is the ROC curve. ROC is the abbreviation of Receiver Operating Characteristic. Let pi be the predicted probability of yi = 1 for individual i. If you want to use the predicted probability to generate an actual forecast for y = 1, you need some pointcut values. The natural choice is .5. If i pˆ≥.5, we predict yi =1. If i pˆ &lt;.5, we predict yi = 0. Then we can build the following classification table:</p>
<p><span class="math display">\[
\begin{array}{l|c|c|c}
&amp; \hat{p}_{i} \geq .5 &amp; \hat{p}_{i}&lt;.5 &amp; \text { Total } \\
y_{i}=1 &amp; 35 &amp; 15 &amp; 50 \\
y_{i}=0 &amp; 10 &amp; 87 &amp; 97 \\
\hline
\end{array}
\]</span>
&gt; 敏感度是正确预测的事件的比例，在这种情况下为35/50 = .70。特异性是正确预测的非事件所占的比例，即87/97 = .90。理想的情况是这两个比例都很高。ROC曲线仅是一条图，在垂直轴上具有灵敏度，在水平轴上具有1减去特异性，两者都随着切点从1减小到0而增加。</p>
<pre><code>PROC LOGISTIC DATA=penalty PLOTS(ONLY)=ROC;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp ;
RUN;</code></pre>
<p>The 45-degree line represents the expected ROC curve of a model with only intercept (ie, no predictive power). The farther the curve is from the 45-degree line, the greater the predictive power. The standard statistic for summarizing deviations is the area under the curve</p>
<blockquote>
<p>45度线代表仅具有截距（即没有预测能力）的模型的预期ROC曲线。曲线与45度线的距离越远，预测能力就越大。汇总偏离的标准统计量是曲线下的面积</p>
</blockquote>
<p>ROC曲线有很多选择，一个方便的选项使您可以将切点放置在曲线上。 可以通过将PLOTS选项更改为PLOTS（ONLY）= ROC（ID = CUTPOINT）来实现，</p>
<div class="figure" style="text-align: center">
<img src="02_Plots/ROC_Logistic.png" alt="Figure: ROC PLOTS（ONLY）= ROC（ID = CUTPOINT）" width="100%" />
<p class="caption">
(#fig:ROC logistic)Figure: ROC PLOTS（ONLY）= ROC（ID = CUTPOINT）
</p>
</div>
<p>Compare the ROC curve and c statistics of different models. In the following code, I request the ROC curve and c statistics of the basic model and three different sub-models</p>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp;
 ROC &#39;omit culp&#39; blackd whitvic;
 ROC &#39;omit blackd&#39; whitvic culp;
 ROC &#39;omit whitvic&#39; blackd culp;
 ROCCONTRAST / ESTIMATE=ALLPAIRS;
RUN; </code></pre>
</div>
<div id="predicted-values-residuals-and-influence-statistics" class="section level3" number="13.2.9">
<h3><span class="header-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</h3>
<p>PROC LOGISTIC can use the OUTPUT statement to generate a large number of case statistics, which writes the selected diagnostic statistics into the SAS data set. Here are some statistics that can be selected:</p>
<ul>
<li>Linear predictor- Predicted log-odds for each case. In matrix notation, this is <span class="math inline">\(\mathbf{x} \boldsymbol{\beta}\)</span>, so it’s commonly
referred to as XBETA.</li>
<li>Standard error of linear predictor-Used in generating confidence intervals.</li>
<li>Predicted values-Predicted probability of the event, based on the estimated model and values of the explanatory variables. For grouped data, this is the expected number of events.</li>
<li>Confidence intervals for predicted values -Confidence intervals are first calculated for the linear predictor by adding and subtracting an appropriate multiple of the standard error. Then, to get confidence intervals around the predicted values, the upper and lower bounds on the linear predictor
are substituted into <span class="math inline">\(1 /\left(1+e^{-x}\right)\)</span>, where <span class="math inline">\(x\)</span> is either an upper or a lower bound.</li>
<li>Deviance residuals - Contribution of each observation to the deviance chi-square.</li>
<li>Pearson residuals - Contribution of each observation to the Pearson chi-square.</li>
</ul>
<blockquote>
<p>OUTPUT语句还可以产生多个统计数据, 这些统计数据旨在测量每个观察结果的影响。基本上，影响力统计 信息会告诉您, 当从数据集中删除特定观察值时，模型的某些功能会发生多少变化。对于用PROC REG估计 的线性模型，影响统计是准确的。但是，逻辑模型中的精确计算将非常耗时, 因此仅使用近似值。 LOGISTIC中可用的影响力统计数据为</p>
</blockquote>
<ul>
<li>DFBETAS-删除特定观察值时每个回归系数有多少变化,实际变化除以系数的标准误差。</li>
<li>DIFDEV-实际变化除以系数的标准误差。</li>
<li>DIFCHISQ一删除观察值后皮尔逊卡方的变化</li>
<li><span class="math inline">\(\mathrm{C}\)</span> and <span class="math inline">\(\mathrm{CBAR}\)</span> 度量回归系数的总体变化, 类似于线性回归中的库克距离</li>
<li>LEVERAGE-测量在解释变量空间中观察值的极端程度。杜杆作用是”帽子”矩阵的对角线。</li>
</ul>
<blockquote>
<p>可以通过在OUTPUT语句上指定适当的选项来获取任何这些统计信息。但是您可能会发现，使用PROC语句 上的PLOTS选项来请求ODS图形更有用。此选项产生的许多图具有三个变体, 根据水平轴上绘制的变量而 有所不同。对于INFLUENCE和DFBETAS图, 水平轴仅是案例编号。对于PHAT和DPC图, 水平轴是预测的 概率。 对于LEVERAGE, 水平轴是杜杆。</p>
</blockquote>
<p>Here is the <a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_logistic_examples06.htm">example</a></p>
<pre><code>PROC LOGISTIC DATA=penalty PLOTS(UNPACK LABEL)=
 (INFLUENCE DFBETAS PHAT DPC LEVERAGE);
 MODEL death(EVENT=&#39;1&#39;)=blackd whitvic culp ;
RUN; </code></pre>
</div>
<div id="unobserved-heterogeneity" class="section level3" number="13.2.10">
<h3><span class="header-section-number">13.2.10</span> Unobserved Heterogeneity</h3>
<p>σ is the coefficient disturbance term ε. The random disturbance term can be regarded as representing all omitted explanatory variables that have nothing to do with the measured x variable, usually referred to as unobserved heterogeneity</p>
<p><span class="math display">\[\log \left[\frac{\operatorname{Pr}(y=1 \mid \varepsilon)}{\operatorname{Pr}(y=0 \mid \varepsilon)}\right]=\beta_{0}+\beta_{1} x_{1}+\beta_{2} x_{2}+\ldots+\beta_{k} x_{k}+\sigma \varepsilon\]</span>
We assume that ε has nothing to do with x and has a standard logarithmic distribution, (Allison 1987) the result is approximately</p>
<p><span class="math display">\[\log \left[\frac{\operatorname{Pr}(y=1)}{\operatorname{Pr}(y=0)}\right]=\beta_{0}^{*}+\beta_{1}^{*} x_{1}+\beta_{2}^{*} x_{2}+\ldots+\beta_{k}^{*} x_{k}\]</span>
<span class="math display">\[\beta_{i}^{*}=\frac{\beta_{j}}{\sqrt{1+\sigma^{2}}}\]</span></p>
<blockquote>
<p>显然，我们永远无法测量并包含影响因变量的所有变量，因此总会有一些异质性缩小。有什么实际意义
首先，在解释逻辑回归的结果时，我们应记住，系数的大小和相应的优势比可能在某种程度上是保守的。
其次，为了使收缩最小化，总是希望在模型中包括重要的解释变量，即使我们认为这些变量与模型中已经存在的变量不相关。该建议尤其适用于随机实验，在随机实验中，有忽略协变量的趋势，而仅关注治疗对反应的影响。对于线性模型可能没关系，但是当包括所有相关的协变量时，logit模型可得出对治疗效果的出色估计。
第三，差分异质性可能会混淆不同组之间的logit系数比较。例如，如果要比较分别针对男性和女性估算的对数系数，则必须隐含地假设两组中未观察到的异质性程度相同。</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>First, in interpreting the results of a logistic regression, we should keep in mind that the magnitudes of the coefficients and the corresponding odds ratios are likely to be conservative to some degree.</li>
<li>Second, to keep such shrinkage to a minimum, it’s always desirable to include important explanatory variables in the model—even if we think those variables are not correlated with the variables already in the model. This advice is especially relevant to randomized experiments where there is a tendency to ignore covariates and look only at the effect of the treatment on the response. That may be okay for linear models, but logit models yield superior estimates of the treatment effect when all relevant covariates are included.</li>
<li>A third problem is that differential heterogeneity can confound comparisons of logit coefficients across different groups. If, for example, you want to compare logit coefficients estimated separately for men and women, you must implicitly assume that the degree of unobserved heterogeneity is the same in both groups.</li>
</ol>
<p><strong>Adjusting for differential heterogeneity using HETERO in Proc QLIM</strong></p>
<pre><code>PROC QLIM DATA=promo;
 ENDOGENOUS promo~DISCRETE(DIST=LOGISTIC);
 MODEL promo = female dur dur*dur select arts prestige
arts*female;
 HETERO promo~female / NOCONST;
run; 

####################################################
Parameter DF   Estimate   StandardError    t Value   Approx Pr &gt; |t|
_H.FEMALE 1    0.354838   0.325341         1.09      0.2754

我们也没有太多证据显示性别差异异质性：FEMALE对σ的影响的p值为.28。
尽管与0没有显着差异，但可以通过计算exp（.354838）= 1.43来解释该影响的大小。 
因此，我们说女性的差异估计比男性的差异高43％。</code></pre>
</div>
</div>
<div id="illustration-in-sas" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Illustration in SAS</h2>
<p><code>PLOTS &lt;(global-plot-options)&gt; =(plot-request &lt;(options)&gt; &lt;…plot-request &lt;(options)&gt;&gt;)</code>
controls the plots produced through ODS Graphics. When you specify only one plot-request, you can omit the parentheses from around the plot-request. For example:</p>
<pre><code>PLOTS = ALL
PLOTS = (ROC EFFECT INFLUENCE(UNPACK))
PLOTS(ONLY) = EFFECT(CLBAR SHOWOBS)</code></pre>
<ul>
<li>If the INFLUENCE or IPLOTS option is specified in the MODEL statement, then the INFLUENCE plots are produced unless the MAXPOINTS= cutoff is exceeded.</li>
<li>If you specify ROC statements, then an overlaid plot of the ROC curves for the model (or the selected model if a SELECTION= method is specified) and for all the ROC statement models is displayed.</li>
<li>If you specify the CLODDS= option in the MODEL statement or if you specify the ODDSRATIO statement, then a plot of the odds ratios and their confidence limits is displayed.</li>
</ul>
<div id="effects-of-predictor-variables" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Effects of Predictor Variables</h3>
<blockquote>
<p>由于逻辑回归模型具有固有的非线性，因此通常很难直观地看到预测变量对事件概率的影响。 EFFECTPLOT语句为该问题提供了一种优雅的解决方案。 在检查交互作用和多项式函数时特别有用。</p>
</blockquote>
<blockquote>
<p>EFFECTPLOT语句要求根据ARTS（已发表文章的数量）绘制促销的预测概率图，同时将所有其他变量设置为其平均值。 如果模型中有任何CLASS变量，则将它们设置为参考级别。水平轴包括ARTS观测值的整个范围。 如果将选项/ LINK放在EFFECTPLOT语句上，则会得到在垂直轴上带有线性预测变量（几率的对数）的图形，在这种情况下，该线性预测变量将是一条直线。 水平轴上0和1处的小圆圈代表因变量在预测变量的不同值处的实际值。 在这种情况下，一个圆圈可以代表许多数据点</p>
</blockquote>
<pre><code>*** 从不包含相互作用或多项式函数的模型开始
PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts;
 EFFECTPLOT FIT(X=arts);
run; 

PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts arts*arts;
 EFFECTPLOT FIT(X=arts);
run;

## SLICEFIT option to produce curves for men and women: 
PROC LOGISTIC DATA=promo;
 MODEL promo(EVENT=&#39;1&#39;) = female dur select arts prestige
arts*female ;
 EFFECTPLOT SLICEFIT(X=arts SLICEBY=female=0 1);
run;</code></pre>
</div>
<div id="odds-ratio-plot" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Odds ratio plot</h3>
<pre><code>ods graphics on;
proc logistic data=prostate
  plots(only)=(effect oddsratio (type=horizontalstat));
  model capsule (event=&quot;1&quot;) = psa /clodds=both;
  unit psa = 10;
run;
ods graphics off;</code></pre>
</div>
</div>
<div id="probit-modell" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Probit Modell</h2>
<div id="introduction-2" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Introduction</h3>
<p>The latent variable model we examined in the last section should help to motivate these models. The equation for the continuous latent variable z was
<span class="math display">\[z=\alpha_{0}+\alpha_{1} x_{1}+\alpha_{2} x_{2}+\ldots+\alpha_{k} x_{k}+\sigma \varepsilon\]</span>
* 如果ε具有标准的logistic分布，则y对x的依赖性由logit模型给出。
* 现在假设ε具有标准正态分布。这意味着y通过概率模型依赖于x。
* 如果ε具有标准的极值分布（也称为Gumbel或双指数分布），我们将获得互补的log-log模型。</p>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Probit-Modell:
<span class="math display">\[\pi=\Phi(\eta) \Longleftrightarrow \Phi^{-1}(\pi)=\eta\]</span>
<span class="math display">\[\pi=\Phi(\eta)=\Phi\left(\boldsymbol{x}^{\prime} \boldsymbol{\beta}\right)\]</span>
So the probit model is often written as
<span class="math display">\[\Phi^{-1}\left(p_{i}\right)=\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span></p>
</div>
<div id="r-implemetation" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> R Implemetation</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="logistic-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./01_Datasets/binary.csv&quot;</span>)</span>
<span id="cb59-2"><a href="logistic-regression.html#cb59-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>rank)</span>
<span id="cb59-3"><a href="logistic-regression.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>rank <span class="sc">+</span> admit, <span class="at">data =</span> mydata)</span></code></pre></div>
<pre><code>##     admit
## rank  0  1
##    1 28 33
##    2 97 54
##    3 93 28
##    4 55 12</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="logistic-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a>myprobit <span class="ot">&lt;-</span> <span class="fu">glm</span>(admit <span class="sc">~</span> gre <span class="sc">+</span> gpa <span class="sc">+</span> rank, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb61-2"><a href="logistic-regression.html#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mydata)</span>
<span id="cb61-3"><a href="logistic-regression.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myprobit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = admit ~ gre + gpa + rank, family = binomial(link = &quot;probit&quot;), 
##     data = mydata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6163  -0.8710  -0.6389   1.1560   2.1035  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.386836   0.673946  -3.542 0.000398 ***
## gre          0.001376   0.000650   2.116 0.034329 *  
## gpa          0.477730   0.197197   2.423 0.015410 *  
## rank2       -0.415399   0.194977  -2.131 0.033130 *  
## rank3       -0.812138   0.208358  -3.898 9.71e-05 ***
## rank4       -0.935899   0.245272  -3.816 0.000136 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 499.98  on 399  degrees of freedom
## Residual deviance: 458.41  on 394  degrees of freedom
## AIC: 470.41
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="logistic-regression.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(myprobit)</span></code></pre></div>
<pre><code>##                     2.5 %       97.5 %
## (Intercept) -3.7201050682 -1.076327713
## gre          0.0001104101  0.002655157
## gpa          0.0960654793  0.862610221
## rank2       -0.7992113929 -0.032995019
## rank3       -1.2230955861 -0.405008112
## rank4       -1.4234218227 -0.459538829</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="logistic-regression.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Wald test</span></span>
<span id="cb65-2"><a href="logistic-regression.html#cb65-2" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb65-3"><a href="logistic-regression.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(myprobit), <span class="at">Sigma =</span> <span class="fu">vcov</span>(myprobit), <span class="at">L =</span> l)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 5.6, df = 1, P(&gt; X2) = 0.018</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="logistic-regression.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(myprobit), <span class="at">Sigma =</span> <span class="fu">vcov</span>(myprobit), <span class="at">Terms =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 21.4, df = 3, P(&gt; X2) = 8.9e-05</code></pre>
</div>
<div id="sas-implementation-1" class="section level3" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> SAS Implementation</h3>
<pre><code>PROC LOGISTIC DATA=penalty;
 MODEL death(EVENT=&#39;1&#39;) = culp blackd whitvic / LINK=PROBIT
 STB;
RUN; </code></pre>
<p>For logit and probit models, the chi-square, p-value, and standardized coefficient are usually very close, although they will never be exactly the same. On the other hand, compared with the logit model, the <strong>parameter estimates and standard errors</strong> of the probit model are much lower.</p>
</div>
</div>
<div id="complementary-log-log-modell" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Complementary log-log-Modell</h2>
<p>The complementary log-log model has important applications in the field of <strong>survival analysis</strong>.</p>
<p>The probability <span class="math inline">\(\pi{i}=\mathrm{P}\left(y{i}=1 \mid x{i 1}, \ldots, x{i k}\right)\)</span> and the linear predictor <span class="math inline">\(\eta_{i}=\beta_{0}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}=\boldsymbol{x}_{i}^{\prime} \boldsymbol{\beta}\)</span> are linked by a response function $<em>{i}=h(</em>{i}) $:</p>
<p>For Logit-Modell:
<span class="math display">\[\pi=\frac{\exp (\eta)}{1+\exp (\eta)} \Longleftrightarrow \log \frac{\pi}{1-\pi}=\eta\]</span>
For Complementary log-log model:
<span class="math display">\[\pi=1-\exp (-\exp (\eta)) \quad \Longleftrightarrow \quad \log (-\log (1-\pi))=\eta\]</span>
<span class="math display">\[\log \left[-\log \left(1-p_{i}\right)\right]=\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
<span class="math display">\[p_{i}=1-\exp \left\{-\exp \left[\beta_{0}+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\right]\right\}\]</span></p>
<ul>
<li>互补对数对数模型与logit和probit模型有一个主要区别。logit和probit变换在p = .50附近是对称的，但互补的log-log变换是不对称的。它是一条S形曲线，但逼近1的速度比逼近0的速度快得多。</li>
<li>生存分析中最流行的方法是Cox回归方法，该方法基于一种称为比例风险模型的模型（Cox 1972）。 该模型的特殊情况包括Weibull回归模型和指数回归模型。 比例风险模型可以写成
<span class="math display">\[\log h(t)=\alpha(t)+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}+\ldots+\beta_{k} x_{i k}\]</span>
where <span class="math inline">\(h(t)\)</span> is something called the hazard of an event at time <span class="math inline">\(t\)</span> and <span class="math inline">\(\alpha(t)\)</span> is an unspecified function of time.</li>
</ul>
<div id="r-implemetation-1" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> R Implemetation</h3>
</div>
</div>
<div id="multicategory-logit-models" class="section level2" number="13.6">
<h2><span class="header-section-number">13.6</span> Multicategory Logit Models</h2>
<div id="multinomialverteilung" class="section level3" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> Multinomialverteilung</h3>
<p><span class="math display">\[
f(\boldsymbol{y} \mid \boldsymbol{\pi})=\pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{q}^{y_{q}}\left(1-\pi_{1}-\ldots-\pi_{q}\right)^{1-y_{1}-\ldots-y_{q}}
\]</span>
given in generalization of the Bernoulli distribution. For m independent repetitions, in generalization to the binomial distribution,<span class="math inline">\(y r, r=1, \ldots, c\)</span> now the number of repetitions in which the category r occurred. Then <span class="math inline">\(\boldsymbol{y}=\left(y 1, \ldots, y_{q}\right)^{\prime}\)</span> has the probability function
<span class="math display">\[
\begin{aligned}
f(\boldsymbol{y} \mid \boldsymbol{\pi}) &amp;=\frac{m !}{y_{1} ! \cdot \ldots \cdot y_{q} !\left(m-y_{1}-\ldots-y_{q}\right) !} \pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{q}^{y_{q}}\left(1-\pi_{1}-\ldots-\pi_{q}\right)^{1-y_{1}-\ldots-y_{q}} \\
&amp;=\frac{m !}{y_{1} ! \cdot \ldots \cdot y_{c} !} \pi_{1}^{y_{1}} \cdot \ldots \cdot \pi_{c}^{y_{c}}
\end{aligned}
\]</span>
a multinomial distribution, in short
<span class="math display">\[
\boldsymbol{y} \sim M(m, \boldsymbol{\pi})
\]</span>
mit den Parametern <span class="math inline">\(\mathrm{m}\)</span> und <span class="math inline">\(\boldsymbol{\pi}=(\pi 1, \ldots, \pi q)^{\prime}\)</span>. Für die ersten beiden Momente ergibt sich
<span class="math display">\[
\mathrm{E}(\boldsymbol{y})=m \boldsymbol{\pi}=\left(\begin{array}{c}
m \pi_{1} \\
\vdots \\
m \pi_{q}
\end{array}\right), \quad \operatorname{Cov}(\boldsymbol{y})=\left(\begin{array}{ccc}
m \pi_{1}\left(1-\pi_{1}\right) &amp; \cdots &amp; -\pi_{1} \pi_{q} \\
\vdots &amp; \ddots &amp; \vdots \\
-\pi_{q} \pi_{1} &amp; \cdots &amp; m \pi_{q}\left(1-\pi_{q}\right)
\end{array}\right)
\]</span>
### Nominal Response</p>
<p>In a similar way in which a multicategory predictor in a GLM uses dummy variables for comparing the effect of the first <span class="math inline">\(J-1\)</span> categories on the odds for success with the effect of the last category, the reference category, multicategory logit models pair a baseline category with all remaining categories. Only that now it is of interest to find out how the set of predictors affects the odds for falling into a certain category versus the baseline category.
Assume the last category <span class="math inline">\((J)\)</span> is the baseline category, then the baseline logits are
<span class="math display">\[
\log \left(\pi_{i} / \pi_{J}\right), \quad i=1,2, \ldots, J-1
\]</span>
The baseline category logit model with one predictor <span class="math inline">\(x\)</span> is given by <span class="math inline">\(J-1\)</span> equations:
<span class="math display">\[
\log \left(\pi_{i} / \pi_{J}\right)=\alpha_{i}+\beta_{i} x, \quad i=1,2, \ldots, J-1
\]</span>
(For <span class="math inline">\(J=2\)</span> (two categories) this becomes the binary logistic regression model.)
Observe that for each category <span class="math inline">\(i\)</span> compared with the baseline category, a new set of parameters is introduced.
The baseline category logit model permits the comparison of any two categories since, for categories <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>
<span class="math display">\[
\log \left(\pi_{a} / \pi_{b}\right)=\log \left(\frac{\pi_{a} / \pi_{J}}{\pi_{b} / \pi_{J}}\right)=\log \left(\pi_{a} / \pi_{J}\right)-\log \left(\pi_{b} / \pi_{J}\right)=\left(\alpha_{a}-\alpha_{b}\right)+\left(\beta_{a}-\beta_{b}\right) x
\]</span>
The choice of baseline category has no effect on the parameter estimates for comparing two categories <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p>
<div id="r-implementation-1" class="section level4" number="13.6.1.1">
<h4><span class="header-section-number">13.6.1.1</span> R Implementation</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="logistic-regression.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb70-2"><a href="logistic-regression.html#cb70-2" aria-hidden="true" tabindex="-1"></a>ml <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;./01_Datasets/hsbdemo.dta&quot;</span>)</span>
<span id="cb70-3"><a href="logistic-regression.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ml, <span class="fu">table</span>(ses, prog))</span></code></pre></div>
<pre><code>##         prog
## ses      general academic vocation
##   low         16       19       12
##   middle      20       44       31
##   high         9       42        7</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="logistic-regression.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ml, <span class="fu">do.call</span>(rbind, <span class="fu">tapply</span>(write, prog, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">M =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x)))))</span></code></pre></div>
<pre><code>##                 M       SD
## general  51.33333 9.397775
## academic 56.25714 7.943343
## vocation 46.76000 9.318754</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="logistic-regression.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Multinomial logistic regression</span></span>
<span id="cb74-2"><a href="logistic-regression.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb74-3"><a href="logistic-regression.html#cb74-3" aria-hidden="true" tabindex="-1"></a>ml<span class="sc">$</span>prog2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(ml<span class="sc">$</span>prog, <span class="at">ref =</span> <span class="st">&quot;academic&quot;</span>)</span>
<span id="cb74-4"><a href="logistic-regression.html#cb74-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">multinom</span>(prog2 <span class="sc">~</span> ses <span class="sc">+</span> write, <span class="at">data =</span> ml)</span></code></pre></div>
<pre><code>## # weights:  15 (8 variable)
## initial  value 219.722458 
## iter  10 value 179.982880
## final  value 179.981726 
## converged</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="logistic-regression.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test)</span></code></pre></div>
<pre><code>## Call:
## multinom(formula = prog2 ~ ses + write, data = ml)
## 
## Coefficients:
##          (Intercept)  sesmiddle    seshigh      write
## general     2.852198 -0.5332810 -1.1628226 -0.0579287
## vocation    5.218260  0.2913859 -0.9826649 -0.1136037
## 
## Std. Errors:
##          (Intercept) sesmiddle   seshigh      write
## general     1.166441 0.4437323 0.5142196 0.02141097
## vocation    1.163552 0.4763739 0.5955665 0.02221996
## 
## Residual Deviance: 359.9635 
## AIC: 375.9635</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="logistic-regression.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract the coefficients from the model and exponentiate</span></span>
<span id="cb78-2"><a href="logistic-regression.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(test))</span></code></pre></div>
<pre><code>##          (Intercept) sesmiddle   seshigh     write
## general     17.32582 0.5866769 0.3126026 0.9437172
## vocation   184.61262 1.3382809 0.3743123 0.8926116</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="logistic-regression.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## does not include the calculation of the p-value of the regression coefficient, so the Wald test (here z-test) is used to calculate the p-value</span></span>
<span id="cb80-2"><a href="logistic-regression.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 2-tailed z test</span></span>
<span id="cb80-3"><a href="logistic-regression.html#cb80-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">summary</span>(test)<span class="sc">$</span>coefficients<span class="sc">/</span><span class="fu">summary</span>(test)<span class="sc">$</span>standard.errors</span>
<span id="cb80-4"><a href="logistic-regression.html#cb80-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z), <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb80-5"><a href="logistic-regression.html#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="logistic-regression.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a fitting function to calculate the probability of each result level</span></span>
<span id="cb80-7"><a href="logistic-regression.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(test))</span></code></pre></div>
<pre><code>##    academic   general  vocation
## 1 0.1482764 0.3382454 0.5134781
## 2 0.1202017 0.1806283 0.6991700
## 3 0.4186747 0.2368082 0.3445171
## 4 0.1726885 0.3508384 0.4764731
## 5 0.1001231 0.1689374 0.7309395
## 6 0.3533566 0.2377976 0.4088458</code></pre>
<p><strong>Interpretation</strong></p>
<p><span class="math display">\[\begin{aligned} ln\left(\frac{P(prog=general)}{P(prog=academic)}\right) = b_{10} + b_{11}(ses=2) + b_{12}(ses=3) + b_{13}write\\ ln\left(\frac{P(prog=vocation)}{P(prog=academic)}\right) = b_{20} + b_{21}(ses=2) + b_{22}(ses=3) + b_{23}write \end{aligned}\]</span>
#### SAS Implementation</p>
<p>The unordered multinomial model is invoked by the LINK=GLOGIT option. If this option is omitted, LOGISTIC estimates the cumulative logit, which assumes that the response levels are ordered.</p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
RUN; </code></pre>
<p>There are three types of wallet, (1) keep the wallet and the money, (2) keep the money and return the wallet, or (3) return both the wallet and the money. The default setting category 3 is the reference category. You can specify category 2 as the reference category</p>
<p><code>MODEL wallet(REF='2') = male business punish explain / LINK=GLOGIT;</code></p>
<p><strong>Test the null hypothesis using TEST</strong></p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
 TEST male_1=male_2, business_1=business_2,
 punish_1=punish_2, explain_1=explain_2;
RUN; </code></pre>
<p><strong>Goodness-of-fit statistics using the AGGREGATE and SCALE=NONE options</strong></p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT
 AGGREGATE SCALE=NONE;
 OUTPUT OUT=predicted PREDPROBS=I;
RUN; </code></pre>
<p>出现OUTPUT语句。它生成一个数据集（名为PREDICTED），其中包含在因变量的每个类别中的预测概率。 该数据集针对195个案例中的每个案例都有一个记录。 PREDPROBS = I选项要求生成三个新变量：IP_1是属于类别1的预测概率，IP_2是属于类别2的预测概率，IP_3是属于类别3的预测概率。 在每个配置文件中这些预测的概率，我们可以获得预期的频率。 我们可以使用PROC TABULATE完成</p>
<pre><code>PROC TABULATE DATA=predicted;
 CLASS male business punish explain;
 var IP_1 IP_2 IP_3;
 TABLE male*business*punish*explain, IP_1 IP_2 IP_3;
RUN; </code></pre>
<div class="figure" style="text-align: center">
<img src="02_Plots/Logistic_AGGREGATE.png" alt="Figure: Goodness-of-fit statistics" width="100%" />
<p class="caption">
(#fig:Logistic AGGREGATE)Figure: Goodness-of-fit statistics
</p>
</div>
<p><strong>Visualizing the effect of a variable</strong></p>
<p>NOLIMITS option suppresses the 95% confidence bands around the plots</p>
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain / LINK=GLOGIT;
 EFFECTPLOT FIT(X=punish) / NOOBS NOLIMITS GRIDSIZE=3;
RUN; </code></pre>
</div>
</div>
<div id="ordinal-response-cumulative-logit-model" class="section level3" number="13.6.2">
<h3><span class="header-section-number">13.6.2</span> Ordinal Response: Cumulative Logit Model</h3>
<p>If the multicategory response is ordinal a model should be used which reflects the order of the categories. A model taking the ordinal nature of the response variable into account should be easier to interpret and tests have greater power.</p>
<p><strong>Definition:</strong>
Assume that <span class="math inline">\(Y\)</span> is an ordinal variable with categories <span class="math inline">\(1,2, \ldots, J\)</span>, then the cumulative probability for category <span class="math inline">\(j\)</span> is the probability to fall at most into category <span class="math inline">\(j\)</span>
<span class="math display">\[
P(Y \leq j)=\pi_{1}+\cdots+\pi_{j}, \quad j=1,2, \ldots, J
\]</span>
It is
<span class="math display">\[
P(Y \leq 1) \leq P(Y \leq 2) \leq \cdots \leq P(Y \leq J)=1
\]</span>
To model an ordinal response variable one models the cumulative response probabilities or cumulative odds. In the model cumulative odds for the last category do not have to be modeled since the cumulative probability for the highest category is always one (no category falls above).</p>
<p><strong>Definition:</strong>
The cumulative logits are the logits for the cumulative probabilities
<span class="math display">\[
\operatorname{logit}(P(Y \leq j))=\log \left(\frac{P(Y \leq j)}{1-P(Y \leq j)}\right)=\log \left(\frac{\pi_{1}+\cdots+\pi_{j}}{\pi_{j+1}+\cdots+\pi_{J}}\right)
\]</span></p>
<p>A model for cumulative logit <span class="math inline">\(j\)</span> is equivalent to a binary logistic regression model for combined categories 1 to <span class="math inline">\(j\)</span> (I) versus the combined category <span class="math inline">\(j+1\)</span> to <span class="math inline">\(J\)</span> (II)
categories: <span class="math inline">\(\underbrace{12 \quad \ldots \quad j}_{I} \underbrace{j+1 \quad \ldots \quad J}_{I I}\)</span>
For one predictor variable <span class="math inline">\(x\)</span> the proportional odds model becomes for <span class="math inline">\(j=1,2 \ldots, J-1\)</span> :
<span class="math display">\[
\operatorname{logit}(P(Y \leq j))=\alpha_{j}+\beta x
\]</span>
The slope <span class="math inline">\(\beta\)</span> is the same for all cumulative logits, and therefore this model has a single slope parameter instead of <span class="math inline">\(J-1\)</span> in the multicategory logistic regression model.
The parameter <span class="math inline">\(\beta\)</span> describes the effect of <span class="math inline">\(x\)</span> on the odds for falling into categories 1 to <span class="math inline">\(j\)</span>. The effect is assumed to be the same for all cumulative odds.</p>
<p>Given the cumulative probabilities in dependency on predictor variable <span class="math inline">\(x\)</span> if <span class="math inline">\(\beta&gt;0\)</span>, We can obtain the probabilities to fall within category <span class="math inline">\(j\)</span> in dependency on <span class="math inline">\(x\)</span> sing that
<span class="math display">\[P(Y=j)=P(Y \leq j)-P(Y \leq j-1)\]</span></p>
<p>The cumulative logit link is the following:
<span class="math display">\[\operatorname{logit}[P(Y \leq j)]=\log \left[\frac{P(Y \leq j)}{1-P(Y \leq j)}\right]=\log \left[\frac{\pi_{0}+\ldots \pi_{j}}{\pi_{j+1}+\ldots \pi_{j}}\right]\]</span> where <span class="math inline">\(\mathrm{j}=0\)</span> to J <span class="math inline">\(-1\)</span></p>
<p>Note that the highest category is not in the model, as the cumulative probability of the highest category is always 1 .</p>
<p><strong>Proportional odds assumption</strong></p>
<p>The proportional odds assumption is that the number added to each of these logarithms to get the next is the same in every case. In other words, these logarithms form an arithmetic sequence.[2] The model states that the number in the last column of the table—the number of times that that logarithm must be added—is some linear combination of the other observed variables.</p>
<p>Ordinal logistic regression assumes that the coefficients that describe the relationship between the lowest versus all higher categories of the response variable</p>
<div id="r-implementation-2" class="section level4" number="13.6.2.1">
<h4><span class="header-section-number">13.6.2.1</span> R Implementation</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="logistic-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(foreign)</span>
<span id="cb87-2"><a href="logistic-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb87-3"><a href="logistic-regression.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb87-4"><a href="logistic-regression.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Hmisc)</span>
<span id="cb87-5"><a href="logistic-regression.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(reshape2)</span>
<span id="cb87-6"><a href="logistic-regression.html#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="logistic-regression.html#cb87-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;./01_Datasets/ologit.dta&quot;</span>)</span>
<span id="cb87-8"><a href="logistic-regression.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="do">## three way cross tabs (xtabs) and flatten the table</span></span>
<span id="cb87-9"><a href="logistic-regression.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> public <span class="sc">+</span> apply <span class="sc">+</span> pared, <span class="at">data =</span> dat))</span></code></pre></div>
<pre><code>##                        pared   0   1
## public apply                        
## 0      unlikely              175  14
##        somewhat likely        98  26
##        very likely            20  10
## 1      unlikely               25   6
##        somewhat likely        12   4
##        very likely             7   3</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="logistic-regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 检查每个申请级别的gpa分布</span></span>
<span id="cb89-2"><a href="logistic-regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> apply, <span class="at">y =</span> gpa)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="logistic-regression.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="logistic-regression.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb89-5"><a href="logistic-regression.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(pared <span class="sc">~</span> public, <span class="at">margins =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb89-6"><a href="logistic-regression.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb89-7"><a href="logistic-regression.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Cumulative%20Logit%20Model-1.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="logistic-regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fit ordered logit model and store results &#39;m&#39;</span></span>
<span id="cb90-2"><a href="logistic-regression.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="do">## proportional odds logistic regression,</span></span>
<span id="cb90-3"><a href="logistic-regression.html#cb90-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(apply <span class="sc">~</span> pared <span class="sc">+</span> public <span class="sc">+</span> gpa, <span class="at">data =</span> dat, </span>
<span id="cb90-4"><a href="logistic-regression.html#cb90-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb90-5"><a href="logistic-regression.html#cb90-5" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Hess = TRUE，以使模型从优化中返回观察到的信息矩阵（称为Hessian）</span></span>
<span id="cb90-6"><a href="logistic-regression.html#cb90-6" aria-hidden="true" tabindex="-1"></a>          <span class="do">## 该矩阵用于获取标准误差</span></span>
<span id="cb90-7"><a href="logistic-regression.html#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## Call:
## polr(formula = apply ~ pared + public + gpa, data = dat, Hess = TRUE)
## 
## Coefficients:
##           Value Std. Error t value
## pared   1.04769     0.2658  3.9418
## public -0.05879     0.2979 -0.1974
## gpa     0.61594     0.2606  2.3632
## 
## Intercepts:
##                             Value   Std. Error t value
## unlikely|somewhat likely     2.2039  0.7795     2.8272
## somewhat likely|very likely  4.2994  0.8043     5.3453
## 
## Residual Deviance: 717.0249 
## AIC: 727.0249</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="logistic-regression.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store p values</span></span>
<span id="cb92-2"><a href="logistic-regression.html#cb92-2" aria-hidden="true" tabindex="-1"></a>ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m))</span>
<span id="cb92-3"><a href="logistic-regression.html#cb92-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ctable[, <span class="st">&quot;t value&quot;</span>]), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb92-4"><a href="logistic-regression.html#cb92-4" aria-hidden="true" tabindex="-1"></a>ctable <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ctable, <span class="st">&quot;p value&quot;</span> <span class="ot">=</span> p)    <span class="do">## combined table</span></span>
<span id="cb92-5"><a href="logistic-regression.html#cb92-5" aria-hidden="true" tabindex="-1"></a>ctable</span></code></pre></div>
<pre><code>##                                   Value Std. Error    t value      p value
## pared                        1.04769010  0.2657894  3.9418050 8.087072e-05
## public                      -0.05878572  0.2978614 -0.1973593 8.435464e-01
## gpa                          0.61594057  0.2606340  2.3632399 1.811594e-02
## unlikely|somewhat likely     2.20391473  0.7795455  2.8271792 4.696004e-03
## somewhat likely|very likely  4.29936315  0.8043267  5.3452947 9.027008e-08</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="logistic-regression.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## KI und odds ratios</span></span>
<span id="cb94-2"><a href="logistic-regression.html#cb94-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m)                          <span class="do">## default method gives profiled CIs</span></span>
<span id="cb94-3"><a href="logistic-regression.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(m)                        <span class="do">## CIs assuming normality</span></span></code></pre></div>
<pre><code>##             2.5 %    97.5 %
## pared   0.5267524 1.5686278
## public -0.6425833 0.5250119
## gpa     0.1051074 1.1267737</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="logistic-regression.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m))                              </span></code></pre></div>
<pre><code>##     pared    public       gpa 
## 2.8510579 0.9429088 1.8513972</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="logistic-regression.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(m), ci))  </span></code></pre></div>
<pre><code>##               OR     2.5 %   97.5 %
## pared  2.8510579 1.6958376 4.817114
## public 0.9429088 0.5208954 1.680579
## gpa    1.8513972 1.1136247 3.098490</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="logistic-regression.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict and marginal effects</span></span>
<span id="cb100-2"><a href="logistic-regression.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="do">## predicted probabilities</span></span>
<span id="cb100-3"><a href="logistic-regression.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Use &quot;probs&quot; for predicted probabilities</span></span>
<span id="cb100-4"><a href="logistic-regression.html#cb100-4" aria-hidden="true" tabindex="-1"></a>m1.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">type=</span><span class="st">&quot;probs&quot;</span>) </span>
<span id="cb100-5"><a href="logistic-regression.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.pred)</span></code></pre></div>
<pre><code>##     unlikely      somewhat likely   very likely     
##  Min.   :0.2294   Min.   :0.2205   Min.   :0.04192  
##  1st Qu.:0.5220   1st Qu.:0.3053   1st Qu.:0.06839  
##  Median :0.5806   Median :0.3378   Median :0.08160  
##  Mean   :0.5498   Mean   :0.3498   Mean   :0.10040  
##  3rd Qu.:0.6263   3rd Qu.:0.3767   3rd Qu.:0.10123  
##  Max.   :0.7376   Max.   :0.4807   Max.   :0.29242</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="logistic-regression.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## marginal effects</span></span>
<span id="cb102-2"><a href="logistic-regression.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(erer)</span>
<span id="cb102-3"><a href="logistic-regression.html#cb102-3" aria-hidden="true" tabindex="-1"></a>m.marginal <span class="ot">&lt;-</span> <span class="fu">ocME</span>(m, <span class="at">rev.dum   =</span><span class="cn">TRUE</span>)</span>
<span id="cb102-4"><a href="logistic-regression.html#cb102-4" aria-hidden="true" tabindex="-1"></a>m.marginal</span></code></pre></div>
<pre><code>##        effect.unlikely effect.somewhat likely effect.very likely
## pared           -0.255                  0.137              0.117
## public           0.015                 -0.010             -0.005
## gpa             -0.152                  0.101              0.051</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="logistic-regression.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## want t and p-values</span></span>
<span id="cb104-2"><a href="logistic-regression.html#cb104-2" aria-hidden="true" tabindex="-1"></a>m.marginal<span class="sc">$</span>out</span></code></pre></div>
<pre><code>## $ME.unlikely
##        effect error t.value p.value
## pared  -0.255 0.060  -4.237   0.000
## public  0.015 0.073   0.198   0.843
## gpa    -0.152 0.064  -2.364   0.019
## 
## $`ME.somewhat likely`
##        effect error t.value p.value
## pared   0.137 0.029   4.820   0.000
## public -0.010 0.049  -0.196   0.844
## gpa     0.101 0.044   2.305   0.022
## 
## $`ME.very likely`
##        effect error t.value p.value
## pared   0.117 0.039   3.025   0.003
## public -0.005 0.024  -0.201   0.841
## gpa     0.051 0.022   2.301   0.022
## 
## $ME.all
##        effect.unlikely effect.somewhat likely effect.very likely
## pared           -0.255                  0.137              0.117
## public           0.015                 -0.010             -0.005
## gpa             -0.152                  0.101              0.051</code></pre>
</div>
<div id="sas-implementation-2" class="section level4" number="13.6.2.2">
<h4><span class="header-section-number">13.6.2.2</span> SAS Implementation</h4>
<p>cumulative logit model—also known as the ordered logit or ordinal logit model. It is the most widely used method and the easiest model to use in SAS (default). In PROC LOGISTIC, specifying LINK=CLOGIT produces a model which utilizes a cumulative logit link.</p>
<p>Using the default settings, the procedure conducts a Score Test for the Proportional Odds Assumption. If it rejects the null hypothesis that proportional odds may be assumed, the user has two additional modeling techniques utilizing the cumulative logit link.
A general cumulative logit model <strong>generates separate parameter estimates (effects) for each predictor across all <span class="math inline">\(J-1\)</span> response levels (see Agresti, 2007)</strong>. This model replaces <span class="math inline">\(\beta\)</span> in the proportional odds model with <span class="math inline">\(\beta_{j}\)</span> and uses the same cumulative logit link:
<span class="math display">\[
\operatorname{logit}[P(Y \leq j)]=\alpha_{j}+\beta_{j} x, \text { where } \mathrm{j}=0 \text { to J - } 1
\]</span>
The model allows for probability distribution curves that climb or fall at different rates for different response levels. This raises the possibility of these curves crossing each other at certain predictor values. This is inappropriate, because this violates the order that cumulative probabilities must have:
<span class="math inline">\(P(Y \leq X) \leq P(Y \leq X+1)\)</span> for all values of the predictors
This result could lead to negative predicted probabilities at individual response levels. Therefore, such a model can only fit adequately over a narrow range of predictor values. Using the proportional odds form of model ensures that the cumulative probabilities have the proper order for all predictor values. If a model of this form is desirable, PROC LOGISTIC will generate a general cumulative logit model if the option UNEQUALSLOPES is specified in the options for the MODEL statement.</p>
<!-- 使用比例优势形式的模型可确保累积概率对于所有预测变量值具有正确的顺序。如果需要这种形式的模型，如果在 MODEL 语句的选项中指定了选项 UNEQUALSLOPES，则 PROC LOGISTIC 将生成一般累积 logit 模型。 -->
<pre><code>PROC LOGISTIC DATA=wallet;
 MODEL wallet = male business punish explain;
RUN;</code></pre>
<p><strong>“Score Test for the Proportional Odds Assumption”</strong></p>
<p>This is the Chi-Square Score Test for the Proportional Odds Assumption. Since the ordered logit model estimates one equation over all levels of the dependent variable (as compared to the multinomial logit model, which models, assuming low ses is our referent level, an equation for medium ses versus low ses, and an equation for high ses versus low ses), the test for proportional odds tests whether our one-equation model is valid. If we were to reject the null hypothesis, we would conclude that ordered logit coefficients are not equal across the levels of the outcome and we would fit a less restrictive model (i.e., multinomial logit model). If we fail to reject the null hypothesis, we conclude that the assumption holds. For our model, the Proportional Odds Assumption appears to have held.</p>
</div>
</div>
</div>
<div id="adjacent-categories-model" class="section level2" number="13.7">
<h2><span class="header-section-number">13.7</span> Adjacent Categories Model</h2>
<p>排序类别数据的另一个通用模型是相邻类别模型。如前所述，我们将 <span class="math inline">\(p_{i j}\)</span> 设为个体 <span class="math inline">\(i\)</span> 进入因变量类别 <span class="math inline">\(j\)</span> 的 概率，并假设类别按序列 <span class="math inline">\(j=1, \ldots, J\)</span> 排序。现在取相邻的任何类别对，例如 <span class="math inline">\(j\)</span> 和 <span class="math inline">\(j+1\)</span> 。我们可 以根据解释变量来针对这两个类别之间的对比编写一个logit模型:
<span class="math display">\[
\begin{array}{c}
\log \left(\frac{p_{i, j+1}}{p_{i j}}\right)=\alpha_{j}+\boldsymbol{\beta}_{j} \mathbf{x}_{i} \quad j=1, \ldots, J-1 \\
\boldsymbol{\beta}_{j} \mathbf{x}_{i}=\beta_{j 1} x_{i 1}+\ldots+\beta_{j k} x_{i k}
\end{array}
\]</span>
为了获得有序数据的相邻类别模型，我们在这组方程上施加了约束。具体而言，我们假设所有的 <span class="math inline">\(\beta_{j}=\beta\)</span> for all <span class="math inline">\(j\)</span> 。换句话说, 不是每个相邻对都有一组不同的系数，而是只有一组。</p>
<p>尽管相邻类别模型是多项式logit模型的特例，但PROC LOGISTIC不允许施加适当的约束。如果可以将数 据分组到列联表中，则可以使用PROC CATMOD估计模型。但是，CATMOD使用加权最小二乘法而不是 最大似然法。</p>
<p>CATMOD没有FREQ语句，但是WEIGHT语句执行相同的功能。带有ALOGIT选项的RESPONSE语句为因变 量调用相邻类别的函数。将RESPONSE放在MODEL语句将通知CATMOD估计一组系数，而不是为每对类 别估计一组系数。默认情况下, CATMOD将所有预测变量视为CLASS变量。但是像LOGISTIC一样, CATMOD也使用”效果参数化”对这些变量进行编码。PARAM = REF选项将覆盖默认值以产生指示符变量编 码. 与LOGISTIC不同, CATMOD对模型进行参数化以预测响应变量的较高值而不是较低值。但是, 因为 MARRIED被视为CLASS变量，所以引用类别为1而不是0.</p>
<p>尽管累积对数模型和相邻类别模型在公式和解释上存在明显差异，但在实践中，这两种模型往往会得出非常相似的结论。我通常更喜欢累积模型，因为它具有吸引人的潜在变量解释能力，并且易于在软件中使用。但是相邻类别模型至少在原则上具有一个优势：容易制定对系数有选择性约束的模型</p>
<pre><code>PROC CATMOD DATA=happy;
 WEIGHT count;
 RESPONSE ALOGIT;
 MODEL happy = _RESPONSE_ married year / PARAM=REF;
RUN;</code></pre>
</div>
<div id="continuation-ratio-model" class="section level2" number="13.8">
<h2><span class="header-section-number">13.8</span> Continuation Ratio Model</h2>
<p>when the ordered categories represent a progression through stages, so that individuals must pass through each lower stage before they go on to higher stages.</p>
<blockquote>
<p>当排序的类别代表各个阶段的进展时，这是最合适的，这样个人就必须先经过每个较低的阶段，然后才能进入较高的阶段。 在那些情况下，延续比率模型比其他两个模型更具吸引力。</p>
</blockquote>
<p>Formalize the model for J categories on the dependent variable
将 <span class="math inline">\(A_{i j}\)</span> 定义为个人进入 <span class="math inline">\(j+1\)</span> 阶段的概率
<span class="math display">\[
\begin{array}{c}
A_{i j}=\operatorname{Pr}\left(y_{i}&gt;j \mid y_{i} \geq j\right) \\
\log \left(\frac{A_{i j}}{1-A_{i j}}\right)=\alpha_{j}+\boldsymbol{\beta} \mathbf{x}_{i} \quad j=1, \ldots, J-1
\end{array}
\]</span>
where <span class="math inline">\(\boldsymbol{\beta} \mathbf{x}_{i}=\beta_{1} x_{i 1}+\ldots+\beta_{k} x_{i k}\)</span>.
<span class="math display">\[
\log \left(\frac{A_{i j}}{1-A_{i j}}\right)=\log \left[\frac{\sum_{m=j+1}^{J} p_{i m}}{p_{i j}}\right]
\]</span></p>
<p>我们可以使用普通的二进制logit过程来估算这个模型。 诀窍在于构建数据集。对于每个阶段，您都将构建一个数据集，该数据集将所有未进入该阶段的个人排除在外，并使用一个虚拟因变量来指示该个人是否进入下一阶段。 现在，我们将这些数据集合并为一个单独的集合，而不是进行单独的分析，其中包括一个指示数据来自哪个阶段的变量。 最后，我们估计组合数据上的单个二进制logit模型。</p>
<p><span class="math display">\[
\begin{array}{lcc|ccc}
\hline &amp; &amp; \text { Father&#39;s } &amp; \text { Grammar } &amp; \text { Some High } &amp; \text { High School } \\
\text { Race } &amp; \text { Age } &amp; \text { Education* } &amp; \text { School } &amp; \text { School } &amp; \text { Graduate } \\
\hline \text { White } &amp; &lt;22 &amp; 1 &amp; 39 &amp; 29 &amp; 8 \\
&amp; &amp; 2 &amp; 4 &amp; 8 &amp; 1 \\
&amp; &amp; 3 &amp; 11 &amp; 9 &amp; 6 \\
&amp; &amp; 4 &amp; 48 &amp; 17 &amp; 8 \\
&amp; \geq 22 &amp; 1 &amp; 231 &amp; 115 &amp; 51 \\
&amp; &amp; 2 &amp; 17 &amp; 21 &amp; 13 \\
&amp; &amp; 3 &amp; 18 &amp; 28 &amp; 45 \\
&amp; &amp; 4 &amp; 197 &amp; 111 &amp; 35 \\
\text { Black } &amp; &lt;22 &amp; 1 &amp; 19 &amp; 40 &amp; 19 \\
&amp; &amp; 2 &amp; 5 &amp; 17 &amp; 7 \\
&amp; &amp; 3 &amp; 2 &amp; 14 &amp; 3 \\
&amp; \geq 22 &amp; 4 &amp; 49 &amp; 79 &amp; 24 \\
&amp; &amp; 1 &amp; 110 &amp; 133 &amp; 103 \\
&amp; &amp; 2 &amp; 18 &amp; 38 &amp; 25 \\
&amp; &amp; 3 &amp; 11 &amp; 25 &amp; 18 \\
&amp; &amp; 4 &amp; 178 &amp; 206 &amp; 81 \\
\hline
\end{array}
\]</span></p>
<pre><code>DATA afqt;
 INPUT white old faed ed count @@;
 DATALINES;
1 0 1 1 39
1 0 1 2 29
1 0 1 3 8
1 0 2 1 4
1 0 2 2 8
1 0 2 3 1
1 0 3 1 11
1 0 3 2 9
1 0 3 3 6
1 0 4 1 48
1 0 4 2 17
1 0 4 3 8
1 1 1 1 231
1 1 1 2 115
1 1 1 3 51
1 1 2 1 17
1 1 2 2 21
1 1 2 3 13
1 1 3 1 18
1 1 3 2 28
1 1 3 3 45
1 1 4 1 197
1 1 4 2 111
1 1 4 3 35
0 0 1 1 19
0 0 1 2 40
0 0 1 3 19
0 0 2 1 5
0 0 2 2 17
0 0 2 3 7
0 0 3 1 2
0 0 3 2 14
0 0 3 3 3
0 0 4 1 49
0 0 4 2 79
0 0 4 3 24
0 1 1 1 110
0 1 1 2 133
0 1 1 3 103
0 1 2 1 18
0 1 2 2 38
0 1 2 3 25
0 1 3 1 11
0 1 3 2 25
0 1 3 3 18
0 1 4 1 178
0 1 4 2 206
0 1 4 3 81
;

##  first stage
DATA first;
 SET afqt;
 stage=1;
 advance = ed GE 2;
RUN; 

## second stage
DATA second;
 SET afqt;
 stage=2;
 IF ed=1 THEN DELETE;
 advance = ed EQ 3;
RUN; 

## concatenated into a single set
DATA concat;
 SET first second;
RUN; 

## Alternatively
DATA combined;
 SET afqt;
 stage=1;
 advance = ed GE 2;
 OUTPUT;
 stage=2;
 IF ed=1 THEN DELETE;
 advance = ed EQ 3;
 OUTPUT;
RUN; 

## estimate the model with PROC LOGISTIC:
PROC LOGISTIC DATA=combined;
 FREQ count;
 CLASS faed / PARAM=REF;
 MODEL advance(EVENT=&#39;1&#39;)=stage white old faed / AGGREGATE
 SCALE=NONE;
RUN;</code></pre>
<p>关于延续比率方法，还有其他几点值得注意。</p>
<ul>
<li>首先，在合并的数据集中，同一个人可能会出现多次。对于教育示例，每个拥有高中的人都对合并后的数据集做出了两个观察。通常，由于多个观测值之间可能存在依赖关系，因此会产生危险信号。但是绝对没有依赖性的问题。对于每个人，将特定结果的概率计入一组条件概率，这些条件概率的结构与独立观察的结构相同。</li>
<li>其次，延续比率法与离散时间法用于生存分析密切相关。在这种情况下，目标是建模直到发生某个事件为止的时间长度，并以离散单位（例如年）为单位来测量时间。</li>
<li>第三，正如存在累积概率和累积互补对数-对数模型一样，人们可以使用概率或互补对数-对数函数轻松估计延续比率模型(probit or complementary log-log functions)。互补对数对数模型对于事件历史记录应用特别有吸引力，因为它是Cox回归中使用的比例风险模型的离散时间等效项</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/13-Logistic-Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
