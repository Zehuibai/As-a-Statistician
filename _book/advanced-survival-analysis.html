<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Advanced Survival Analysis | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Advanced Survival Analysis | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Advanced Survival Analysis | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="survival-analysis.html"/>
<link rel="next" href="mixed-model.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#coord" id="toc-coord"><span class="toc-section-number">4.4.3</span> coord</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.5</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.6</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.7</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#reorder" id="toc-reorder"><span class="toc-section-number">4.5.2</span> Reorder</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.3</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.5</span> Dot + Box Plot</a></li>
<li><a href="ggplot2.html#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.5.6</span> Violin Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#nominal-response" id="toc-nominal-response"><span class="toc-section-number">13.6.2</span> Nominal Response</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.3</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-survival-analysis" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> Advanced Survival Analysis</h1>
<div id="htmlwidget-ac0a7946444bb6acf37b" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac0a7946444bb6acf37b">{"x":{"data":"# \n## Advanced Survival Analysis\n### Tied or Discrete Data\n#### Introduction of Tie\n#### Discrete time\n#### Notation and Definitions\n#### Discrete Cox Regression\n#### Discrete-Time Regression Models\n##### Logit model for Discrete time\n##### Complementary log-log model for continuous time process\n#### The GLM Framework and Person-Period Data\n#### Discrete-Time Survival Analysis in R\n#### Discrete Cause-Specific Hazards Model\n#### Discrete Subdistribution Hazard Model\n### Time-dependent covariates\n#### Introduction\n#### Programming method\n#### Counting method\n### Additive Hazards Regression Model\n#### Preview\n#### Lin and Ying's additive hazards model\n#### Aalen's Additive Hazards Model\n### Competing Risk\n#### Introduction\n#### Type-specific hazards\n#### Covariate effects via COX model\n#### Cumulative incidence function (CIF)\n##### Introduction\n##### Proc Lifetest\n##### %CIF Macro\n#### Subdistribution hazard function\n##### Introduction\n##### Modeling using proc phreg\n##### %FINEGRAY_SEL\n##### %MULTIPLE_PHREG\n#### Cause-specific hazard function\n##### Modeling using proc phreg\n##### %Cause_Specific_SEL\n### Clustered Events\n#### Introduction\n#### Proportional hazards model which adopts a marginal\n#### Frailty model\n### Non-proportional hazards in Survival Analysis\n#### Weighted Piecewise Log-Rank Test\n#### Restricted Mean Survival Time Difference\n#### Maximum Combination Test","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="tied-or-discrete-data" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Tied or Discrete Data</h2>
<p><strong>Source</strong></p>
<ul>
<li>(Schmid M, Berger M (2021): Competing risks analysis for discrete
time-to-event data. WIREs Computational Statistics
13:e1529.)[<a href="https://sci-hub.se/10.1002/wics.1529" class="uri">https://sci-hub.se/10.1002/wics.1529</a>]</li>
<li>(discSurv: Discrete Time Survival
Analysis)[<a href="https://cran.r-project.org/web/packages/discSurv/index.html" class="uri">https://cran.r-project.org/web/packages/discSurv/index.html</a>]</li>
</ul>
<div id="introduction-of-tie" class="section level3" number="18.1.1">
<h3><span class="header-section-number">18.1.1</span> Introduction of Tie</h3>
<p>In the process of model derivation, we assumed that there would be only
one death observation at each point <span class="math inline">\(t_j\)</span>. If there are more than two
observations, we call it the “Tie”, we have the following three tricky
solutions</p>
<ol style="list-style-type: decimal">
<li>Average partial likelihood</li>
<li>Breslow</li>
<li>Efron</li>
</ol>
<p><strong>Average partial likelihood</strong></p>
<p>Since two individuals observe death at the same time at a certain time,
we might as well use the average value as their contribution to
likelihood!</p>
<p><span class="math display">\[\quad L_{j}(\beta)=\frac{1}{2} \frac{w_{2}}{\sum_{2,3,4} w_{j}} \frac{w_{3}}{\sum_{2,4} w_{j}}+\frac{1}{2} \frac{w_{3}}{\sum_{2,3,4} w_{j}} \frac{w_{2}}{\sum_{3,4} w_{j}}\]</span></p>
<ul>
<li>Advantages: the idea is simple and the most intuitive</li>
<li>Disadvantages: difficult to calculate</li>
</ul>
<p><strong>Breslow</strong></p>
<p>Idea: Use the above average partial likelihood approximation,</p>
<p><span class="math display">\[\quad \sum_{2,3,4} w_{j} \sum_{3,4} w_{j} \approx \sum_{2,3,4} w_{j} \sum_{2,4} w_{j} \approx\left(\sum_{2,3,4} w_{j}\right)^{2}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i}^{T} \beta\right)}{\prod_{r=0}^{d_{j}-1}\left(\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)-r \bar{w}\right)}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i} \beta\right)}{\left[\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)\right]^{d_{j}}}, \quad L_{j}(\beta)=\frac{\exp \left(\sum_{i \in D_{j}} x_{i} \beta\right)}{\left[\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)\right]^{d_{j}}}\]</span></p>
<ul>
<li>Advantages: simple calculation, similar to partial likelihood, easy
to solve</li>
<li>Disadvantages: more deviation from the average partial likelihood</li>
</ul>
<p><strong>Efron</strong></p>
<p>Idea: Approximate between the above
<span class="math display">\[\sum_{2,3,4} w_{j} \sum_{3,4} w_{j} \approx \sum_{2,3,4} w_{j} \sum_{2,4} w_{j} \approx\left(\sum_{2,3,4} w_{j}-\bar{w}\right)^{2}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i}^{T} \beta\right)}{\prod_{r=0}^{d_{j}-1}\left(\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)-r \bar{w}\right)}\]</span></p>
<pre><code>PROC PHREG DATA=recid;
   MODEL week*arrest(0)=fin age race wexp mar paro prio / TIES=EFRON;
RUN; </code></pre>
</div>
<div id="discrete-time" class="section level3" number="18.1.2">
<h3><span class="header-section-number">18.1.2</span> Discrete time</h3>
<p><strong>Time-to-event data</strong></p>
<p>Survival analysis is a body of methods commonly used to analyse
time-to-event data, such as the time until someone dies from a disease,
gets promoted at work, or has intercourse for the first time. The focus
is on the modelling of event transition (i.e. from no to yes) and the
time it takes for the event to occur. In comparison to other statistical
methods, survival analysis has two particular advantages. First, it
models the effects of both time-varying and time-fixed predictors on the
outcome. For instance, whether a person develops the common cold may be
influenced by both that person’s gender (which is in many cases a fixed
variable that does not vary with time) and the weather conditions (which
changes with time). Survival analysis can appropriately incorporate both
time-fixed and time-varying factors into the same model, while most
other modelling framework cannot. Second, survival analysis can take
care of the right censoring issue in the data, with right censoring
meaning that for some individuals the time when a transition (i.e. the
target event) takes place is unknown, which poses missing data issues
for other statistical approaches.</p>
<p>Many survival analysis techniques assume continuous measurement of time
(e.g. Cox regression). However, in practice, data are often collected in
discrete-time intervals, for instance, days, weeks and years, which
violates the assumption of continous time in many standard survival
analysis tools. Because of this reason, we need a special type of
survival analysis for discrete-time data, namely discrete-time survival
analysis. There are advantages to using discrete-time analysis, in
comparison to its continuous-time counterpart. For example,
discrete-time analysis has no problem with ties (i.e. multiple events
occurring at the same time point) and it can be embedded into the
generalised linear model (GLM) framework</p>
<p><strong>Time-scales</strong></p>
<ul>
<li><p>Continuous: The “exact” time of an event for each subject is known,
e.g., time of death</p></li>
<li><p>Discrete:</p>
<ul>
<li>The timing of an event is continuous but is only recorded for an
intervalof time, e.g., grade of school drop-out.</li>
<li>The timing of an event is itself discrete, e.g., grade retention</li>
</ul></li>
</ul>
<p><img src="02_Plots/DisTime.PNG" width="100%" style="display: block; margin: auto;" /></p>
<p>Which means observation times measured on a discrete time scale
<span class="math inline">\(t=1,2, \ldots, q\)</span> (apply to both scenarios)</p>
<p><strong>Scenario 1:</strong></p>
<ul>
<li>Values of <span class="math inline">\(t\)</span> represent a set of fixed follow-up intervals
<span class="math inline">\(\left[a_{t-1}, a_{t}\right)\)</span> with continuous boundaries
<span class="math inline">\(a_{0}=0&lt;a_{1}&lt;\ldots&lt;a_{q}=\infty\)</span></li>
<li>Examples: clinical and epidemiological studies, panel studies,</li>
</ul>
<p><strong>Scenario 2:</strong></p>
<ul>
<li>Intrinsically discrete time scale</li>
<li>Examples: time to pregnancy (observation time defined by number of
menstrual cycles), university outcomes in educational research
(observation time defined by number of semesters),</li>
</ul>
<p>Traditional methods for time-to-event analysis have often dealt with
building models for one target event only. For example, in case of the
CRASH-2 data, one could focus on only one cause of death (e.g.,
bleeding) and treat all patients that experienced another target event
(e.g., death due to head injury or other causes, in the following termed
“competing events”) as censored. This strategy has the advantage that it
is simple to implement (see, e.g., the works by Kalbfleisch &amp; Prentice,
2002; Singer &amp; Willett, 2003; Box-Steffensmeier &amp; Jones, 2004; Allison,
2014 and Tutz &amp; Schmid, 2016, which provide comprehensive treatments of
the available methodology for discrete failure time analysis with a
single target event). On the other hand, it is often prone to biased
analysis results. This is because the “censoring” times implicitly
defined by this strategy are usually not independent of the event times,
so that the assumptions of many existing methods for time-to-event
analysis with a single target event are violated (e.g., the random
censoring assumption or, more generally, the independent censoring
assumption made by Kalbfleisch &amp; Prentice, 2002). As a consequence,
special methods that account for the presence of competing risks are
needed.</p>
<!-- 事件时间分析的传统方法通常只为一个目标事件构建模型。例如，在 CRASH-2 数据的情况下，可以只关注一个死因（例如，出血）并治疗所有经历过另一目标事件（例如，由于头部受伤或其他原因导致的死亡，在以下情况下）的患者被称为“竞争事件”）被审查。这种策略的优点是易于实施（例如，参见 Kalbfleisch & Prentice，2002 年；Singer & Willett，2003 年；Box-Steffensmeier & Jones，2004 年；Allison，2014 年和 Tutz & Schmid，2016 年的著作，其中提供对单个目标事件的离散故障时间分析的可用方法的综合处理）。另一方面，它往往容易出现有偏差的分析结果。这是因为该策略隐式定义的“审查”时间通常不独立于事件时间，因此违反了许多现有方法对单个目标事件的时间到事件分析的假设（例如，随机审查假设，或者更一般地说，是 Kalbfleisch & Prentice，2002 年做出的独立审查假设）。因此，需要考虑竞争风险的特殊方法。 -->
</div>
<div id="notation-and-definitions" class="section level3" number="18.1.3">
<h3><span class="header-section-number">18.1.3</span> Notation and Definitions</h3>
<ul>
<li><p><span class="math inline">\(n\)</span> independent individuals, <span class="math inline">\(J\)</span> possible target events</p></li>
<li><p><span class="math inline">\(\mathbf{x}_{i}=\left(x_{i 1}, \ldots, x_{i p}\right)^{\top}, i=1, \ldots, n:\)</span>
covariate vectors</p></li>
<li><p><span class="math inline">\(\rightarrow T_{i} \in\{1,2, \ldots, q\}:\)</span> event time of individual
<span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(C_{i} \in\{1,2, \ldots, q\}:\)</span> censoring time of individual <span class="math inline">\(i\)</span></p></li>
<li><p>Assumptions:</p>
<ul>
<li><span class="math inline">\(T_{i}\)</span> and <span class="math inline">\(C_{i}\)</span> are independent (“random censoring”)</li>
<li>Censoring process does not depend on any parameters used to
model the event times ( “non-informative censoring”)</li>
<li>In Scenario <span class="math inline">\(1, T_{i}\)</span> always precedes <span class="math inline">\(C_{i}\)</span> if both <span class="math inline">\(T_{i}\)</span>
and <span class="math inline">\(C_{i}\)</span> occur in the same interval (“censoring at the end of
the interval”)</li>
</ul></li>
<li><p><span class="math inline">\(\tilde{T}_{i}=\min \left(T_{i}, C_{i}\right)\)</span> and
<span class="math inline">\(\Delta_{i}:=I\left(T_{i} \leq C_{i}\right):\)</span> observation time and
status indicator, respectively, of individual <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\rightarrow \epsilon_{i} \in\{1, \ldots, J\}:\)</span> event type of
individual <span class="math inline">\(i\)</span> at <span class="math inline">\(T_{i}\)</span></p></li>
<li><p>Cumulative incidence function (CIF):
<span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right):=P\left(T_{i} \leq t, \epsilon_{i}=j \mid \mathbf{x}_{i}\right)\)</span></p>
<ul>
<li>Defined for each <span class="math inline">\(j \in\{1, \ldots, J\}\)</span></li>
<li>Bounded between 0 and
<span class="math inline">\(F_{j}\left(q \mid \mathbf{x}_{i}\right)=P\left(\epsilon_{i}=j \mid \mathbf{x}_{i}\right) \leq 1\)</span></li>
</ul></li>
<li><p>Cause-specific hazard function: <span class="math display">\[
\lambda_{j}\left(t \mid \mathbf{x}_{i}\right):=P\left(T_{i}=t, \epsilon_{i}=j \mid T_{i} \geq t, \mathbf{x}_{i}\right)
\]</span></p>
<ul>
<li>Defined in terms of a probability</li>
</ul></li>
<li><p>Overall hazard function:</p></li>
</ul>
<p><span class="math display">\[
\lambda\left(t \mid \mathbf{x}_{i}\right):=P\left(T_{i}=t \mid T_{i} \geq t, \mathbf{x}_{i}\right)=\sum_{j=1}^{J} \lambda_{j}\left(t \mid \mathbf{x}_{i}\right)
\]</span></p>
<ul>
<li><p>Conditional probability of experiencing any of the <span class="math inline">\(J\)</span> events at <span class="math inline">\(t\)</span></p></li>
<li><p>(Overall) survival function:
<span class="math inline">\(S\left(t \mid \mathbf{x}_{i}\right):=P\left(T_{i}&gt;t \mid \mathbf{x}_{i}\right)=\prod_{t=1}^{q}\left(1-\lambda\left(t \mid \mathbf{x}_{i}\right)\right)\)</span></p></li>
</ul>
</div>
<div id="discrete-cox-regression" class="section level3" number="18.1.4">
<h3><span class="header-section-number">18.1.4</span> Discrete Cox Regression</h3>
<p><strong>Modeling</strong></p>
<p><span class="math display">\[\quad \frac{\lambda_{i j}}{1-\lambda_{i j}}=\frac{\lambda_{0 j}}{1-\lambda_{0 j}} \exp \left(x_{i}^{T} \beta\right), \]</span>
Some forms of <span class="math inline">\(\lambda_{0 j}\)</span> can be omitted (using Cox partial
likelihood method). This can be considered as an approximation of Cox
Regression in discreteness. This form is actually caused by
<span class="math inline">\(\lambda_{i j} \in(0,1)\)</span>, which can be considered as a probability in
the discrete case.</p>
<p><strong>PROC PHREG</strong></p>
<p>PROC PHREG uses the <strong>Breslow approximation</strong> as the default value, but
it also provides a better approximation proposed by Efron (1977) and two
precise methods. These are specified in PROC PHREG by <strong>TIES = EXACT</strong>
or <strong>TIES = DISCRETE</strong> as options in the MODEL statement. The difference
is that</p>
<ul>
<li><p>The EXACT method assumes that the <strong>time sequence</strong> of related
events is correct (but the time is unknown) (that is, the <strong>time is
continuous</strong>)</p>
<ul>
<li>Farewell and Prentice (1980) pointed out that as the number of
contacts at a particular point in time becomes a <strong>large
proportion of the number of cases at risk</strong>, the Breslow
approximation will become worse.</li>
<li>EXACT may be more reasonable for most applications. Since the
event may occur at any point in time, it is reasonable to assume
that the connection is only the result of an inaccurate
measurement of time, and there is a real but unknown time
sequence. We can construct partiality (likelihood) in the usual
way. However, without knowing the order, we must consider all
possibilities.</li>
</ul></li>
<li><p>The DISCRETE method assumes that events do <strong>occur at the same
time</strong>.</p>
<ul>
<li>In fact, DISCRETE is not a proportional hazard model at all.
However, this model does fall within the Cox regression
framework. The DISCRETE model assumes that time is actually
discrete, which is different from the EXACT model. When two or
more events seem to happen at the same time, there is no
underlying sequence-they actually happen at the same time</li>
</ul></li>
</ul>
</div>
<div id="discrete-time-regression-models" class="section level3" number="18.1.5">
<h3><span class="header-section-number">18.1.5</span> Discrete-Time Regression Models</h3>
<p>A general representation of the hazard function that connects the hazard <span class="math inline">\(h_{i s}\)</span> to a linear predictor <span class="math inline">\(\eta\)</span> is
<span class="math display">\[
\eta=g\left(h_{i s}\right)=\gamma_{0 s}+x_{i s} \gamma
\]</span>
where <span class="math inline">\(g(.)\)</span> is a link function. It links the hazard and the linear predictor <span class="math inline">\(\eta=\gamma_{0 s}+x_{i s} \gamma\)</span>, which contains the effects of covariates for individual <span class="math inline">\(i\)</span> in time period <span class="math inline">\(s\)</span>. The intercept <span class="math inline">\(\gamma_{0 s}\)</span> is assumed to vary over time, whereas the parameter <span class="math inline">\(\gamma\)</span> is fixed. Since hazards are probabilities restricted to the interval <span class="math inline">\([o, 1]\)</span>, natural candidates for the response function <span class="math inline">\(g(.)\)</span> are, for instance, the logit link and the Gompertz link (also called complementary log-log link). Both of them are frequent choices in discrete-time survival analysis. The corresponding hazard functions become
<span class="math display">\[
\begin{array}{c}
\text { logit }: h_{i s}=\exp (\eta) /(1+\exp (\eta)) \\
\text { Gompert } z: h_{i s}=1-\exp (-\exp (\eta))
\end{array}
\]</span>
Both link functions are appropriate in most cases. In fact, when the underlying hazards are small, both link functions usually lead to very similar parameter estimates. However, there are two differences. First, the two links result in different interpretations of the estimated parameters. In a logistic model (i.e. using the logit link), the exponential term of a parameter estimate quantifies the difference in the value of the odds per unit difference in the predictor, while in the Gompertz model it is the value of the hazard (i.e. which is a probability). Therefore, the Gompertz link results in a more intuitive model interpretation. Second, the Gompertz link assumes the underlying distribution of time to be continuous, but for practical reasons the measurement is discrete. Where it is safe to assume a continuous underlying distribution of time, we recommend using the Gompertz link and thus one would also benefit from more interpretable model estimates: othenvise, the logit link.</p>
<!-- 事实上，当潜在危害很小时，两个链接函数通常会导致非常相似的参数估计。 但是，有两个不同之处。 首先，这两个链接导致对估计参数的不同解释。 在逻辑模型中（即使用 logit 链接），参数估计的指数项量化了预测变量中每单位差异的几率值的差异，而在 Gompertz 模型中，它是风险的值（即 是一个概率）。 因此，Gompertz 链接导致更直观的模型解释。 其次，Gompertz 链接假设基本的时间分布是连续的，但出于实际原因，测量是离散的。 在假设连续的基本时间分布是安全的情况下，我们建议使用 Gompertz 链接，因此人们也将从更可解释的模型估计中受益 -->
<div id="logit-model-for-discrete-time" class="section level4" number="18.1.5.1">
<h4><span class="header-section-number">18.1.5.1</span> Logit model for Discrete time</h4>
<p>Cox’s discrete model can be described as follows. The time variable t
can only take integer values. Assume that <span class="math inline">\(P_{it}\)</span> is the conditional
probability of an event occurring in an individual at time <span class="math inline">\(t\)</span>, and
assume that an event has not occurred in this individual. This
possibility is sometimes called a discrete-time hazard. The model shows
that <span class="math inline">\(P_{it}\)</span> is related to the covariate through a logarithmic
regression equation <span class="math display">\[
\log \left(\frac{P_{it}}{1-P_{it}}\right)=\alpha_{t}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_ {ik}
\]</span></p>
<pre><code>DATA jobyrs;
 SET jobdur;
 DO year=1 TO dur;
 IF year=dur AND event=1 THEN quit=1;
 ELSE quit=0;
 OUTPUT;
 END;
RUN; 

PROC LOGISTIC DATA=jobyrs;
 CLASS year / PARAM=GLM;
 MODEL quit(DESC)=ed prestige salary year;
RUN; </code></pre>
</div>
<div id="complementary-log-log-model-for-continuous-time-process" class="section level4" number="18.1.5.2">
<h4><span class="header-section-number">18.1.5.2</span> Complementary log-log model for continuous time process</h4>
<p>The logarithmic model assumes that events can only occur at discrete
points in time. However, for most applications, the connection is
because the event time is roughly measured, even though the event can
actually occur at any point in time. The logit model lacks the
invariance of the length of the time interval.
<span class="math display">\[\log \left[-\log \left(1-P_{i t}\right)\right]=\alpha_{t}+\beta_{1} x_{i t 1}+\ldots+\beta_{k} x_{i t k}\]</span></p>
<pre><code>DATA jobyrs;
 SET jobdur;
 DO year=1 TO dur;
 IF year=dur AND event=1 THEN quit=1;
 ELSE quit=0;
 OUTPUT;
 END;
RUN; 

PROC LOGISTIC DATA=jobyrs;
 CLASS year / PARAM=GLM;
 MODEL quit(DESC)=ed prestige salary year/ LINK=CLOGLOG;
RUN; </code></pre>
</div>
</div>
<div id="the-glm-framework-and-person-period-data" class="section level3" number="18.1.6">
<h3><span class="header-section-number">18.1.6</span> The GLM Framework and Person-Period Data</h3>
<p>The total negative log-likelihood of the discrete survival regression model, assuming random (right) censoring, is given by
<span class="math display">\[
-l \propto \sum_{i=1}^{n} \sum_{s=1}^{t_{i}} y_{i s} \log h_{i s}+\left(1-y_{i s}\right) \log \left(1-h_{i s}\right)
\]</span>
where <span class="math inline">\(y_{i s}=1\)</span> if the target event occurs for individual <span class="math inline">\(i\)</span> during time period <span class="math inline">\(s\)</span>, and <span class="math inline">\(y_{i s}=0\)</span> otherwise: <span class="math inline">\(n\)</span> refers to the total number of individuals: <span class="math inline">\(t_{i}\)</span> the observed censored time for individual <span class="math inline">\(i\)</span>. This negative log-likelihood is equivalent to that of a binary response model (e.g. binary logistic regression). This analogue allows us to use software designed for binary response models for model estimation, with only two modifications. First, the distribution function is Gompertz (if not logit). Second, the number of binary observations in the discrete survival model depends on the observed censoring and lifetimes. Thus, the number of binary observations is <span class="math inline">\(\sum_{i=1}^{n} \sum_{s=1}^{t_{i}}\)</span>. This requires the so-called Person-Period data format, where there is a separate row for each individual <span class="math inline">\(i\)</span> for each period <span class="math inline">\(s\)</span> when the person is observed. In each row a variable indicates whether an event occurs. The event occurs in the last observed period unless the observation has been censored.
Below is an exemplar Person-Period data set, containing observations from three persons.</p>
<pre><code>##    id time event gender employed
## 1   1    1     0   male      yes
## 2   1    2     0   male      yes
## 3   1    3     1   male       no
## 4   2    1     1 female       no
## 5   3    1     0 female      yes
## 6   3    2     0 female      yes
## 7   3    3     0 female       no
## 8   3    4     0 female      yes
## 9   3    5     0 female      yes
## 10  3    6     0 female      yes</code></pre>
</div>
<div id="discrete-time-survival-analysis-in-r" class="section level3" number="18.1.7">
<h3><span class="header-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</h3>
<p><strong>Model Evaluation: Goodness of Fit</strong></p>
<p><strong>Deviance Residuals</strong></p>
<p>Deviance residuals of a discrete-time survival model can be used to examine the fit of a model on a case-by-case manner. The deviance residual for each individual i at time s is calculated via the following formula:</p>
<p><span class="math display">\[DevRes_{is} = \begin{cases}-\sqrt{-2log(1-\hat{h}_{is})} &amp; y_{is} = 0\\\sqrt{-2log(\hat{h}_{is})} &amp; y_{is} = 1\end{cases}\]</span>
<strong>Model Evaluation: Predictive Performance</strong></p>
<p><strong>Predictive Deviance</strong></p>
<p><span class="math display">\[
PD = -2 * (\sum_{i=1}^n\sum_{s=1}^{t_{i}} y_{is}\log (\hat{h}_{is}) + (1-y_{is})\log (1-\hat{h}_{is}))
\]</span></p>
<pre><code>{r,echo = T,message = FALSE, error = FALSE, warning = FALSE}
### load package
library(lme4) # for multilevel models
library(tidyverse) # for data manipulation and plots
library(effects) #for plotting parameter effects
library(jtools) #for transformaing model summaries
library(eha) #for the data sets used in this tutorial
library(discSurv) #discrete-time survival analysis tool kit 

## https://www.rensvandeschoot.com/tutorials/discrete-time-survival/
data(&quot;scania&quot;)
head(scania)
Scania_Person &lt;- scania %&gt;%
  mutate(exit = ceiling(exit),
         birthdate = floor(birthdate),
         spell = exit - enter) %&gt;% #spell refers to the observed duration of a person
  mutate(enter = enter - 50,
         exit = exit - 50)

head(Scania_Person)

###  Divide Data into Training (80%) and Test (20%) Sets
set.seed(123)
Scania_Person_Train &lt;- sample_frac(Scania_Person, 0.8)
Scania_Person_Test &lt;- Scania_Person[!Scania_Person$id %in% Scania_Person_Train$id,]

### Person-Period Format
#convert the training set
Scania_PersonPeriod_Train &lt;- dataLong(dataSet = Scania_Person_Train, 
                                      timeColumn = &quot;spell&quot;, 
                                      censColumn = &quot;event&quot;,
                                      timeAsFactor = F) %&gt;%
  as_tibble() %&gt;%
  mutate(enter = timeInt - 1,
         age = enter + 50) %&gt;%
  select(-obj, -event, -exit) %&gt;%
  rename(event = y,
         exit = timeInt) %&gt;%
  mutate(year = age + birthdate) %&gt;%
  select(id, enter, exit, event, everything()) %&gt;%
  left_join(logrye, by = &quot;year&quot;) #joined with the `logrye` data for a variable on yearly food prices

#convert the test set
Scania_PersonPeriod_Test &lt;- dataLong(dataSet = Scania_Person_Test, 
                                     timeColumn = &quot;spell&quot;, 
                                     censColumn = &quot;event&quot;,
                                     timeAsFactor = F) %&gt;%
  as_tibble() %&gt;%
  mutate(enter = timeInt - 1,
         age = enter + 50) %&gt;%
  select(-obj, -event, -exit) %&gt;%
  rename(event = y,
         exit = timeInt) %&gt;%
  mutate(year = age + birthdate) %&gt;%
  select(id, enter, exit, event, everything()) %&gt;%
  left_join(logrye, by = &quot;year&quot;)

### Gompertz Regression
Scania_PersonPeriod_Train %&gt;%
  group_by(exit) %&gt;%
  summarise(event = sum(event),
            total = n()) %&gt;%
  mutate(hazard = event/total) %&gt;%
  ggplot(aes(x = exit, y = log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth()

Gompertz_Model_Baseline &lt;- glm(formula = event ~ exit,
                               family = binomial(link = &quot;cloglog&quot;),
                               data = Scania_PersonPeriod_Train)
library(sjPlot)
tab_model(Gompertz_Model_Baseline)

### To ease the interpretaion, we can exponentiate the model estimates, using the summ function from the jtools package.
### exp = T means that we want exponentiated estimates
summ(Gompertz_Model_Baseline, exp = T) 

### Gompertz Regression Model between sex and cloglog(hazard):
Scania_PersonPeriod_Train %&gt;%
  group_by(exit, sex) %&gt;%
  summarise(event = sum(event),
         total = n()) %&gt;%
  mutate(hazard = event/total) %&gt;%
  ggplot(aes(x = exit, 
             y = log(-log(1-hazard)),
             col = sex)) +
  geom_point() +
  geom_smooth()
## fit the full model with all the variables just examined.
Gompertz_Model_Full &lt;- glm(formula = event ~ exit + sex + ses + immigrant + foodprices,
                           family = binomial(link = &quot;cloglog&quot;),
                           data = Scania_PersonPeriod_Train)
summ(Gompertz_Model_Full, exp = T)

## Visualisation of Parameter Effects
plot_summs(Gompertz_Model_Full, exp = T, scale = T)

## visualise the parameter effect
plot(allEffects(Gompertz_Model_Full))

## Model Evaluation: Goodness of Fit
## Likelihood Ratio Test
anova(Gompertz_Model_Baseline, Gompertz_Model_Full, test =&quot;Chisq&quot;)
## Akaike information criterion (AIC) 
Gompertz_Model_Full$aic
Gompertz_Model_Baseline$aic
## Deviance Residuals
Data_DevResid &lt;- tibble(Pred_Haz = predict(Gompertz_Model_Full, type = &quot;response&quot;),
       Event = pull(Scania_PersonPeriod_Train, event),
       ID = pull(Scania_PersonPeriod_Train, id)) %&gt;%
  mutate(DevRes = if_else(Event == 0, 
                          -sqrt(-2*log(1-Pred_Haz)),
                          sqrt(-2*log(Pred_Haz))))
Data_DevResid %&gt;%
  ggplot(aes(x = ID, y = DevRes)) +
  geom_point()


###  Predictive Deviance
#observed hazards
Obs_Haz &lt;- pull(Scania_PersonPeriod_Test, event)
#predicted hazards
Pred_Haz_Full &lt;- predict(Gompertz_Model_Full, Scania_PersonPeriod_Test, type = &quot;response&quot;)
#predictive deviance
Pred_Dev_Full &lt;- tibble(obs = Obs_Haz, pred = Pred_Haz_Full) %&gt;%
  mutate(dev = obs*log(pred) + (1-obs)*log(1-pred)) %&gt;%
  summarise(deviance = -2*sum(dev))%&gt;%
  pull(deviance)

Pred_Dev_Full


### Prediction Error Curves
### Prediction Error (PE) curves (PE(t)) are a time-dependent measure of prediction error based on the squared distance between the predicted individual survival functions
#calculate 1 - predicted hazards
OneMinusPredHaz &lt;- 1 - predict(Gompertz_Model_Full, 
                               newdata = Scania_PersonPeriod_Test, 
                               type = &quot;response&quot;)
#calculate individual predicted survival curves
PredSurv &lt;- aggregate(formula = OneMinusPredHaz ~ id, 
                      data = Scania_PersonPeriod_Test, 
                      FUN=cumprod)

#PE curves for all the 30 time points in the data
PredErrCurve &lt;- predErrDiscShort(timepoints = 1:30, 
                                 estSurvList = PredSurv[[2]], #survival curves
                                 newTime = Scania_Person_Test$exit, #time points in the test set
                                 newEvent = Scania_Person_Test$event, #event in the test set
                                 trainTime = Scania_Person_Train$exit, #time points in the training set
                                 trainEvent = Scania_Person_Train$event) #event in the training set
#plot the PE curve
tibble(PE = PredErrCurve$Output$predErr) %&gt;%
  mutate(exit = row_number()) %&gt;%
  ggplot(aes(y = PE, x = exit)) +
  geom_point() +
  geom_line(lty = &quot;dashed&quot;) +
  geom_hline(yintercept = 0.25)</code></pre>
</div>
<div id="discrete-cause-specific-hazards-model" class="section level3" number="18.1.8">
<h3><span class="header-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</h3>
<!-- 通过指定多元回归模型将累积关联函数 Fj(tj xi) 与一组协变量值 xi 相关联对于特定原因的危害 λj(tj xi)。 -->
<ul>
<li>Model that relates the cause-specific hazard function to covariates</li>
</ul>
<p>A popular approach to modeling discrete-time competing-risks data is the
discrete cause-specific hazards model (Tutz, 1995), which relates the
cumulative incidence functions <span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right)\)</span>
to a set of covariate values <span class="math inline">\(\mathbf{x}_{i}\)</span> by specifying a
multivariate regression model for the cause-specific hazards
<span class="math inline">\(\lambda_{j}\left(t \mid \mathbf{x}_{i}\right) .\)</span> We first consider the
parametric version of the discrete cause-specific hazards model, which
is defined by</p>
<p><span class="math display">\[
\begin{array}{c}
\lambda_{j}\left(t \mid \mathbf{x}_{i}\right)=\frac{\exp \left(\gamma_{0 t j}+\mathbf{x}_{i}^{\top} \gamma_{j}\right)}{1+\sum_{j=1}^{J} \exp \left(\gamma_{0 t j}+\mathbf{x}_{i}^{\top} \gamma_{j}\right)} \\
j=1, \ldots, J, t=1, \ldots, q-1
\end{array}
\]</span> - <span class="math inline">\(\gamma_{01 j}, \ldots, \gamma_{0(q-1) j}\)</span> : cause-specific
baseline coefficients (factor variables) -
<span class="math inline">\(\rightarrow \gamma_{j}:=\left(\gamma_{j 1}, \ldots, \gamma_{j p}\right)^{\top}:\)</span>
cause-specific vector of regression coefficients</p>
<p>Define conditional survival beyond <span class="math inline">\(t\)</span> by <span class="math display">\[
\lambda_{0}\left(t \mid \mathbf{x}_{i}\right):=P\left(T_{i}&gt;t \mid T_{i} \geq t, \mathbf{x}_{i}\right)
\]</span></p>
<p>Then
<span class="math inline">\(\lambda_{j}\left(t \mid \mathbf{x}_{i}\right) / \lambda_{0}\left(t \mid \mathbf{x}_{i}\right)=\exp \left(\gamma_{0 t j}\right) \cdot \exp \left(\gamma_{j 1}\right)^{x_{1}} \cdots \exp \left(\gamma_{j p}\right)^{x_{p}}\)</span>
<span class="math inline">\(\Rightarrow\)</span> Increase of covariate <span class="math inline">\(x_{k}, k \in\{1, \ldots, p\}\)</span>, by
one unit increases the cause-specific odds by the factor
<span class="math inline">\(\exp \left(\gamma_{j k}\right)\)</span></p>
<p>Equivalent to a multinomial logistic regression model with <span class="math inline">\(J+1\)</span> outcome
categories and reference category “survival beyond <span class="math inline">\(t\)</span></p>
</div>
<div id="discrete-subdistribution-hazard-model" class="section level3" number="18.1.9">
<h3><span class="header-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</h3>
<p><strong>Summary Motivation</strong></p>
<ul>
<li><p>Disadvantage of the discrete cause-specific hazards model: no
one-to-one relationship between
<span class="math inline">\(\lambda_{j}\left(t \mid \mathbf{x}_{i}\right)\)</span> and
<span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right)\)</span> <span class="math inline">\(\Rightarrow\)</span> All <span class="math inline">\(J\)</span>
cause-specific hazard functions are needed to model
<span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right)\)</span> <span class="math inline">\(\Rightarrow\)</span> Difficult to
infer the effects of the covariates on
<span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right)\)</span></p></li>
<li><p>Alternative: discrete subdistribution hazard model</p>
<ul>
<li>Direct modeling approach for the cumulative incidence function
of a specific event of interest</li>
<li>Extension of the respective modeling approach for continuous
event times</li>
<li>Only one model needs to be considered for interpretation of the
covariate effects on event occurrence</li>
</ul></li>
</ul>
<p>A disadvantage of the discrete cause-specific hazards model defined in
<span class="math inline">\(\lambda_{j}\left(t \mid \mathbf{x}_{i}\right)=\frac{\exp \left(\gamma_{0 t j}+\mathbf{x}_{i}^{\top} \gamma_{j}\right)}{1+\sum_{j=1}^{J} \exp \left(\gamma_{0 t j}+\mathbf{x}_{i}^{\top} \gamma_{j}\right)}\)</span>
is the lack of a one-to-one relationship between λj(tj xi) and Fj(tj
xi). In fact, Equation
<span class="math inline">\(F_{j}\left(t \mid \mathbf{x}_{i}\right)=\sum_{s=1}^{t} \lambda_{j}\left(s \mid \mathbf{x}_{i}\right) \cdot S\left(s-1 \mid \mathbf{x}_{i}\right)\)</span>
implies that all J cause-specific hazard functions are needed to model
the cumulative incidence function Fj(tj xi) of the j-th event. This is a
drawback especially when the interest is only in one of the J events and
when the number of competing events (and hence the number of
coefficients to be estimated) is large. In particular, it becomes
difficult to infer the effects of the covariates on the CIF, as a change
in the survival probability (with regard to xi) of the event of interest
may be a result of a changed cause-specific hazard of a competing event
(while the cause-specific hazard of the event of interest may remain
unchanged). In these situations, an alternative to the discrete
cause-specific hazards model is the discrete subdistribution hazard
model (Berger, Schmid, Welchowski, Schmitz-Valckenberg, &amp; Beyersmann,
2020), which is a direct modeling approach for the cumulative incidence
function of a specific event of interest. It is an extension of the
respective modeling approach for continuous event times by Fine and Gray
(1999) and has the advantage that only one model needs to be considered
for interpretation of the covariate effects on event occurrence.</p>
<!-- 中定义的离散原因特定危害模型的一个缺点是 λj(tj xi) 和 Fj(tj xi) 之间缺乏一对一的关系。事实上，等式 (1) 意味着需要所有 J 个特定于原因的危险函数来模拟第 j 个事件的累积发生率函数 Fj(tj xi)。这是一个缺点，尤其是当只关注 J 个事件之一并且竞争事件的数量（以及因此要估计的系数的数量）很大时。特别是，推断协变量对 CIF 的影响变得困难，因为感兴趣事件的生存概率（关于 xi）的变化可能是竞争事件的特定原因危害变化的结果（而感兴趣事件的特定原因危害可能保持不变）。在这些情况下，离散原因特定危害模型的替代方法是离散子分布危害模型（Berger、Schmid、Welchowski、Schmitz-Valckenberg 和 Beyersmann，2020 年），它是一种用于累积关联函数的直接建模方法。感兴趣的特定事件。它是 Fine and Gray (1999) 对连续事件时间的相应建模方法的扩展，其优点是只需要考虑一个模型来解释事件发生的协变量效应。 -->
<!-- 根据定义，ϑi 测量到类型 1 事件发生的时间。具体来说，它假设一旦竞争事件发生，1 类事件将永远不会是第一个被观察到的事件（Fine & Gray，1999），这意味着对于 1 类事件的发生没有有限的事件时间如果 ϵi ≠ 1。 -->
<p>Assume w.l.o.g. that the event of interest is defined by <span class="math inline">\(j=1\)</span> -
Consider subdistribution time <span class="math display">\[
\vartheta_{i}:=\left\{\begin{array}{l}
T_{i}, \text { if } \epsilon_{i}=1 \\
\infty, \text { if } \epsilon_{i} \neq 1
\end{array}\right.
\]</span> - <span class="math inline">\(\vartheta_{i}\)</span> : time to the occurrence of the type- 1 event -
Discrete subdistribution hazard is defined by <span class="math display">\[
\begin{aligned}
\xi_{1}\left(t \mid \mathbf{x}_{i}\right) &amp;:=P\left(T_{i}=t, \epsilon_{i}=1 \mid\left(T_{i} \geq t\right) \cup\left(T_{i} \leq t-1, \epsilon_{i} \neq 1\right), \mathbf{x}_{i}\right) \\
&amp;=P\left(\vartheta_{i}=t \mid \vartheta_{i} \geq t, \mathbf{x}_{i}\right), \quad t=1, \ldots, q
\end{aligned}
\]</span></p>
<ul>
<li><span class="math inline">\(t=1, \ldots, q\)</span>, represents the discrete hazard function of the
subdistribution time <span class="math inline">\(\vartheta_{i}\)</span>.</li>
<li>Comparing <span class="math inline">\(\xi_{1}(t)\)</span> to the cause-specific hazard
<span class="math inline">\(\lambda_{1}(t)\)</span>, it follows with a little algebra that
<span class="math inline">\(\lambda_{1}(t)=\xi_{1}(t) \cdot\left(1+P\left(T_{i} \leq t-1, \epsilon_{i} \neq 1\right) / P\left(T_{i} \geq t\right)\right) .\)</span>
This relationship, which is analogous to a relationship for
continuous event times derived by Beyersmann and Schumacher (2007),
implies that <span class="math inline">\(\xi_{1}(t)\)</span> is usually smaller than <span class="math inline">\(\lambda_{1}(t)\)</span>.</li>
<li>Conceptually, the subdistribution hazard may be considered as an
approach to model the occurrence probability of the target event
whereas the cause-specific hazards may be understood as the driving
forces of competing risks data, providing, for example, insight in
disease dynamics.</li>
</ul>
<!-- 从概念上讲，子分布危害可以被视为一种对目标事件发生概率进行建模的方法，而特定原因的危害可以被理解为竞争风险数据的驱动力，例如提供对疾病动态的洞察力。 -->
<p>With a little algebra it can be shown that the subdistribution hazard
<span class="math inline">\(\xi_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span> is linked to
<span class="math inline">\(F_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span> by
<span class="math inline">\(F_{1}\left(t \mid \mathbf{x}_{i}\right)=1-\prod_{s=1}^{t}\left(1-\xi_{1}\left(s \mid \mathbf{x}_{i}\right)\right)=1-S_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span>,
where
<span class="math inline">\(S_{1}\left(t \mid \mathbf{x}_{i}\right)=P\left(\vartheta_{i}&gt;t \mid \mathbf{x}_{i}\right) .\)</span>
Consequently, there is a one-to-one relationship between
<span class="math inline">\(\xi_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span> and
<span class="math inline">\(F_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span>, and the effects of the
covariates on <span class="math inline">\(\xi_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span> have a direct
interpretation in terms of increases or decreases in the CIF of a type-
1 event. A parametric model for
<span class="math inline">\(\xi_{1}\left(t \mid \mathbf{x}_{i}\right)\)</span> is given by <span class="math display">\[
\xi_{1}\left(t \mid \mathbf{x}_{i}\right)=\frac{\exp \left(\beta_{0 t 1}+\mathbf{x}_{i}^{\top} \beta_{1}\right)}{1+\exp \left(\beta_{0 t 1}+\mathbf{x}_{i}^{\top} \beta_{1}\right)}
\]</span> <span class="math inline">\(t=1, \ldots, q-1\)</span>, where the parameters
<span class="math inline">\(\beta_{011}, \ldots, \beta_{0(q-1) 1}\)</span> represent the baseline
coefficients and
<span class="math inline">\(\beta_{1}:=\left(\beta_{11}, \ldots, \beta_{p 1}\right)^{\top}\)</span> is a
vector of regression coefficients. Analogous to the cause-specific
hazards model (2), the increase of covariate <span class="math inline">\(x_{k}, k \in\{1,\)</span>,
<span class="math inline">\(\ldots, p\}\)</span>, by one unit increases the odds
<span class="math inline">\(\xi_{1}\left(t \mid \mathbf{x}_{i}\right) /\left(1-\xi_{1}\left(t \mid \mathbf{x}_{i}\right)\right)\)</span>
by the factor <span class="math inline">\(\exp \left(\beta_{k 1}\right) .\)</span> The baseline and
regression coefficients in (7) can be obtained by a weighted maximum
likelihood estimation scheme that is based on an estimate of the
censoring survival function <span class="math inline">\(\hat{G}(t)=\hat{P}\left(C_{i}&gt;t\right)\)</span> and
on a vector of weights <span class="math display">\[
w_{i t}:=\frac{\hat{G}(t-1)}{\hat{G}\left(\min \left(\tilde{T}_{i}, t\right)-1\right)} \cdot\left(I\left(t \leq \tilde{T}_{i}\right)+I\left(\tilde{T}_{i} \leq t-1, \Delta_{i} \epsilon_{i}&gt;1\right)\right)
\]</span></p>
</div>
</div>
<div id="time-dependent-covariates" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Time-dependent covariates</h2>
<div id="introduction" class="section level3" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> Introduction</h3>
<p>For a model with one time-invariant covariate and one time-dependent
covariate, we have
<span class="math display">\[\log h_{i}(t)=\alpha(t)+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}(t)\]</span></p>
<p>In order to deal with time-related covariates, PROC PHREG has two very
different ways to set up data and specify models. If done correctly,
these two methods will produce exactly the same results</p>
<ol style="list-style-type: decimal">
<li><strong>programming statements method</strong>: There is only one record per
person, and information about time-related covariates is contained
in multiple variables in that record. Then, define the time-related
covariates in the programming statement as part of the PROC PHREG
step.</li>
<li><strong>counting process method</strong>: Each person may have multiple records,
and each record corresponds to the time interval at which all
covariates remain constant. Once this special data set is
constructed, the time-related covariates are treated the same as the
time-invariant covariates.</li>
</ol>
<p>Including time-related covariates in the Cox model, generating
time-related covariates by creating a function of the <strong>interaction of
the predictor variables and survival time</strong>, and including them in the
model. If any time-related covariates are important, these predictors
are not proportional.</p>
<pre><code>proc phreg data=uis;
  model time*censor(0) = age race treat site agesite aget racet treatt sitet;
  aget = age*log(time);
  racet = race*log(time);
  treatt = treat*log(time);
  sitet = site*log(time);
  proportionality_test: test aget, racet, treat, sitet;
run;</code></pre>
</div>
<div id="programming-method" class="section level3" number="18.2.2">
<h3><span class="header-section-number">18.2.2</span> Programming method</h3>
<pre><code>*** If the patient has been transplanted on day t, define the time-related covariate; 
*** PLANT to be equal to 1, and it can be processed correctly; otherwise, PLANT is equal to 0;

PROC PHREG DATA=stan;
  MODEL surv1*dead(0)=plant surg ageaccpt / TIES=EFRON;
  IF wait&gt;=surv1 OR wait=. THEN plant=0; ELSE plant=1;
RUN;

*** sometimes including time-related covariates;

PROC PHREG DATA=stan;
  MODEL surv1*dead(0)=plant surg logage / TIES=EFRON;
  IF wait&gt;surv1 OR wait=. THEN plant=0; ELSE plant=1;
  logage=LOG(ageaccpt+surv1);
RUN;</code></pre>
</div>
<div id="counting-method" class="section level3" number="18.2.3">
<h3><span class="header-section-number">18.2.3</span> Counting method</h3>
<p>Construct a data set that contains multiple records per person. For
those who have not received the transplant, only one record is required.
The transplant recipient needs two records: one records the time
interval between acceptance and transplantation (PLANT = 0), and the
other records the interval time between transplantation and death or
examination (PLANT = 1). The first time interval is coded as review. The
second time interval can be censored or uncensored, depending on whether
the person died during the observation period. Invariant variable when
copying for two records. For each record, we also need two time
variables, one for the beginning of the time interval and one for the
end of the time interval. Both time variables are measured in the number
of days since the study was accepted.</p>
<pre><code>    DATA stanlong;
      SET stan;
      plant=0;
      start=0;

    IF trans=0 THEN DO;
     dead2=dead;
     stop=surv1;
     IF stop=0 THEN stop=.1;
     OUTPUT;
    END;

    ELSE DO;
     stop=wait;
     IF stop=0 THEN stop=.1;
     dead2=0;
     OUTPUT;
     plant=1;
     start=wait;
     IF stop=.1 THEN start=.1;
     stop=surv1;
     dead2=dead;
     OUTPUT;
    END;

    RUN;

    PROC PHREG DATA=stanlong;
     MODEL (start,stop)*dead2(0)=plant surg ageaccpt /TIES=EFRON;
    RUN; </code></pre>
</div>
</div>
<div id="additive-hazards-regression-model" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> Additive Hazards Regression Model</h2>
<div id="preview" class="section level3" number="18.3.1">
<h3><span class="header-section-number">18.3.1</span> Preview</h3>
<p>Currently, the most popular regression model for survival analysis is
the cox proportional hazards model. Based on this model, the relation
between failure times and pdimensional vector of independent variables
<span class="math inline">\((\mathrm{X})\)</span> has the form</p>
<p><span class="math display">\[\lambda_{i}(t)=\lambda_{0}(t) \exp \left(\gamma_{1} X_{i 1}+\cdots+\gamma_{p} X_{i p}\right)\]</span></p>
<p>where <span class="math inline">\(\lambda_{0}(\mathrm{t})\)</span> is the baseline hazard function and
<span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> is unknown timeindependent coefficients.
The crucial assumption of proportional hazards in the Cox model means
that the proportional effect of a treatment dose not vary with time
(David, 1972 ).</p>
</div>
<div id="lin-and-yings-additive-hazards-model" class="section level3" number="18.3.2">
<h3><span class="header-section-number">18.3.2</span> Lin and Ying’s additive hazards model</h3>
<p>This semiparametric additive hazards model the constant effects of
covariates upon baseline hazard is additive. According to this model,
hazard function for failure time (<span class="math inline">\(T_i\)</span>) has following relation with
<span class="math inline">\(\mathrm{p}\)</span>-dimensional vector <span class="math inline">\(\mathrm{X}\)</span> (covariates).</p>
<p><span class="math display">\[\lambda_{i}(\mathrm{t})=\lambda_{0}(\mathrm{t})+\gamma_{1} \mathrm{x}_{i 1}(\mathrm{t})+\ldots \ldots+\gamma_{p} \mathrm{x}_{i p}(\mathrm{t})\]</span>
where is baseline hazard function. Coefficients
<span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> are time independent additive effects (Lin
and Ying, 1995).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="advanced-survival-analysis.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(addhazard)</span>
<span id="cb9-2"><a href="advanced-survival-analysis.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb9-3"><a href="advanced-survival-analysis.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nwtsco)</span>
<span id="cb9-4"><a href="advanced-survival-analysis.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">### using the first 100 rows in nwtsco to build an additive hazards model</span></span>
<span id="cb9-5"><a href="advanced-survival-analysis.html#cb9-5" aria-hidden="true" tabindex="-1"></a>nwts<span class="ot">&lt;-</span> nwtsco[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,]</span>
<span id="cb9-6"><a href="advanced-survival-analysis.html#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="advanced-survival-analysis.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="do">### fit the additive hazards model to the data</span></span>
<span id="cb9-8"><a href="advanced-survival-analysis.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">### the model-based standard errors are reported when setting robust = FALSE</span></span>
<span id="cb9-9"><a href="advanced-survival-analysis.html#cb9-9" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">ah</span>(<span class="fu">Surv</span>(trel,relaps) <span class="sc">~</span> age <span class="sc">+</span> instit, <span class="at">ties =</span> <span class="cn">FALSE</span>, <span class="at">data =</span> nwts, <span class="at">robust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-10"><a href="advanced-survival-analysis.html#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<pre><code>## Call:
## ah(formula = Surv(trel, relaps) ~ age + instit, data = nwts, 
##     robust = FALSE, ties = FALSE)
## 
##              coef         se   lower.95   upper.95     z p.value
## age     0.0001401  0.0012043 -0.0022204  0.0025006 0.116   0.907
## instit  0.0155257  0.0123040 -0.0085902  0.0396416 1.262   0.207</code></pre>
</div>
<div id="aalens-additive-hazards-model" class="section level3" number="18.3.3">
<h3><span class="header-section-number">18.3.3</span> Aalen’s Additive Hazards Model</h3>
<p>In this non-parametric model the effects of covariates (constant or
variable effect) upon baseline hazard is additive. According to this
model, the relation between hazard function and failure time (<span class="math inline">\(T_i\)</span>)
with p-dimensional vector <span class="math inline">\(X\)</span> (covariates) takes the form</p>
<p><span class="math display">\[\lambda_{i}(\mathrm{t})=\lambda_{0}(\mathrm{t})+\gamma_{1}(t) \mathrm{x}_{i 1}(\mathrm{t})+\ldots+\gamma_{p}(\mathrm{t}) \mathrm{x}_{\mathrm{p} p}(\mathrm{t})\]</span></p>
<p>where is baseline hazard function. Coefficients
<span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> are time dependent additive effects. The
Aalen’s model provides cumulative regression function plots (Aalen’s
plot) that display how the effects of covariates change over the time.
In the other words, Aalen’s plot shows time-dependent or constant effect
of each covariate (Aalen, 1989). In this model, tests such as
Kolmogorov-Smirnov test and Cramer Von Mises test have been presented
for evaluating <strong>time invariant effect</strong> (Martinussen and Scheike, 2007
).</p>
</div>
</div>
<div id="competing-risk" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> Competing Risk</h2>
<div id="introduction-1" class="section level3" number="18.4.1">
<h3><span class="header-section-number">18.4.1</span> Introduction</h3>
<p>Competing risk are said to be present when a patient is at risk of more
than one mutually exclusive event, such as death from different cause
which will prevent any other from happening. Competing risk models
provide real world probabilities of death when competing events are
present as opposed to standard survival models by allowing us to
separate the probability of event into different causes.</p>
<p>In presence of competing events, the standard product-limit method of
estimating survivor function for the event of interest <strong>yields biased
results</strong> as the probability of occurrence is modified by an antecedent
competing event.</p>
<p>The biggest drawback of competing risks analysis is the requirement that
times for different event types be <strong>independent</strong> or <strong>at least that
each event be noninformative</strong> for the others.</p>
</div>
<div id="type-specific-hazards" class="section level3" number="18.4.2">
<h3><span class="header-section-number">18.4.2</span> Type-specific hazards</h3>
<p>As before, let <span class="math inline">\(T_{i}\)</span> be a random variable denoting the time of death
for person <span class="math inline">\(i\)</span>. Now let <span class="math inline">\(J_{i}\)</span> be a random variable denoting the type
of death that occurred to person <span class="math inline">\(i\)</span>. Thus, <span class="math inline">\(J_{5}=2\)</span> means that person
5 died of cancer. We now define <span class="math inline">\(h_{i j}(t)\)</span>, the hazard for death type
<span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span> for person <span class="math inline">\(i\)</span>, as follows:</p>
<p><span class="math display">\[h_{i j}(t)=\lim _{\Delta t \rightarrow 0} \frac{\operatorname{Pr}\left(t&lt;T_{i}&lt;t+\Delta t, J_{i}=j \mid T_{i} \geq t\right)}{\Delta t}, \quad j=1, \ldots, 5\]</span></p>
<p>The overall hazard of death is just the sum of all the typespecific
hazards: <span class="math display">\[h_{i}(t)=\sum_{j} h_{i j}(t)\]</span> Based on the type-specific
hazards, we can also define type-specific survival functions:
<span class="math display">\[S_{j}(t)=\exp \left\{-\int_{0}^{t} h_{j}(u) d u\right\}\]</span></p>
<p>we can define the hypothetical variable <span class="math inline">\(T_{i j}\)</span> as the time at which
the <span class="math inline">\(j_{t h}\)</span> event type either occurred to the ith person or would have
occurred if other event types had not preceded it. In other words, we
suppose that a person who dies of cancer at time <span class="math inline">\(T_{2}\)</span> would have
later died of heart disease at time <span class="math inline">\(T_{1}\)</span> if the cancer death had not
occurred. For a given set of <span class="math inline">\(T_{i j} \mathrm{~s}\)</span>, we only observe the
one that is smallest. If we further assume that the
<span class="math inline">\(T_{i j} \mathrm{~s}\)</span> are independent across event types, we can say
that <span class="math display">\[
S_{i j}(t)=\operatorname{Pr}\left(T_{i j}&gt;t\right)
\]</span> That is, the type-specific survival function gives the probability
that an event of type j occurs later than time t.</p>
<p><strong>Non-informative</strong></p>
<p>If the estimate is to be unbiased, the censor must be uninformative. For
competitive risks, we must make exactly the same assumptions. In other
words, we must assume that, on the condition of covariates, those who
are at a particularly high (or low) risk of one type of event will not
(or less) experience other types of events. Therefore, if we know that
someone died of heart disease at the age of 50, that would not give us
any information (except the information we derive from the covariates),
and there is no information about his risk of dying from cancer at that
age.</p>
</div>
<div id="covariate-effects-via-cox-model" class="section level3" number="18.4.3">
<h3><span class="header-section-number">18.4.3</span> Covariate effects via COX model</h3>
<ul>
<li>The first model treats all event types the same.</li>
<li>The second model focuses on type 3 by treating types 1 and 2 as
censoring.</li>
<li>That’s followed by a model for type 2, treating types 1 and 3 as
censoring</li>
</ul>
<p>These tests are only valid when using the Breslow method for handling
ties or when there are no tied event times. With tied event times:
TIES=EFRON</p>
<pre><code>PROC PHREG DATA=leaders;
 MODEL years*lost(0)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
 
PROC PHREG DATA=leaders;
 MODEL years*lost(0,1,2)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
 
PROC PHREG DATA=leaders;
 MODEL years*lost(0,1,3)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
RUN;</code></pre>
</div>
<div id="cumulative-incidence-function-cif" class="section level3" number="18.4.4">
<h3><span class="header-section-number">18.4.4</span> Cumulative incidence function (CIF)</h3>
<div id="introduction-2" class="section level4" number="18.4.4.1">
<h4><span class="header-section-number">18.4.4.1</span> Introduction</h4>
<p>Based on type-specific survival functions:
<span class="math display">\[S_{j}(t)=\exp \left\{-\int_{0}^{t} h_{j}(u) d u\right\}\]</span></p>
<p>It can be interpreted as the probability that a person arrives at time
<span class="math inline">\(t\)</span> without an event of type <span class="math inline">\(j\)</span> under the assumption that no other type
of event may occur. <span class="math display">\[F_{j}(t)=1-S_{j}(t)\]</span> This is not considered a
useful feature. Because the sum of the probabilities of various events
that occurred before time t may usually exceed 1.
<span class="math display">\[\sum_{j} F_{j}(t) \ge 1\]</span> Instead, many people prefer to estimate the
cumulative incidence function, This equation estimates the probability
that an event of type j happens to individual i before time t, in the
presence of competing event types. which is defined as
<span class="math display">\[I_{j}(t)=\operatorname{Pr}\left(T_{i}&lt;t, J_{i}=j\right)\]</span> The
consistent estimate of the cumulative incidence function is given by
<span class="math display">\[\hat{I}_{j}(t)=\sum_{k \mid t_{k} \leq t} \hat{S}\left(t_{k}\right) \frac{d_{j k}}{n_{k}}\]</span></p>
<ul>
<li>where <span class="math inline">\(\hat{S}(t)\)</span> is the Kaplan-Meier estimate of the overall
survivor function,</li>
<li><span class="math inline">\(d_{j k}\)</span> is the number of events of type <span class="math inline">\(j\)</span> that occurred at time
<span class="math inline">\(t_{k}\)</span>,</li>
<li><span class="math inline">\(n_{k}\)</span> is the number at risk at time <span class="math inline">\(t_{k}\)</span>.</li>
<li>The ratio of <span class="math inline">\(d_{j k}\)</span> to <span class="math inline">\(n_{k}\)</span> is an estimate of the hazard of
event type <span class="math inline">\(j\)</span> at time <span class="math inline">\(t_{k}\)</span></li>
</ul>
<p>An attractive feature of this estimator is <span class="math display">\[
\hat{S}(t)+\sum_{j} \hat{I}_{j}(t)=1
\]</span></p>
<p>This says that at any time t, the probabilities for all the event types
plus the probability of no event add up to 1. Another attraction is that
the method does not depend on the assumption that each event type is
noninformative for other event types.</p>
</div>
<div id="proc-lifetest" class="section level4" number="18.4.4.2">
<h4><span class="header-section-number">18.4.4.2</span> Proc Lifetest</h4>
<p>For competitive risk data, PROC LIFETEST estimates the cumulative
incidence function (CIF). If you have multiple data samples, it will
estimate the CIF for each sample and compare the CIF between the samples
by using the Gray test (Gray 1988). The estimated CIF is a step
function, with a jump at each different time when the event of interest
occurs. If there are a large number of such events, the estimated CIF
table may be very long. If you are interested in the cumulative
incidence of specific time points, you can use the TIMELIST = option in
the PROC LIFETEST statement to specify these time points, and PROC
LIFETEST only prints the estimated CIF values at these time points.</p>
<p><a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_lifetest_examples04.htm">source</a></p>
<ul>
<li>Censoring <span class="math inline">\(c_{i}=0\)</span></li>
<li>Without censoring (had a event) <span class="math inline">\(c_{i}=1\)</span></li>
<li>Competing events <span class="math inline">\(c_{i}=2\)</span></li>
</ul>
<!-- -->
<pre><code>proc format;
    value RG 1=&#39;MelaGenix® Low Risk&#39; 0=&#39;MelaGenix® High Risk&#39;;
run;
*** IF censoring then Status = 0;
*** IF Melanoma-specific death then Status = 1;
*** IF other death then Status = 2;
data MSS_Dummy;
    input Days Status Group Site $ @@;
    format Group RG.;
    datalines;
   1179 1 1 A 
    378 0 1 B
    956 1 1 C 
    355 1 1 A
   1432 0 1 B
    262 1 1 B 
    819 2 1 C
    256 1 1 A 
   2256 2 1 B
    255 1 1 C 
   1171 1 1 A
    224 0 1 B 
   1325 1 1 C
    225 1 0 A 
   1325 2 1 B
   1256 1 1 A 
    256 2 0 B
    255 0 1 C 
   1171 2 1 A
    224 0 1 B 
    325 1 0 C
   1225 0 1 A 
    725 1 1 B
    287 2 1 C 
    217 0 0 A
    319 1 1 B 
   1255 2 1 A
    264 0 1 C 
    256 1 1 B
    237 0 0 C 
    291 1 1 A
   1156 0 0 B 
    323 0 0 C
    270 1 0 A 
    253 1 1 B
   1257 2 0 C 
    206 1 0 A
    242 0 1 B 
   1206 1 0 A
    157 1 0 C 
    237 1 1 B
   1249 0 0 B 
    211 1 0 C
    180 0 0 B 
    229 1 1 C
    226 1 0 A 
   1234 2 1 A
    268 0 0 B 
    209 1 0 C
;


*** Log Rank Test;
ods graphics on;
ods trace on;
ods output  CensoredSummary =_censorsum
            HomTests = _Hom; 
proc lifetest data=MSS_Dummy NOTABLE 
              outsurv = MSS_Dummy_Output 
              alpha = 0.0074 
              plots=(survival(atrisk)); 
    time Days*Status(0);
    strata Group / group = site;
run;
ods output close;
ods trace off; 
ods graphics off;


*** Cumulative incidence function (CIF);
ods graphics on;
proc lifetest data=MSS_Dummy 
              alpha = 0.0222
              plots=CIF(test) 
              timelist=0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0;
   time Days*Status(0)/eventcode=1;
   strata Group / order=internal;
run;
ods graphics off;</code></pre>
<p><strong>Stratified Gray’s Test</strong></p>
<p>Specify the GROUP= option in the STRATA statement, PROC LIFETEST enables
you to perform a stratified test to evaluate the homogeneity of the CIFs
between groups.</p>
<pre><code>ods graphics on;
proc lifetest data=MSS_Dummy 
              alpha = 0.0222
              plots=CIF(test) 
              timelist=0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0;
   time Days*Status(0)/eventcode=1;
   strata site  /group=Group order=internal;
run;
ods graphics off;</code></pre>
</div>
<div id="cif-macro" class="section level4" number="18.4.4.3">
<h4><span class="header-section-number">18.4.4.3</span> %CIF Macro</h4>
<p>The %CIF macro computes the crude cumulative incidence function
estimates for homogeneous (no covariates) survival data whose endpoints
are subjected to competing risks (Klein and Moeschberger, 2003).
Standard errors and pointwise confidence limits are also computed. The
estimated cumulative incidence curve is plotted as a step function using
ODS graphics. You can also display the pointwise confidence limits in
the plot by specifying the PLOTCL keyword in the OPTIONS= argument. If
you do not want any plots, you can suppress it by specifying the NOPLOT
keyword in the OPTIONS= argument.</p>
<p>If the data contains multiple samples identified by the GROUP= variable,
the %CIF macro computes a cumulative incidence curve for each group, and
the macro also compares cumulative incidence functions between groups
using the method of Gray (1988).</p>
<pre><code>* cohort is the data name
* time is the survival time
* Ending y There is a risk of competition among multiple categories
     * 0 = Survival
     * 1 = Mainly concerned about ending A
     * 2 = Competitive risk event B
     
ods graphics on；ods html dpi＝300；

/*Do not group A total CIF*/
% cif(data＝cohort，out＝cif1_data，time＝time，status＝y，event＝1，censored＝0)；

/*CIF of gray’s comparison A between treat groups in operation group*/
% cif(data＝cohort，out＝cif1_data，time＝time，status＝y，
      event＝1，censored＝0，group＝treat)；
      
/*CIF of gray’s comparison B between treat groups in operation group*/
% cif(data＝cohort，out＝cif2_data，time＝time，status＝y，
      event＝2，censored＝0，group＝treat)；


%macro CIF(
   data=,           /* Name of the input data set                             */
   out=cifEstimate, /* Name of the output data set that                       */
                    /* contains the cumulative incidence estimates            */
   time=Time,       /* Time variable                                          */
   status=Status,   /* Numeric variable whose values indicate  whether an     */
                    /* observation corresponds to the event of interest, the  */
                    /* competing event, or is censored                        */
   event=1,         /* Values of status= variable that correspond to the event*/
                    /* interest. Multiple values are separated by blanks      */
   censored=0,      /* Values of status= variable that correspond to censored */
                    /* observations. Multiple values are separated blanks     */
   group=,          /* Variable that defines the groups for comparison        */
   strata=,         /* Variable that defines the  strata for stratified test  */
   alpha=.05,       /* Complement of the confidence level for pointwise       */
                    /*confidence limits                                       */
   rho=0,           /* Power of the weight function in the test               */
   SE=1,            /* Method to compute the standard error of cumulative     */
                    /* incidence functions. 1=delta method;2=counting process */
   TITLE=,          /* First title for the cumulative incidence function      */
                    /* plot (without quote)                                   */
   TITLE2=,         /* Second title for the cumulative incidence function     */
                    /* plot (without quote)                                   */
   options=,        /* Multiple keywords are separated by blanks              */
                    /* NOPLOT suppresses plotting the cumulative incidence    */
                    /*        curves                                          */
                    /* PLOTCL plots the pointwise confidence limits for       */
                    /*        cumulative incidence curves                     */
                    /* NOCIFEST suppresses the CIF estimate table             */
                    /* NOTEST suppresses the test for differences among       */
                    /*        cumulative incidence functions                  */
                    /*                                                        */
   );;

%macro HL; %mend HL;
%local Confidence savenote noplotflag plotclflag notestflag nocifflag nev s11 inconsistentgrpnumflag;
%let savenote     = %sysfunc(getoption(notes));

options nonotes;


/* Check if time= and status= variables okey */
proc contents data=&amp;data noprint out=_c; run;

%let TimeVar=1;
%let StatusVar=1;
%let GroupVar=1;
%let StrataVar=1;
%let nocifflag=0;
%let inconsistentgrpnumflag=0;

data _null_;
   length x y $32;
   set _c;
   x=lowcase(NAME);
   y=lowcase(&quot;&amp;time&quot;);
   if x=y then do;
      if TYPE=1 then call symput(&#39;TimeVar&#39;, put(0,1.));
      else           call symput(&#39;TimeVar&#39;, put(2,1.));
   end;
   y=lowcase(&quot;&amp;status&quot;);
   if x=y then do;
      if TYPE=1 then call symput(&#39;StatusVar&#39;, put(0,1.));
      else           call symput(&#39;StatusVar&#39;, put(2,1.));
   end;
   %if ((&amp;group^=) ) %then %do;
           y=lowcase(&quot;&amp;group&quot;);
           if x=y then do;
                  if TYPE=1 then call symput(&#39;GroupVar&#39;, put(0,1.));
                  else           call symput(&#39;GroupVar&#39;, put(2,1.));
                  end;
           %end;
   %else
       call symput(&#39;GroupVar&#39;, put(3,1.));;

   %if ((&amp;strata^=) ) %then %do;
           y=lowcase(&quot;&amp;strata&quot;);
           if x=y then do;
                  if TYPE=1 then call symput(&#39;StrataVar&#39;, put(0,1.));
                  else           call symput(&#39;StrataVar&#39;, put(2,1.));
           end;
           %end;
   %else
                call symput(&#39;StrataVar&#39;, put(3,1.));;

run;


%if &amp;TimeVar=1 %then %do;
   %let _xrc_=
     %str(Variable &amp;time not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;TimeVar=2 %then %do;
   %let _xrc_=
     %str(Variable &amp;time is not a numeric variable);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;StatusVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;status not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;StatusVar=2 %then %do;
   %let _xrc_=
    %str(Variable &amp;status is not a numeric variable);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;

%if &amp;GroupVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;group not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;

%if &amp;StrataVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;strata not found in the input data set);
    %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;



data _null_;
   /*----- check OPTIONS= -----*/
   list= lowcase(symget(&#39;options&#39;));
   i = index(list, &#39;noplot&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;noplotflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;plotcl&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;plotclflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;notest&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;notestflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;nocifest&#39;); if i then substr(list, i, 8) = &#39; &#39;;
   call symput(&#39;nocifestflag&#39;, put(i gt 0, 1.));

   /*----- Confidence Level -------*/
   alpha=.05;
   %if &amp;alpha ne %then %do; alpha=&amp;alpha; %end;
   call symput(&#39;Confidence&#39;,trim(put(100*(1-alpha),best8. -l)));
   /*---- No of event= and compete= values ----*/
   ne=countw(symget(&#39;event&#39;),&#39; &#39;);
   call symput(&#39;ne&#39;,put(ne,best8. -l));
   ncens=countw(symget(&#39;censored&#39;),&#39; &#39;);
   call symput(&#39;ncens&#39;,put(ncens,best8. -l));

run;


%if &amp;data= %then %do;
   %let _xrc_= %str(The DATA= parameter is not specified);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
   %end;
%else
   %do;

   data _null_;
   set &amp;data;
   array event[&amp;ne] _temporary_(&amp;event);
   array censored[&amp;ncens] _temporary_(&amp;censored);;
   zevent=0;
   zcensored=0;
   do i=1 to &amp;ne;
     if &amp;status = event[i] then do;
       zevent=1;
       goto skip1;
     end;
   end;
   skip1:;

   do i=1 to &amp;ncens;
      if &amp;status = censored[i] then do;
         zcensored=1;
         go to skip2;
      end;
   end;
   skip2:;

   if zevent=1 and zcensored=1 then do;
      call symput(&#39;s11&#39;,trim(left(put(&amp;status,best8.))));
      stop;
   end;
   if zevent=1 then do;
       call symput(&#39;nev&#39;,put(1,1.));
   end;
   run;

%if &amp;nev eq %then %do;
  %let _xrc_=
    %str(The total number of EVENT is 0);
  %put ERROR: &amp;_xrc_..;
  %goto exit;
%end;

%if &amp;s11 ne %then %do;
  %let _xrc_=
    %str(&amp;Status=%sysfunc(trim(&amp;s11)) is both an EVENT= and CENSORED= value);
  %put ERROR: &amp;_xrc_..;
  %goto exit;
%end;
run;

data _null_;
   set &amp;data;
   length l $ 60;
   call vname(&amp;time, l);
   call symputx(&#39;tname&#39;, l, &#39;L&#39;);
   call label(&amp;time, l);
   call symputx(&#39;tlabel&#39;, l, &#39;L&#39;);
   %if ((&amp;group^=) ) %then %do;
      call vname(&amp;group, l);
      call symputx(&#39;gname&#39;, l, &#39;L&#39;);
      call label(&amp;group, l);
      call symputx(&#39;glabel&#39;,l , &#39;L&#39;);
      call symputx(&#39;grpFmt&#39;, VFORMAT(&amp;group));
      %end;
   %else %do;
      call symputx(&#39;glabel&#39;,&quot;Group&quot; , &#39;L&#39;);
          call symputx(&#39;gname&#39;, &quot;Group&quot;, &#39;L&#39;);;
      %end;

    %if ((&amp;strata^=) ) %then %do;
      call vname(&amp;strata, l);
      call symputx(&#39;stratname&#39;, l, &#39;L&#39;);
      call label(&amp;strata, l);
      call symputx(&#39;stratlabel&#39;,l , &#39;L&#39;);
      call symputx(&#39;stratFmt&#39;, VFORMAT(&amp;strata));
      %end;
   %else %do;
      call symputx(&#39;stratlabel&#39;,&quot;Strata&quot; , &#39;L&#39;);
          call symputx(&#39;stratname&#39;, &quot;Strata&quot;, &#39;L&#39;);;
      %end;


run;

/*create a data set by ignoring those missing observations*/
data &amp;data.1(drop=&amp;group);
   set &amp;data;
   %if ((&amp;group^=) ) %then %do;
      f&amp;group= put(&amp;group, &amp;grpFmt);
      IF CMISS(&amp;time,&amp;status, f&amp;group) &gt; 0 THEN DELETE;
      %end;
   %if ((&amp;strata^=) ) %then %do;
      f&amp;strata= put(&amp;strata, &amp;stratFmt);
      IF CMISS(&amp;time, &amp;status, f&amp;strata) &gt; 0 THEN  DELETE;
      %end;
   %end;


run;


data _null_;
   call symputx(&#39;nobs0&#39;,nobs0);
   stop;
   set &amp;data nobs=nobs0;
run;

data _null_;
   call symputx(&#39;nobs1&#39;,nobs1);
   stop;
   set &amp;data.1 nobs=nobs1;
run;


%if &amp;nobs0&gt;&amp;nobs1 %then %do;
   %put NOTE: There are %eval(&amp;nobs0-&amp;nobs1) missing observations;

%end;


proc iml;
   use &amp;data.1;
   read all var{&amp;time} into time;
   read all var{&amp;status} into status;
   nobs= nrow(time);
   %if %bquote(&amp;group)= %then %do;
     group= j(nobs,1,1);
   %end;
   %else %do;
   read all var{f&amp;group} into group;
   %end;


   %if %bquote(&amp;strata)= %then %do;
     strat= j(nobs,1,1);
   %end;
   %else %do;
     read all var{f&amp;strata} into strat;
   %end;


   close &amp;data.1;

* subroutine to calculate the cumulative incidence and variance;
start estimate_cif(y, causecode) global(time, cif, vcif1, vcif2, n2);
/*************************************************************
* y is the failure times (sorted in increasing order);
* ic is the indicator for censoring
*   (= 0 if censored, =1 if failed from any cause);
* icc is the indicator for failure from the cause of interest
*   (= 0 if failed from cause of interest, =1 otherwise);
* n is the # of observations (length of y);
* n2 = n+2:  the number of the unique time points from cause 1 with 2 extra points (0 and largest time point within this group);
* ut is the unique failure times from the cause of interest;
* cif is the estimated cumulative incidence function;
* vcif1 and vcif2 are the estimated variance of cif from Marubini method and Gray method respectively;
**************************************************************/
   surv_km= 1;
   v11= 0; v21= 0;
   v12= 0; v22= 0;
   v13= 0; v23= 0;


   cif_pos= 1;
   n= nrow(y);
   nrisk=n;

   ut=unique(y)`;
   n_ut=nrow(ut);

   cif= j(n2,1,0);
   vcif1= j(n2,1,0);
   vcif2= j(n2,1,0);


   do i=1 to n_ut;
      *compute the number of events of interest and competing events;
      nevent=sum(causecode[loc(y=ut[i])]=1);
      ncompetevent=sum(causecode[loc(y=ut[i])]=2);
      n_allevents = nevent+ ncompetevent;

      *compute survival function and cumulative incidence function;
      if n_allevents^= 0 then do; *overall survival changes whenever a failure occurs;
         if (i&gt;1)  then nrisk =n - min(loc(y=ut[i]))+ 1 ;
         surv_km_n= surv_km* (nrisk- n_allevents)/ nrisk;
         if nevent&gt; 0 then do;
            cif_pos= cif_pos + 1;
            cif[cif_pos]= cif[cif_pos- 1]+ surv_km * nevent/ nrisk;
            end;


            * variance estimator using delta method- (10.12) in Marubini and Valsecchi (1995);
            * Analysing Survival Data from Clinical Trials and Observational Studies;
            t1=0;
            if (nrisk- n_allevents&gt;0) then         t1= n_allevents/ nrisk/ (nrisk- n_allevents);
            t2= surv_km* nevent/ nrisk/ nrisk;
            t3= surv_km* (1- nevent/ nrisk)* t2;
            t4= cif[cif_pos]* cif[cif_pos];
            v11= v11+ t1;
            v12= v12- 2* (cif[cif_pos]* t1+ t2);
            v13= v13+ t4* t1+ 2* cif[cif_pos]* t2 + t3;
            vcif1[cif_pos]= t4* v11+ cif[cif_pos]* v12+ v13;



            *variance estimator using counting process- Gray (1988);

            if (ncompetevent&gt; 0 &amp; surv_km_n&gt; 0) then do;
               vt1=1;
               if( ncompetevent &gt; 1) then vt1= 1- (ncompetevent - 1)/(nrisk- 1);
               vt2= surv_km* surv_km* vt1* ncompetevent/(nrisk* nrisk);
               vt3= 1/ surv_km_n;
               vt4= cif[cif_pos]/ surv_km_n;
               v21= v21+ vt2* vt4* vt4;
               v22= v22+ vt2* vt3* vt4;
               v23= v23+ vt2* vt3* vt3;
               end;
            if (nevent&gt; 0) then do;
               vt1=1;
               if( nevent&gt; 1 ) then vt1= 1-(nevent- 1)/(nrisk- 1);
               vt2= surv_km* surv_km* vt1* nevent/(nrisk* nrisk);
               if surv_km_n&gt; 0 then vt3= 1/ surv_km_n; else vt3= 0;
               vt4= 1+ vt3* cif[cif_pos];
               v21= v21+ vt2* vt4* vt4;
               v22= v22+ vt2* vt3* vt4;
               v23= v23+ vt2* vt3* vt3;
               vcif2[cif_pos]= v21 - 2*cif[cif_pos]*v22 +  cif[cif_pos]*cif[cif_pos]*v23;
               end;

            surv_km= surv_km_n;

         end;


   end;       /*end do i=*/


   if cif_pos&lt; n2 then do;
      /*deal with the largest time point with the group*/
      cif_pos= cif_pos+ 1;
      time[cif_pos]= ut[n_ut];
      cif[cif_pos]= cif[cif_pos- 1];
      vcif1[cif_pos]= vcif1[cif_pos- 1];
      vcif2[cif_pos]= vcif2[cif_pos- 1];

   end;
   if (sum(vcif1&lt;0)&gt;0) then   vcif1[loc(vcif1&lt;0)]=0;
   if (sum(vcif2&lt;0)&gt;0) then   vcif2[loc(vcif2&lt;0)]=0;


   vcif1= sqrt(vcif1);
   vcif2= sqrt(vcif2);

finish estimate_cif;



/* subroutine for calculating k-sample test statitsics and variance within stratum;
* for competing risk for Gray&#39;s method (1988);*/
start test_ksample(y, causecode, ig, rho) global(score, vcov);
*  y is the failure times (sorted in ascending order)
*  causecode is cause indicator
*   (= 0 if censored, =1 if failed from the cause of interest,
*       2 if failed from some other causes.)
*  ig denotes group membership

*  rho is the power of the weight function in the test statistic


   *  ng denotes the number of groups, ng1= ng- 1;
   ng= ncol(unique(ig));
   * risk set size in each at the current failure time (= sample size at 0);
   nrisk= j(ng,1,0);

   do i= 1 to ng;
      nrisk[i]= nrisk[i] + sum(ig=i);
   end;

   ng1=ng-1;
   ng2= ng* ng1/ 2;
   score= j(ng1,1,0);
   vcov= j(ng2,1,0);

   l= 0;
   cifgleft= j(ng,1,0);
   cifg=  j(ng,1,0);
   cif0left= 0;
   cif0= 0;

   vtvec=  j(ng,1,0);
   skmgleft= j(ng,1,1);
   skmg= j(ng,1,1);


   vtmatrix= j(ng1,ng,0);
   c= j(ng,ng,0);


   ll= 1;

   ut=unique(y)`;
   n_ut=nrow(ut);

   do i=1 to n_ut;
         d= j(3,ng,0);
         yloc=loc(y=ut[i]);
      do ii= yloc[1] to yloc[ncol(yloc)];
         k= causecode[ii]+ 1;   * causes code:0, 1, 2;
         d[k,ig[ii]]= d[k,ig[ii]] + 1;
      end;
      nd1= d[2,+];
      nd2= d[3,+];

      if (nd1^= 0 | nd2^= 0) then do;
         *hdot is sum(hhat), Rdot is sum(R), skmgleft is Shat, nrisk is Y, cifgleft is CIF;
         hdot= 0; Rdot= 0;
         do g= 1 to ng;
            if (nrisk[g]&gt; 0) then do;
               td= d[2,g] + d[3,g];
               skmg[g]= skmgleft[g]* (nrisk[g]- td)/ nrisk[g];
               cifg[g]= cifgleft[g]+ skmgleft[g]* d[2,g]/ nrisk[g];
               hdot= hdot+ nrisk[g]/ skmgleft[g];
               Rdot= Rdot+ nrisk[g]* (1 - cifgleft[g])/ skmgleft[g];
               end;
         end;

         cif0= cif0left+ nd1/hdot;
         grho= (1- cif0left)**rho;

         * score statistic;
         do g=1 to ng1;
            if (nrisk[g]&gt; 0) then score[g]= score[g]+ grho* (d[2,g]- nd1* nrisk[g]* (1- cifgleft[g])/ skmgleft[g]/ Rdot);
         end;

         a= j(ng, ng,0);
         do g= 1 to ng;
            if (nrisk[g]&gt; 0) then do;
               t1= nrisk[g]/ skmgleft[g];
               a[g,g]= grho* t1* (1- t1/ hdot);
               c[g,g]= c[g,g]+ a[g,g]* nd1/hdot/(1- cif0left);
               k= g + 1;
               *if (k&lt;= ng) then do j= k to ng;
               do j= g+1 to ng;
                  if (nrisk[j]&gt; 0) then do;
                     a[g,j]= - grho* t1* nrisk[j]/ skmgleft[j]/ hdot; a[j,g]= a[g,j];
                     c[g,j]= c[g,j]+ a[g,j]* nd1/ hdot/ (1 - cif0left); c[j,g]= c[g,j];
                     end;
               end;
               end;
         end;


         * variance estimators;
         if nd1&gt; 0 then do k=1 to ng;
            if (nrisk[k]&gt; 0) then do;
               if skmg[k]&gt; 0 then vt1= 1- (1- cif0)/ skmg[k]; else vt1= 1;
               if nd1&gt; 1 then vt2= 1- (nd1- 1)/ (hdot* skmgleft[k]- 1); else vt2= 1;
               vt3= vt2* skmgleft[k]* nd1/ (hdot* nrisk[k]);
               vtvec[k]= vtvec[k]+ vt1* vt1* vt3;
               do g= 1 to ng1;
                  vt4= a[g,k]- vt1* c[g,k];
                  vtmatrix[g,k]= vtmatrix[g,k]+ vt4* vt1* vt3;
                  do j=1 to g;
                     l= g* (g- 1)/ 2+ j;
                     vt5= a[j,k]- vt1* c[j,k];
                     vcov[l]= vcov[l]+ vt3* vt4* vt5;
                  end;
               end;
               end;
            end;

         if (nd2^= 0) then do k=1 to ng;
            if (skmg[k]&gt; 0 &amp; d[3,k]&gt; 0) then do;
               vt1= (1- cif0)/ skmg[k];
               vt2= 1;
               if (d[3,k]&gt; 1) then vt2= 1- (d[3,k] - 1)/ (nrisk[k]- 1);
               vt3= vt2* ((skmgleft[k]** 2)* d[3,k])/ (nrisk[k]** 2);
               vtvec[k]= vtvec[k]+ vt1* vt1* vt3;
               do g=1 to ng1;
                  vt4= vt1* c[g,k];
                  vtmatrix[g,k]= vtmatrix[g,k]- vt4* vt1* vt3;
                  do j=1 to g;
                     l= g* (g- 1)/ 2+ j;
                     vt5= vt1* c[j,k];
                     vcov[l]= vcov[l]+ vt3* vt4* vt5;
                  end;
               end;
               end;
            end; /*if (nd2^= 0)*/

         end; /*if (nd1^= 0 | nd2^= 0)*/

      *update the risk sets and the index of the next failure time;

      do ii= yloc[1] to yloc[ncol(yloc)];
         nrisk[ig[ii]]= nrisk[ig[ii]] - 1;
      end;
      cif0left= cif0;
      cifgleft= cifg;
      skmgleft= skmg;



   end;  /* end do i=*/

   pos= 0;
   do g= 1 to ng1;
      do j= 1 to g;
         pos= pos+ 1;
         do k= 1 to ng;
            vcov[pos]= vcov[pos]+ c[g,k]* c[j,k]* vtvec[k];
            vcov[pos]= vcov[pos]+ c[g,k]* vtmatrix[j,k];
            vcov[pos]= vcov[pos]+ c[j,k]* vtmatrix[g,k];
         end;
      end;
   end;

finish test_ksample;





   * subroutines end and the calculation starts here;
   * status need to be numerical value;

   x= time|| status;

   *call sort(x, {1 2});
   call sortndx(sidx, x, {1 2});
   x=x[sidx,];



   group=group[sidx];
   strat=strat[sidx];
   ugg= unique(group);
   ng= ncol(ugg);
   call symput(&#39;ng&#39;,left(char(ng)));

   * censind= 0 if censored, =1 if failed;

   censList={&amp;censored}`;
   eventList={&amp;event}`;
   censind=j(nrow(x),1,0);

   eventind=censind;
   do i= 1 to &amp;ncens;
     censind= censind |(x[,2]= censList[i]);
   end;
   do i= 1 to &amp;ne;
     eventind= eventind |(x[,2]= eventList[i]);
   end;

   causecode= 2* (^censind)- eventind;


   * prepare the data;
   x= x|| censind|| causecode;
   if ng&gt; 1 then do;
      ng1= ng - 1;
      ng2= ng* ng1/ 2;
      vv= j(ng1,ng1,0); *the final covariance matrix;
      vcov_st= j(ng2,1,0);  vcov= vcov_st; *vcov_st for each stratum, vs add v across strata ;
      score_st= j(ng1,1,0); score= score_st; *s is test statiatics by stratum,ss add s across strata;

   end;

   ust= unique(strat);
   nstrata= ncol(ust);
   call symput(&#39;nstrata&#39;,left(char(nstrata)));

  /* calculate CIF and  variance*/
   if (&amp;nocifflag=0) then do;

          do k= 1 to nstrata;

                  do g= 1 to ng;
                         gind= (group= ugg[g]);
                         *ncg= sum(gind);
                         * subset of data for group g and stratum k;
                         grpstra=(gind= 1) &amp; (strat= ust[k]) &amp; (x[,4]=1);

                         if (sum(grpstra)&gt;0) then do;

                                 xsub= x[loc((gind= 1) &amp; (strat= ust[k])), ];

                                 * aa are failure times for cause 1, n2 is the length of CIF;
                                 aa= xsub[loc(xsub[,4]= 1), 1];
                                 n2 = ncol(unique(aa))+ 2;

                                 run estimate_cif(xsub[,1], xsub[,4]);

                                 time1=0//(unique(aa))`//xsub[nrow(xsub),1];
                                 tmp= time1|| cif|| vcif1|| vcif2;  *time,CI,variance,group;
                                 if (g= 1 &amp; k=1) then do;
                                        cifEST= tmp;
                                        grpLabel=j(n2,1,ugg[g]);
                                        if(nstrata&gt;1) then stratLabel=j(n2,1,ust[k]);

                                        end;
                                 else  do;
                                        cifEST= cifEST//tmp;
                                        grpLabel= grpLabel//j(n2,1,ugg[g]);
                                        if(nstrata&gt;1) then stratLabel=stratLabel//j(n2,1,ust[k]);
                                        end;
                                end; /*(sum(grpstra)&gt;0)*/
                  end;
           end;



      /*create SAS data set for CIF estimate*/
      cifloc=loc(cifEST[,2]&gt;0);
      ncif= nrow(cifEST);
      lowci=j(ncif, 1, 0);
      upci =j(ncif, 1, 0);
      z=probit(1-&amp;alpha/2.0);

      /*confidence intervals:  log-log tranform*/
      lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
      upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));

      if (&amp;SE=1) then do;
         /*Counting process method -- Gray*/
         lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 4]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 4]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         cifEST=cifEST[, (1:2||4)];
         cifEST = cifEST || lowci || upci;
         create &amp;out.plot from cifEST[colname={&quot;&amp;tname&quot; &quot;CIF&quot; &quot;StdErr&quot; &quot;LowerCI&quot; &quot;UpperCI&quot;}];
         end;
      else do;
         /*Delta Method -- Marubini*/
         lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         cifEST=cifEST[,(1:3)];
         cifEST = cifEST|| lowci || upci;
         create &amp;out.plot from cifEST[colname={&quot;&amp;tname&quot; &quot;CIF&quot; &quot;StdErr&quot; &quot;LowerCI&quot; &quot;UpperCI&quot;}];
         end;



      append from cifEST;
      close &amp;out.plot;

      create _outgrpLabel from grpLabel[colname={&quot;&amp;gname&quot;}] ;
                append  from grpLabel;
      close _outgrpLabel;

          if (nstrata&gt;1) then do;
                  create outstratLabel from stratLabel[colname={&quot;&amp;stratname&quot;}] ;
                        append  from stratLabel;
                  close outstratLabel;
                  end;


   end;


   /* start Gray&#39;s K-sample test, and strata is allowed;
   * merge the data;*/


   if ( ng&gt;1 &amp;(^&amp;notestflag)) then do;
      /* recode the group member id from 1 to ng*/
      grpcode=j(nrow(x), 1, 0);
      do g= 1 to ng;
        grpcode[loc(group= ugg[g])]=g;
      end;



      do k= 1 to nstrata;
         * subset of data for stratum k;
         xsub= x[loc(strat= ust[k]), ];
                 grpcodesub=grpcode[loc(strat= ust[k])];
                 if (ncol(unique(grpcodesub))=ng) then do;

                        Run test_ksample(xsub[,1], xsub[,4], grpcodesub, &amp;rho);
                        score_st= score_st+ score;
                        vcov_st= vcov_st+ vcov;
                        end;
                 else
                        call symput(&#39;inconsistentgrpnumflag&#39;,left(char(1)));


      end;


      pos= 0;
      do i= 1 to ng1;
         do j= 1 to i;
            pos= pos+ 1;
            vv[i,j]= vcov_st[pos];
            vv[j,i]= vv[i,j];
         end;
      end;

      * test statistic and p-value;

      test_stat= score_st`* ginv(vv)* score_st;
      df= ng1;
      pval= 1- probchi(test_stat, df);
      Test=  test_stat || df || pval;
      create TestResult from Test[colname={ &quot;test_stat&quot; &quot;df&quot; &quot;pval&quot;}];
      append from Test;
      close TestResult;

      end;

quit; /*Exit Proc IML*/


/*create the output data for the cumulative incidence estimates for the CIF plot */

%if &amp;nocifflag %then %do; %put WARNING: No CIF is computed when both STRATA and GROUP are specified; %goto exit2; %end;
data &amp;out.plot;
   merge _outgrpLabel &amp;out.plot;
   if (0) then set &amp;data(keep=&amp;tname);
run;


%if (&amp;nstrata&gt;1) %then %do;
  data &amp;out.plot;
    label &amp;stratname=&quot;&amp;stratlabel&quot;;
    merge outstratLabel &amp;out.plot;
  run;
%end;

data &amp;out(%if %bquote(&amp;group)= %then drop=&amp;gname;);
   set &amp;out.plot;
   %if (&amp;nstrata&gt;1) %then %do;
      by &amp;stratname &amp;gname;
          %end;
   %else %do;
          by &amp;gname;;
      %end;
   if not last.&amp;gname;


run;

%if( ^&amp;nocifestflag ) %then  %do;
Title &quot;Cumulative Incidence Estimates  with &amp;Confidence% Confidence Limits&quot;;
proc print data=&amp;out NOOBS Label;
   label   LowerCI= &quot;Lower &amp;Confidence% Limits&quot;
           UpperCI=&quot;Upper  &amp;Confidence% Limits&quot;;
run;
%end;

/*plot the CIF curves*/

%if &amp;noplotflag %then %goto exit2;
    %if (%bquote(&amp;title)=) %then
        %if (&amp;plotclflag ) %then
            %let title= Cumulative Incidence Functions with &amp;Confidence% Confidence Intervals;
            %else
                %let title= Cumulative Incidence Functions;;




title &#39;&amp;title&#39;;
title2 &#39;&amp;title2&#39;;


%if (&amp;ng&gt;1 ) %then %let groupopt=group=&amp;gname;
%else %let groupOpt=;

%if (&amp;nstrata=1) %then %do;
        proc sgplot data=&amp;out.plot;
           label CIF=&#39;Cumulative Incidence&#39;;
           *yaxis values=(0 .1 .2 .3 .4 .5 .6 .7 .8 .9 1.0);
           step y=CIF x=&amp;tname / &amp;groupOpt  name=&quot;cif&quot;;
           %if &amp;plotclflag %then
                band x=&amp;tname lower=LowerCI upper=UpperCI / group=&amp;gname fill transparency=.5
                                                     modelname=&#39;cif&#39; legendlabel=&#39;&#39;;;

        run;
        %end;
%else %do;

        proc sgpanel data=&amp;out.plot;
           panelby &amp;stratname;
           label CIF=&#39;Cumulative Incidence&#39;;
           *rowaxis values=(0 .1 .2 .3 .4 .5 .6 .7 .8 .9 1.0);

           step y=CIF x=&amp;tname / &amp;groupOpt  name=&quot;cif&quot;;
           %if &amp;plotclflag %then
               band x=&amp;tname lower=LowerCI upper=UpperCI / group=&amp;gname fill transparency=.5
                                                          modelname=&#39;cif&#39; legendlabel=&#39;&#39;;;

        run;
        %end;



%exit2:
   %if (&amp;inconsistentgrpnumflag) %then %do; %put WARNING: The test is not available because the &amp;group number is not the same across the strata; %goto exit; %end;
   %if ( &amp;ng&gt;1 &amp;(^&amp;notestflag)) %then %do;
       Title &quot;Gray&#39;s Test for Equality of Cumulative Incidence Functions&quot;;
       proc print data=testresult NOOBS Label;
       label test_stat=&quot;Chi-Square&quot;
                 df=&quot;DF&quot;
                 pval= &quot;Pr &gt; Chi-Square&quot;;
           format pval pvalue6.4;
       run;
   %end;

%exit:
Title ;
Title2 ;
proc datasets nolist;
     delete &amp;data.1 _outgrpLabel _c;
run;

options &amp;savenote;

%mend CIF



/*****************************************************************/
 /*          S A S   A U T O C A L L   L I B R A R Y              */
 /*                                                               */
 /*   NAME : CIF                                                  */
 /*   TITLE: Estimate Cumulative Incidence Function and           */
 /*          Compare Cumulative Incidence Functions across Samples*/
 /* PRODUCT: STAT                                                 */
 /*  SYSTEM: ALL                                                  */
 /*    KEYS: survival data, failure probability, competing risks  */
 /*   PROCS:                                                      */
 /*    DATA:                                                      */
 /* SUPPORT: Guixian Lin                UPDATE:  Mar2012          */
 /*     REF: Klein  and Moeschberger   (2003)                     */
 /*          Marubini and Valsecchi    (1995)                     */
 /*          Gray                      (1988)                     */
 /*    MISC: The %CIF macro requires Base SAS and SAS/IML.        */
 /*          SAS/GRAPH is also required in SAS 9.2                */
 /*****************************************************************/


/*------------------------------------------------------------------
The %CIF macro computes the crude cumulative incidence function
estimates for homogeneous (no covariates) survival data whose
endpoints are subjected to competing risks (Klein and
Moeschberger, 2003). Standard errors and pointwise confidence
limits are also computed. The estimated cumulative incidence curve
is plotted as a  step function using ODS graphics. You can also
display the pointwise confidence limits in the plot by specifying
the PLOTCL keyword in the OPTIONS= argument. If you do not want any
plots, you can suppress it by specifying the NOPLOT keyword in the
OPTIONS= argument.

If the data contains multiple samples identified by the GROUP= variable,
the %CIF macro computes a cumulative incidence curve for each group, and
the macro also compares cumulative incidence functions between groups
using the method of Gray (1988).


--------------------------------------
EXAMPLES:

-----Example 1:

Consider the data in Table 10.1 of Marubini and
Valsecchi (1995). The data include two treatment groups (A and B), and
two competing events (1 and 2). The variable status has 3 distinct
values: value 0 indicates a censored time, and values 1 and 2 represent
two competing events.


Here we illustrate how to estimate the cumulative incidence function within
each group with the event of interest(=2), and test whether there is any
difference  between these two cumulative incidence functions.


data a (drop=_i_);
   array type1(10) _temporary_ (1 13 17 30 34 41 78 100 119 169);
   array type2(20) _temporary_ (1 6 8 13 13 15 33 37 44 45
                                63 80 89 89 91 132 144 171 183 240);
   array type3(5)  _temporary_ (34 60 63 149 207);
   do _i_=1 to 10;
      Status=1;
      t=type1{_i_};
      output;
      end;
   do _i_=1 to 20;
      Status=2;
      t=type2{_i_};
      output;
      end;
   do _i_=1 to 5;
      Status=0;
      t=type3{_i_};
      output;
      end;
run;

data b (drop=_i_);
   array type1(10) _temporary_ (7 16 16 20 39 49 56 73 93 113);
   array type2(20) _temporary_ (1 2 4 6 8 9 10 13 17 17
                                17 18 18 27 29 39 50 69 76 110);
   array type3(5)  _temporary_ (34 60 63 78 149);
   do _i_=1 to 10;
      Status=1;
      t=type1{_i_};
      output;
      end;
   do _i_=1 to 20;
      Status=2;
      t=type2{_i_};
      output;
      end;
   do _i_=1 to 5;
      Status=0;
      t=type3{_i_};
      output;
      end;
run;

data ab;
   label t=&quot;Weeks&quot;;
   set a(in=ina) b;
   if ina then group=&#39;A&#39;;
   else        group=&#39;B&#39;;

run;



%CIF(data=ab, out=est, time=t, status=status, group=group, event=2, title=CIF curves, title2=for Status=2);




-----Example 2:
Consider the data on 137 Bone Marrow Transplant Patients in Appendix D of Klein
and Moeschberger (2003). In this data, Patients are grouped into 3 categories:
ALL (38 patients), AML low risk (54 patients), and AML high risk (45). The competing
events are relapse and death in remission.  The variables used in the
example are:
Gender: patient gender (1-Male, 0-Female)
Status: event indicator (0=censored, 1=death in remission, 2=relapse)
   Grp: disease categories (1-ALL, 2-AML low risk, 3-AML high risk)
 Ftime: failure time.

The following DATA step creates the SAS data set BMT. Here we use the data set BMT
to illustrate how to compute the cumulative incidence functions with the event of interest
for different groups, and test whether there is any difference between the CIF across
groups using stratified data by specifying the strata= variables.


proc format;
   value grpLabel 1=&#39;ALL&#39; 2=&#39;AML low risk&#39; 3=&#39;AML high risk&#39;;
run;

data BMT;
        input DIAGNOSIS Ftime Status Gender@@;
        label Ftime=&quot;Days&quot;;
        format Diagnosis grpLabel.;
datalines;
1       2081       0       1       1       1602    0       1
1       1496       0       1       1       1462    0       0
1       1433       0       1       1       1377    0       1
1       1330       0       1       1       996     0       1
1       226        0       0       1       1199    0       1
1       1111       0       1       1       530     0       1
1       1182       0       0       1       1167    0       0
1       418        2       1       1       383     1       1
1       276        2       0       1       104     1       1
1       609        1       1       1       172     2       0
1       487        2       1       1       662     1       1
1       194        2       0       1       230     1       0
1       526        2       1       1       122     2       1
1       129        1       0       1       74      1       1
1       122        1       0       1       86      2       1
1       466        2       1       1       192     1       1
1       109        1       1       1       55      1       0
1       1          2       1       1       107     2       1
1       110        1       0       1       332     2       1
2       2569       0       1       2       2506    0       1
2       2409       0       1       2       2218    0       1
2       1857       0       0       2       1829    0       1
2       1562       0       1       2       1470    0       1
2       1363       0       1       2       1030    0       0
2       860        0       0       2       1258    0       0
2       2246       0       0       2       1870    0       0
2       1799       0       1       2       1709    0       0
2       1674       0       1       2       1568    0       1
2       1527       0       0       2       1324    0       1
2       957        0       1       2       932     0       0
2       847        0       1       2       848     0       1
2       1850       0       0       2       1843    0       0
2       1535       0       0       2       1447    0       0
2       1384       0       0       2       414     2       1
2       2204       2       0       2       1063    2       1
2       481        2       1       2       105     2       1
2       641        2       1       2       390     2       1
2       288        2       1       2       421     1       1
2       79         2       0       2       748     1       1
2       486        1       0       2       48      2       0
2       272        1       0       2       1074    2       1
2       381        1       0       2       10      2       1
2       53         2       0       2       80      2       0
2       35         2       0       2       248     1       1
2       704        2       0       2       211     1       1
2       219        1       1       2       606     1       1
3       2640       0       1       3       2430    0       1
3       2252       0       1       3       2140    0       1
3       2133       0       0       3       1238    0       1
3       1631       0       1       3       2024    0       0
3       1345       0       1       3       1136    0       1
3       845        0       0       3       422     1       0
3       162        2       1       3       84      1       0
3       100        1       1       3       2       2       1
3       47         1       1       3       242     1       1
3       456        1       1       3       268     1       0
3       318        2       0       3       32      1       1
3       467        1       0       3       47      1       1
3       390        1       1       3       183     2       0
3       105        2       1       3       115     1       0
3       164        2       0       3       93      1       0
3       120        1       0       3       80      2       1
3       677        2       1       3       64      1       0
3       168        2       0       3       74      2       0
3       16         2       0       3       157     1       0
3       625        1       0       3       48      1       0
3       273        1       1       3       63      2       1
3       76         1       1       3       113     1       0
3       363        2       1
;
run;

%CIF(data=bmt,time=Ftime, status=Status, group=Diagnosis, event=1, censored=0, strata=Gender, alpha=.05);

----------------------------------------------------------------------
References:
1. Marubini, E. and Valsecchi, M.G. (1995), Analysing survival data from clinical trials
   and observational studies, John Wiley.
2. Gray, R.J. (1988). &quot;A class of K-sample tests for comparing the cumulative incidence of
   a competing risk,&quot; Annals of statistics, 16(3), 1141--1154.
3. Klein, J.P. and Moeschberger, M.L., (2003), Survival analysis: techniques for censored
   and truncated data, Springer Verlag.</code></pre>
</div>
</div>
<div id="subdistribution-hazard-function" class="section level3" number="18.4.5">
<h3><span class="header-section-number">18.4.5</span> Subdistribution hazard function</h3>
<div id="introduction-3" class="section level4" number="18.4.5.1">
<h4><span class="header-section-number">18.4.5.1</span> Introduction</h4>
<p>Hazard function, <span class="math inline">\(h(t)]\)</span> The instantaneous strength of the probability
that the observed individual surviving at this moment dies at <span class="math inline">\(t\)</span>, the
formula is <span class="math display">\[
h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t \leqslant T&lt;t+\Delta t \mid T \geqslant t)}{\Delta t}
\]</span> If there is no competitive risk, the Cox proportional hazard model is
<span class="math display">\[
\log [\lambda(t)]=\log \left[\lambda_{0}(t)\right]+X \beta
\]</span> Among them, <span class="math inline">\(\lambda(t)\)</span> is the net risk rate, and <span class="math inline">\(\lambda_{0}(t)\)</span>
is the baseline risk function, that is, the risk function when the
covariate vector is 0, which can be written as
<span class="math display">\[\lambda(t)=\lambda_{0}(t) \exp (\mathrm{X} \beta)\]</span></p>
<p>If there is a risk of competition, the <strong>condition of “censoring
independence”</strong> is not met at this time, and there are two models:</p>
<ul>
<li><p>Subdistribution hazard function (CIF regression model, Fine-Gray
model)</p>
<ul>
<li>Represents the instantaneous probability intensity of the
occurrence of the <span class="math inline">\(k\)</span> event of the observed individual without
the <span class="math inline">\(k\)</span> event at the time <span class="math inline">\(t\)</span></li>
</ul></li>
<li><p>Cause-specific hazard</p>
<ul>
<li>Represents the instantaneous probability intensity of the
occurrence of the <span class="math inline">\(k\)</span> event of the observed individual without
any event at the time <span class="math inline">\(t\)</span></li>
</ul></li>
</ul>
</div>
<div id="modeling-using-proc-phreg" class="section level4" number="18.4.5.2">
<h4><span class="header-section-number">18.4.5.2</span> Modeling using proc phreg</h4>
<p><span class="math display">\[\lambda_{K}^{S D}(t)=\lim _{\Delta t \rightarrow 0} \frac{P[t \leqslant T&lt;t+\Delta t, D=k \mid T&gt;t \cup(T&lt;t \cap K \neq k)]}{\Delta t}\]</span></p>
<pre><code>*** Mainly concerned about the outcome A corrected CIF, SD model;
proc phreg data＝cohort plots(overlay＝stratum)＝cif；
    model time*y(0)＝cov1~covn /eventcode ＝ 1 rl；
run；

*** Competitive risk event B corrected CIF, SD model;
proc phreg data＝cohort plots(overlay＝stratum)＝cif； 
    model time*y(0)＝cov1~covn /eventcode＝2 rl；
run；</code></pre>
</div>
<div id="finegray_sel" class="section level4" number="18.4.5.3">
<h4><span class="header-section-number">18.4.5.3</span> %FINEGRAY_SEL</h4>
<p>Conduct Backward Selection in Multivariable Competing Risk Analysis by
Fine &amp; Gray Model</p>
<pre><code>%macro FINEGRAY_SEL(dsn=,  event=,  censor=,  event_code=1, var=,  cVar=, inc= 0, alpha=.2,
         type3=T, id=,  clnum=T, ORIENTATION = portrait, report =T, outpath=, filename=, debug=F) ;
     
   %local cnt cnt_ pos pos_ L1 L2 clist_ _cnt_ cvar_cnt i cnt_bef  cvar_ref cnt2 len2 cntw pos2 pos3 bef cnt_bef cvar_ nn;

   /* Capitalize */
    
    %let debug      = %UPCASE(&amp;debug);
    %let type3      = %UPCASE(&amp;type3);
    %let report     = %UPCASE(&amp;report);
    
   /* Macros for final variable lists */
   %global _finalvar _finalcvar;

  /* Save current options */
   PROC OPTSAVE out=_options;   RUN;

  /* Count number of variables in var */
    %let var_cnt = %sysfunc(countw(&amp;var,&#39; &#39;));



  /* It could be longer if there are interaction terms */
   %let length = 64; 


   /* Time Should not be missing value*/
   
   %if &amp;event = %STR()  %then %do;
      %put ERROR: EVENT should be specified.; 
      %goto exit;
   %end;



/*Check CVAR whether in the proper format, such as separate by * if reference level is specified*/
  /* Count number of class variables */

  %if %superq(cvar) = %str( ) %then %let cvar_cnt = 0;
  %if %superq(cvar) ~= %str( ) %then %do;
        
        %let cnt = %qsysfunc(countw(%superq(cvar),&#39;*&#39;));
        %let cnt_= %qsysfunc(countw(%superq(cvar),&#39; &#39;));

        %let pos=%qsysfunc(countc(%superq(cvar), &#39;(&#39; ));
        %let pos_ = %qsysfunc(countc(%superq(cvar), &#39;*&#39; ));

        %if %superq(pos) = 1 %then %do;
        %let L1=%qsysfunc(findc(%superq(cvar),  &#39;(&#39; ));
        %let L2=%qsysfunc(findc(%superq(cvar),  &#39;)&#39; ));
        %let clist_=%qsysfunc(SUBSTR(%superq(cvar), %superq(L1),%eval(%superq(L2) - %superq(L1) +1)));
        %let _cnt_ = %qsysfunc(countw(%superq(clist_),&#39; &#39;));
        %end;

        %if %superq(cnt) = 1 and  %superq(cnt_) = 1 %then %let cvar_cnt = 1;
        %else %if %superq(pos_) &gt; 0 %then %let cvar_cnt = %superq(cnt);
        %else %if %superq(pos_) = 0 and %superq(pos) = 0 %then %let cvar_cnt = %superq(cnt_);
        %else %if (%superq(pos) = 1 and %superq(pos_) = 0) and %superq(cnt_) = %superq(_cnt_) %then  %let cvar_cnt = 1;
        %else %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                   %goto exit; %end;

  %end;

/*Build up categorical variable list without reference level specified*/
  %let cvarlist =; 

  %if &amp;cvar_cnt = 1 and &amp;pos = 1 %then %let cvarlist = %sysfunc(SUBSTR(%superq(cvar), 1,%eval(&amp;L1-1)));
  %else %if &amp;cvar_cnt = 1 and &amp;pos = 0 %then %let cvarlist = %superq(cvar);
  %if &amp;cvar_cnt &gt; 1  and %superq(pos_) = 0 %then  %let cvarlist = %superq(cvar) ; 

  %if &amp;cvar_cnt &gt; 1  and %superq(pos_) &gt; 0 %then %do; 
            
      %do i = 1 %to &amp;cvar_cnt; 

                %let cvar_ref = %SCAN(&amp;cvar, &amp;i, &#39;*&#39;); 

                %let cnt2=%qsysfunc(countc(&amp;cvar_ref, &#39;(&#39; ));
                
                %let len2=%LENGTH(&amp;cvar_ref);
                %let cntw=%qsysfunc(countw(&amp;cvar_ref,&#39; &#39;));

                /*%put cvar_ref = &amp;cvar_ref cnt2= &amp;cnt2  len2=&amp;len2 cntw =&amp;cntw ;*/

                %if %superq(cnt2) = 1 %then %do;

                    %let pos2=%sysfunc(findc(&amp;cvar_ref, &#39;(&#39; ));
                    %let pos3=%sysfunc(findc(&amp;cvar_ref, &#39;)&#39; ));

                    %let bef = %sysfunc(SUBSTR(&amp;cvar_ref, 1,%eval(&amp;pos2-1)));
                    %let cnt_bef = %qsysfunc(countw(&amp;bef,&#39; &#39;));

                    %if %superq(cnt_bef) = 1 and  %superq(pos3) = %superq(len2) %then %let cvar_=&amp;bef;
                    %else %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                                %goto exit;%end;
                    %end;
                    
                %if %superq(cnt2) = 0 and %superq(cntw) = 1 %then %LET cvar_ = &amp;cvar_ref;

                %if %superq(cnt2) &gt; 1 or ( %superq(cntw) &gt; 1 and %superq(cnt2) = 0) %then %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                %goto exit;  %end;   

            %let cvarlist = %superq(cvarlist) %superq(cvar_); 
 %end;
         
 %end;

 /* Make sure that CVAR are either in VAR or FORCEINVAR*/
 %put &amp;var   ;
 %put &amp;cvarlist;

   %do i = 1 %to &amp;cvar_cnt;
        %let _check_ = 1;
     %do j = 1 %to &amp;var_cnt;
         %if %upcase(%SCAN(&amp;var, &amp;j)) = %upcase(%SCAN(&amp;cvarlist, &amp;i)) %then %let _check_ = 0;;
     %end;
   %end;

   %if &amp;_check_ = 1 %then %do; 
   %put ERROR: The varaible appears in CVAR should also be in VAR.; 
   %goto exit;  %end;


  /* Check for variable names that are longer than the default and increase length as needed */
   %DO i = 1 %to &amp;cvar_cnt; 
      %IF %LENGTH(%SCAN(&amp;var, &amp;i,&#39; &#39;)) &gt; &amp;length %then %let length = %LENGTH(%SCAN(&amp;var, &amp;i,&#39; &#39;);
   %END;


   /*Fine&amp;Gray model with backwards elimination */ 

   %let remlist =;

  %do %while (&amp;var_cnt &gt; 0);

    %if &amp;cvar_cnt &gt; 0 %then %let  cvar_ref = %sysfunc(tranwrd(%superq(cvar),*,%str()));
    
   ods select none;
   ODS OUTPUT  NObs = numobs ClassLevelFreq =clfreq ParameterEstimates = MLEC ModelInfo=modelinf ModelANOVA = type3  ;
   proc phreg data=&amp;dsn simple namelen=&amp;length %if &amp;id ~= %STR() %then %do; COVS(AGGREGATE) %end;;
        %if &amp;cvar_cnt &gt; 0 %then %do; 
        class &amp;cvar_ref /order=internal param=glm;%end;
        model &amp;event*&amp;censor(0) = &amp;var / eventcode=&amp;event_code rl;
        %if &amp;id ~= %STR() %then %do;
            id &amp;id;
         %end;
    run;
    ods select all;

    /*Identifiy next candidate to be removed*/

     proc sql noprint; select count(*) into :nn from type3; quit;

     %if &amp;nn = &amp;inc %then %goto exit2;
     %else %do;

    * in Type3 data remove variables that should not be fixed in model;
        Data typ3_n; set type3; if _N_ &gt; &amp;inc;run;
    * for the rest variables, see which one has the largest p value and compare it to alpha; 

     proc sql noprint; 
        select Effect into: var_ separated by &#39; &#39; from typ3_n ;quit; * keep the original order;

     proc sort data=typ3_n; by desending ProbChiSq;run;
     proc sql noprint;
       select ProbChiSq into: rplist separated by &#39; &#39; from typ3_n ;
       select Effect into: rvlist separated by &#39; &#39; from typ3_n ;
     quit;


    %let premove_p = %scan(&amp;rplist,1, &#39; &#39;); 
    %let premove = %scan(&amp;rvlist,1, &#39; &#39;);

    %put &amp;premove_p &amp;premove;

    * if the current largest pvalue is less than alpha, then stop, else update &amp;var and &amp;cvar;
    %if &amp;premove_p &lt; &amp;alpha %then %goto exit2;

    %else %do;
         %let remlist = &amp;remlist &amp;premove;
         /* update &amp;var list and keep the same input order;*/
         %let var = %sysfunc(tranwrd(%upcase(&amp;var),%upcase(&amp;premove),%str())); 

         /* update &amp;cvar;*/
         %if &amp;cvar_cnt &gt;  0 %then %do;* update &amp;cvar;

            %let pos_=%qsysfunc(findc(%superq(cvar), &#39;*&#39; ));
            

            %let newcvar = ;
            %do i = 1 %to &amp;cvar_cnt;
/*              %put pos_ = &amp;pos_ cvar= &amp;cvar;*/
                %if &amp;pos_ &gt; 0 or &amp;cvar_cnt = 1 %then %let scanvar = %SCAN(&amp;cvar, &amp;i, &#39;*&#39;);
                %else %let scanvar = %SCAN(&amp;cvar, &amp;i, &#39; &#39;);

                %let pos = %qsysfunc(findc(%superq(scanvar), &#39;(&#39; ));

                %if &amp;pos &gt; 0 %then %let trimvar=%qsysfunc(SUBSTR(%superq(scanvar), 1,%eval(&amp;pos-1)));
                %else %let trimvar = &amp;scanvar;

/*              %put trimvar = &amp;trimvar scanvar=&amp;scanvar premove=&amp;premove;*/

                %if %upcase(&amp;trimvar) = %upcase(&amp;premove) %then %let newcvar = &amp;newcvar; 
                %else  %let newcvar = &amp;newcvar*&amp;scanvar; 

            %end;
            %let cvar = &amp;newcvar;
         %end;
    %end;

    %let var_cnt = %sysfunc(countw(&amp;var,&#39; &#39;)); * update number of variable in &amp;var; 
    %let cvar_cnt = %sysfunc(countw(&amp;cvar,&#39;*&#39;));  * update number of variable in &amp;cvar; 

%end;/*%do %if (&amp;var_cnt &gt; 0);*/

   /* Save in macro variables */
   %let _finalvar = &amp;var;
   %let _finalcvar = &amp;cvar;

%end; /*end of   %if &amp;nn = &amp;inc %then %goto exit2;  %else %do;*/

%exit2:

/* Produce report of final model */
   %if &amp;report = T %then %do;
      %let forceInVar = .;
      %if &amp;inc &gt;0 %then %do;

        Data typ3_n; set type3; if _N_ &lt;= &amp;inc;run;
        proc sql noprint;
        select Effect into :inforcevar separated by &#39; &#39;
        from Typ3_n;

        PROC CONTENTS DATA = &amp;dsn (keep=&amp;inforcevar) out=cont noprint; RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :inLab separated by &#39;, &#39;
             from cont;
         QUIT;
         %end;
         %else %let inLab = None;


      /* If any variables were removed from the model create a list */
      %if &amp;remlist ~= %STR() %then %do;
         /* Get variable labels for footnote */
         PROC CONTENTS DATA = &amp;dsn (keep=&amp;remlist) out=cont noprint;
         RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :remLab separated by &#39;, &#39;
             from cont;
         QUIT;

           %let foottext = The following variables were forced in the model: &amp;inLab . The following variables were removed from the model: &amp;remLab..;

      %end;
      %else %let foottext = The following variables were forced in the model: &amp;inLab . No variables were removed from the model.;

      %MULTIPLE_PHREG(        
          OUTPATH = &amp;outpath, 
          FNAME = &amp;filename,
          ORIENTATION = &amp;ORIENTATION,
          clnum=&amp;clnum,
          TYPE3 = &amp;type3,
          debug= &amp;debug,
          FOOTNOTE=&quot;** Backward selection with an alpha level of removal of &amp;alpha was used.  &amp;foottext&quot;
        );

  %end;


   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
           delete %if cvar ~= %STR() %then %do; freq  %end; mergedata mlec modelinf numobs type3 typ3_n keptlist Cont
                  result1 result2 result2_ result3 Ori_list Removed _options _cont ;
       quit;
    %end;
   
/* Final variables selected (get rid of double spaces */
   %put Categorical variables selected: &amp;_finalcvar;
   %put All variables selected: &amp;_finalvar;

%exit:
%mend finegray_sel;


proc format;
value DiseaseGroup 1=&#39;ALL&#39; 2=&#39;AML-Low Risk&#39; 3=&#39;AML-High Risk&#39;;
value sex 0= &#39;F&#39; 1=&#39;M&#39;;
run;
data bmt;
  input Group T Status WaitTime @@;
  logWaittime=log(WaitTime);
  label T = &#39; disease-free survival time (days)&#39; ;
datalines;
1 2081 0 98 1 1602 0 1720 1 1496 0 127  1 1462 0 168
1 1433 0 93 1 1377 0 2187 1 1330 0 1006 1 996  0 1319
1 226  0 208 1 1199 0 174  1 1111 0 236  1 530  0  151 
1 1182 0 203 1 1167 0 191 1 418 2 110 1 383 1 824
1 276  2 146 1 104 1 85   1 609 1 187  1 172 2 129
1 487 2 128  1 662 1 84   1 194 2 329 1 230 1 147 
1 526 2 943 1 122 2 2616  1 129 1 937 1 74 1 303
1 122 1 170 1 86 2 239    1 466 2 508 1 192 1 74
1 109 1 393 1 55 1 331    1   1 2 196 1 107 2 178
1 110 1 361 1 332 2 834   2 2569 0 270 2 2506 0 60
2 2409 0 120 2 2218 0 60 2 1857 0 90 2 1829 0 210
2 1562 0 90 2 1470 0 240 2 1363 0 90 2 1030 0 210
2 860 0 180 2 1258 0 180 2 2246 0 105 2 1870 0 225
2 1799 0 120 2 1709 0 90 2 1674 0 60 2 1568 0 90
2 1527 0 450 2 1324 0 75 2 957 0 90 2 932 0 60
2 847 0 75 2 848 0 180 2 1850 0 180 2 1843 0 270
2 1535 0 180 2 1447 0 150 2 1384 0 120 2 414 2 120
2 2204 2 60 2 1063 2 270 2 481 2 90 2 105 2 120
2 641 2 90 2 390 2 120 2 288 2 90 2 421 1 90
2 79 2 90 2 748 1 60 2 486 1 120 2 48 2 150
2 272 1 120 2 1074 2 150 2 381 1 120 2 10 2 240
2 53 2 180 2 80 2 150 2 35 2 150 2 248 1 30
2 704 2 105 2 211 1 90 2 219 1 120 2 606 1 210
3 2640 0 750 3 2430 0 24 3 2252 0 120 3 2140 0 210
3 2133 0 240 3 1238 0 240 3 1631 0 690 3 2024 0 105
3 1345 0 120 3 1136 0 900 3 845 0 210 3 422 1 210
3 162 2 300 3 84 1 105 3 100 1 210 3 2 2 75
3 47 1 90 3 242 1 180 3 456 1 630 3 268 1 180
3 318 2 300 3 32 1 90 3 467 1 120 3 47 1 135
3 390 1 210 3 183 2 120 3 105 2 150 3 115 1 270
3 164 2 285 3 93 1 240 3 120 1 510 3 80 2 780
3 677 2 150 3 64 1 180 3 168 2 150 3 74 2 750
3 16 2 180 3 157 1 180 3 625 1 150 3 48 1 210
3 273 1 240 3 63 2 360 3 76 1 330 3 113 1 240
3 363 2 180
;
run;


data bmt;
  set bmt;
  call streaminit(123);      
  u = rand(&quot;Uniform&quot;);      
  output;
run;

data bmt;
  set bmt;
   if u&gt;=0.7 then sex=1; else if u&lt;0.5 then sex=0;
   if u&gt;=0.4 then race=&#39;white&#39;; else race=&#39;AA&#39;;
   Dftime= t / 365.25;
   
   label sex = &#39;gender&#39;
         group = &#39;patient group&#39;
    ;
 format Group DiseaseGroup. SEX SEX.;
run;

*** %include &quot;C:\Users\gcpdmpc3\Desktop\ZBA\MULTIPLE_PHREG V21.sas&quot;;
*** %let dir = H:\Chao_paper_2019124\Informative_censoring\output;
%include &quot;/home/zehuibai24885190/CIF/MULTIPLE_PHREG V21.sas&quot;;
%let dir = /home/zehuibai24885190/CIF;

Title &quot;Table 3 Multivariate Survival Analysis for Fine and Gray�s Model&quot;;
%finegray_sel (dsn=bmt,  
       event=t,    
       censor=Status,  
       var= race Group  logWaitTime sex  , 
       cVar= Group(desc)*  race *sex,
       event_code=1,
       inc = 1,
       alpha=0.2,
       Type3=t,
       debug=F,
       outpath =  &amp;dir.\ ,
       filename = Multivariable Fine and Gray) ;
Title;</code></pre>
</div>
<div id="multiple_phreg" class="section level4" number="18.4.5.4">
<h4><span class="header-section-number">18.4.5.4</span> %MULTIPLE_PHREG</h4>
<pre><code>/**********************************************************************************************
***********************************************************************************************
Macro Name: MULTIPLE_PHREG
Created Date/Author: Feb. 2012/Yuan Liu
Last Update Date/Person: Oct, 2016/ Yaqi Jia
Current Version: V21
Working Environment: SAS 9.3 English version

Contact: Dr. Yuan Liu yliu31@emory.edu

Purpose:  To produce a summary table from a multivariable survival model, but the macro itself 
does not do statistical modeling automatically.  

Notes: The macro only helps to generate a nice summary table, and cannot be used for 
statistical modeling.  The modeling must be conducted using PROC PHREG before calling this 
macro.  Several tables must be created using ODS OUTPUT when running PROC PHREG (nNObs = numobs 
ParameterEstimates = MLEC ModelInfo=modelinf SliceDiffs = slices_diff(only for interaction model)
Type3 = type3). The option RL must also be used in the model statement and option PARAM= GLM in 
class statement. Variable names must not be more than 20 characters.  This macro can be set up to 
handle models including interaction terms, and in the model fitting step, use SLICE statement to specify 
how the stratified analysis to be conducted and use ods output SliceDiffs = slices_diff.   

Parameters: 

OUTPATH        Path for output table to be stored.
FNAME          File name for output table.
FOOTNOTE       Text of footnote to include in the table (optional).  It should be in quotes.  This 
               footnote will appear below the footnote containing the number of observations.  
               Leave this field blank if not including an additional footnote.
FOOTNOTE2      Text of second footnote to include in the table (optional).  It should be in quotes.  
               This footnote will appear below all other footnotes.  Leave this field blank if not
               including an additional footnote.   
TYPE3          Set to F to suppress type III p-values from being reported in the table (optional).
               The default value is T.
CLNUM          Set to T if you want to see the number of observations for each level of covariates. The default is T.
EFFECT         If not empty, then the model contains a two-way interaction. It is used to specify
               the treatment effect in the interaction.
SLICEBY        Use in combine with EFFECT to specify the stratified variable in the interaction.
SHORTREPORT    Use in combine with EFFECT and SLICEBY when there is an interaction in the model and set
               to T to only report the stratified treatment effect. 
ORIENTATION    orientation of the output Word table. Default is portrait, can be changed to landscape.
DEBUG          Set to T if running in debug mode (optional).  Work datasets will not be deleted in
               debug mode.  This is useful if you are editing the code or want to further 
               manipulate the resulting data sets.  The default value is F.

***********************************************************************************************
For more details, please see the related documentation
**********************************************************************************************/

%macro MULTIPLE_PHREG(OUTPATH=, FNAME =, FOOTNOTE=, FOOTNOTE2=, TYPE3=T, EFFECT=,SLICEBY=,CLNUM=T,STRATA=, shortreport=T,
ORIENTATION = portrait, DEBUG=F);

   %local FOOTNOTE FOOTNOTE2 NUMREAD NUMUSED OUTPATH DSN EVENT VAR CLASSEXIST N CONTRAST
     EVENTVV CLIST TYPE3 FNAME DEBUG;

   /* Upper case */
   %let type3 = %UPCASE(&amp;type3);
   %let debug = %UPCASE(&amp;debug);
   %let strata = %UPCASE(&amp;strata);

   /* Save current options */
   PROC OPTSAVE out=_options;
   RUN;

   /* Get data set name and outcome name */
   PROC SQL noprint;
      select cvalue into :dsn
      from modelinf
      where description = &#39;Data Set&#39;;
      select cvalue into :event
      from modelinf
      where description = &#39;Dependent Variable&#39;;
   QUIT;

   /* Get outcome label */
   data _NULL_; 
      set &amp;dsn (obs=1); 
      call symput(&#39;eventvv&#39;, VLABEL(&amp;event));
   run;

      /* Get variable labels */
   PROC CONTENTS DATA = &amp;dsn out=_cont (rename=(name=parameter)) noprint;
   RUN;


   /* Check to see if class variables were used - s/b classval0 variable */
   data _null_;
      dsid=open(&#39;mlec&#39;);
      check=varnum(dsid,&#39;classval0&#39;);
      /* 0 = does not exist, 1 = exists */
      exist = MIN(check, 1);
      CALL SYMPUT(&#39;classExist&#39;,PUT(exist,1.));
   run;

   /* If class variables were used */
   /* Don&#39;t include interaction terms in categorical list */
   %if &amp;classexist = 1 %then %do;
      /* Create list of class variables */
      PROC SQL noprint;
         select distinct Parameter into :clist separated by &#39; &#39; 
         from mlec
         where MISSING(classval0) = 0 and INDEX(parameter,&#39;*&#39;) = 0 ;
      QUIT;
   %end;
   %else %let clist =;
   
   %put &amp;clist;

   proc sql noprint;
      select NObsRead into :numread  from numobs; 
      select NObsUsed into :numused from numobs; 
   quit;

   %put &amp;numread &amp;numused;

   DATA mlec;
      set mlec;
      /* Save order */
      Num= _N_;
   RUN;

   %IF &amp;CLIST NE %THEN %DO; 
     
       /*Merge mlec and clfreq*/

        /*prepare to be sorted. there is missing value in class variable in clfreq, so need below data step*/
       data clfreq; 
       length parameter $256.;
       retain parameter;
       set clfreq;
       if class ~= &#39; &#39; then parameter=class;
       else class=parameter;
       keep parameter class value freq;
       run;

       proc sort data=clfreq; by parameter value;run;
       proc sort data=mlec;  by parameter classval0;run;

         %if &amp;strata ~= %str() %then %do; /*when the strata statement used in the model, the sample size is generated by strata, reduce it to total samples through strata*/
              ods select none;
              ods output Summary=sums_(rename=(freq_Sum=Freq));
              proc means data=clfreq sum;
              var Freq; by parameter Value;
              run; ods select all; 

              data clfreq; set sums_;run;
         %end;

       data mg;
         length parameter $256. level $256.;
         merge mlec(in=a rename=(classval0=level)) clfreq(in=b rename=(value=level));
         by parameter level;
         if a;
         drop label; /*avoid conflict with label variable in lab data set produced by proc contents below*/
       run;
        
        /*Merge mg with label data set produced by proc contents*/
        ods select none;
        ods output variables=lab;
        proc contents data= &amp;dsn ;run;
        ods select all;
        
        proc sort data=lab;by variable;run;
        proc sort data=mg;  by parameter;run;

        data mglab;
          merge mg (in=a) lab (in=b rename=(variable=parameter) keep=variable label);
          by parameter;
          if a;
        run;
       
       /*Merge type3 and mg*/
       data type3;
           length effect $100;
           set type3; 
           order=_n_; 
           rename ProbChiSq = p_type3 effect=parameter; 
           format ProbChiSq;
           keep effect ProbChiSq order;
      run;

       proc sort data=type3;by parameter;run;
       proc sort data=mglab;by parameter;run;

      data mergedata;
           length parameter $256. level $256. plabel $256. n $120.;
           merge mglab type3;
           by parameter;
           n=put(freq,8.);
           plabel=label;
           if label = &quot;&quot; and plabel = &quot;&quot; then plabel = parameter;
           format ProbChiSq;
           if n=. then n=&quot;&amp;numused&quot;;

           /* If coding was ref then reference parameters will not have been in the original */
         /* parameter estimates file and will have missing num - Make sure they are ordered */
           /* as the last category for a variable */
           if num = . then num = 1000;
      run;

       proc sort data=mergedata;
         by order num;
      run; 

   %END;

   %ELSE %DO;

      /* Check to see if label variable exists (it won&#39;t exist if none of the model vars have */
      /* labels */
      data _null_;
         dsid=open(&#39;mlec&#39;);
         check=varnum(dsid,&#39;label&#39;);
           /* 0 = does not exist, 1 = exists */
           exist = MIN(check, 1);
         CALL SYMPUT(&#39;labexist&#39;,PUT(exist,1.));
      run;

      data mergedata;
         length plabel $256;
         set mlec;
         Level = &quot;&quot;;
         p_type3 = ProbChiSq;

         /* If there are no labels use var names */
         %if &amp;labexist ~= 0 %then %do; 
            if label ~= &#39; &#39; then plabel = label; 
               else plabel = parameter;
         %end;
         %else %do;
            plabel = Parameter;
         %end;

         format p_type3 ProbChiSq;
      run;

   %END;



   /* If reporting contrasts as well */
  %if &amp;effect ~=%str() %then %do;

        /*Extract variable name,label and length*/
       %let cfivar=%sysfunc(countw(&amp;_finalvar,&#39; &#39;));
        %put finalvar=&amp;_finalvar;
        %put number of final var=&amp;cfivar; 
        data frequency;
          set &amp;dsn;
          %do i=4 %to &amp;cfivar;
          if missing(%scan(&amp;_finalvar,&amp;i,&#39; &#39;))=0;
          %end;

          %if &amp;event ~= %STR() %then %do;
            where &amp;event &gt;= 0 and missing(&amp;censor)=0;
          %end;

          %else %do;
            where &amp;stop &gt;= &amp;start and missing (&amp;start)=0 and missing(&amp;stop)=0 and missing(&amp;censor)=0;
          %end;
        run;
        
        ods output list=freq_;
        proc freq data=frequency;
           tables &amp;sliceby*&amp;effect/list;
        run;

        Data freq;
          length slice $256. effect $256.;
          set freq_;
          sliceby=vvalue(&amp;sliceby);
          effect=vvalue(&amp;effect);
          keep sliceby effect frequency;
        run;

      /*extract effect and slicby values from data to prepare for the merge with freq*/ 
        data slices_diff;
          length effect $256. _effect $256. slice $256.;
          set slices_diff;
          effect=vvalue(&amp;effect);
          _effect=vvalue(_&amp;effect);
          sliceby=vvalue(slice);
          rank=_n_;/*save original order*/
        run;
       
      /* get the number of observations used for &amp;effect */
        proc sort data=slices_diff; by effect sliceby ;run;
        proc sort data=freq; by effect sliceby;run;

        data merge_1;
           merge freq (in=a rename=(frequency=obsused1)) slices_diff(in=b);
           by effect;
           if b;
        run;

       /* get the number of observations used for _&amp;effect*/
       proc sort data=slices_diff nodupkey; by _effect sliceby;run;

       data merge_2;
          merge freq (in=a rename=(effect=_effect frequency=obsused2)) slices_diff (in=b);
          by _effect;
          if b;
          keep sliceby _effect obsused2;
       run;

       proc sort data=merge_1;by _effect sliceby;run;
       proc sort data=merge_2;by _effect sliceby;run;
       data merge_12;
         merge merge_1(in=a) merge_2 (in=b);
         by _effect sliceby;
         if a;
       run;


      DATA merge12;
        length plabel $256. level $256. n $120.; 
        set merge_12;
        plabel = tranwrd(sliceby,scan(sliceby,1), &quot;&quot;);
        level=cat(strip(effect),&quot; vs. &quot;,strip(_effect));
        n=cat(strip(obsused1),&quot; vs. &quot;,strip(obsused2));
        HazardRatio = ExpEstimate;
        HRLowerCL = LowerExp;
        HRUpperCL = UpperExp;
        ProbChiSq = Probz;
      Run;
    
       /* put data in original order*/
        proc sort data=merge12;by rank;run;

      /* extract type3 p-value as interaction p-value from type3 data set*/
      
      Data _null_; /* get the label of sliceby variable*/
         set &amp;dsn (obs=1);
         call symput (&#39;slicebylabel&#39;,vlabel(&amp;sliceby));
         call symput (&#39;effectlabel&#39;,vlabel(&amp;effect));
      run;

      Data _type3;
         length plabel $256 level $256.;
         set type3;
         plabel = &quot;Comparisons Stratified by &amp;Slicebylabel :&quot;;
         level=&quot;&amp;effectlabel :&quot;;
         where index(parameter,&#39;*&#39;) ~=0;
         keep parameter plabel level p_type3;
      run;
      
      /* Combine Type3 data set and Hazardratio data set*/
      DATA _contrast;
         set _type3 merge12;
         keep plabel level n HazardRatio HRLowerCL HRUpperCL probchisq p_type3;
      RUN;

      %if &amp;shortreport = T %then %do;

         %let upeffect=%upcase(&amp;effect); /* delete &amp;effect &amp;sliceby and &amp;effect*&amp;sliceby variables in above data set*/
         %let upsliceby=%upcase(&amp;sliceby);

          DATA conlab;
          set mergedata; 
          if upcase(parameter) not in (&quot;&amp;upeffect&quot;  &quot;&amp;upsliceby&quot; &quot;&amp;upeffect*&amp;upsliceby&quot; );
          RUN;

          %let conlab= None;
          proc sql noprint;
            select distinct(plabel) into: conlab separated by &#39;, &#39; from conlab;
          quit;
        
        Data mergedata;
          set _contrast;run; 
       %end;

       %else %do;
          %let upeffect=%upcase(&amp;effect); /* delete &amp;effect &amp;sliceby and &amp;effect*&amp;sliceby variables in above data set*/
          %let upsliceby=%upcase(&amp;sliceby);
          DATA mergedata;
          set mergedata _contrast; 
          if upcase(parameter) not in (&quot;&amp;upeffect&quot;  &quot;&amp;upsliceby&quot; &quot;&amp;upeffect*&amp;upsliceby&quot; );
          RUN;
       %end;

   %end;

   DATA mergedata;
      set mergedata;
      /* HR and 95% CI */
      if HazardRatio ~= . then HR = TRIM(LEFT(PUT(HazardRatio,8.2))) || &quot; (&quot; || 
         TRIM(LEFT(PUT(HRLowerCL,8.2))) || &quot;-&quot; || 
         TRIM(LEFT(PUT(HRUpperCL,8.2))) || &quot;)&quot;;
      else HR = &#39;-&#39;;
      /* Number of observations read and used - save in data set */
      numused = &amp;numused;
      numread = &amp;numread;
   RUN;

   *---- table template -----;  
   ODS PATH WORK.TEMPLAT(UPDATE) SASUSR.TEMPLAT(UPDATE) SASHELP.TMPLMST(READ);

   PROC TEMPLATE;
      DEFINE STYLE STYLES.TABLES;
      NOTES &quot;MY TABLE STYLE&quot;; 
      PARENT=STYLES.MINIMAL;

       STYLE SYSTEMTITLE /FONT_SIZE = 12pt   FONT_FACE = &quot;TIMES NEW ROMAN&quot;;

       STYLE HEADER /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
            CELLPADDING=8
            JUST=C
            VJUST=C
            FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD; 

     STYLE TABLE /
            FRAME=HSIDES            /* outside borders: void, box, above/below, vsides/hsides, lhs/rhs */
           RULES=GROUP              /* internal borders: none, all, cols, rows, groups */
           CELLPADDING=6            /* the space between table cell contents and the cell border */
            CELLSPACING=6           /* the space between table cells, allows background to show */
            JUST=C
            FONT_SIZE = 10pt
           BORDERWIDTH = 0.5pt;  /* the width of the borders and rules */

     STYLE DATAEMPHASIS /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
           FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD;

     STYLE DATA /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot; 
           FONT_SIZE = 10pt;

     STYLE SYSTEMFOOTER /FONT_SIZE = 9pt FONT_FACE = &quot;TIMES NEW ROMAN&quot; JUST=C;
END;

RUN; 



   **** PRINT THE TABLE ************;
   OPTIONS ORIENTATION=&amp;ORIENTATION MISSING = &quot;-&quot; NODATE;
   ODS rtf STYLE=TABLES file= &quot;&amp;OUTPATH.&amp;FNAME &amp;SYSDATE..DOC&quot;; 

   PROC REPORT DATA=mergedata HEADLINE HEADSKIP CENTER STYLE(REPORT)={JUST=CENTER} SPLIT=&#39;~&#39; 
     nowd SPANROWS lS=256; 
      COLUMN plabel  Level %if &amp;clnum=T %then %do;n %end;(&quot;&amp;eventvv&quot; &#39;------------------------------------------&#39;
          (HR  ProbChiSq  %if &amp;type3 = T %then %do; p_type3 %end;)); 
      DEFINE plabel/order order=data &quot;Covariate&quot;  STYLE(COLUMN) = {JUST = L CellWidth=25%}; 
      DEFINE Level/DISPLAY &quot;Level&quot; STYLE(COLUMN) = {JUST =L CellWidth=20%}; 
      %if &amp;clnum=T %then %do;
      DEFINE n/display &quot;N&quot; style(column)={just=C cellwidth=10%};
      %end;
      %if &amp;type3 = T %then %do; 
      DEFINE p_type3/order MISSING &quot;Type3 P-value&quot; STYLE(COLUMN) = {JUST=C CellWidth=8%} 
               FORMAT=PVALUE8.3; 
       %end;
      DEFINE HR/DISPLAY &quot;Hazard Ratio (95% CI)&quot; STYLE(COLUMN) = {JUST = C CellWidth=15%}; 
      DEFINE ProbChiSq/DISPLAY &quot;HR P-value&quot; STYLE(COLUMN) = {JUST = C CellWidth=8%} FORMAT=PVALUE8.3; 

      COMPUTE ProbChiSq; 
         IF . &lt; ProbChiSq &lt;0.05 THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         *if plabel = &quot;Stratified Comparisons by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[COLOR=WHITE]&quot;);
      ENDCOMP; 

       %if &amp;effect ~= %str() %then %do;
       COMPUTE plabel;
          if plabel = &quot;Comparisons Stratified by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;plabel&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;);  
       ENDCOMP;

       COMPUTE level;
          if level = &quot;&amp;effectlabel :&quot; THEN CALL DEFINE(&quot;level&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;);  
       ENDCOMP;
       %end;
       /*COMPUTE HR;
          if plabel = &quot;Stratified Comparisons by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;HR&quot;, &quot;STYLE&quot;, &quot;STYLE=[COLOR=WHITE]&quot;);
       ENDCOMP;*/

       %if &amp;type3 = T %then %do;
         COMPUTE p_type3; 
            IF . &lt; p_type3 &lt;0.05 THEN CALL DEFINE(&quot;p_type3&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         ENDCOMP;   
       %end;

       compute after plabel; line &#39;&#39;;   endcomp;  

       compute after _page_;
         length text1 - text2 $512.;
         text1 = &quot;*  Number of observations in the original data set = %TRIM(&amp;numread). Number of observations used = %TRIM(&amp;numused).&quot;;
         line @0 text1 $512.;

           %if &amp;footnote ~= %STR() %then %do;
              line @0 &amp;footnote;
           %end;
           %if &amp;footnote2 ~= %STR() %then %do;
              line @0 &amp;footnote2;
           %end;
           %if &amp;effect ~=%str() and &amp;shortreport = T %then %do;
            line @0 &quot;*** The estimated stratified treatement effect was controlled by: &amp;conlab&quot;;
           %end;
      ENDCOMP;
 
   RUN;

   ods rtf close;

   /* Reload original options that were in use before running the macro */
   PROC OPTLOAD data=_options;
   RUN;

   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
          delete mergedata _options _cont %if &amp;CLIST ~= %STR() %then %do; clfreq lab mglab freq mg type3 Sums_ %end;
          %if &amp;effect ~= %str() %then %do;freq freq_ frequency slices_diff _contrast _temp merge_1 merge_2 merge_12 merge12 _type3 %end;
          %if &amp;shortreport = T %then %do; conlab %end;;

      quit;    
   %end;

%mend;</code></pre>
</div>
</div>
<div id="cause-specific-hazard-function" class="section level3" number="18.4.6">
<h3><span class="header-section-number">18.4.6</span> Cause-specific hazard function</h3>
<div id="modeling-using-proc-phreg-1" class="section level4" number="18.4.6.1">
<h4><span class="header-section-number">18.4.6.1</span> Modeling using proc phreg</h4>
<p>CS represents the instantaneous probability intensity of the occurrence
of the <span class="math inline">\(k\)</span> event of the observed individual without any event at the
time <span class="math inline">\(t\)</span>. In words, It is a conditional probability that a subject with
covariates <span class="math inline">\(x\)</span> dies in the interval <span class="math inline">\([t, t+d t]\)</span> and the event of
interest is jth cause, given that the subject was alive just before time
t.</p>
<p><span class="math display">\[\lambda_{K}^{C s}(t)=\lim _{\Delta i \rightarrow 0} \frac{P(t \leqslant T&lt;t+\Delta t, D=k \mid T \geqslant t)}{\Delta t}\]</span></p>
<p>The principal estimable quantity in competing risks is the causespecific
hazard function <span class="math inline">\(\lambda_{\mathrm{k}}(\mathrm{t})\)</span>, which can
heuristically be thought of as a probability of failure specifically
resulting from cause <span class="math inline">\(\mathrm{k}\)</span> in a small interval of time, given
that no failure of any kind has occurred thus far. The overall hazard
<span class="math inline">\(\lambda(\mathrm{t})\)</span> for any type of failure at time <span class="math inline">\(\mathrm{t}\)</span> is
the sum of the cause-specific hazards
<span class="math inline">\(\lambda_{\mathrm{k}}(\mathrm{t})\)</span>. The cumulative causespecific hazard
function <span class="math inline">\(\Lambda{\mathrm{k}}(\mathrm{t})\)</span> or cumulative hazard function
<span class="math inline">\(\Lambda(\mathrm{t})\)</span> equals the value of its corresponding hazard
function summed up to time <span class="math inline">\(t\)</span>. Note that the cumulative hazard function
is uniquely related to the familiar survival function (probability of
survival past time <span class="math inline">\(t\)</span> ) via <span class="math inline">\(S(t)=\exp (-\Lambda(t)).\)</span> However,
<span class="math inline">\(\exp \left(-\Lambda_{\mathrm{k}}(\mathrm{t})\right)\)</span> is in general not
interpretable as the survival function for cause <span class="math inline">\(\mathrm{k}\)</span> alone
unless additional assumptions are made that cannot be verified in
competing risks data.</p>
<pre><code>*** competing events censored;
proc phreg data＝cohort zph；
    * class cov1(order=internal ref=&#39;3&#39;);
    model time*Status(0，2)＝cov1~covn /ties＝efron rl；
    assess ph/resample seed＝1234；
run；

*** Effect of competing events;
proc phreg data＝cohort zph； 
    model time*Status(0，1)＝cov1~covn /ties＝efron rl；
    assess ph/resample seed＝1234；
run；</code></pre>
</div>
<div id="cause_specific_sel" class="section level4" number="18.4.6.2">
<h4><span class="header-section-number">18.4.6.2</span> %Cause_Specific_SEL</h4>
<p>To conduct multivariate backward selection Cause-Specific Hazard model
on competing risk survival data. For a particular cause of interest, we
treat all the competing events as censored observations in the analysis.
The risk set at each time includes only those subjects who have not
failed from competing events or are truly censored.</p>
<pre><code>/***************************************************************************************************
****************************************************************************************************;
Macro Name: CauseSpecific_Sel
Created Date/Author/Contact: Jan 2019/  Chao Zhang,  Yuan Liu, and Yaqi Jia
Current Version: V1
Working Environment: SAS 9.4 English version  

Contact Information: chao.zhang2@emory.edu

Purpose:  :  To conduct multivariate backward selection Cause-Specific Hazard model on competing risk
survival data. For a particular cause of interest, we treat all the competing events as censored 
observations in the analysis.  The risk set at each time includes only those subjects who have not 
failed from competing events or are truly censored.    


References:
    1 SAS Institute Inc, 2017 SAS/STAT� 14.3 User�s Guide. Cary, NC: SAS Institute Inc. User�s Guide the Phreg Procedure.
    2 Changbin Guo and Ying So (2018), Cause-Specific Analysis of Competing Risks Using the Phreg Procedure. SAS2159-2018 SAS Institute Inc.
    3 PHREG_SEL V23 created by Dana Nickleach

Parameters: 

DSN            The name of the data set to be analyzed(required).   
 
EVENT          Name of time to event outcome variable (required).                                                             

CENSOR         Name of censoring indicator variable.  Values of 0 indicate censored observations(required).

CENSORED_VALUE The value in CENSOR that were specified the Values of Censored(required). For example, 0 = Censored, 1= Relapse, 2= Death,
               if relapse is the event of interest, type 0 and type 2 were specified censored in Cause-Specified Hazard Model 
               of competing-Risk survival data.

VAR            The list of variables on interest in the initial model that would be eliminated during the backward selection 
               procedure separated by spaces. The order of variables in this list will be preserved in the final report(required).

CVAR           The list of categorical variables that are in VAR(required). If need to change the reference group, you can 
               follow each variable name by (DESC) where needed and separate terms by *.  See code example. 

INC            Number of variables to include in the model. The first n variables in the var parameter will be included 
               in every model(optional).  The default value is 0. 

SLSTAY         The significance level for removing variables from the model (optional).  The default value is 0.2.

ID             Variable to be used in the ID statement in PHREG (optional).  Refer to SAS Help and Documentation for proper use of this 
               option. ID and COVSAGG will be used together in the model to compute the robust sandwich covariance matrix estimate for 
               cluster data. The ID statement identifies the variable that represents the clusters.  If observations have more than 
               one record in the data file, the number of observations reported in the table footer will be the number of records, 
               not unique observations. 

ORIENTATION    Orientation of the output Word table. Default is portrait, can be changed to landscape.

OUTPATH        Path for output table to be stored(required).

FNAME          File name for output table(required).

DEBUG          Set to T if running in debug mode (optional).  Work datasets will not be deleted in
               debug mode.  This is useful if you are editing the code or want to further 
               manipulate the resulting data sets.  The default value is F.

******************************************************************************************************/

Options macrogen symbolgen mlogic mprint mfile;
%macro CauseSpecific_sel(dsn=, event=, censor=, censored_value=, var=,cvar=,inc=0,slstay=.2,id=,covsagg=f, ORIENTATION = portrait,outpath=,filename=,debug=F);
    /* Save current options */
    PROC OPTSAVE out=_options;   RUN;

    /* Upper case T/F */
    %let debug   = %UPCASE(&amp;debug);
    %let var     = %UPCASE(&amp;var);
    %let cvar    = %UPCASE(&amp;cvar);
    %let covsagg = %UPCASE(&amp;covsagg);
    /* Initialize error variable */
    %LET __Macro_Err = 0;

   /* Time Should not be missing value*/
   
    %if &amp;censor = %STR()  %then %do;
       %put ERROR: censor should be specified.; 
       %let __Macro_Err=1;
    %end;
   
     %if %INDEX(&amp;cvar,*) &gt; 0 OR %INDEX(&amp;cvar,(DESC)) &gt; 0 %then %let cvar_cnt = %sysfunc(countw(&amp;cvar,*));
     %else %let cvar_cnt = %sysfunc(countw(&amp;cvar,&#39; &#39;)); 


      %if &amp;__Macro_Err. %then %do;
      data _null_;
         abort 3;
      run;
     %end;

     ODS SELECT NONE;
      ODS OUTPUT   ModelBuildingSummary(nowarn)=removed NObs = numobs
          ParameterEstimates = MLEC ModelInfo=modelinf %if &amp;cvar_cnt ~=0 %then %do; ModelANOVA = type3 ClassLevelFreq=clfreq %end;;

          proc phreg data=&amp;dsn   %if &amp;covsagg=T %then %do; COVS(AGGREGATE) %end;simple;
           
             class %if %sysevalf(%superq(CVAR)~=,boolean) %then %do; 
               %sysfunc(TRANSLATE(&amp;cvar,&#39; &#39;,&#39;*&#39;)) %end;/order=internal param=glm ;

               model &amp;event*&amp;censor(&amp;censored_value) = &amp;var/rl selection=backward include=&amp;inc /*stop=%EVAL(&amp;var_cnt-1)*/
               slstay=&amp;slstay hierarchy=single;
        

         %if &amp;id ~= %STR() %then %do;
            id &amp;id;
         %end;

      run;
      ODS SELECT ALL;


       /* Save order */
       DATA MLEC2;
          set MLEC;
          order = _n_;
       RUN;
       
       /* Check to see if data set containing a removed variable exists */
      /* If no variables were removed then the data set will not be created and the selection */
      /* process is done */
      %let continue = %sysfunc(exist(removed));

      %if &amp;continue = 1 %then %do;
         /* Get name of variable removed */
         /* Need SCAN because variable label is included after variable name in the same column */
         PROC SQL noprint;
            select UPCASE(SCAN(EffectRemoved,1,&#39; &#39;))
            into :remove
            from removed;
         quit;

         %let remlist =  &amp;remove;

       /* If any variables were removed from the model create a list */
      %if &amp;remlist ~= %STR() %then %do;
         /* Get variable labels for footnote */
         PROC CONTENTS DATA = &amp;dsn (keep=&amp;remlist) out=cont noprint;
         RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :remLab separated by &#39;, &#39;
             from cont;
         QUIT;

           %let foottext = The following variables were removed from the model: &amp;remLab..;

      %end;
      %else %let foottext = No variables were removed from the model.;
      %end;


/* Get dataset name and outcome name and use them in the output*/
   PROC SQL noprint;
      select cvalue into :event
      from modelinf
      where description = &#39;Dependent Variable&#39;;
   QUIT;

   /* Get outcome label */
   data _NULL_; 
      set &amp;dsn (obs=1); 
      call symput(&#39;eventvv&#39;, VLABEL(&amp;event));
   run;

      ** get number for continuous vars **;
      proc sql noprint;
        select NObsRead into :numread from numobs; 
        select NObsUsed into :numused from numobs; 
      quit;

    %if &amp;cvar_cnt ~=0 %then %do;
      **merge type3 and mlec datasets **;
      data type3;
         set type3;
        rename ProbChiSq = type3_p ;
        
      run;

       proc sql;
         create table MergeData AS 
         select A.* , B.effect, B.type3_p  
         from MLEC2 A, type3 B
         where MLEC2.Parameter = type3.effect;
       QUIT;
      

     **add frequency to mergedata **;
        %let continue2 = %sysfunc(exist(Clfreq));

        %if &amp;continue2 = 1 %then %do;

         data Clfreq(rename=(value=level));
            length parameter $100;
            set Clfreq;
            retain;
            if class ~=&quot;&quot; then parameter = upcase(class);
            else if class =&quot;&quot; then do;
            retain class;
            end;
            drop class control_var;
            format freq 8.0 ;
         run; 

       data mergedata;
          length parameter $100;
          set mergedata;
          parameter  = UPCASE(parameter);
          rename ClassVal0 = level;
       run;

       proc sql;
         create table mergedata_ as
            select A.*, B.FREQ
            from mergedata A LEFT JOIN Clfreq B
              on A.parameter = B.parameter AND A.level =B.level;
               
        QUIT;


    proc sort data=mergedata_; by effect order; run;
    data mergedata_ ;
      set mergedata_;
      if first.effect  then p_type3 = type3_p ;
      by effect order;
    run;
 
     data mergedata_ ;
        set  mergedata_ ;
        N = freq;
        if freq =. then N = &amp;numused;
      run;

    proc sort data=mergedata_; by order; run;

   %end;
 %end;
  %else %do;
        data mergedata_;
          set mlec2;
          rename Parameter = effect;
         run;
  %end;
 
DATA mergedata_;
      set MergeData_;
      /* HR and 95% CI */
      if HazardRatio ~= . then HR = TRIM(LEFT(PUT(HazardRatio,8.2))) || &quot; (&quot; || 
         TRIM(LEFT(PUT(HRLowerCL,8.2))) || &quot;-&quot; || 
         TRIM(LEFT(PUT(HRUpperCL,8.2))) || &quot;)&quot;;
      else HR = &#39;-&#39;;
      /* Number of observations read and used - save in data set */
      numused = &amp;numused;
      numread = &amp;numread;
      parameter = upcase(parameter);
RUN;

    **catch type of interest **;
    
   proc freq data=&amp;DSN;
     table status/out = freqCount;
   run;

   data freqCount;
     set freqCount;
     where &amp;censor ~ in (&amp;censored_value);
   run;

    Proc sql noprint;
         select &amp;censor  into:interest
         from freqCount;
    quit;
  %PUT interest: &amp;interest;

     /* part 3 create the word format table  */;

*---- table template -----;  
   ODS PATH WORK.TEMPLAT(UPDATE) SASUSR.TEMPLAT(UPDATE) SASHELP.TMPLMST(READ);

   PROC TEMPLATE;
      DEFINE STYLE STYLES.TABLES;
      NOTES &quot;MY TABLE STYLE&quot;; 
      PARENT=STYLES.MINIMAL;

       STYLE SYSTEMTITLE /FONT_SIZE = 12pt   FONT_FACE = &quot;TIMES NEW ROMAN&quot;;

       STYLE HEADER /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
            CELLPADDING=8
            JUST=C
            VJUST=C
            FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD; 

     STYLE TABLE /
            FRAME=HSIDES           
           RULES=GROUP              
           CELLPADDING=6            
            CELLSPACING=6           
            JUST=C
            FONT_SIZE = 10pt
           BORDERWIDTH = 0.5pt;  

     STYLE DATAEMPHASIS /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
           FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD;

     STYLE DATA /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot; 
           FONT_SIZE = 10pt;

     STYLE SYSTEMFOOTER /FONT_SIZE = 9pt FONT_FACE = &quot;TIMES NEW ROMAN&quot; JUST=C;
END;

RUN; 



   **** PRINT THE TABLE ************;
   OPTIONS ORIENTATION=&amp;ORIENTATION MISSING = &quot;-&quot; NODATE;
   ODS rtf STYLE=TABLES file= &quot;&amp;OUTPATH.&amp;FILENAME &amp;SYSDATE..DOC&quot;; 

   PROC REPORT DATA=mergedata_ HEADLINE HEADSKIP CENTER STYLE(REPORT)={JUST=CENTER} SPLIT=&#39;~&#39; 
     nowd SPANROWS lS=256; 
      COLUMN effect %if &amp;cvar_cnt ~=0 %then %do;  Level N %end;(&quot;&amp;eventvv&quot; &#39;------------------------------------------&#39;
          (HR  ProbChiSq  %if &amp;cvar_cnt ~=0 %then %do; p_type3 %end;)); 
      DEFINE effect/order order=data &quot;Covariate&quot;  STYLE(COLUMN) = {JUST = C CellWidth=25%}; 
      %if &amp;cvar_cnt ~=0 %then %do;
      DEFINE Level/DISPLAY &quot;Level&quot; STYLE(COLUMN) = {JUST =L CellWidth=20%}; 
      DEFINE N/DISPLAY &quot;N&quot; STYLE(COLUMN) = {JUST =C CellWidth=8%}FORMAT=8.0; 
      %end;
       %if &amp;cvar_cnt ~=0 %then %do;
         DEFINE p_type3/display   MISSING &quot;Global P-value&quot; STYLE(COLUMN) = {JUST=C CellWidth=8%} 
               FORMAT=PVALUE8.3; 
       %end;
      DEFINE HR/DISPLAY &quot;Hazard Ratio&quot; STYLE(COLUMN) = {JUST = C CellWidth=15%}; 
      DEFINE ProbChiSq/DISPLAY &quot;HR P-value&quot; STYLE(COLUMN) = {JUST = C CellWidth=8%} FORMAT=PVALUE8.3; 

      COMPUTE ProbChiSq; 
         IF . &lt; ProbChiSq &lt;=0.05 THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
       
      ENDCOMP; 


       %if &amp;cvar_cnt ~=0 %then %do;
         COMPUTE p_type3; 
            IF . &lt; p_type3 &lt;0.05 THEN CALL DEFINE(&quot;p_type3&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         ENDCOMP;   
       %end;

       compute after effect; line &#39;&#39;;   endcomp;  

       compute after _page_;
         length text1 - text3 $200.;
         text1 = &quot;*Number of observations in the original data set = %TRIM(&amp;numread). Number of observations used = %TRIM(&amp;numused).&quot;;
         line @0 text1 $200.;
          
         text2 = &quot;*Backward selection with an alpha level of removal of &amp;slstay was used.  &amp;foottext&quot; ;
         
          line @0 text2 $200.;

         text3 = &quot;*Cause-Specific Hazard Model:  Type of Censored= &amp;censored_value;  Type of Interest= %TRIM(&amp;interest).&quot; ;
         
         line @0 text3 $200.;
       ENDCOMP;
 
     RUN;
   ods rtf close;


   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
           delete %if cvar ~= %STR() %then %do; CLfreq  %end; mergedata mlec modelinf numobs type3 REMOVED Cont Freqcount Mergedata_ Mlec2  ;
       quit;
    %end;
   
%mend CauseSpecific_sel;


data bmt;
  input Group T Status WaitTime @@;
  logWaittime=log(WaitTime);
 datalines;
1 2081 0 98 1 1602 0 1720 1 1496 0 127  1 1462 0 168
1 1433 0 93 1 1377 0 2187 1 1330 0 1006 1 996  0 1319
1 226  0 208 1 1199 0 174  1 1111 0 236  1 530  0  151 
1 1182 0 203 1 1167 0 191 1 418 2 110 1 383 1 824
1 276  2 146 1 104 1 85   1 609 1 187  1 172 2 129
1 487 2 128  1 662 1 84   1 194 2 329 1 230 1 147 
1 526 2 943 1 122 2 2616  1 129 1 937 1 74 1 303
1 122 1 170 1 86 2 239    1 466 2 508 1 192 1 74
1 109 1 393 1 55 1 331    1   1 2 196 1 107 2 178
1 110 1 361 1 332 2 834   2 2569 0 270 2 2506 0 60
2 2409 0 120 2 2218 0 60 2 1857 0 90 2 1829 0 210
2 1562 0 90 2 1470 0 240 2 1363 0 90 2 1030 0 210
2 860 0 180 2 1258 0 180 2 2246 0 105 2 1870 0 225
2 1799 0 120 2 1709 0 90 2 1674 0 60 2 1568 0 90
2 1527 0 450 2 1324 0 75 2 957 0 90 2 932 0 60
2 847 0 75 2 848 0 180 2 1850 0 180 2 1843 0 270
2 1535 0 180 2 1447 0 150 2 1384 0 120 2 414 2 120
2 2204 2 60 2 1063 2 270 2 481 2 90 2 105 2 120
2 641 2 90 2 390 2 120 2 288 2 90 2 421 1 90
2 79 2 90 2 748 1 60 2 486 1 120 2 48 2 150
2 272 1 120 2 1074 2 150 2 381 1 120 2 10 2 240
2 53 2 180 2 80 2 150 2 35 2 150 2 248 1 30
2 704 2 105 2 211 1 90 2 219 1 120 2 606 1 210
3 2640 0 750 3 2430 0 24 3 2252 0 120 3 2140 0 210
3 2133 0 240 3 1238 0 240 3 1631 0 690 3 2024 0 105
3 1345 0 120 3 1136 0 900 3 845 0 210 3 422 1 210
3 162 2 300 3 84 1 105 3 100 1 210 3 2 2 75
3 47 1 90 3 242 1 180 3 456 1 630 3 268 1 180
3 318 2 300 3 32 1 90 3 467 1 120 3 47 1 135
3 390 1 210 3 183 2 120 3 105 2 150 3 115 1 270
3 164 2 285 3 93 1 240 3 120 1 510 3 80 2 780
3 677 2 150 3 64 1 180 3 168 2 150 3 74 2 750
3 16 2 180 3 157 1 180 3 625 1 150 3 48 1 210
3 273 1 240 3 63 2 360 3 76 1 330 3 113 1 240
3 363 2 180
;
run;

*** %let dir = H:\Chao_paper_2019124\Informative_censoring\output;
%let dir = /home/zehuibai24885190/CIF;

proc format;
value DiseaseGroup 1=&#39;ALL&#39; 2=&#39;AML-Low Risk&#39; 3=&#39;AML-High Risk&#39;;
value sex 0= &#39;F&#39; 1=&#39;M&#39;;
run;

data bmt;
  set bmt;
  call streaminit(123);      
  u = rand(&quot;Uniform&quot;);      
  output;
run;

data bmt;
  set bmt;
   if u&gt;=0.7 then sex=1; else if u&lt;0.5 then sex=0;
   if u&gt;=0.4 then race=&#39;white&#39;; else race=&#39;AA&#39;;
        
   label sex = &#39;gender&#39;
         group = &#39;patient group&#39;
         label T = &#39; disease-free survival time (days)&#39; ;
    ;
 format Group DiseaseGroup. SEX SEX.;
run;


title &#39;Table 1 Multivariate Cause-Specific Hazard Regression for Relapse&#39; ;
%CauseSpecific_sel(dsn=bmt, 
                 event=t, censor=status, 
                 censored_value=0 2, 
                 var=Group logWaitTime sex,
                 cvar=Group(desc)* sex,
                 inc=0,
                 slstay=.3,
                 ORIENTATION = portrait, 
                 outpath= &amp;dir.\,
                 filename=aaa,
                 debug=t);
title &#39;&#39;;

title &#39;Table 2 Multivariate Cause-Specific Hazard Regression for Death&#39; ;
%CauseSpecific_sel(dsn=bmt, 
                 event=t, censor=status, 
                 censored_value=0 1, 
                 var=Group logWaitTime sex,
                 cvar=Group  sex,
                 inc=0,
                 slstay=.3,
                 ORIENTATION = portrait, 
                 outpath= &amp;dir.\,
                 filename=bbb,
                 debug=t);
title &#39;&#39;;</code></pre>
</div>
</div>
</div>
<div id="clustered-events" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> Clustered Events</h2>
<div id="introduction-4" class="section level3" number="18.5.1">
<h3><span class="header-section-number">18.5.1</span> Introduction</h3>
<p><a href="https://support.sas.com/resources/papers/proceedings09/237-2009.pdf">Source</a></p>
<p>we are interested in the analysis of multivariate failure time data.
Such data arise when each study subject can potentially experience
several events (for instance, multiple infections after surgery) or when
there exists some natural or artificial clustering of subjects (for
instance, a litter of mice) that induces dependence among the failure
times of the same cluster.</p>
<ul>
<li>Data in the former situation are referred to as multiple events
data, which include recurrent events data as a special case;</li>
<li>Data in the latter situation are referred to as clustered data.</li>
</ul>
<p>Two methods to analyzing survival data with clustered events are
presented.</p>
<ol style="list-style-type: decimal">
<li>The first method is a proportional hazards model which adopts a
marginal approach with a working independence assumption. This model
can be fitted by SAS PROC PHREG with the robust sandwich estimate
option. In the marginal model, WLW (Wei, Lin, and Weissfeld,
hereafter WLW) adopts a pseudolikelihood approach with a working
independence assumption. They estimated the covariate effect
assuming independence among correlated failure times, while
adjusting for the correlation by sandwich estimate in estimating the
covariance matrix.</li>
<li>The second method is a likelihood-based random effects (frailty)
model. In the second model, the baseline hazard could be either a
priori determined (e.g., Weibull) or approximated by piecewise
constant counterpart. The estimation could be carried out by
adaptive Gaussian quadrature method which is implemented in SAS PROC
NLMIXED. Frailty model is a random effects proportional hazards
model. The random effects could be used to capture the relation of
the correlated observations in the clustered or recurrent events
data.</li>
</ol>
</div>
<div id="proportional-hazards-model-which-adopts-a-marginal" class="section level3" number="18.5.2">
<h3><span class="header-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</h3>
<p>Calculate robust sandwich covariance estimates in the PROC PHREG call.
The PHREG process uses ODS graphics to create graphics as part of its
output. For example, the ASSESS statement uses a graphics method that
uses ODS Graphics to check the model suitability of the model. PROC
PHREG (version 9.2) also provides many important enhancements. The most
notable features are the CLASS statement used to specify categorical
variables; the CONTRAST statement used to estimate and test linear
contrast; the BAYES statement used to perform Bayesian analysis; and the
HAZARDRATIO statement used to estimate custom hazard ratios.</p>
<p>The option COVS(AGGREGATE) is specified in the PROC statement to obtain
the robust sandwich estimate of the covariance matrix, and the score
residuals used in computing the middle part of the sandwich estimate are
aggregated over identical ID values. Then, the model is defined
including Treat covariate, JR covariate, and interaction term between
Treat and JR. The TEST statements can be included in the PROC PHREG code
to test various linear hypotheses of the regression parameters based on
the robust sandwich covariance matrix estimate. This method is most
appropriate when the main purpose is to estimate the marginal
(population) covariate effects.</p>
<p>The marginal Cox model for the <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event and the
<span class="math inline">\(\hat{t}^{\text {th }}\)</span> cluster is given by <span class="math display">\[
\lambda_{j}\left(t ; Z_{i j}\right)=\lambda_{0 j} e^{\beta_{j}^{\prime} Z_{i j}(t)}, j=1, \ldots, J ; i=1, \ldots, n
\]</span> and the <span class="math inline">\(j^{\text {th }}\)</span> event-specific partial likelihood is <span class="math display">\[
\mathrm{L}_{\mathrm{j}}(\beta)=\prod_{\mathrm{i}=1}^{\mathrm{n}}\left[\frac{\exp \left\{\beta^{\prime} Z_{i j}\left(X_{i j}\right)\right\}}{\sum_{l \in R_{j}\left(X_{i j}\right)} \exp \left\{\beta^{\prime} Z_{i l}\left(X_{i j}\right)\right\}}\right]^{\Delta_{\mathrm{i}}}
\]</span></p>
<ul>
<li>Where <span class="math inline">\(\lambda_{0 j}(t)\)</span> is an arbitrary baseline hazard function
for the <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event</li>
<li><span class="math inline">\(\beta_{j}\)</span> is the (event-specific) column vector of regression
coefficients for <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event.</li>
<li>WLW estimates <span class="math inline">\(\beta_{1}, \ldots, \beta_{J}\)</span> by the maximum partial
likelihood estimates <span class="math inline">\(\hat{\beta} 1, \ldots, \hat{\beta} J\)</span>,
respectively, and uses a robust sandwich covariance matrix estimate
for
<span class="math inline">\(\left(\hat{\beta} 1^{\prime}, \ldots, \hat{\beta} J^{\prime}\right)^{\prime}\)</span>
to account for the dependence of the multiple failure times.</li>
</ul>
<!-- -->
<pre><code>proc phreg data=diabetes covs(aggregate);
 model Time*Status(0)=Treat JR Interaction;
 Interaction= Treat * JR;
 id ID;
run;</code></pre>
</div>
<div id="frailty-model" class="section level3" number="18.5.3">
<h3><span class="header-section-number">18.5.3</span> Frailty model</h3>
<p><strong>Analysis of clustered data with known distribution using proc
nlmixed</strong></p>
</div>
</div>
<div id="non-proportional-hazards-in-survival-analysis" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> Non-proportional hazards in Survival Analysis</h2>
<p>The log-rank test is most powerful under proportional hazards (PH). In practice, non-PH patterns are often observed in clinical trials, such as in immuno-oncology; therefore, alternative methods are needed to restore the efficiency of statistical testing. Three categories of testing methods were evaluated, including weighted log-rank tests, Kaplan-Meier curve-based tests (including weighted Kaplan-Meier and Restricted Mean Survival Time, RMST), and combination tests (including Breslow test, Lee’s combo test, and MaxCombo test). Nine scenarios representing the PH and various non-PH patterns were simulated. The power, type-I error, and effect estimates of each method were compared. In general, all tests control type I error well. There is not a single most powerful test across all scenarios. In the absence of prior knowledge regarding the PH or non-PH patterns, the Maximum combination test is relatively robust across patterns.</p>
<p>Since the treatment effect changes over time under non-PH, the overall profile of the treatment effect may not be represented comprehensively based on a single measure. Thus, multiple measures of the treatment effect should be pre-specified as sensitivity analyses to evaluate the totality of the data.</p>
<!-- 对数秩检验在比例风险 (PH) 下最为强大。在实践中，在临床试验中经常观察到非 PH 模式，例如在免疫肿瘤学中；因此，需要替代方法来恢复统计检验的效率。评估了三类测试方法，包括加权对数秩检验、基于 Kaplan-Meier 曲线的检验（包括加权 Kaplan-Meier 和受限平均生存时间，RMST）和组合检验（包括 Breslow 检验、Lee 的组合检验和MaxCombo 测试）。模拟了代表 PH 和各种非 PH 模式的九个场景。比较了每种方法的功效、I 类误差和效果估计值。一般来说，所有测试都能很好地控制 I 型错误。没有一个适用于所有场景的最强大的测试。在缺乏有关 PH 或非 PH 模式的先验知识的情况下，最大组合测试在模式之间相对稳健。 -->
<!-- 由于在非 PH 条件下处理效果随时间变化，因此可能无法基于单一测量来全面表示处理效果的整体情况。因此，治疗效果的多种测量应预先指定为敏感性分析，以评估数据的整体性。 -->
<ul>
<li>Maximum Combination Test</li>
<li>Survival Analysis using Relative Time</li>
<li>Interaction effects in Survival Analysis
Test for Interaction Effect in 2x2 Design
Log-Rank test with Stratification
Constructing a prediction model in Survival Analysis
How to correctly/ effectively build a prediction model using Survival Endpoints</li>
</ul>
<p><img src="02_Plots/NPH_Survival_Model.PNG" width="100%" style="display: block; margin: auto;" /></p>
<div id="weighted-piecewise-log-rank-test" class="section level3" number="18.6.1">
<h3><span class="header-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</h3>
<ul>
<li>Piecewise Weighted Log-Rank Test proposed a model where NPH present
<ul>
<li>Piecewise: Different HR per time period</li>
<li>Weighted: Diff. weight per time period</li>
</ul></li>
<li>Simple Delayed Effect Model: <span class="math inline">\(\mathrm{HR}=1\)</span> until time t, then constant HR onwards
APPLE model as per Xu et al (2017)</li>
<li>Need strong assumption “delayoun (t) and baseline hazard (Extension: Rar et al <span class="math inline">\((2019))\)</span>)</li>
</ul>
<p><span class="math display">\[
S_{w}=\frac{\sum_{j \in D_{1}} w_{1}\left\{X_{j}-p\left(t_{j}\right)\right\}+\sum_{j \in D_{2}} w_{2}\left\{X_{j}-p\left(t_{j}\right)\right\}}{\left[\sum_{j \in D_{1}} w_{i}^{2} p\left(t_{j}\right)\left\{p\left(t_{j}\right)\right\}+\sum_{j \in D_{2}} w_{2}^{2} p\left(t_{j}\right)\left\{1-p\left(t_{j}\right)\right\}\right]^{1 / 2}}
\]</span></p>
</div>
<div id="restricted-mean-survival-time-difference" class="section level3" number="18.6.2">
<h3><span class="header-section-number">18.6.2</span> Restricted Mean Survival Time Difference</h3>
<ul>
<li>RMST is the mean survival time under restricted time horizon, <span class="math inline">\(\mathrm{t}^{*}\)</span>
<ul>
<li>Equivalent to area under the K-M curve</li>
<li>RMST diff = Area between K-M curves @ t*</li>
</ul></li>
<li>RMST difference has two advantages
<ul>
<li>Robust to non-proportional hazards</li>
<li>Intuitive: Mean number of extra additional time units of survival up to <span class="math inline">\(\mathrm{t}^{*}\)</span></li>
</ul></li>
<li>Sample size methods developing quickly with guidance on practical values Royston &amp; Parmar (2013), Uno et. al. (2015),
Eaton 2021)</li>
</ul>
</div>
<div id="maximum-combination-test" class="section level3" number="18.6.3">
<h3><span class="header-section-number">18.6.3</span> Maximum Combination Test</h3>
<p><img src="02_Plots/MaxCombi.PNG" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mixed-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/18-Advanced-Survival-Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
