[["group-adaptive-sequential-design.html", "Chapter 25 Group (Adaptive) Sequential Design 25.1 Classical Designs without futility stopping 25.2 Classical Designs with binding futility stopping 25.3 Alpha Spending Function Approach 25.4 R Implementation using rpact", " Chapter 25 Group (Adaptive) Sequential Design library(&#39;mindr&#39;) ### text -&gt; widget ### input &lt;- c(&quot;# Chapter 1&quot;, &quot;## Section 1.1&quot;, &quot;### Section 1.1.1&quot;, &quot;## Section 1.2&quot;, &quot;# Chapter 2&quot;) ### mm(from = input, type = &quot;text&quot;, root = &quot;mindr&quot;) filename &lt;- rstudioapi::getSourceEditorContext()$path widget &lt;- mm(from = filename, type = &quot;file&quot;, root = &quot;&quot;) widget 25.1 Classical Designs without futility stopping The design of many clinical trials includes some strategy for early stopping if an interim analysis reveals large differences between treatment groups, or shows obvious futility such that there is no chance that continuing to the end would show a clinically meaningful effect. In addition to saving time and resources, such a design feature can reduce study participants exposure to an inferior or useless treatment. However, when repeated significance testing on accumulating data is done, some adjustment of the usual hypothesis testing procedure must be made to maintain an overall significance level. The methods described by Pocock and OBrien &amp; Fleming, among others, are popular implementations of group sequential testing for clinical trials. 25.1.1 Pocock Method The Pocock boundary is a method for determining whether to stop a clinical trial prematurely. The typical clinical trial compares two groups of patients. One group are given a placebo or conventional treatment, while the other group of patients are given the treatment that is being tested. The investigators running the clinical trial will wish to stop the trial early for ethical reasons if the treatment group clearly shows evidence of benefit. In other words, when early results proved so promising it was no longer fair to keep patients on the older drugs for comparison, without giving them the opportunity to change. The Pocock boundary is simple to use in that the p-value threshold is the same at each interim analysis. The disadvantages are that the number of interim analyses must be fixed at the start and it is not possible under this scheme to add analyses after the trial has started. Another disadvantage is that investigators and readers frequently do not understand how the p-values are reported: for example, if there are five interim analyses planned, but the trial is stopped after the third interim analysis because the p-value was 0.01, then the overall p-value for the trial is still reported as &lt;0.05 and not as 0.01. With the Pocock design early rejections are more likely. 25.1.2 OBrien &amp; Fleming Method Pocock (1977) first proposed that the crossing boundary be constant for all equally spaced analyses. OBrien and Fleming \\((1979)\\) suggested that the crossing boundaries for the kth analysis, \\(z_{c}(k)\\), be changed over the total number of analyses \\(\\mathrm{K}\\) such that \\[ z_{c}(k)=z_{O B F} \\sqrt{K / k} \\] The OBrien-Fleming boundaries have been used more frequently because they preserve a nominal significance level at the final analysis that is close to that of a single test procedure. With the OBrien &amp; Fleming design the early rejection bounds are large and early rejections are rather unlikely, at least under \\(\\mathrm{H} _0\\). With the OBrien&amp; Fleming design the last rejection bound is close to the un-adjusted bound \\(Z_{\\alpha / 2}\\). This is not the case for Pococks design. In practice, the OBrien &amp; Fleming design is generally preferred, since early rejection without overwhelming evidence may not be convincing. 25.1.3 Wang &amp; Tsiatis Method Wang &amp; Tsiatis (1987) suggest the rejection boundaries \\[ u_{k}=\\mathrm{c}_{\\mathrm{WT}}(K, \\alpha, \\beta, \\Delta) k^{\\Delta-0.5} \\] For \\(\\Delta=0\\) we obtain the OBrien &amp; Fleming boundaries. For \\(\\Delta=0.5\\) we obtain Pococks boundaries For \\(0&lt;\\Delta&lt;0.5\\) we obtain a compromise between \\(\\mathrm{P}\\) and OBF. 25.1.4 Rejection bounds and Local p-values Rejection bounds Rejection regions with rejection bounds \\(u_{k}, k=1, \\ldots, K\\). \\[ \\begin{array}{c} \\mathcal{R}_{k}^{*}=\\left\\{\\left|Z_{k}^{*}\\right| \\geq u_{k}\\right\\}=\\left(-\\infty,-u_{k}\\right) \\cup\\left(u_{k}, \\infty\\right) \\\\ \\mathcal{A}_{k}^{*}=\\emptyset, \\mathcal{C}_{k}^{*}=\\left(-u_{k}, u_{k}\\right) \\text { for } k&lt;K, \\text { and } \\mathcal{A}_{K}^{*}=\\left(-u_{K}, u_{K}\\right) \\end{array} \\] Design of Pocock (1977): Constant rejection bounds, i.e. \\[u_{1}=\\cdots=u_{K}=c_{\\mathrm{P}}$ with $c P=c P(K, \\alpha)\\] such that \\[\\mathbf{P}_{\\mu_{0}}\\left(\\bigcup_{k=1}^{K}\\left\\{\\left|Z_{k}^{*}\\right| \\geq c_{P}\\right\\}\\right)=\\alpha\\] Design of OBrien &amp; Fleming (1979): Decreasing rejection bounds with \\(u_{k}=c_{\\mathrm{OBF}} / \\sqrt{k}\\) with \\(c \\mathrm{OBF}=c \\mathrm{OBF}(K, \\alpha)\\) \\[\\mathbf{P}_{\\mu_{0}}\\left(\\bigcup_{k=1}^{K}\\left\\{\\left|Z_{k}^{*}\\right| \\geq C_{\\mathrm{OBF}} / \\sqrt{k}\\right\\}\\right)=\\alpha\\] Local p-values \\[ \\begin{array}{c} p_{k}^{*}:=2\\left(1-\\Phi\\left(\\left|Z_{k}^{*}\\right|\\right)\\right), \\quad k=1, \\ldots, K \\\\ \\text { Namely: } \\quad\\left|Z_{k}^{*}\\right| \\geq u_{k} \\quad \\Longleftrightarrow \\quad p_{k}^{*} \\leq \\alpha_{k}:=2\\left(1-\\Phi\\left(u_{k}\\right)\\right) \\end{array} \\] Constant local levels in the Pocock design: \\[\\alpha_{1}=\\cdots=\\alpha_{K}=2\\left(1-\\Phi\\left(C_{\\mathrm{P}}\\right)\\right)\\] Decreasing local levels of the OBrien &amp; Fleming design: \\[\\alpha_{k}=2\\left(1-\\Phi\\left(c_{\\mathrm{OBF}} / \\sqrt{k}\\right)\\right), \\quad k=1, \\ldots, K\\] 25.1.5 Power and Sample size As argued before, the maximum sample size \\(N_{K}\\) required for power \\(1-\\beta\\) is a multiple of the fixed size \\[ \\begin{array}{l} n_{f}=\\left(z_{\\alpha / 2}+z_{\\beta}\\right)^{2} / \\delta_{1}^{2} \\\\ N_{K}=n_{f} \\cdot I(K, \\alpha, \\beta) \\end{array} \\] The inflation factor \\(I(K, \\alpha, \\beta)\\) depends on the type of design, e.g. whether Pocock or OBrien &amp; Fleming. Average Sample Size The required stage-wise sample size is \\[n=N_{K} / K=n_{f} \\cdot I(K, \\alpha, \\beta) / K\\] Consequently, we get for the ASN \\[\\frac{\\operatorname{ASN}(\\mu)}{n_{f}}=\\frac{I(K, \\alpha, \\beta)}{K} \\underbrace{\\left(1+\\sum_{k=2}^{K} \\mathbf{P}_{\\vartheta_{1}}\\left(Z_{1}^{*} \\in \\mathcal{C}_{1}^{*}, \\ldots, Z_{k-1}^{*} \\in \\mathcal{C}_{k-1}^{*}\\right)\\right)}_{\\text {average number of stages }}\\] 25.2 Classical Designs with binding futility stopping 25.2.1 Symmetric designs Pampallona &amp; Tsiatis (1994) suggest to use a GSD with a symmetric interim acceptance region: \\[ \\mathcal{A}_{k}^{*}=\\left[-u_{k k}^{0}, u_{k}^{0}\\right], \\quad \\mathcal{C}_{k}^{*}=\\left(-u_{k}^{1},-u_{k}^{0}\\right) \\cup\\left(u_{k}^{0}, u_{k}^{1}\\right), \\quad k=1, \\ldots, K \\] for specific \\(0&lt;u_{k}^{0}&lt;u_{k}^{1}(k&lt;K)\\) and \\(0&lt;u_{K}^{0}=u_{K}^{1}\\) This means to accept \\(H_{0}\\) at stage k if \\(|Z k| \\leq u k^{0}\\), and to reject \\(H_{0}\\) at stage k if \\(\\left|Z_{k}\\right| \\geq u_{k}^{1}\\) The method can be implemented by using the acceptance bounds \\[ u_{k}^{0}:=\\max (\\underbrace{\\left[\\sqrt{k / K}\\left(c^{0}+c^{1}\\right)-c^{0}\\right] K^{\\Delta-0.5}}_{\\text {the original } u_{k}^{0}}, 0) \\] 25.2.2 One-Sided Designs Without early acceptance we would now choose: \\[ \\begin{array}{c} \\mathcal{C}_{k}^{*}=\\left(-\\infty, u_{k}\\right), \\quad \\mathcal{A}_{k}^{*}=\\emptyset, \\quad k=1, \\ldots, K-1 \\\\ \\mathcal{R}_{k}^{*}=\\left[u_{k}, \\infty\\right), \\quad k=1, \\ldots, K, \\quad \\mathcal{A}_{K}^{*}=\\left(-\\infty, u_{K}\\right) \\end{array} \\] Type I error rate control: \\[ \\mathbf{P}_{\\mu_{0}}\\left(\\bigcup_{k=1}^{K}\\left\\{Z_{k}^{*} \\geq u_{k}\\right\\}\\right)=\\alpha \\] One-sided GSD with early acceptance: DeMets &amp; Ware \\((1980,1982)\\) suggest to use a constant futility boundary \\(u^{L}&lt;u_{k}\\) for all \\(k \\leq K-1\\), With this futility boundary the decision regions become \\[ \\begin{array}{c} \\mathcal{C}_{k}^{*}=\\left(u^{L}, u_{k}\\right), \\quad \\mathcal{A}_{k}^{*}=\\left(-\\infty, u^{L}\\right), \\quad k=1, \\ldots, K-1 \\\\ \\mathcal{R}_{k}^{*}=\\left(u_{k}, \\infty\\right), \\quad k=1, \\ldots, K, \\quad \\mathcal{A}_{K}^{*}=\\left(-\\infty, u_{K}\\right) \\end{array} \\] 25.3 Alpha Spending Function Approach GSD with unequally sized stages Assume that we have planned the GSD with equally spaced stages, but the stage-wise sample sizes \\(n_k\\) are unequal. We can calculate all boundaries (e.g. Pocock or OBrien &amp; Fleming) also with unequal stages. alpha 1/31/260%I.  \\[ \\alpha_{1}^{*}=\\alpha\\left(t_{1}^{*}\\right)-\\alpha(0),\\] \\[\\alpha_{2}^{*}=\\alpha\\left(t_{2}^{*}\\right)-\\alpha\\left(t_{1}^{*}\\right), \\ldots,\\] \\[\\alpha_{n}^{*}=\\alpha(1)-\\alpha\\left(t_{n-1}^{*}\\right)\\] \\(\\alpha_{1}^{*}=\\alpha\\left(t_{1}^{*}\\right), \\sum \\alpha^{*}=\\alpha,\\) It is usually difficult or even impossible to achieve the pre-planned sample sizes perfectly. One reason is that we need to fix a date for the DMC to meet. So solve this issue, Lan &amp; DeMets suggest to fix the maximum sample size \\(\\mathrm{N}\\) and a spending function at level \\(\\alpha^{*}(t), \\quad t \\in[0,1]\\) that is strictly increasing with \\(\\alpha(0)=0\\) and \\(\\alpha(1)=\\alpha\\) In the 1 st interim analysis (IA) calculate \\(t_{1}=n_{1} / \\mathrm{N}\\) and \\(u_{1}, \\mathrm{~s}\\).th. \\(\\mathbf{P}\\left(\\left|Z_{1}^{*}\\right| \\geq u_{1}\\right)=\\alpha^{*}\\left(t_{1}\\right)\\) In the 2nd IA we calculate \\(t_{2}=\\left(n_{1}+n_{2}\\right) / N\\) and \\(u_{2}, \\mathrm{~s}\\).th. \\(\\alpha_{1}^{*}\\left(t_{1}\\right)+\\mathbf{P}\\left(\\left|Z_{1}^{*}\\right|&lt;u_{1},\\left|Z_{2}^{*}\\right| \\geq u_{2}\\right)=\\alpha^{*}\\left(t_{2}\\right)\\) In the \\(k^{\\text {th }}\\) IA calculate \\(t k=(n 1+\\cdots+n k) / N\\) and \\(u_{k}\\) \\[ \\alpha^{*}\\left(t_{k-1}\\right)+\\mathbf{P}\\left(\\left|Z_{1}^{*}\\right|&lt;u_{1}, \\ldots,\\left|Z_{k-1}^{*}\\right|&lt;u_{k-1},\\left|Z_{k}^{*}\\right| \\geq u_{k}\\right)=\\alpha^{*}\\left(t_{k}\\right) \\] This means to use the level \\(\\alpha^{*}\\left(t_{k}\\right)\\) up to stage \\(k\\) Examples for spending functions To mimic Pococks design (Lan &amp; DeMets, 1983): \\(\\alpha_{1}^{*}(t)=\\alpha \\log (1+(e-1) t), \\quad t \\in[0,1]\\) To mimic the OBrien &amp; Fleming design (Lan &amp; DeMets, 1983): \\(\\alpha_{2}^{*}(t)=\\left\\{\\begin{array}{l}4\\left\\{1-\\phi^{-1}\\left[\\Phi(1-\\alpha / 4) / \\sqrt{t_{k}}\\right]\\right\\} \\\\ 4\\left\\{1-\\phi^{-1}\\left[\\Phi(1-\\alpha / 2) / \\sqrt{t_{k}}\\right]\\right\\} &amp; \\begin{array}{l}\\text { one-sided } \\\\ \\text { two-sided }\\end{array}\\end{array}\\right.\\) Spending function family of Kim &amp; DeMets (1987) \\(\\alpha_{3}^{*}(\\rho, t)=\\alpha t^{\\rho}, \\quad t \\in[0,1], \\quad\\) for some \\(\\rho&gt;0\\) 25.4 R Implementation using rpact R Package for Adaptive Clinical Trials Shiny Apps 25.4.1 Basic Functions Design Functions getDesignGroupSequential() getDesignInverseNormal() getDesignFisher() getDesignCharacteristics() Sample Size Calculation Functions getSampleSizeMeans() getSampleSizeRates() getSampleSizeSurvival() Power Calculation Functions getPowerMeans() getPowerRates() getPowerSurvival() Simulation Functions getSimulationMeans() getSimulationRates() getSimulationSurvival() getSimulationMultiArmMeans() getSimulationMultiArmRates() getSimulationMultiArmSurvival() Dataset and Analysis Results Functions getDataset() getAnalysisResults() getStageResults() 25.4.2 getDesignGroupSequential defining efficacy boundaries typeOfDesign = c(&quot;OF&quot;, &quot;P&quot;, &quot;WT&quot;, &quot;HP&quot;, &quot;WToptimum&quot;, &quot;asP&quot;, &quot;asOF&quot;, &quot;asKD&quot;, &quot;asHSD&quot;, &quot;asUser&quot;) library(rpact) ## Standard OBrien &amp; Fleming boundary design &lt;- getDesignGroupSequential(sided = 1, alpha = 0.025, informationRates = c(0.33, 0.67, 1), typeOfDesign = &quot;OF&quot;) ## User-defined -spending functions ## User-defined -spending functions (typeOfDesign = &quot;asUser&quot;) can be obtained via the argument userAlphaSpending which must contain a numeric vector with elements 0&lt;1&lt;&lt;kMax=0&lt;1&lt;&lt;kMax= that define the values of the cumulative alpha-spending function at each interim analysis. ## Example: User-defined alpha-spending function which is very conservative at first interim (spend alpha = 0.001), conservative at second (spend an additional alpha = 0.01, i.e., total cumulative alpha spent is 0.011 up to second interim), and spends the remaining alpha at the final analysis (i.e., cumulative alpha = 0.025) design &lt;- getDesignGroupSequential(sided = 1, alpha = 0.025, informationRates = c(0.33, 0.67, 1), typeOfDesign = &quot;asUser&quot;, userAlphaSpending = c(0.001, 0.01 + 0.001, 0.025)) ## OBrien &amp; Fleming type -spending design &lt;- getDesignGroupSequential(sided = 1, alpha = 0.025, informationRates = c(0.33, 0.67, 1), typeOfDesign = &quot;asOF&quot;) # plot the design with default type 1 (Boundary Plot) plot(design) ### plot.TrialDesign ### 1: creates a &#39;Boundaries&#39; plot ### 3: creates a &#39;Stage Levels&#39; plot ### 4: creates a &#39;Error Spending&#39; plot ### 5: creates a &#39;Power and Early Stopping&#39; plot ### 6: creates an &#39;Average Sample Size and Power / Early Stop&#39; plot ### 7: creates an &#39;Power&#39; plot ### 8: creates an &#39;Early Stopping&#39; plot ### 9: creates an &#39;Average Sample Size&#39; plot ### &quot;all&quot;: creates all available plots and returns it as a grid plot or list # summary() creates a nice presentation of the design: summary(design) ## Sequential analysis with a maximum of 3 looks (group sequential design) ## ## O&#39;Brien &amp; Fleming type alpha spending design, one-sided local ## significance level 2.5%, power 80%, undefined endpoint. ## ## Stage 1 2 3 ## Information rate 33% 67% 100% ## Efficacy boundary (z-value scale) 3.731 2.504 1.994 ## Cumulative alpha spent &lt;0.0001 0.0062 0.0250 ## One-sided local significance level &lt;0.0001 0.0061 0.0231 # display the design characteristics # Stopping probabilities and expected sample size reduction getDesignCharacteristics(design) ## Group sequential design characteristics: ## Number of subjects fixed : 7.849 ## Shift : 7.9510 ## Inflation factor : 1.0130 ## Informations : 2.624, 5.327, 7.951 ## Power : 0.01739, 0.42271, 0.80000 ## Rejection probabilities : 0.01739, 0.40532, 0.37729 ## Futility probabilities : 0, 0 ## Ratio expected vs fixed sample size under H1 : 0.8657 ## Ratio expected vs fixed sample size under a value between H0 and H1 : 0.9827 ## Ratio expected vs fixed sample size under H0 : 1.0109 ### Comparison of multiple designs # O&#39;Brien &amp; Fleming, 3 equally spaced stages d1 &lt;- getDesignGroupSequential(typeOfDesign = &quot;OF&quot;, kMax = 3) # Pocock d2 &lt;- getDesignGroupSequential(typeOfDesign = &quot;P&quot;, kMax = 3) designSet &lt;- getDesignSet(designs = c(d1, d2), variedParameters = &quot;typeOfDesign&quot;) plot(designSet, type = 1) 25.4.3 futilityBounds defining futility boundaries A futility bound of z=0 corresponds to an estimated treatment effect of zero or null, i.e., in this case futility stopping is recommended if the treatment effect estimate at the interim analysis is zero or goes in the wrong direction. utility bounds of z= (which are numerically equivalent to z=6) correspond to no futility stopping at an interim. ## Example: non-binding futility boundary at each interim in case ## estimated treatment effect is null or goes in &quot;the wrong direction&quot; ## See Futility boundary (z-value scale) design &lt;- getDesignGroupSequential(sided = 1, alpha = 0.025, informationRates = c(0.33, 0.67, 1), typeOfDesign = &quot;asOF&quot;, futilityBounds = c(0,0), bindingFutility = FALSE) summary(design) ## Sequential analysis with a maximum of 3 looks (group sequential design) ## ## O&#39;Brien &amp; Fleming type alpha spending design, non-binding futility, one-sided local ## significance level 2.5%, power 80%, undefined endpoint. ## ## Stage 1 2 3 ## Information rate 33% 67% 100% ## Efficacy boundary (z-value scale) 3.731 2.504 1.994 ## Futility boundary (z-value scale) 0 0 ## Cumulative alpha spent &lt;0.0001 0.0062 0.0250 ## One-sided local significance level &lt;0.0001 0.0061 0.0231 "]]
