<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Sample Size Calculation | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Sample Size Calculation | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Sample Size Calculation | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="non-parametric-test.html"/>
<link rel="next" href="anova.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#coord" id="toc-coord"><span class="toc-section-number">4.4.3</span> coord</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.5</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.6</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.7</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#reorder" id="toc-reorder"><span class="toc-section-number">4.5.2</span> Reorder</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.3</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.5</span> Dot + Box Plot</a></li>
<li><a href="ggplot2.html#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.5.6</span> Violin Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#nominal-response" id="toc-nominal-response"><span class="toc-section-number">13.6.2</span> Nominal Response</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.3</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sample-size-calculation" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Sample Size Calculation</h1>
<div id="htmlwidget-95b617633aa7061da5be" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-95b617633aa7061da5be">{"x":{"data":"# \n## Sample Size Calculation\n### Distribution\n#### Quantile Function in SAS\n#### Binomial distribution\n#### Negative binomial distribution\n#### Multinomial distribution\n#### Normal Distribution\n#### Multivariate normal distribution\n#### Poisson distribution\n#### Exponential distribution\n#### Gamma distribution\n#### Weibull Distribution\n#### Chi-Squared Distribution\n#### Beta Distribution\n### Binomial CI \n#### Point Estimates\n#### Binomial CI for Small Samples\n##### Wald CI\n##### Clopper-Pearson or “Exact” CI\n##### Wilson score CI\n##### Adjusted Wald CI\n#### R Packages\n##### Package binom\n##### Package: pwr\n#### Incidence rate CI\n### Test 1-Sample Proportion\n##### 2-Sided Equality based on Wald CI\n##### Non-Inferiority or Superiority\n##### Equivalence\n### Test 2-Sample Proportions\n#### Technical details\n#### Fisher’s Exact Test\n#### Z Test (or Chi-Square Test) (Pooled and Unpooled)\n##### 2-Sided Equality based on Wald CI\n##### Non-Inferiority or Superiority\n##### Equivalence\n#### Conditional Mantel-Haenszel Test \n#### Paired Proportions: McNemar's Z-test\n#### Chi-square test\n### Test Mean(s)\n#### One Sample Mean 2-Sided Equality\n#### 1-Sample Mean Non-Inferiority or Superiority\n#### 1-Sample Mean Equivalence\n#### 2-Sample Means, 2-Sided Equality\n#### 2-Sample Means, 1-Sided\n#### 2-Sample Means Non-Inferiority or Superiority\n#### 2-Sample Means Equivalence\n#### T-Test using `pwr.t.test` or `pwr.t2n.test`\n#### Test k Means\n#### Anova using `pwr.anova.test`\n#### Average Bioequivalence\n### Other Methods\n#### Odds Ratio\n#### Correlation\n#### Correlated Binary Data: Ophthalmologic Studies\n### Multiple test\n#### Definitions of Power \n#### Bonferroni Tests (Individual Power)\n#### Tukey's method (Individual Power)\n#### Dunnett's Two-Sided Tests (Individual Power)\n#### Combined Power %SimPower and %PlotSimPower\n##### **All Pairwise Comparisons**\n##### **logically constrained step-down tests**\n##### **DUNNETT Comparisons with a Control Two-Sided**\n##### **Step-down Dunnett**\n#### Dunnett Set up Close Tests in R\n### Time-To-Event Data\n#### Cox PH, 2-Sided Equality\n#### Log-Rank Tests for Competing Risks\n### Estimation in diagnostic test \n#### Adequate sensitivity/specificity\n#### Testing sensitivity (or specificity) \n#### Likelihood ratio estimation\n#### ROC index of accuracy","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<p>Using the usual method for determination of the appropriate sample size, the following
items should be specified:</p>
<ul>
<li>a primary endpoint</li>
<li>the applied statistical test</li>
<li>the null and alternative hypothesis</li>
<li>the probability of erroneously rejecting the null hypothesis (the type I error)</li>
<li>the probability of erroneously failing to reject the null hypothesis (the type II error)</li>
<li>the expected drop-out rate</li>
<li>the software used for sample size calculation</li>
<li>assumptions made for the sample size calculation as well as their sources</li>
</ul>
<p>In some instances, such as time-to-event analyses, the event rate is of primary interest for evaluating power, and assumptions should be made to extrapolate from the required number of events to the eventual sample size of the trial.</p>
<div id="distribution" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Distribution</h2>
<div id="quantile-function-in-sas" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Quantile Function in SAS</h3>
<table>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Argument</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bernoulli</td>
<td>BERNOULLI</td>
</tr>
<tr class="even">
<td>Beta</td>
<td>BETA</td>
</tr>
<tr class="odd">
<td>Binomial</td>
<td>BINOMIAL</td>
</tr>
<tr class="even">
<td>Cauchy</td>
<td>CAUCHY</td>
</tr>
<tr class="odd">
<td>Chi-Square</td>
<td>CHISQUARE</td>
</tr>
<tr class="even">
<td>Conway-Maxwell-Poisson</td>
<td>CONMAXPOI</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>EXPONENTIAL</td>
</tr>
<tr class="even">
<td>F</td>
<td>F</td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td>GAMMA</td>
</tr>
<tr class="even">
<td>Generalized Poisson</td>
<td>GENPOISSON</td>
</tr>
<tr class="odd">
<td>Geometric</td>
<td>GEOMETRIC</td>
</tr>
<tr class="even">
<td>Hypergeometric</td>
<td>HYPERGEOMETRIC</td>
</tr>
<tr class="odd">
<td>Laplace</td>
<td>LAPLACE</td>
</tr>
<tr class="even">
<td>Logistic</td>
<td>LOGISTIC</td>
</tr>
<tr class="odd">
<td>Lognormal</td>
<td>LOGNORMAL</td>
</tr>
<tr class="even">
<td>Negative binomial</td>
<td>NEGBINOMIAL</td>
</tr>
<tr class="odd">
<td>Normal</td>
<td>NORMAL|GAUSS</td>
</tr>
<tr class="even">
<td>Normal mixture</td>
<td>NORMALMIX</td>
</tr>
<tr class="odd">
<td>Pareto</td>
<td>PARETO</td>
</tr>
<tr class="even">
<td>Poisson</td>
<td>POISSON</td>
</tr>
<tr class="odd">
<td>T</td>
<td>T</td>
</tr>
<tr class="even">
<td>Tweedie</td>
<td>TWEEDIE</td>
</tr>
<tr class="odd">
<td>Uniform</td>
<td>UNIFORM</td>
</tr>
<tr class="even">
<td>Wald (inverse Gaussian)</td>
<td>WALD|IGAUSS</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td>WEIBULL</td>
</tr>
</tbody>
</table>
<pre><code>data new;                                                                                                                       
   a=quantile(&#39;BERN&#39;, .75, .25);   
   b=quantile(&#39;BETA&#39;, 0.1, 3, 4);    
   c=quantile(&#39;BINOM&#39;, .4, .5, 10);   
   d=quantile(&#39;CAUCHY&#39;, .85);    
   e=quantile(&#39;CHISQ&#39;, .6, 11);     
   f=quantile(&#39;CONMAXPOI&#39;, .2, 2.3, .4);   
   g=quantile(&#39;EXPO&#39;, .6);   
   h=quantile(&#39;F&#39;, .8, 2, 3); 
   i=quantile(&#39;GAMMA&#39;, .4, 3);  
   j=quantile(&#39;GENPOISSON&#39;, .9, 1, .7);   
   k=quantile(&#39;HYPER&#39;, .5, 200, 50, 10);  
   l=quantile(&#39;LAPLACE&#39;, .8);  
   m=quantile(&#39;LOGISTIC&#39;, .7);     
   n=quantile(&#39;LOGNORMAL&#39;, .5);  
   o=quantile(&#39;NEGB&#39;, .5, .5, 2);     
   p=quantile(&#39;NORMAL&#39;, .975);    
   q=quantile(&#39;NORMALMIX&#39;, 0.5, 1, 0.2, 1.1, 0.1);   
   r=quantile(&#39;PARETO&#39;, .01, 1);  
   s=quantile(&#39;POISSON&#39;, .9, 1);    
   t=quantile(&#39;T&#39;, .8, 5);   
   u=quantile(&#39;TWEEDIE&#39;, .8, 5);      
   v=quantile(&#39;UNIFORM&#39;, 0.25);       
   w=quantile(&#39;WALD&#39;, .6, 2);                                                                                                  
   x=quantile(&#39;WEIBULL&#39;, .6, 2); 
run;</code></pre>
</div>
<div id="binomial-distribution" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Binomial distribution</h3>
<p>In probability theory and statistics, the binomial distribution with parameters n and p is the discrete probability distribution of the number of successes in a sequence of n independent experiments, each asking a yes–no question, and each with its own Boolean-valued outcome: success (with probability p) or failure (with probability q = 1 − p).</p>
<p><span class="math display">\[
\begin{array}{l}
f(k, n, p)=\operatorname{Pr}(k ; n, p)=\operatorname{Pr}(X=k)=\left(\begin{array}{l}
n \\
k
\end{array}\right) p^{k}(1-p)^{n-k} \\\\
\begin{array}{l}
k=0,1,2, \ldots, n, \text { where } \\\\
\left(\begin{array}{l}
n \\
k
\end{array}\right)=\frac{n !}{k !(n-k) !}
\end{array}
\end{array}
\]</span></p>
<p><strong>Expected value and variance</strong></p>
<p><span class="math display">\[{\displaystyle \operatorname {E} (X)=\operatorname {E} (X_{1}+\dotsb +X_{n})=\operatorname {E} (X_{1})+\dotsb +\operatorname {E} (X_{n})=np.}\]</span>
<span class="math display">\[
{\displaystyle {\begin{aligned}\mu &amp;=\sum _{k=0}^{n}k{\binom {n}{k}}p^{k}(1-p)^{n-k}\\&amp;=np\sum _{k=0}^{n}k{\frac {(n-1)!}{(n-k)!k!}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{k=1}^{n}{\frac {(n-1)!}{(n-k)!(k-1)!}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{k=1}^{n}{\binom {n-1}{k-1}}p^{k-1}(1-p)^{(n-1)-(k-1)}\\&amp;=np\sum _{\ell =0}^{n-1}{\binom {n-1}{\ell }}p^{\ell }(1-p)^{(n-1)-\ell }\quad {\text{mit }}\ell :=k-1\\&amp;=np\sum _{\ell =0}^{m}{\binom {m}{\ell }}p^{\ell }(1-p)^{m-\ell }\qquad {\text{mit }}m:=n-1\\&amp;=np\left(p+\left(1-p\right)\right)^{m}=np1^{m}=np.\end{aligned}}}
\]</span></p>
<p><span class="math display">\[
{\displaystyle \operatorname {Var} (X)=\operatorname {Var} (X_{1}+\dotsb +X_{n})=\operatorname {Var} (X_{1})+\dotsb +\operatorname {Var} (X_{n})=n\operatorname {Var} (X_{1})=np\left(1-p\right)=npq.}
\]</span></p>
<p><span class="math display">\[
\begin{array}{l}
\operatorname{Var}(X)\\=\sum_{k=0}^{n} k^{2} \cdot P(X=k)-(n p)^{2} \\
=\sum_{k=0}^{n} k^{2} \cdot\left(\begin{array}{c}
n \\
k
\end{array}\right) p^{k}(1-p)^{n-k}-n^{2} p^{2} \\
=n^{2} {p}^{2}-n p^{2}+n p-x^{2} p^{2} \\
=n p(1-p)=n p q
\end{array}
\]</span></p>
<pre><code>dbinom(x, size, prob)
pbinom(x, size, prob)
qbinom(p, size, prob)
rbinom(n, size, prob)

x - 是数字的向量
p - 是概率向量
n - 是观察次数
size - 是试验的次数
prob - 是每次试验成功的概率</code></pre>
</div>
<div id="negative-binomial-distribution" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Negative binomial distribution</h3>
<p>满足以下条件的称为负二项分布 <span class="math inline">\(X \sim \mathrm{NB}(r, p)\)</span>
1. 实验包含一系列独立的实验。
2. 每个实验都有成功、失败两种结果。
3. 成功的概率是恒定的。
4. 实验持续到次失败, r可以为任意正数。</p>
<p>Probability mass function
<span class="math display">\[
f(k ; r, p) \equiv \operatorname{Pr}(X=k)=\left(\begin{array}{c}
k+r-1 \\
k
\end{array}\right) p^{r}(1-p)^{k}
\]</span>
The binomial coefficient, and is equal to
<span class="math display">\[
\left(\begin{array}{c}
k+r-1 \\
k
\end{array}\right)=\frac{(k+r-1) !}{(r-1) !(k) !}=\frac{(k+r-1)(k+r-2) \cdots(r)}{(k) !}
\]</span></p>
<ul>
<li><strong>Expectation</strong>: <span class="math inline">\(r /(1-p)-r=r p /(1-p)\)</span>.</li>
<li><strong>Variance</strong>: <span class="math inline">\(r(1-p) / p^{2}\)</span>.</li>
</ul>
</div>
<div id="multinomial-distribution" class="section level3" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Multinomial distribution</h3>
<p><span class="math display">\[
{\displaystyle {\begin{aligned}f(x_{1},\ldots ,x_{k};n,p_{1},\ldots ,p_{k})&amp;{}=\Pr(X_{1}=x_{1}{\text{ and }}\dots {\text{ and }}X_{k}=x_{k})\\&amp;{}={\begin{cases}{\displaystyle {n! \over x_{1}!\cdots x_{k}!}p_{1}^{x_{1}}\times \cdots \times p_{k}^{x_{k}}},\quad &amp;{\text{when }}\sum _{i=1}^{k}x_{i}=n\\\\0&amp;{\text{otherwise,}}\end{cases}}\end{aligned}}}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sample-size-calculation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 其中p, x均为向量，分别代表各试验结果的概率和发生次数</span></span>
<span id="cb3-2"><a href="sample-size-calculation.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## p=c(p1, p2, ..., pk), x=c(x1, x2, ..., xk)</span></span>
<span id="cb3-3"><a href="sample-size-calculation.html#cb3-3" aria-hidden="true" tabindex="-1"></a>multi <span class="ot">&lt;-</span> <span class="cf">function</span>(p, x) {</span>
<span id="cb3-4"><a href="sample-size-calculation.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)                      <span class="do">##试验次数</span></span>
<span id="cb3-5"><a href="sample-size-calculation.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> <span class="fu">prod</span>(p<span class="sc">^</span>x)</span>
<span id="cb3-6"><a href="sample-size-calculation.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">factorial</span>(x))</span>
<span id="cb3-7"><a href="sample-size-calculation.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factorial</span>(n)<span class="sc">*</span>f1<span class="sc">/</span>f2               <span class="do">##返回值</span></span>
<span id="cb3-8"><a href="sample-size-calculation.html#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="sample-size-calculation.html#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="sample-size-calculation.html#cb3-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">71</span>, <span class="dv">35</span>, <span class="dv">72</span>)<span class="sc">/</span><span class="dv">178</span></span>
<span id="cb3-11"><a href="sample-size-calculation.html#cb3-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb3-12"><a href="sample-size-calculation.html#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">multi</span>(p, x)</span></code></pre></div>
<pre><code>## [1] 0.1225009</code></pre>
</div>
<div id="normal-distribution" class="section level3" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Normal Distribution</h3>
<p><span class="math display">\[{\displaystyle f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}}\]</span>
<span class="math display">\[
F(x;\mu,\sigma)
=
\frac{1}{\sigma\sqrt{2\pi}}
\int_{-\infty}^x
\exp
\left( -\frac{(t - \mu)^2}{2\sigma^2}
\ \right)\, dt.
\]</span></p>
<p><strong>Moment generating function</strong></p>
<p>设 <span class="math inline">\(x\)</span> 为随机变量, 若存在正实数 <span class="math inline">\(h\)</span>, 使得对于 <span class="math inline">\((-h, h)\)</span> 中任一实数 <span class="math inline">\(t, \quad E\left(e^{t \Sigma}\right)\)</span> 均存在, 则称 <span class="math inline">\(m_{x}(t)=E\left(e^{t x}\right)\)</span> 为 <span class="math inline">\(x\)</span> 的矩母函数(moment generating function), 通过它可以比较方便的求出随机变量各阶原点矩,若 <span class="math inline">\(x \sim N\left(\mu, \sigma^{2}\right)\)</span>, 即其概率密度函数为 <span class="math inline">\(f(x)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)\)</span>, 它的矩母函数是
<span class="math display">\[M_{y}(t)=e^{t \mu+t^{2} \sigma^{2} / 2}\]</span></p>
<p><strong>Prove</strong></p>
<p><span class="math display">\[\begin{align}
M_{x}(t)&amp;=\int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}+t x\right) d \\
&amp;=\int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{\left[x-\left(\mu+t \sigma^{2}\right)\right]^{2}}{2 \sigma^{2}}+t \mu+\frac{t^{2} \sigma^{2}}{2}\right) d x \\
&amp;=e^{t \mu+t^{2} \sigma^{2} / 2}
\end{align}\]</span>
注意其中 <span class="math inline">\(\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{\left[x-\left(\mu+t \sigma^{2}\right)\right]^{2}}{2 \sigma^{2}}\right)\)</span> 是 <span class="math inline">\(N\left(\mu+t \sigma^{2}, \sigma^{2}\right)\)</span> 的概率密度函数, 它在 <span class="math inline">\((-\infty, \infty)\)</span>上的积分值为 1</p>
<p><span class="math display">\[M_{x}^{(k)}(0)=E\left(x^{k}\right)\]</span></p>
<p><strong>Prove</strong></p>
<p><span class="math display">\[M_{x}^{(k)}(0)=\int_{-\infty}^{\infty} x^{k} f(x) d x=E\left(x^{k}\right)\]</span></p>
</div>
<div id="multivariate-normal-distribution" class="section level3" number="8.1.6">
<h3><span class="header-section-number">8.1.6</span> Multivariate normal distribution</h3>
<p>The multivariate normal distribution of a k-dimensional random vector <span class="math inline">\(\mathbf{X}=\left(X_{1}, \ldots, X_{k}\right)^{\mathrm{T}}\)</span> can be written in the following notation:
<span class="math display">\[
\mathbf{X} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})
\]</span>
or to make it explicitly known that <span class="math inline">\(\mathrm{X}\)</span> is <span class="math inline">\(\mathrm{k}\)</span> -dimensional.
<span class="math display">\[
\mathbf{X} \sim \mathcal{N}_{k}(\boldsymbol{\mu}, \boldsymbol{\Sigma})
\]</span>
with k-dimensional mean vector
<span class="math display">\[
\boldsymbol{\mu}=\mathrm{E}[\mathbf{X}]=\left(\mathrm{E}\left[X_{1}\right], \mathrm{E}\left[X_{2}\right], \ldots, \mathrm{E}\left[X_{k}\right]\right)^{\mathrm{T}}
\]</span>
and {ldisplaystyle k(times k}k <span class="math inline">\(\mathrm{k}\)</span> covariance matrix
<span class="math display">\[
\Sigma_{i, j}:=\mathrm{E}\left[\left(X_{i}-\mu_{i}\right)\left(X_{j}-\mu_{j}\right)\right]=\operatorname{Cov}\left[X_{i}, X_{j}\right]
\]</span></p>
<p><strong>For the Bivariate case</strong></p>
<p><span class="math display">\[{\displaystyle f(x,y)={\frac {1}{2\pi \sigma _{X}\sigma _{Y}{\sqrt {1-\rho ^{2}}}}}\mathrm {e} ^{-{\frac {1}{2(1-\rho ^{2})}}\left[({\frac {x-\mu _{X}}{\sigma _{X}}})^{2}-2\rho ({\frac {x-\mu _{X}}{\sigma _{X}}})({\frac {y-\mu _{Y}}{\sigma _{Y}}})+({\frac {y-\mu _{Y}}{\sigma _{Y}}})^{2}\right]}}\]</span>
<span class="math display">\[{\displaystyle {\boldsymbol {\mu }}={\begin{pmatrix}\mu _{X}\\\mu _{Y}\end{pmatrix}},\quad {\boldsymbol {\Sigma }}={\begin{pmatrix}\sigma _{X}^{2}&amp;\rho \sigma _{X}\sigma _{Y}\\\rho \sigma _{X}\sigma _{Y}&amp;\sigma _{Y}^{2}\end{pmatrix}}.}\]</span></p>
<p>The <strong>conditional expectation</strong> of <span class="math inline">\(X_1\)</span> given <span class="math inline">\(X_2\)</span> is:
<span class="math display">\[\operatorname{E}(X_1 \mid X_2=x_2) = \mu_1 + \rho \frac{\sigma_1}{\sigma_2}(x_2 - \mu_2)\]</span></p>
</div>
<div id="poisson-distribution" class="section level3" number="8.1.7">
<h3><span class="header-section-number">8.1.7</span> Poisson distribution</h3>
<p>The Poisson distribution is popular for modeling the number of times an event occurs in an interval of time or space.</p>
<p><span class="math display">\[\!f(k;\lambda )=\Pr(X=k)={\frac {\lambda ^{k}e^{-\lambda }}{k!}},\]</span>
<span class="math display">\[\lambda =\operatorname {E} (X)=\operatorname {Var} (X).\]</span></p>
</div>
<div id="exponential-distribution" class="section level3" number="8.1.8">
<h3><span class="header-section-number">8.1.8</span> Exponential distribution</h3>
<p>The exponential distribution is the probability distribution of the time interval between events in the Poisson point process, that is, when events occur continuously and independently at a constant average rate. This is a special case of <strong>gamma distribution</strong>. It is a continuous simulation of geometric distribution and has the key feature of no memory.</p>
<!-- 指数分布是在泊松点过程中，即事件以恒定的平均速率连续且独立发生的过程中，事件之间时间间隔的概率分布。 这是**伽玛分布的一种特殊情况**。 它是几何分布的连续模拟，并且具有无记忆的关键特性. 从意义来看：指数分布解决的问题是“要等到一个随机事件发生，需要经历多久时间”，伽玛分布解决的问题是“要等到n个随机事件都发生，需要经历多久时间”。 -->
<p><span class="math display">\[{\displaystyle f(x;\lambda )={\begin{cases}\lambda e^{-\lambda x}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}\]</span></p>
<p>The cumulative distribution function is given by
<span class="math display">\[{\displaystyle F(x;\lambda )={\begin{cases}1-e^{-(\lambda x)}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}{\displaystyle F(x;\lambda )={\begin{cases}1-e^{-(\lambda x)}&amp;x\geq 0,\\0&amp;x&lt;0.\end{cases}}}\]</span></p>
<p><strong>Mean, variance, moments and median</strong></p>
<p>The mean or expected value of an exponentially (distributed random variable <span class="math inline">\(X\)</span> with rate parameter <span class="math inline">\(\lambda\)</span>
is given by
<span class="math display">\[
\mathrm{E}[X]=\frac{1}{\lambda}
\]</span>
The variance of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
\operatorname{Var}[X]=\frac{1}{\lambda^{2}}
\]</span>
The moments of <span class="math inline">\(X\)</span>, for <span class="math inline">\(n \in \mathbb{N}\)</span> are given by
<span class="math display">\[
\mathrm{E}\left[X^{n}\right]=\frac{n !}{\lambda^{n}} \cdot \mathrm{E}\left[X^{n}\right]=\frac{n !}{\lambda^{n}}
\]</span>
The median of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
\mathrm{m}[X]=\frac{\ln (2)}{\lambda}&lt;\mathrm{E}[X]
\]</span>
where In refers to the natural logarithm. Thus the absolute difference between the mean and median
is
<span class="math display">\[
|\mathrm{E}[X]-\mathrm{m}[X]|=\frac{1-\ln (2)}{\lambda}&lt;\frac{1}{\lambda}=\sigma[X]
\]</span>
<strong>Properties of Exponential Distributions</strong></p>
<p>If <span class="math inline">\(X \sim \operatorname{exponential}(\lambda)\)</span>, then the following hold.
1. The cdf of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
F(x)=\left\{\begin{array}{ll}
0 &amp; \text { for } x&lt;0 \\
1-e^{-\lambda x}, &amp; \text { for } x \geq 0
\end{array}\right.
\]</span>
2. For any <span class="math inline">\(0&lt;p&lt;1\)</span>, the <span class="math inline">\((100 p)^{\text {th }}\)</span> percentile is <span class="math inline">\(\pi_{p}=\frac{-\ln (1-p)}{\lambda}\)</span>
3. The mean of <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathrm{E}[X]=\frac{1}{\lambda}\)</span>
4. The variance of <span class="math inline">\(X\)</span> is <span class="math inline">\(\operatorname{Var}(X)=\frac{1}{\lambda^{2}}\)</span>
5. The mgf of <span class="math inline">\(X\)</span> is
<span class="math display">\[
M_{X}(t)=\frac{1}{1-(t / \lambda)}, \quad \text { for } t&lt;\lambda
\]</span>
6. <span class="math inline">\(X\)</span> satisfies the Memoryless Property, i.e., <span class="math inline">\(P(X&gt;t+s \mid X&gt;s)=P(X&gt;t)\)</span>, for any <span class="math inline">\(t, s \geq 0\)</span></p>
</div>
<div id="gamma-distribution" class="section level3" number="8.1.9">
<h3><span class="header-section-number">8.1.9</span> Gamma distribution</h3>
<p>Gamma distribution is the distribution of the sum of multiple independent and identically distributed (iid) of exponential distribution variables.</p>
<p><strong>Probability Density Function</strong></p>
<p>The general formula for the probability density function of the gamma distribution is
<span class="math display">\[
f(x)=\frac{\left(\frac{x-\mu}{\beta}\right)^{\gamma-1} \exp \left(-\frac{x-\mu}{\beta}\right)}{\beta \Gamma(\gamma)} \quad x \geq \mu ; \gamma, \beta&gt;0
\]</span>
where <span class="math inline">\(\gamma\)</span> is the shape parameter, <span class="math inline">\(\mu\)</span> is the location parameter, <span class="math inline">\(\beta\)</span> is the scale parameter, and <span class="math inline">\(\Gamma\)</span> is the gamma function which has the formula
<span class="math display">\[
\Gamma(a)=\int_{0}^{\infty} t^{a-1} e^{-t} d t
\]</span>
The case where <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\beta=1\)</span> is called the standard gamma distribution. The equation for the standard gamma distribution reduces to
<span class="math display">\[
f(x)=\frac{x^{\gamma-1}-x}{\Gamma(\gamma)} \quad x \geq 0 ; \gamma&gt;0
\]</span></p>
<p><strong>Gamma distribution &amp; Exponential distribution</strong></p>
<p>From the meaning:</p>
<ul>
<li>the problem solved by exponential distribution is “how long does it take to wait until a random event occurs”,</li>
<li>the problem solved by gamma distribution is “how long does it take to wait until n random events occur at same time”.</li>
</ul>
<p>From the formula</p>
<ul>
<li>A random variable <span class="math inline">\(X\)</span> has a gamma distribution with parameters <span class="math inline">\(\alpha, \lambda&gt;0\)</span>, write <span class="math inline">\(X \sim \operatorname{gamma}(\alpha, \lambda)\)</span>, if <span class="math inline">\(X\)</span> has pdf given by
<span class="math display">\[
f(x)=\left\{\begin{array}{ll}
\frac{\lambda^{\alpha}}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x}, &amp; \text { for } x \geq 0 \\
0 &amp; \text { otherwise }
\end{array}\right.
\]</span>
where <span class="math inline">\(\Gamma(\alpha)\)</span> is a function (referred to as the gamma function) given by the following integral:
<span class="math display">\[
\Gamma(\alpha)=\int_{0}^{\infty} t^{\alpha-1} e^{-t} d t
\]</span>
When <span class="math inline">\(\alpha\)</span> turns to 1, the gamma distribution becomes the exponential distribution.</li>
<li>A random variable <span class="math inline">\(X\)</span> has an exponential distribution with parameter <span class="math inline">\(\lambda&gt;0\)</span>, write <span class="math inline">\(X \sim\)</span> exponential <span class="math inline">\((\lambda)\)</span>, if <span class="math inline">\(X\)</span> has pdf given by
<span class="math display">\[
f(x)=\left\{\begin{array}{ll}
\lambda e^{-\lambda x}, &amp; \text { for } x \geq 0 \\
0 &amp; \text { otherwise }
\end{array}\right.
\]</span></li>
</ul>
</div>
<div id="weibull-distribution" class="section level3" number="8.1.10">
<h3><span class="header-section-number">8.1.10</span> Weibull Distribution</h3>
<p><strong>Definition</strong></p>
<p>A random variable <span class="math inline">\(X\)</span> has a Weibull distribution with parameters <span class="math inline">\(\alpha, \beta&gt;0\)</span>, write <span class="math inline">\(X \sim\)</span> Weibull <span class="math inline">\((\alpha, \beta)\)</span>, if <span class="math inline">\(X\)</span> has pdf given by
<span class="math display">\[
f(x)=\left\{\begin{array}{ll}
\frac{\alpha}{\beta^{\alpha}} x^{\alpha-1} e^{-(x / \beta)^{\alpha}}, &amp; \text { for } x \geq 0 \\
0 &amp; \text { otherwise }
\end{array}\right.
\]</span>
Where <span class="math inline">\(\alpha\)</span> is scale parameter and <span class="math inline">\(\beta\)</span> is shape parameter.</p>
<p>Weibull distribution is related to many distributions. When <span class="math inline">\(\alpha=1\)</span>, the Weibull distribution is an exponential distribution with <span class="math inline">\(\lambda = 1/\beta\)</span>, so the exponential distribution is a special case of both the Weibull distributions and the gamma distributions.</p>
<p><strong>Properties of Weibull Distributions</strong></p>
<p>If <span class="math inline">\(X \sim\)</span> Weibull <span class="math inline">\((\alpha, \beta)\)</span>, then the following hold.</p>
<ol style="list-style-type: decimal">
<li>The cdf of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
F(x)=\left\{\begin{array}{ll}
0 &amp; \text { for } x&lt;0 \\
1-e^{-(x / \beta)^{\alpha}}, &amp; \text { for } x \geq 0
\end{array}\right.
\]</span></li>
<li>For any <span class="math inline">\(0&lt;p&lt;1\)</span>, the <span class="math inline">\((100 p)^{\text {th }}\)</span> percentile is <span class="math inline">\(\pi_{p}=\beta(-\ln (1-p))^{1 / \alpha}\)</span>.</li>
<li>The mean of <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathrm{E}[X]=\beta \Gamma\left(1+\frac{1}{\alpha}\right)\)</span>.</li>
<li>The variance of <span class="math inline">\(X\)</span> is <span class="math inline">\(\operatorname{Var}(X)=\beta^{2}\left[\Gamma\left(1+\frac{2}{\alpha}\right)-\left[\Gamma\left(1+\frac{1}{\alpha}\right)\right]^{2}\right]\)</span></li>
</ol>
</div>
<div id="chi-squared-distribution" class="section level3" number="8.1.11">
<h3><span class="header-section-number">8.1.11</span> Chi-Squared Distribution</h3>
<p><strong>Definition</strong></p>
<p>A random variable <span class="math inline">\(X\)</span> has a chi-squared distribution with <span class="math inline">\(k\)</span> degrees of freedom, where <span class="math inline">\(k\)</span> is a positive integer, write <span class="math inline">\(X \sim \chi^{2}(k)\)</span>, if <span class="math inline">\(X\)</span> has pdf given by
<span class="math display">\[
f(x)=\left\{\begin{array}{ll}
\frac{1}{\Gamma(k / 2) 2^{k / 2}} x^{k / 2-1} e^{-x / 2}, &amp; \text { for } x \geq 0 \\
0 &amp; \text { otherwise }
\end{array}\right.
\]</span></p>
<p>The chi-squared distributions are a special case of the gamma distributions with <span class="math inline">\(\alpha=\frac{k}{2}, \lambda=\frac{1}{2}\)</span>, which can be used to establish the following properties of the chi-squared distribution.</p>
<p><strong>Properties of Chi-Squared Distributions</strong></p>
<p>If <span class="math inline">\(X \sim \chi^{2}(k)\)</span>, then <span class="math inline">\(X\)</span> has the following properties.</p>
<ol style="list-style-type: decimal">
<li>The mgf of <span class="math inline">\(X\)</span> is given by
<span class="math display">\[
M_{X}(t)=\frac{1}{(1-2 t)^{k / 2}}, \quad \text { for } t&lt;\frac{1}{2}
\]</span></li>
<li>The mean of <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathrm{E}[X]=k_{r}\)</span> i.e., the degrees of freedom.</li>
<li>The variance of <span class="math inline">\(X\)</span> is <span class="math inline">\(\operatorname{Var}(X)=2 k\)</span>, i.e., twice the degrees of freedom.</li>
</ol>
<p>The main applications of the chi-squared distributions relate to their importance in the field of statistics, which result from the following relationships between the chi-squared distributions and the normal distributions.</p>
<p><strong>Relationships of Chi-Squared Distributions (Normal Distributions)</strong></p>
<ol style="list-style-type: decimal">
<li>If <span class="math inline">\(Z\)</span> is a standard normal random variable, i.e., <span class="math inline">\(Z \sim N(0,1)\)</span>, then the distribution of <span class="math inline">\(Z^{2}\)</span> is chi-squared with <span class="math inline">\(k=1\)</span> degree of freedom.</li>
<li>If <span class="math inline">\(X_{1}, \ldots, X_{n}\)</span> is a collection of independent, chi-squared random variables each with 1 degree of freedom, i.e., <span class="math inline">\(X_{i} \sim \chi^{2}(1)\)</span>, for each <span class="math inline">\(i=1, \ldots, n\)</span>, then the sum <span class="math inline">\(X_{1}+\cdots+X_{n}\)</span> is also chi-squared with <span class="math inline">\(k=n\)</span> degrees of freedom.</li>
<li>If <span class="math inline">\(X \sim \chi^{2}\left(k_{1}\right)\)</span> and <span class="math inline">\(Y \sim \chi^{2}\left(k_{2}\right)\)</span> are independent random variables, then <span class="math inline">\(X+Y \sim \chi^{2}\left(k_{1}+k_{2}\right)\)</span>.</li>
</ol>
</div>
<div id="beta-distribution" class="section level3" number="8.1.12">
<h3><span class="header-section-number">8.1.12</span> Beta Distribution</h3>
<p><strong>Definition</strong></p>
<p>A random variable <span class="math inline">\(X\)</span> has a beta distribution with parameters <span class="math inline">\(\alpha, \beta&gt;0\)</span>, write <span class="math inline">\(X \sim \operatorname{beta}(\alpha, \beta)\)</span>, if <span class="math inline">\(X\)</span> has pdf given by
<span class="math display">\[
f(x)=\left\{\begin{array}{ll}
\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha) \Gamma(\beta)} x^{\alpha-1}(1-x)^{\beta-1}, &amp; \text { for } 0 \leq x \leq 1 \\
0 &amp; \text { otherwise }
\end{array}\right.
\]</span>
Note <span class="math inline">\(\Gamma(\alpha)\)</span> is the gamma function.</p>
<p>The parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, are both shape parameters for the beta distribution, varying their values changes the shape of the pdf.</p>
<p><strong>Properties of Chi-Squared Distributions</strong></p>
<p>If <span class="math inline">\(X \sim \operatorname{beta}(\alpha, \beta)\)</span>, then:</p>
<ol style="list-style-type: decimal">
<li>the mean of <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathrm{E}[X]=\frac{\alpha}{\alpha+\beta}\)</span>,</li>
<li>the variance of <span class="math inline">\(X\)</span> is <span class="math inline">\(\operatorname{Var}(X)=\frac{\alpha \beta}{(\alpha+\beta)^{2}(\alpha+\beta+1)}\)</span></li>
</ol>
</div>
</div>
<div id="binomial-ci" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Binomial CI</h2>
<div id="point-estimates" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Point Estimates</h3>
<ol style="list-style-type: decimal">
<li>MLE (Maximum Likelihood Estimate)</li>
<li>LaPlace point estimates</li>
<li>Wilson point estimates</li>
<li>Jeffreys point estimates</li>
</ol>
<p><strong>MLE (Maximum Likelihood Estimate)</strong></p>
<p>MLE是样本比例或成功用户数除以总尝试次数。这是所报告的最常见的点估计。</p>
<p><span class="math display">\[\hat p=x/n\]</span></p>
<p><strong>LaPlace point estimates</strong></p>
<p>一个著名的大样本问题来自拉普拉斯在1800年代初期的开创性工作。他提出了一个问题，即您可以确定明天的太阳会升起，因为您知道过去的5000年（1,825,000天）每天都在升起。您可以确定它会上升，但不能完全确定。太阳可能会爆炸，或者大的小行星可能会将地球粉碎成碎片。为了回答这个问题，他提出了拉普拉斯继承定律，即在分子上加一个，在分母上加两个（（x + 1）/（n + 2））。应用此过程，您将确定99.999945％的明天明天会升起-接近100％，但略微偏离了那个极端。当样本量较小时，调整幅度会更大。</p>
<p><span class="math display">\[\hat p=(x+1)/(n+2)\]</span>
<strong>Wilson point estimates</strong></p>
<p>Wilson’s点估计值是调整后的Wald CI的中点。 它是通过将分子的临界值平方和分子分母的临界值平方相加而得出的。 Wilson’s方法更为保守。</p>
<p><span class="math display">\[\hat p=\frac{x+\frac{1}{2} z^{2}}{n+z^{2}}\]</span></p>
<p><strong>Jeffreys point estimates</strong></p>
<p>Jeffreys（1961）在LaPlace和MLE方法之间进行了折衷。Jeffreys区间是在对二项式比例p使用非信息性Jeffreys之前获得的贝叶斯可信区间。这个问题的Jeffreys先验是带有参数（1/2，1/2）的Beta分布，它是共轭先验。在n次试验中观察到x次成功之后，p的后验分布是带有参数（x + 1/2，n – x + 1/2）的Beta分布。</p>
<p><span class="math display">\[\hat p=(x+0.5)/(n+1)\]</span></p>
</div>
<div id="binomial-ci-for-small-samples" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Binomial CI for Small Samples</h3>
<div id="wald-ci" class="section level4" number="8.2.2.1">
<h4><span class="header-section-number">8.2.2.1</span> Wald CI</h4>
<p>Wald方法是计算二项式置信区间的最常用公式, 不幸的是，当样本量较小时，尤其是当完成率不接近50％时，它产生的间隔太窄。</p>
<p><span class="math display">\[\hat{p} \pm z_{\alpha / 2} \sqrt{\hat{p}(1-\hat{p}) / n}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sample-size-calculation.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span>
<span id="cb5-2"><a href="sample-size-calculation.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests of proportions</span></span>
<span id="cb5-3"><a href="sample-size-calculation.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="fl">0.65</span>, <span class="fl">0.6</span>), <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1033347
##               n = 1604.007
##       sig.level = 0.05
##           power = 0.9
##     alternative = greater
## 
## NOTE: same sample sizes</code></pre>
</div>
<div id="clopper-pearson-or-exact-ci" class="section level4" number="8.2.2.2">
<h4><span class="header-section-number">8.2.2.2</span> Clopper-Pearson or “Exact” CI</h4>
<p>为了改善Wald区间的较差平均覆盖率，更为复杂的方法，称为Clopper-Pearson或“精确”方法. 精确方法使用小样本可提供更可靠的置信区间（Clopper和Pearson，1934）。但是，在实际实践中，
当标称置信度为95％时，“精确”区间会产生过于保守的置信区间，其真实覆盖率接近99％。
当样本量较小（n &lt;15）时，这种过度保守的性质尤其容易受到伤害（Agresti and Coull，1996）</p>
<p><span class="math display">\[\begin{aligned}
\left[1+\frac{n-x+1}{x F_{2 x, 2(n-x+1), 1-\alpha / 2}}\right]^{-1} &amp;
&lt;p&lt;\left[1+\frac{n-x}{(x+1) F_{2(x+1), 2(n-x), \alpha / 2}}\right]^{-1}
\end{aligned}\]</span></p>
</div>
<div id="wilson-score-ci" class="section level4" number="8.2.2.3">
<h4><span class="header-section-number">8.2.2.3</span> Wilson score CI</h4>
<p>精确间隔太宽而Wald间隔太窄。第三种方法称为“得分”间隔（Wilson，1927年）并不过分保守，对于标称95％的间隔，其平均覆盖率接近95％。不幸的是，它的计算与精确方法一样繁琐，并且当完成率接近0或1时，它存在一些严重的覆盖问题（Agresti和Coull，1998）</p>
<p><span class="math display">\[\left(\hat{p}+\frac{z_{\alpha / 2}^{2}}{2 n} \pm z_{\alpha / 2} \sqrt{\left[\hat{p}(1-\hat{p})+z_{\alpha / 2}^{2} / 4 n\right] / n}\right) /\left(1+z_{\alpha / 2}^{2} / n\right)\]</span></p>
</div>
<div id="adjusted-wald-ci" class="section level4" number="8.2.2.4">
<h4><span class="header-section-number">8.2.2.4</span> Adjusted Wald CI</h4>
<p>另一种可供选择的方法，由Agresti and Coull. 命名为Adjusted Wald方法，
仅要求在95％的置信区间内，将观察到的完成率加两个成功和两个失败，然后使用Wald公式计算95％的二项式置信区间。
对于大多数p值，它的覆盖范围与Score方法一样好，并且通常在完成率接近0或1时更好。
该方法非常简单，并且在统计文献中已被推荐, 相加两次成功和两次失败”（或分子加上两个，分母增加四个）是从正态分布的临界值中得出的。</p>
<p><span class="math display">\[\frac{\hat{p}+\frac{z_{1-\alpha / 2}^{2}}{2 n}+z_{1-\alpha / 2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{1-\alpha / 2}^{2}}{4 n^{2}}}}{1+\frac{z_{1-\alpha / 2}^{2}}{n}}  &lt; \hat{p} &lt;\frac{\hat{p}+\frac{z_{\alpha / 2}^{2}}{2 n}+z_{\alpha / 2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{\alpha / 2}^{2}}{4 n^{2}}}}{1+\frac{z_{\alpha / 2}^{2}}{n}}\]</span></p>
</div>
</div>
<div id="r-packages" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> R Packages</h3>
<div id="package-binom" class="section level4" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> Package binom</h4>
<p>Package <a href="https://cran.r-project.org/web/packages/binom/binom.pdf">binom</a> can provide different binomial CI and Test such as</p>
<ul>
<li>exact - Pearson-Klopper method. See also binom.test.</li>
<li>asymptotic - the text-book definition for confidence limits on a single proportion using the Central Limit Theorem.</li>
<li>wilson - Wilson method.</li>
<li>prop.test - equivalent to prop.test(x = x, n = n, conf.level = conf.level)$conf.int.</li>
<li>bayes - see binom.bayes.</li>
<li>logit - see binom.logit.</li>
<li>cloglog - see binom.cloglog.</li>
<li>probit - see binom.probit.</li>
<li>profile - see binom.profile.</li>
</ul>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>binom.bayes</td>
<td>Binomial confidence intervals using Bayesian inference</td>
</tr>
<tr class="even">
<td></td>
<td>二项式分布概率上使用beta优先级，从beta的后验确定两侧置信区间。 二项式实验中使用先于p分布（成功概率）的共轭beta，从β后验构造一个置信区间。根据贝叶斯定理，给定数据x的p的后验分布为：p | x〜Beta（x + prior.shape1，n-x +prior.shape2)默认的priority是Jeffrey′sprior，它是Beta（0.5，0.5）分布 。 因此，后验均值为（x +0.5）/（n + 1）。</td>
</tr>
<tr class="odd">
<td>binom.logit</td>
<td>Binomial confidence intervals using the logit parameterization</td>
</tr>
<tr class="even">
<td>binom.probit</td>
<td>Binomial confidence intervals using the probit parameterization</td>
</tr>
<tr class="odd">
<td>binom.cloglog</td>
<td>在观察到的比例上（cloglog）参数化来构造置信区间 The complementary-log-log link function says that <span class="math display">\[\eta(x) = \log(-\log(1-\pi_x))=\mathbf{x}\beta\]</span></td>
</tr>
<tr class="even">
<td>binom.lrt</td>
<td>Binomial confidence intervals using the lrt likelihood – likelihood ratio test (LRT) 置信区间基于对MLE附近的二项式偏差进行分析。</td>
</tr>
<tr class="odd">
<td>binom.profile</td>
<td>Binomial confidence intervals using the profile likelihood 当使用标准方法难以获得准确的间隔估计值时，例如，当对数似然函数的形状高度非正态或有大量麻烦参数时，通常使用轮廓似然.当似然函数具有多个参数时，只关注其中一部分参数，而将其他参数视为常数，此时似然函数就被称为profile likelihood。</td>
</tr>
<tr class="even">
<td>binom.sim</td>
<td>Simulates confidence intervals for binomial data</td>
</tr>
<tr class="odd">
<td>binom.confint</td>
<td>Binomial confidence intervals</td>
</tr>
<tr class="even">
<td>binom.coverage</td>
<td>Probability coverage for binomial confidence intervals</td>
</tr>
<tr class="odd">
<td>binom.plot</td>
<td>Coverage plots for binomial confidence intervals</td>
</tr>
<tr class="even">
<td>binom.length</td>
<td>Expected length for binomial confidence intervals</td>
</tr>
<tr class="odd">
<td>binom.power</td>
<td>Power curves for binomial parameterizations</td>
</tr>
<tr class="even">
<td>cloglog.sample.size</td>
<td>Power and sample size for a binomial proportion using the cloglog parameterization</td>
</tr>
<tr class="odd">
<td>cloglog.sample.size</td>
<td>Power and sample size for a binomial proportion using the cloglog parameterization</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sample-size-calculation.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Which method to use to construct the interval. Any combination of </span></span>
<span id="cb7-2"><a href="sample-size-calculation.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   c(&quot;exact&quot;, &quot;ac&quot;, &quot;asymptotic&quot;, &quot;wilson&quot;, &quot;prop.test&quot;, &quot;bayes&quot;, </span></span>
<span id="cb7-3"><a href="sample-size-calculation.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    &quot;logit&quot;, &quot;cloglog&quot;, &quot;probit&quot;) </span></span>
<span id="cb7-4"><a href="sample-size-calculation.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   is allowed. Default is &quot;all&quot;.</span></span>
<span id="cb7-5"><a href="sample-size-calculation.html#cb7-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-6"><a href="sample-size-calculation.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;binom&quot;</span>)</span>
<span id="cb7-7"><a href="sample-size-calculation.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.confint</span>(<span class="at">x=</span><span class="dv">26</span>, <span class="at">n=</span><span class="dv">79</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">methods =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<pre><code>##           method  x  n      mean     lower     upper
## 1  agresti-coull 26 79 0.3291139 0.2352474 0.4388288
## 2     asymptotic 26 79 0.3291139 0.2254967 0.4327312
## 3          bayes 26 79 0.3312500 0.2304097 0.4344362
## 4        cloglog 26 79 0.3291139 0.2287076 0.4329294
## 5          exact 26 79 0.3291139 0.2274809 0.4439939
## 6          logit 26 79 0.3291139 0.2347861 0.4395694
## 7         probit 26 79 0.3291139 0.2330656 0.4380425
## 8        profile 26 79 0.3291139 0.2321350 0.4370161
## 9            lrt 26 79 0.3291139 0.2321076 0.4370015
## 10     prop.test 26 79 0.3291139 0.2299875 0.4450313
## 11        wilson 26 79 0.3291139 0.2355420 0.4385342</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sample-size-calculation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span>
<span id="cb9-2"><a href="sample-size-calculation.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;binomSamSize&quot;</span>)</span>
<span id="cb9-3"><a href="sample-size-calculation.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="sample-size-calculation.html#cb9-4" aria-hidden="true" tabindex="-1"></a>one_propotion1 <span class="ot">&lt;-</span> <span class="cf">function</span>(seq,p0,h1,corr,power){</span>
<span id="cb9-5"><a href="sample-size-calculation.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p1=</span>seq,<span class="at">p0=</span><span class="fu">rep</span>(p0,<span class="fu">length</span>(seq)))</span>
<span id="cb9-6"><a href="sample-size-calculation.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(seq)) {</span>
<span id="cb9-7"><a href="sample-size-calculation.html#cb9-7" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>n[i] <span class="ot">&lt;-</span> <span class="fu">pwr.p.test</span>(<span class="at">h=</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> seq[i], <span class="at">p2 =</span> p0),<span class="at">power=</span>power,<span class="at">sig.level=</span><span class="fl">0.025</span>,<span class="at">alternative=</span>h1)<span class="sc">$</span>n</span>
<span id="cb9-8"><a href="sample-size-calculation.html#cb9-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-9"><a href="sample-size-calculation.html#cb9-9" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i])</span>
<span id="cb9-10"><a href="sample-size-calculation.html#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="sample-size-calculation.html#cb9-11" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length[i] <span class="ot">&lt;-</span> <span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>wald.ne[i], </span>
<span id="cb9-12"><a href="sample-size-calculation.html#cb9-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;asymptotic&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb9-13"><a href="sample-size-calculation.html#cb9-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-14"><a href="sample-size-calculation.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-15"><a href="sample-size-calculation.html#cb9-15" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne[i] <span class="ot">&lt;-</span> <span class="fu">ciss.agresticoull</span>(seq[i],data<span class="sc">$</span>wd.Length[i], <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb9-16"><a href="sample-size-calculation.html#cb9-16" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length[i] <span class="ot">&lt;-</span> <span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>ac.ne[i], </span>
<span id="cb9-17"><a href="sample-size-calculation.html#cb9-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;ac&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb9-18"><a href="sample-size-calculation.html#cb9-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-19"><a href="sample-size-calculation.html#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="sample-size-calculation.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne.drop[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i]<span class="sc">/</span><span class="fl">0.9</span>)</span>
<span id="cb9-21"><a href="sample-size-calculation.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne.drop[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>ac.ne[i]<span class="sc">/</span><span class="fl">0.9</span>) </span>
<span id="cb9-22"><a href="sample-size-calculation.html#cb9-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-23"><a href="sample-size-calculation.html#cb9-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-24"><a href="sample-size-calculation.html#cb9-24" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ns[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>n[i]<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-25"><a href="sample-size-calculation.html#cb9-25" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ns[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(data<span class="sc">$</span>ac.ne[i]<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-26"><a href="sample-size-calculation.html#cb9-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-27"><a href="sample-size-calculation.html#cb9-27" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>wd.Length[i],<span class="dv">3</span>)</span>
<span id="cb9-28"><a href="sample-size-calculation.html#cb9-28" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>ac.Length[i],<span class="dv">3</span>)</span>
<span id="cb9-29"><a href="sample-size-calculation.html#cb9-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-30"><a href="sample-size-calculation.html#cb9-30" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wald.ne.cor[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">+</span>corr)<span class="sc">*</span>data<span class="sc">$</span>n[i])</span>
<span id="cb9-31"><a href="sample-size-calculation.html#cb9-31" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.ne.cor[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">+</span>corr)<span class="sc">*</span>data<span class="sc">$</span>ac.ne[i])</span>
<span id="cb9-32"><a href="sample-size-calculation.html#cb9-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-33"><a href="sample-size-calculation.html#cb9-33" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>wd.Length.cor[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>wald.ne.cor[i], </span>
<span id="cb9-34"><a href="sample-size-calculation.html#cb9-34" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;asymptotic&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb9-35"><a href="sample-size-calculation.html#cb9-35" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>ac.Length.cor[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">binom.length</span>(<span class="at">p=</span>seq[i], <span class="at">n=</span>data<span class="sc">$</span>ac.ne.cor[i], </span>
<span id="cb9-36"><a href="sample-size-calculation.html#cb9-36" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;ac&quot;</span>))<span class="sc">$</span>length[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb9-37"><a href="sample-size-calculation.html#cb9-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-38"><a href="sample-size-calculation.html#cb9-38" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)]</span>
<span id="cb9-39"><a href="sample-size-calculation.html#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb9-40"><a href="sample-size-calculation.html#cb9-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-41"><a href="sample-size-calculation.html#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="sample-size-calculation.html#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="fu">one_propotion1</span>(<span class="at">seq=</span><span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.02</span>,<span class="fl">0.005</span>),<span class="at">p0=</span><span class="fl">0.05</span>,<span class="at">h1=</span><span class="st">&quot;less&quot;</span>,<span class="at">corr=</span><span class="fl">0.5</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>##      p1   p0 wald.ne ac.ne wald.ne.drop ac.ne.drop wald.ns ac.ns wd.Length
## 1 0.005 0.05      82   250           92        278      41   125     0.009
## 2 0.010 0.05     125   184          139        205      63    92     0.014
## 3 0.015 0.05     186   210          207        234      93   105     0.016
## 4 0.020 0.05     281   293          312        326     141   147     0.016
##   ac.Length wald.ne.cor ac.ne.cor wd.Length.cor ac.Length.cor
## 1     0.013         123       375         0.008         0.010
## 2     0.020         188       276         0.013         0.015
## 3     0.020         279       315         0.014         0.015
## 4     0.018         421       440         0.013         0.014</code></pre>
</div>
<div id="package-pwr" class="section level4" number="8.2.3.2">
<h4><span class="header-section-number">8.2.3.2</span> Package: pwr</h4>
<p><a href="https://cran.r-project.org/web/packages/pwr/pwr.pdf">Basic Functions for Power Analysis</a></p>
<table>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>方法</th>
<th>功效计算的对象</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pwr.2p.test()</td>
<td>两比例(n相等)</td>
</tr>
<tr class="even">
<td>pwr.2p2n.test()</td>
<td>两比例(n不相等)</td>
</tr>
<tr class="odd">
<td>pwr.anova.test()</td>
<td>平衡的单因素ANOVA</td>
</tr>
<tr class="even">
<td>pwr.chisq.test()</td>
<td>卡方检验</td>
</tr>
<tr class="odd">
<td>pwr.f2.test()</td>
<td>广义线性模型</td>
</tr>
<tr class="even">
<td>pwr.p.test()</td>
<td>比例(单样本)</td>
</tr>
<tr class="odd">
<td>pwr.r.test()</td>
<td>相关系数</td>
</tr>
<tr class="even">
<td>pwr.t.test()</td>
<td>t检验(单样本、两样本、配对)</td>
</tr>
<tr class="odd">
<td>pwr.t2n.test()</td>
<td>t检验(n不相等的两样本)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="incidence-rate-ci" class="section level3" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Incidence rate CI</h3>
<p>Incidence rate is the rate at which new clinical events occur in a population. It is the number of new events divided by the population at risk of an event in a specific time period, sometimes it is the person-time at risk.</p>
<p><span class="math display">\[r=\frac{a}{N}\]</span>
<span class="math display">\[\mathrm{SE}=\sqrt{\frac{1-r}{\mathrm{a}}}\]</span>
<span class="math inline">\(100(1-\mathrm{a}) \%\)</span> confidence interval is defined as:
<span class="math display">\[
(\mathrm{e}^{\ln \mathrm{r}-\mathrm{z}_{1-\frac{\alpha}{2}} \mathrm{SE}}, \mathrm{e}^{\ln \mathrm{r}+\mathrm{z}_{1-\frac{\alpha}{2}} \mathrm{SE}})
\]</span></p>
<pre><code>                                              |</code></pre>
</div>
</div>
<div id="test-1-sample-proportion" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Test 1-Sample Proportion</h2>
<div id="sided-equality-based-on-wald-ci" class="section level4" number="8.3.0.1">
<h4><span class="header-section-number">8.3.0.1</span> 2-Sided Equality based on Wald CI</h4>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p=p_{0} \\
H_{1}: p \neq p_{0}
\end{array}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{p-p_{0}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p-p_{0}}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span>
#### Non-Inferiority or Superiority</p>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p-p_{0} \leq \delta \\
H_{1}: p-p_{0}&gt;\delta
\end{array}
\]</span>
and <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin.</p>
<p>Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{p-p_{0}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{p-p_{0}-\delta}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="sample-size-calculation.html#cb12-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb12-2"><a href="sample-size-calculation.html#cb12-2" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">=</span><span class="fl">0.3</span></span>
<span id="cb12-3"><a href="sample-size-calculation.html#cb12-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb12-4"><a href="sample-size-calculation.html#cb12-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb12-5"><a href="sample-size-calculation.html#cb12-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb12-6"><a href="sample-size-calculation.html#cb12-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(p<span class="sc">-</span>p0<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 17.17377</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sample-size-calculation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sample-size-calculation.html#cb16-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(p<span class="sc">-</span>p0<span class="sc">-</span>delta)<span class="sc">/</span><span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb16-2"><a href="sample-size-calculation.html#cb16-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))</span></code></pre></div>
<pre><code>## [1] 0.800018</code></pre>
</div>
<div id="equivalence" class="section level4" number="8.3.0.2">
<h4><span class="header-section-number">8.3.0.2</span> Equivalence</h4>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|p-p_{0}\right| \geq \delta \\
H_{1}:\left|p-p_{0}\right|&lt;\delta
\end{array}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=p(1-p)\left(\frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|p-p_{0}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|p-p_{0}\right|-\delta}{\sqrt{\frac{p(1-p)}{n}}}
\end{array}
\]</span></p>
</div>
</div>
<div id="test-2-sample-proportions" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Test 2-Sample Proportions</h2>
<div id="technical-details" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Technical details</h3>
<p>Random samples of m and n individuals are obtained from these two populations. The data from these samples
can be displayed in a 2-by-2 contingency table as follows</p>
<p><span class="math display">\[\begin{array}{lccc}\text { Group } &amp; \text { Success } &amp; \text { Failure } &amp; \text { Total } \\ \text { Treatment } &amp; x_{11} &amp; x_{12} &amp; n_{1} \\ \text { Control } &amp; x_{21} &amp; x_{22} &amp; n_{2} \\ \text { Total } &amp; m_{1} &amp; m_{2} &amp; N\end{array}\]</span></p>
<p>The binomial proportions <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}\)</span> are estimated from these data using the formulae
<span class="math display">\[
\hat{p}_{1}=\frac{x_{11}}{n_{1}} \text { and } \hat{p}_{2}=\frac{x_{21}}{n_{2}}
\]</span></p>
<p>Mathematically, there are three comparison parameters
<span class="math display">\[
\begin{array}{ll}
\underline{\text { Parameter }} &amp; \underline{\text { Computation }} \\
\text { Difference } &amp; \delta=p_{1}-p_{2} \\
\text { Risk Ratio } &amp; \phi=p_{1} / p_{2} \\
\text { Odds Ratio } &amp; \psi=\frac{p_{1} /\left(1-p_{1}\right)}{p_{2} /\left(1-p_{2}\right)}=\frac{p_{1} q_{2}}{p}
\end{array}
\]</span>
The tests analyzed by this routine are for the null case. This refers to the values of the above parameters under the null hypothesis. In the null case, the difference is zero and the ratios are one under the null hypothesis. In the nonnull case, discussed in another chapter, the difference is some value other than zero and the ratios are some value other than one. The non-null case often appears in equivalence and non-inferiority testing.</p>
</div>
<div id="fishers-exact-test" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Fisher’s Exact Test</h3>
<p>The test statistic is
<span class="math display">\[
T=-\ln \left[\frac{\left(\begin{array}{l}
n_{1} \\
x_{1}
\end{array}\right)\left(\begin{array}{l}
n_{2} \\
x_{2}
\end{array}\right)}{\left(\begin{array}{l}
N \\
m
\end{array}\right)}\right]
\]</span>
The null distribution of <span class="math inline">\(\mathrm{T}\)</span> is based on the hypergeometric distribution. It is given by
<span class="math display">\[
\operatorname{Pr}\left(T \geq t \mid m, H_{0}\right)=\sum_{A(m)}\left[\frac{\left(\begin{array}{l}
n_{1} \\
x_{1}
\end{array}\right)\left(\begin{array}{l}
n_{2} \\
x_{2}
\end{array}\right)}{\left(\begin{array}{c}
N \\
m
\end{array}\right)}\right]
\]</span></p>
<p>where
<span class="math display">\[
A(m)=\left\{\text { all pairs } x_{1}, x_{2} \text { such that } x_{1}+x_{2}=m, \text { given } T \geq t\right\}
\]</span>
Conditional on <span class="math inline">\(m\)</span>, the critical value, <span class="math inline">\(t_{\alpha}\)</span>, is the smallest value of <span class="math inline">\(t\)</span> such that
<span class="math display">\[
\operatorname{Pr}\left(T \geq t_{\alpha} \mid m, H_{0}\right) \leq \alpha
\]</span>
The power is defined as
<span class="math display">\[
1-\beta=\sum_{m=0}^{N} P(m) \operatorname{Pr}\left(T \geq t_{\alpha} \mid m, H_{1}\right)
\]</span>
where
<span class="math display">\[
\operatorname{Pr}\left(T \geq t_{\alpha} \mid m, H_{1}\right)=\sum_{A\left(m, T \geq t_{a}\right)}\left[\frac{b\left(x_{1}, n_{1}, p_{1}\right) b\left(x_{2}, n_{2}, p_{2}\right)}{\sum_{A(m)} b\left(x_{1}, n_{1}, p_{1}\right) b\left(x_{2}, n_{2}, p_{2}\right)}\right]
\]</span>
<span class="math display">\[
\begin{aligned}
P(m) &amp;=\operatorname{Pr}\left(x_{1}+x_{2}=m \mid H_{1}\right) \\
&amp;=b\left(x_{1}, n_{1}, p_{1}\right) b\left(x_{2}, n_{2}, p_{2}\right)
\end{aligned}
\]</span>
<span class="math display">\[
b(x, n, p)=\left(\begin{array}{l}
n \\ x
\end{array}\right) p^{x}(1-p)^{n-x}
\]</span>
When the normal approximation is used to compute power, the result is based on the pooled, continuity corrected <span class="math inline">\(Z\)</span> test.</p>
</div>
<div id="z-test-or-chi-square-test-pooled-and-unpooled" class="section level3" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</h3>
<p>Although this test is usually expressed directly as a Chi-Square statistic, it is expressed here as a z statistic so that it can be more easily used for one-sided hypothesis testing.</p>
<p>Both pooled and unpooled versions of this test have been discussed in the statistical literature. The pooling refers to the way in which the standard error is estimated. In the pooled version, the two proportions are averaged, and only one proportion is used to estimate the standard error. In the unpooled version, the two proportions are used separately.</p>
<p>The formula for the test statistic is
<span class="math display">\[
z_{t}=\frac{\hat{p}_{1}-\hat{p}_{2}}{\hat{\sigma}_{D}}
\]</span></p>
<p><strong>Pooled Version</strong>
<span class="math display">\[
\hat{\sigma}_{D}=\sqrt{\hat{p}(1-\hat{p})\left(\frac{1}{n_{1}}+\frac{1}{n_{2}}\right)} \\
\hat{p}=\frac{n_{1} \hat{p}_{1}+n_{2} \hat{p}_{2}}{n_{1}+n_{2}}
\]</span></p>
<p><strong>Unpooled Version</strong>
<span class="math display">\[
\hat{\sigma}_{D}=\sqrt{\frac{\hat{p}_{1}\left(1-\hat{p}_{1}\right)}{n_{1}}+\frac{\hat{p}_{2}\left(1-\hat{p}_{2}\right)}{n_{2}}}
\]</span></p>
<p><strong>Power</strong></p>
<p>The power of this test is computed using the enumeration procedure described above. For <strong>large sample sizes</strong>, the following approximation is used as presented in Chow et al. (2008).
1. Find the critical value (or values in the case of a two-sided test) using the standard normal distribution. The critical value is that value of <span class="math inline">\(\mathrm{z}\)</span> that leaves exactly the target value of alpha in the tail.
2. Use the normal approximation to binomial distribution to compute binomial probabilities, compute the power for the pooled and unpooled tests, respectively, using
Pooled: <span class="math inline">\(1-\beta=\operatorname{Pr}\left(Z&lt;\frac{z_{\alpha} \sigma_{D, p}+\left(p_{1}-p_{2}\right)}{\sigma_{D, u}}\right) \quad\)</span> Unpooled: <span class="math inline">\(1-\beta=\operatorname{Pr}\left(Z&lt;\frac{z_{\alpha} \sigma_{D, u}+\left(p_{1}-p_{2}\right)}{\sigma_{D, u}}\right)\)</span>
where
<span class="math display">\[
\begin{array}{l}
\sigma_{D, u}=\sqrt{\frac{p_{1} q_{1}}{n_{1}}+\frac{p_{2} q_{2}}{n_{2}}} \quad \text { (unpooled standard error) } \\
\sigma_{D, p}=\sqrt{\overline{p q}\left(\frac{1}{n_{1}}+\frac{1}{n_{2}}\right)} \quad \text { (pooled standard error) }
\end{array}
\]</span>
with <span class="math inline">\(\bar{p}=\frac{n_{1} p_{1}+n_{2} p_{2}}{n_{1}+n_{2}}\)</span> and <span class="math inline">\(\bar{q}=1-\bar{p}\)</span></p>
<p><strong>With Continuity Correction</strong></p>
<p><em>When you are approximating a Discrete Random Variable with Continuous Random Variable, such as when we use Normal distribution to approximate a Binomial Distribution, we need to use continuity correction.</em></p>
<p>The continuity corrected <span class="math inline">\(\mathrm{z}\)</span>-test is
<span class="math display">\[
z=\frac{\left(\hat{p}_{1}-\hat{p}_{2}\right)+\frac{F}{2}\left(\frac{1}{n_{1}}+\frac{1}{n_{2}}\right)}{\hat{\sigma}_{D}}
\]</span>
where <span class="math inline">\(F\)</span> is <span class="math inline">\(-1\)</span> for lower-tailed, 1 for upper-tailed, and both <span class="math inline">\(-1\)</span> and 1 for two-sided hypotheses.</p>
<div id="sided-equality-based-on-wald-ci-1" class="section level4" number="8.4.3.1">
<h4><span class="header-section-number">8.4.3.1</span> 2-Sided Equality based on Wald CI</h4>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p_{A}-p_{B}=0 \\
H_{1}: p_{A}-p_{B} \neq 0
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{p_{A}-p_{B}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p_{A}-p_{B}}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sample-size-calculation.html#cb18-1" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.65</span></span>
<span id="cb18-2"><a href="sample-size-calculation.html#cb18-2" aria-hidden="true" tabindex="-1"></a>pB<span class="ot">=</span><span class="fl">0.85</span></span>
<span id="cb18-3"><a href="sample-size-calculation.html#cb18-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb18-4"><a href="sample-size-calculation.html#cb18-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb18-5"><a href="sample-size-calculation.html#cb18-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb18-6"><a href="sample-size-calculation.html#cb18-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">/</span>kappa<span class="sc">+</span>pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB))<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(pA<span class="sc">-</span>pB))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 69.65881</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sample-size-calculation.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 70</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sample-size-calculation.html#cb22-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(pA<span class="sc">-</span>pB)<span class="sc">/</span><span class="fu">sqrt</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">/</span>nB<span class="sc">/</span>kappa<span class="sc">+</span>pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)<span class="sc">/</span>nB)</span>
<span id="cb22-2"><a href="sample-size-calculation.html#cb22-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="non-inferiority-or-superiority" class="section level4" number="8.4.3.2">
<h4><span class="header-section-number">8.4.3.2</span> Non-Inferiority or Superiority</h4>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: p_{A}-p_{B} \leq \delta \\
H_{1}: p_{A}-p_{B}&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{p_{A}-p_{B}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{p_{A}-p_{B}-\delta}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
</div>
<div id="equivalence-1" class="section level4" number="8.4.3.3">
<h4><span class="header-section-number">8.4.3.3</span> Equivalence</h4>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|p_{A}-p_{B}\right| \geq \delta \\
H_{1}:\left|p_{A}-p_{B}\right|&lt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{p_{A}\left(1-p_{A}\right)}{\kappa}+p_{B}\left(1-p_{B}\right)\right)\left(\frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|p_{A}-p_{B}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|p_{A}-p_{B}\right|-\delta}{\sqrt{\frac{p_{A}\left(1-p_{A}\right)}{n_{A}}+\frac{p_{B}\left(1-p_{B}\right)}{n_{B}}}}
\end{array}
\]</span></p>
<p><strong>Equivalence Trial with Binary Endpoint</strong></p>
<pre><code>%Macro TwoSamZTest(nSims=100000, nPerGrp=100, px=0.3, py=0.4, delta=0.3, alpha=0.05);
  Data TwoGVars;
  KEEP powerCI powerTest;
  powerCI=0; powerTest=0;
  Do iSim=1 To &amp;nSims;
  PxObs=Ranbin(733,&amp;nPerGrp,&amp;px)/&amp;nPerGrp;
  PyObs=Ranbin(236,&amp;nPerGrp,&amp;py)/&amp;nPerGrp;
  se=((PxObs*(1-PxObs)+PyObs*(1-PyObs))/&amp;nPerGrp)**0.5;
  *CI method;
  ICW=Probit(1-&amp;alpha)*se;
  IF Abs(PxObs-PyObs)+ICW &lt; &amp;delta Then
  powerCI=powerCI+1/&amp;nSims;
  *Two one-sided tests method;
  T1=(PyObs-PxObs-&amp;delta)/se;
  T2=(PyObs-PxObs+&amp;delta)/se;
  IF T1=Probit(1-&amp;alpha) &amp; T2&gt;Probit(1-&amp;alpha) Then
  powerTest=powerTest+1/&amp;nSims;
  End;
  Output;
  Run;
  Proc Print; Run;
%Mend TwoSamZTest;

Title “Equivalence test with binary response: Alpha under Ho”;
%TwoSamZTest(nPerGrp=100, px=0.1, py=0.2, delta=0.1, alpha=0.05);

Title “Equivalence test with binary response: Power under Ha”;
%TwoSamZTest(nPerGrp=100, px=0.3, py=0.3, delta=0.2, alpha=0.05);</code></pre>
</div>
</div>
<div id="conditional-mantel-haenszel-test" class="section level3" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</h3>
<p>The conditional Mantel-Haenszel test is based on the index frequency, <span class="math inline">\(x_{11}\)</span>, from the <span class="math inline">\(2 \mathrm{x} 2\)</span> table to compare the odds ratios of several 2-by-2 tables. The formula for the <span class="math inline">\(\mathrm{z}\)</span>-statistic is
<span class="math display">\[
z=\frac{x_{11}-E\left(x_{11}\right)}{\sqrt{V_{c}\left(x_{11}\right)}}
\]</span>
where
<span class="math display">\[
\begin{array}{l}
E\left(x_{11}\right)=\frac{n_{1} m_{1}}{N} \\
V_{c}\left(x_{11}\right)=\frac{n_{1} n_{2} m_{1} m_{2}}{N^{2}(N-1)}
\end{array}
\]</span></p>
</div>
<div id="paired-proportions-mcnemars-z-test" class="section level3" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</h3>
<p>Compare the probability that an event occurs in group ‘A’ to that in group ‘B’. Example study designs include matched case-control studies and cross-over studies.
<span class="math display">\[
\begin{array}{cl}
&amp; &amp; \text { Group &#39;B&#39; } \\
&amp; &amp; \text { Success} &amp; \text { Failure } \\
\text { Group &#39;A&#39; } &amp;\text { Success } &amp; p_{11} &amp; p_{10} \\
&amp;\text { Failure } &amp; p_{01} &amp; p_{00}
\end{array}
\]</span>
Interest is in comparing the following hypotheses:</p>
<ul>
<li><span class="math inline">\(H_{0}:\)</span> Both groups have the same success probability</li>
<li><span class="math inline">\(H_{1}\)</span> :The success probability is not equal between the Groups</li>
</ul>
<p>Mathematically, this can be represented as
<span class="math display">\[
\begin{array}{l}
H_{0}: p_{10}=p_{01} \\
H_{1}: p_{10} \neq p_{01}
\end{array}
\]</span></p>
<p>In the formulas below, we use the notation that
<span class="math display">\[
p_{d i s c}=p_{10}+p_{01}
\]</span>
and
<span class="math display">\[
p_{d i f f}=p_{10}-p_{01}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=\left(\frac{z_{1-\alpha / 2} \sqrt{p_{d i s c}}+z_{1-\beta} \sqrt{p_{d i s c}-p_{d i f f}^{2}}}{p_{d i f f}}\right)^{2} \\
\quad 1-\beta=\Phi\left(\frac{p_{d i f f} \sqrt{n}-z_{1-\alpha / 2} \sqrt{p_{d i s c}}}{\sqrt{p_{d i s c}-p_{d i f f}^{2}}}\right)
\end{array}
\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sample-size-calculation.html#cb25-1" aria-hidden="true" tabindex="-1"></a>p01<span class="ot">=</span><span class="fl">0.45</span></span>
<span id="cb25-2"><a href="sample-size-calculation.html#cb25-2" aria-hidden="true" tabindex="-1"></a>p10<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb25-3"><a href="sample-size-calculation.html#cb25-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span><span class="sc">*</span><span class="dv">2</span> <span class="co"># *2 to convert cited example&#39;s 1-sided test to 2-sided test</span></span>
<span id="cb25-4"><a href="sample-size-calculation.html#cb25-4" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.10</span></span>
<span id="cb25-5"><a href="sample-size-calculation.html#cb25-5" aria-hidden="true" tabindex="-1"></a>pdisc<span class="ot">=</span>p10<span class="sc">+</span>p01</span>
<span id="cb25-6"><a href="sample-size-calculation.html#cb25-6" aria-hidden="true" tabindex="-1"></a>pdiff<span class="ot">=</span>p10<span class="sc">-</span>p01</span>
<span id="cb25-7"><a href="sample-size-calculation.html#cb25-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>pdiff)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 22.80907</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sample-size-calculation.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sample-size-calculation.html#cb29-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span>( pdiff<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc))<span class="sc">/</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb29-2"><a href="sample-size-calculation.html#cb29-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span>(<span class="sc">-</span>pdiff<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pdisc))<span class="sc">/</span><span class="fu">sqrt</span>(pdisc<span class="sc">-</span>pdiff<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb29-3"><a href="sample-size-calculation.html#cb29-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power =</span> <span class="fu">pnorm</span>(x1)<span class="sc">+</span><span class="fu">pnorm</span>(x2))</span></code></pre></div>
<pre><code>## [1] 0.9000001</code></pre>
</div>
<div id="chi-square-test" class="section level3" number="8.4.6">
<h3><span class="header-section-number">8.4.6</span> Chi-square test</h3>
<p>Chi-square test is often used to evaluate the relationship between two categorical variables. The typical null hypothesis is independence between variables, and the alternative hypothesis is not independence. The pwr.chisq.test() function can evaluate the power, effect size and required sample size of the chi-square test</p>
<blockquote>
<p>想研究人种与工作晋升的关系。你预期样本中70%是白种人，10% 是美国黑人，20%西班牙裔人。而且，你认为相比30%的美国黑人和50%的西班牙裔人，60%的 白种人更容易晋升。研究假设的晋升概率如表所示。</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>人 种</th>
<th>晋升比例</th>
<th>未晋升者比例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>白种人</td>
<td>0.42</td>
<td>0.28</td>
</tr>
<tr class="even">
<td>美国黑人</td>
<td>0.03</td>
<td>0.07</td>
</tr>
<tr class="odd">
<td>西班牙裔</td>
<td>0.10</td>
<td>0.10</td>
</tr>
</tbody>
</table>
<blockquote>
<p>预期总人数的42%是晋升的白种人(0.42 = 0.70 × 0.60)，总人数的7%是未 晋升的美国黑人(0.07 = 0.10 × 0.70)。让我们取0.05的显著性水平和0.90的预期功效水平。双因 素列联表的自由度为(r-1)(c-1)，r是行数，c是列数</p>
</blockquote>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sample-size-calculation.html#cb31-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.42</span>, <span class="fl">0.28</span>, <span class="fl">0.03</span>, <span class="fl">0.07</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb31-2"><a href="sample-size-calculation.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ES.w2</span>(prob)</span></code></pre></div>
<pre><code>## [1] 0.1853198</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sample-size-calculation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.chisq.test</span>(<span class="at">w =</span><span class="fu">ES.w2</span>(prob), <span class="at">df =</span> <span class="dv">3</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.1853198
##               N = 412.6404
##              df = 3
##       sig.level = 0.05
##           power = 0.9
## 
## NOTE: N is the number of observations</code></pre>
</div>
</div>
<div id="test-means" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Test Mean(s)</h2>
<div id="one-sample-mean-2-sided-equality" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</h3>
<p>The Null and Alternative hypotheses are
<span class="math display">\[
\begin{array}{l}
H_{0}: \mu=\mu_{0} \\
H_{1}: \mu \neq \mu_{0}
\end{array}
\]</span>
Formulas compute sample size and power, respectively:
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha / 2}+z_{1-\beta}}{\mu-\mu_{0}}\right)^{2}\]</span>
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{\mu-\mu_{0}}{\sigma / \sqrt{n}}
\]</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sample-size-calculation.html#cb35-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb35-2"><a href="sample-size-calculation.html#cb35-2" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="fl">1.5</span></span>
<span id="cb35-3"><a href="sample-size-calculation.html#cb35-3" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb35-4"><a href="sample-size-calculation.html#cb35-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb35-5"><a href="sample-size-calculation.html#cb35-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb35-6"><a href="sample-size-calculation.html#cb35-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(mu<span class="sc">-</span>mu0))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 31.39552</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sample-size-calculation.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sample-size-calculation.html#cb39-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(mu<span class="sc">-</span>mu0)<span class="sc">/</span>sd<span class="sc">*</span><span class="fu">sqrt</span>(n)</span>
<span id="cb39-2"><a href="sample-size-calculation.html#cb39-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="sample-mean-non-inferiority-or-superiority" class="section level3" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu-\mu_{0} \leq \delta \\
H_{1}: \mu-\mu_{0}&gt;\delta
\end{array}
\]</span>
Sample Size
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta}}{\mu-\mu_{0}-\delta}\right)^{2}\]</span>
Power
<span class="math display">\[1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{\mu-\mu_{0}-\delta}{\sigma / \sqrt{n}}\]</span></p>
</div>
<div id="sample-mean-equivalence" class="section level3" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> 1-Sample Mean Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|\mu-\mu_{0}\right| \geq \delta \\
H_{1}:\left|\mu-\mu_{0}\right|&lt;\delta
\end{array}
\]</span>
Sample Size
<span class="math display">\[n=\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta / 2}}{\delta-\left|\mu-\mu_{0}\right|}\right)^{2}\]</span>
Power
<span class="math display">\[1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|\mu-\mu_{0}\right|-\delta}{\sigma / \sqrt{n}}\]</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sample-size-calculation.html#cb41-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb41-2"><a href="sample-size-calculation.html#cb41-2" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb41-3"><a href="sample-size-calculation.html#cb41-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb41-4"><a href="sample-size-calculation.html#cb41-4" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="fl">0.10</span></span>
<span id="cb41-5"><a href="sample-size-calculation.html#cb41-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb41-6"><a href="sample-size-calculation.html#cb41-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb41-7"><a href="sample-size-calculation.html#cb41-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(delta<span class="sc">-</span><span class="fu">abs</span>(mu<span class="sc">-</span>mu0)))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 34.25539</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sample-size-calculation.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 35</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="sample-size-calculation.html#cb45-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">abs</span>(mu<span class="sc">-</span>mu0)<span class="sc">-</span>delta)<span class="sc">/</span>sd<span class="sc">*</span><span class="fu">sqrt</span>(n)</span>
<span id="cb45-2"><a href="sample-size-calculation.html#cb45-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000048</code></pre>
</div>
<div id="sample-means-2-sided-equality" class="section level3" number="8.5.4">
<h3><span class="header-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}-\mu_{B}=0 \\
H_{1}: \mu_{A}-\mu_{B} \neq 0
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span></p>
<p>Sample size
<span class="math display">\[
n_{A}=\kappa n_{B}
\]</span>
<span class="math display">\[
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha / 2}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2}
\]</span>
Power
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\]</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sample-size-calculation.html#cb47-1" aria-hidden="true" tabindex="-1"></a>muA<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb47-2"><a href="sample-size-calculation.html#cb47-2" aria-hidden="true" tabindex="-1"></a>muB<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb47-3"><a href="sample-size-calculation.html#cb47-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb47-4"><a href="sample-size-calculation.html#cb47-4" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb47-5"><a href="sample-size-calculation.html#cb47-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb47-6"><a href="sample-size-calculation.html#cb47-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb47-7"><a href="sample-size-calculation.html#cb47-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">*</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(muA<span class="sc">-</span>muB))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 62.79104</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sample-size-calculation.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 63</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sample-size-calculation.html#cb51-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(muA<span class="sc">-</span>muB)<span class="sc">/</span>(sd<span class="sc">*</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">/</span>nB))</span>
<span id="cb51-2"><a href="sample-size-calculation.html#cb51-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.800001</code></pre>
</div>
<div id="sample-means-1-sided" class="section level3" number="8.5.5">
<h3><span class="header-section-number">8.5.5</span> 2-Sample Means, 1-Sided</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}=\mu_{B} \\
H_{1}: \mu_{A}&gt;\mu_{B}
\end{array}
\]</span>
where the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{B}}{n_{A}}
\]</span>
Sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\left(\sigma_{A}^{2}+\sigma_{B}^{2} / \kappa\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2} \\
n_{B}=\kappa n_{A} \\
1-\beta=\Phi\left(\frac{\left|\mu_{A}-\mu_{B}\right| \sqrt{n_{A}}}{\sqrt{\sigma_{A}^{2}+\sigma_{B}^{2} / \kappa}}-z_{1-\alpha}\right)
\end{array}
\]</span></p>
</div>
<div id="sample-means-non-inferiority-or-superiority" class="section level3" number="8.5.6">
<h3><span class="header-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}-\mu_{B} \leq \delta \\
H_{1}: \mu_{A}-\mu_{B}&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta}}{\mu_{A}-\mu_{B}-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}-\delta}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\end{array}
\]</span></p>
</div>
<div id="sample-means-equivalence" class="section level3" number="8.5.7">
<h3><span class="header-section-number">8.5.7</span> 2-Sample Means Equivalence</h3>
<p><span class="math display">\[
\begin{array}{l}
H_{0}:\left|\mu_{A}-\mu_{B}\right| \geq \delta \\
H_{1}:\left|\mu_{A}-\mu_{B}\right|&lt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin and the ratio between the sample sizes of the two groups is
<span class="math display">\[
\kappa=\frac{n_{1}}{n_{2}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n_{A}=\kappa n_{B} \\
n_{B}=\left(1+\frac{1}{\kappa}\right)\left(\sigma \frac{z_{1-\alpha}+z_{1-\beta / 2}}{\left|\mu_{A}-\mu_{B}\right|-\delta}\right)^{2} \\
1-\beta=2\left[\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right)\right]-1 \quad, \quad z=\frac{\left|\mu_{A}-\mu_{B}\right|-\delta}{\sigma \sqrt{\frac{1}{n_{A}}+\frac{1}{n_{B}}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="sample-size-calculation.html#cb53-1" aria-hidden="true" tabindex="-1"></a>muA<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb53-2"><a href="sample-size-calculation.html#cb53-2" aria-hidden="true" tabindex="-1"></a>muB<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb53-3"><a href="sample-size-calculation.html#cb53-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb53-4"><a href="sample-size-calculation.html#cb53-4" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb53-5"><a href="sample-size-calculation.html#cb53-5" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb53-6"><a href="sample-size-calculation.html#cb53-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb53-7"><a href="sample-size-calculation.html#cb53-7" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb53-8"><a href="sample-size-calculation.html#cb53-8" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">*</span>(sd<span class="sc">*</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">abs</span>(muA<span class="sc">-</span>muB)<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 107.0481</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="sample-size-calculation.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB)</span></code></pre></div>
<pre><code>## [1] 108</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sample-size-calculation.html#cb57-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">abs</span>(muA<span class="sc">-</span>muB)<span class="sc">-</span>delta)<span class="sc">/</span>(sd<span class="sc">*</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>kappa)<span class="sc">/</span>nB))</span>
<span id="cb57-2"><a href="sample-size-calculation.html#cb57-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000048</code></pre>
<p><strong>SAS Implementation</strong></p>
<pre><code>*** Equivalence Trial with Normal Endpoin;

%Macro EquivCI(nSims=1000, nPerGrp=200, ux=0, uy=1, delta=1.2, sigmax=1, sigmay=1.2, alpha=0.05);
  Data TwoGVars;
  Keep xMean yMean powerCI powerTest;
  powerCI=0; powerTest=0;
  Do iSim=1 To &amp;nSims;
  xMean=0; yMean=0; s2x=0; s2y=0;
  Do iObs=1 To &amp;nPerGrp;
  xNOR=Rannor(7362); xMean=xMean+xNor; s2x=s2x+xNor**2;
  yNOR=Rannor(2637); yMean=yMean+yNor; s2y=s2y+yNor**2;
  End;
  xMean=xMean*&amp;sigmax/&amp;nPerGrp+&amp;ux;
  yMean=yMean*&amp;sigmay/&amp;nPerGrp+&amp;uy;
  sp=((s2x*&amp;sigmax**2+s2y*&amp;sigmay**2)/(2*&amp;nPerGrp-2))**0.5;
  se=sp/(&amp;nPerGrp/2)**0.5;
  * CI method;
  ICW=Probit(1-&amp;alpha)*se;
  If Abs(yMean-xMean)+ICW &lt; &amp;delta Then
  powerCI=powerCI+1/&amp;nSims;
  *Two one-sided test method;
  T1=(xMean-yMean-&amp;delta)/se;
  T2=(xMean-yMean+&amp;delta)/se;
  If T1=Probit(1-&amp;alpha) &amp; T2&gt;Probit(1-&amp;alpha) Then
  powerTest=powerTest+1/&amp;nSims;
  End;
  Output;
  Run;
  Proc Print Data=TwoGVars(obs=1); Run;
%Mend EquivCI;

Title “Equivalence test with normal response: Alpha under Ho”;
%EquivCI(nSims=10000, nPerGrp=1000, ux=0.2, uy=0, delta=0.2, sigmax=1, sigmay=1, alpha=0.05);

Title “Equivalence test with normal response: Power under Ha”;
%EquivCI(nSims=10000, nPerGrp=198, ux=0, uy=1, delta=1.2, sigmax=0.8, sigmay=0.8, alpha=0.05);</code></pre>
</div>
<div id="t-test-using-pwr.t.test-or-pwr.t2n.test" class="section level3" number="8.5.8">
<h3><span class="header-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></h3>
<ul>
<li><code>pwr.t.test</code>: Power calculations for t-tests of means (one sample, two samples and paired samples)</li>
<li><code>pwr.t2n.test</code>: Power calculations for two samples (different sizes) t-tests of means</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="sample-size-calculation.html#cb60-1" aria-hidden="true" tabindex="-1"></a>TTest <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,mean,std,power,side){</span>
<span id="cb60-2"><a href="sample-size-calculation.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> mean<span class="sc">/</span>std</span>
<span id="cb60-3"><a href="sample-size-calculation.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># d: Effect size (Cohen&#39;s d) - difference between the means divided by the pooled standard deviation</span></span>
<span id="cb60-4"><a href="sample-size-calculation.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  samplesize <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d=</span>d, <span class="at">power=</span>power, <span class="at">sig.level=</span>alpha, <span class="at">type=</span><span class="st">&quot;two.sample&quot;</span>,<span class="at">alternative=</span>side)</span>
<span id="cb60-5"><a href="sample-size-calculation.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  CI.Left  <span class="ot">&lt;-</span> mean<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>std<span class="sc">/</span><span class="fu">sqrt</span>(samplesize<span class="sc">$</span>n)</span>
<span id="cb60-6"><a href="sample-size-calculation.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  CI.Right <span class="ot">&lt;-</span> mean<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>std<span class="sc">/</span><span class="fu">sqrt</span>(samplesize<span class="sc">$</span>n)</span>
<span id="cb60-7"><a href="sample-size-calculation.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;[&quot;</span>,<span class="fu">round</span>(CI.Left,<span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(CI.Right,<span class="dv">3</span>), <span class="st">&quot;]&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>,<span class="at">collapse =</span> <span class="cn">NULL</span>)</span>
<span id="cb60-8"><a href="sample-size-calculation.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">alpha =</span> alpha,</span>
<span id="cb60-9"><a href="sample-size-calculation.html#cb60-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean =</span> mean,</span>
<span id="cb60-10"><a href="sample-size-calculation.html#cb60-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sd =</span> std,</span>
<span id="cb60-11"><a href="sample-size-calculation.html#cb60-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">power =</span> samplesize<span class="sc">$</span>power,</span>
<span id="cb60-12"><a href="sample-size-calculation.html#cb60-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">side =</span> samplesize<span class="sc">$</span>alternative,</span>
<span id="cb60-13"><a href="sample-size-calculation.html#cb60-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n =</span> samplesize<span class="sc">$</span>n,</span>
<span id="cb60-14"><a href="sample-size-calculation.html#cb60-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">CI =</span> CI)</span>
<span id="cb60-15"><a href="sample-size-calculation.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb60-16"><a href="sample-size-calculation.html#cb60-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-17"><a href="sample-size-calculation.html#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="sample-size-calculation.html#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="fu">TTest</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.42</span>, <span class="at">std =</span> <span class="fl">0.7</span>, <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">side =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##   alpha  mean  sd power      side        n              CI
## 1  0.05 -0.42 0.7   0.8 two.sided 44.58577 [-0.625,-0.215]</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="sample-size-calculation.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TTest</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.42</span>, <span class="at">std =</span> <span class="fl">0.748</span>, <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">side =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>##   alpha  mean    sd power side        n              CI
## 1  0.05 -0.42 0.748   0.8 less 39.91355 [-0.652,-0.188]</code></pre>
</div>
<div id="test-k-means" class="section level3" number="8.5.9">
<h3><span class="header-section-number">8.5.9</span> Test k Means</h3>
<p><strong>1-Way ANOVA Pairwise, 2-Sided Equality using Bonferroni Adjustment</strong></p>
<p>In more general terms, we may have <span class="math inline">\(k\)</span> groups, meaning there are a total of <span class="math inline">\(K \equiv\left(\begin{array}{c}k \\ 2\end{array}\right)=k(k-1) / 2\)</span> possible pairwise comparisons. When we test <span class="math inline">\(\tau \leq K\)</span> of these pairwise comparisons, we have <span class="math inline">\(\tau\)</span> hypotheses of the form
<span class="math display">\[
\begin{array}{l}
H_{0}: \mu_{A}=\mu_{B} \\
H_{1}: \mu_{A} \neq \mu_{B}
\end{array}
\]</span>
where <span class="math inline">\(\mu_{A}\)</span> and <span class="math inline">\(\mu_{B}\)</span> represent the means of two of the <span class="math inline">\(k\)</span> groups, groups ‘A’ and ‘B’. We’ll compute the required sample size for each of the <span class="math inline">\(\tau\)</span> comparisons, and total sample size needed is the largest of these. In the formula below, <span class="math inline">\(n\)</span> represents the sample size in any one of these <span class="math inline">\(\tau\)</span> comparisons; that is, there are <span class="math inline">\(n / 2\)</span> people in the ‘A’ group, and <span class="math inline">\(n / 2\)</span> people in the ‘B’ group.</p>
<p>Formulas to compute sample size and power, respectively:
<span class="math display">\[
\begin{array}{c}
n=2\left(\sigma \frac{z_{1-\alpha /(2 \tau)}+z_{1-\beta}}{\mu_{A}-\mu_{B}}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha /(2 \tau)}\right)+\Phi\left(-z-z_{1-\alpha /(2 \tau)}\right) \quad, \quad z=\frac{\mu_{A}-\mu_{B}}{\sigma \sqrt{\frac{2}{n}}}
\end{array}
\]</span></p>
<p>See more under multiple tests.</p>
</div>
<div id="anova-using-pwr.anova.test" class="section level3" number="8.5.10">
<h3><span class="header-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></h3>
<p>Perform power analysis on balanced one-way analysis of variance, where k is the number of groups, and n is the sample size in each group.</p>
<p>Now do a one-way analysis of variance for the five groups to achieve a power of 0.8, an <strong>effect value</strong> of 0.25, and a significance level of 0.05 to calculate the sample size required for each group</p>
<p>Where <strong>effect value</strong> is calculated using <span class="math display">\[f=\sqrt{\frac{\sum_{i=1}^k p_i \times (\mu_i - \mu)^2}{\sigma^2}}\]</span></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="sample-size-calculation.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">f =</span> <span class="fl">0.25</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 5
##               n = 39.1534
##               f = 0.25
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="sample-size-calculation.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample sizes for detecting significant effects in a One-Way ANOVA</span></span>
<span id="cb66-2"><a href="sample-size-calculation.html#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="sample-size-calculation.html#cb66-3" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>)</span>
<span id="cb66-4"><a href="sample-size-calculation.html#cb66-4" aria-hidden="true" tabindex="-1"></a>nes <span class="ot">&lt;-</span> <span class="fu">length</span>(es)</span>
<span id="cb66-5"><a href="sample-size-calculation.html#cb66-5" aria-hidden="true" tabindex="-1"></a>samsize <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb66-6"><a href="sample-size-calculation.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nes) {</span>
<span id="cb66-7"><a href="sample-size-calculation.html#cb66-7" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">f =</span> es[i], </span>
<span id="cb66-8"><a href="sample-size-calculation.html#cb66-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb66-9"><a href="sample-size-calculation.html#cb66-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">power =</span> <span class="fl">0.9</span>)</span>
<span id="cb66-10"><a href="sample-size-calculation.html#cb66-10" aria-hidden="true" tabindex="-1"></a>    samsize[i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb66-11"><a href="sample-size-calculation.html#cb66-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-12"><a href="sample-size-calculation.html#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samsize, es, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb66-13"><a href="sample-size-calculation.html#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Effect Size&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Sample Size (per cell)&quot;</span>, </span>
<span id="cb66-14"><a href="sample-size-calculation.html#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;One Way ANOVA with Power=.90 and Alpha=.05&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Anova%20test-1.png" width="672" /></p>
</div>
<div id="average-bioequivalence" class="section level3" number="8.5.11">
<h3><span class="header-section-number">8.5.11</span> Average Bioequivalence</h3>
<p>Pharmacokinetics (PK) is the study of the body’s absorption, distribution, metabolism, and elimination of a drug. An important outcome of a PK study is the bioavailability of the drug. The bioavailability of a drug is defined as the rate and extent to which the active drug ingredient or therapeutic moiety is absorbed and becomes available at the site of drug action. As bioavailability cannot be easily measured directly, the concentration of the drug that reaches the circulating bloodstream is taken as a surrogate. Therefore, bioavailability can be viewed as the concentration of the drug that is in the blood. Two drugs are bioequivalent if they have the same bioavailability.</p>
<blockquote>
<p>药代动力学（PK）是人体对药物的吸收，分布，代谢和消除的研究。 PK 研究的一个重要结果是药物的生物利用度。
药物的生物利用度被定义为活性药物成分或治疗部分被吸收并在药物作用部位变得可用的速率和程度。由于不能轻易直接测量生物利用度，因此将到达循环血流的药物浓度作为替代指标。因此，生物利用度可以看作是血液中药物的浓度。如果两种药物具有相同的生物利用度，则它们是生物等效的</p>
</blockquote>
<p>At the present time, average bioequivalence (ABE) serves as the current international standard for bioequivalence (BE) testing using a 2 × 2 crossover design (Chow and Liu, 2008). The PK parameters used for assessing ABE are area under the curve (AUC) and peak concentration (Cmax). The recommended statistical method is the two one-sided tests procedure to determine if the average values for the PK measures determined after administration of the T (test) and R (reference) products were comparable. This approach is termed ABE. It is equivalent to the so-called confidence interval method, which involves the calculation of a 90% confidence interval for the ratio of the averages (population geometric means) of the measures for the T and R products. To establish BE, the calculated confidence interval should fall within a BE limit, usually 80%–125% for the ratio of the product averages. The 1992 FDA guidance has also provided specific recommendations for logarithmic transformation of PK data, methods to evaluate sequence effects, and methods to evaluate outlier data. In practice, people also use parallel designs and the 90% confidence interval for nontransformed data. To establish BE, the calculated confidence interval should fall within a BE limit, usually 80%–120% for the difference of the product averages.</p>
<blockquote>
<p>目前，平均生物等效性 (ABE) 是使用 2 × 2 交叉设计进行生物等效性 (BE) 测试的当前国际标准（Chow 和 Liu，2008 年）。用于评估 ABE 的 PK 参数是曲线下面积 (AUC) 和峰值浓度 (Cmax)。推荐的统计方法是两个单面测试程序，以确定在施用T（测试）和R（参考）产品后确定的PK度量的平均值是否可比。这种方法称为 ABE。它等效于所谓的置信区间方法，它涉及计算 T 和 R 产品度量的平均值（总体几何平均值）之比的 90% 置信区间。要建立 BE，计算出的置信区间应落在 BE 限值内，通常产品平均值的比率为 80% -125%。 1992 年的 FDA 指南还为 PK 数据的对数转换、评估序列效应的方法和评估离群数据的方法提供了具体建议。在实践中，人们还使用平行设计和未转换数据的 90% 置信区间。要建立 BE，计算的置信区间应落在 BE 限制内，通常产品平均值的差异为 80% -120%。</p>
</blockquote>
<p>The hypothesis for ABE in a 2×2 crossover design with log-transformed data can be written as
<span class="math display">\[
\begin{array}{l}
H_{01}: \mu_{T}-\mu_{R} \leq-\ln 1.25 \\
H_{02}: \mu_{T}-\mu_{R} \geq \ln 1.25
\end{array}
\]</span>
The asymptotic sample size is given by (Chow et al., 2003 )
<span class="math display">\[
n=\frac{\left(z_{1-\alpha}+z_{1-\beta / 2}\right)^{2} \sigma_{1,1}^{2}}{2(\ln 1.25-|\varepsilon|)^{2}}
\]</span>
where the variance for the intrasubject comparison is estimated using
<span class="math display">\[
\hat{\sigma}_{1,1}^{2}=\frac{1}{n_{1}+n_{2}-2} \sum_{j=1}^{2} \sum_{i=1}^{n_{j}}\left(y_{i 1 j}-y_{i 2 j}-\bar{y}_{1 j}+\bar{y}_{2 j}\right)^{2}
\]</span>
<span class="math inline">\(y_{i k j}\)</span> is the log-transformed <span class="math inline">\(\mathrm{PK}\)</span> measure from the <span class="math inline">\(i\)</span> th subject in the <span class="math inline">\(j\)</span> th sequence at the <span class="math inline">\(k\)</span> th dosing period, and <span class="math inline">\(\bar{y}_{k j}\)</span> is the sample mean of the observations in the <span class="math inline">\(j\)</span> th sequence at the <span class="math inline">\(k\)</span> th period.</p>
<p><strong>Crossover Bioequivalence Trial SAS</strong></p>
<p>The <span class="math inline">\(\mathrm{PK}\)</span> parameter chosen for this bioequivalence test is a log-transformation of the 24 -hour AUC (i.e., the raw data is log-normal). Assume that the difference between the two formulations in <span class="math inline">\(\log (\mathrm{AUC})\)</span> is <span class="math inline">\(\varepsilon=0.04\)</span> and the standard deviation for the intrasubject comparison is <span class="math inline">\(\sigma_{1,1}^{2}=0.55\)</span> with <span class="math inline">\(\alpha=0.05\)</span> and <span class="math inline">\(\beta=0.2\)</span>, the sample size per sequence is given by
<span class="math display">\[
n=\frac{(1.96+0.84)^{2}(0.55)^{2}}{2(0.223-0.04)^{2}}=36
\]</span></p>
<pre><code>%Macro Power2By2ABE(totalN=24, sWithin=0.355, uRatio=1);
  Data ABE; Keep sWithin uRatio n power;
  n=&amp;totalN; sWithin=&amp;sWithin; uRatio=&amp;uRatio;
  * Err df for AB/BA crossover design;
  n2=n-2;
  t1=tinv(1-0.05,n-2); t2=-t1;
  nc1=Sqrt(n)*log(uRatio/0.8)/Sqrt(2)/sWithin;
  nc2=Sqrt(n)*log(uRatio/1.25)/Sqrt(2)/sWithin;
  df=Sqrt(n-2)*(nc1-nc2)/(2*t1);
  Power=Probt(t2,df,nc2)-Probt(t1,df,nc1);
  Run;
  Proc Print; Run;
%Mend Power2By2ABE;

%Power2By2ABE(totalN=58, sWithin=0.355, uRatio=1)</code></pre>
</div>
</div>
<div id="other-methods" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Other Methods</h2>
<div id="odds-ratio" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Odds Ratio</h3>
<p><strong>Non-Inferiority or Superiority</strong></p>
<p><span class="math display">\[
O R=\frac{p_{A}\left(1-p_{B}\right)}{p_{B}\left(1-p_{A}\right)}
\]</span>
The hypotheses to test are
<span class="math display">\[
\begin{array}{l}
H_{0}: \ln (O R) \leq \delta \\
H_{1}: \ln (O R)&gt;\delta
\end{array}
\]</span>
where <span class="math inline">\(\delta\)</span> is the superiority or non-inferiority margin on the log scale, and the ratio between the sample sizes of the two
groups is
<span class="math display">\[
\kappa=\frac{n_{A}}{n_{B}}
\]</span>
Formulas of sample size and power, respectively:
<span class="math display">\[
\begin{array}{l}
n_{A}=\kappa n_{B} \\ n_{B}=\left(\frac{1}{\kappa p_{A}\left(1-p_{A}\right)}+\frac{1}{p_{B}\left(1-p_{B}\right)}\right)\left(\frac{z_{1-\alpha}+z_{1-\beta}}{\ln (O R)-\delta}\right)^{2} \\
1-\beta=\Phi\left(z-z_{1-\alpha}\right)+\Phi\left(-z-z_{1-\alpha}\right) \quad, \quad z=\frac{(\ln (O R)-\delta) \sqrt{n_{B}}}{\sqrt{\frac{1}{\kappa p_{A}\left(1-p_{A}\right)}+\frac{1}{p_{B}\left(1-p_{B}\right)}}}
\end{array}
\]</span></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="sample-size-calculation.html#cb68-1" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.40</span></span>
<span id="cb68-2"><a href="sample-size-calculation.html#cb68-2" aria-hidden="true" tabindex="-1"></a>pB<span class="ot">=</span><span class="fl">0.25</span></span>
<span id="cb68-3"><a href="sample-size-calculation.html#cb68-3" aria-hidden="true" tabindex="-1"></a>delta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb68-4"><a href="sample-size-calculation.html#cb68-4" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb68-5"><a href="sample-size-calculation.html#cb68-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb68-6"><a href="sample-size-calculation.html#cb68-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb68-7"><a href="sample-size-calculation.html#cb68-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">OR=</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)<span class="sc">/</span>pB<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pA)) <span class="co"># 2</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="sample-size-calculation.html#cb70-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">nB=</span>(<span class="dv">1</span><span class="sc">/</span>(kappa<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>(pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)))<span class="sc">*</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(<span class="fu">log</span>(OR)<span class="sc">-</span>delta))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 241.512</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="sample-size-calculation.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(nB) </span></code></pre></div>
<pre><code>## [1] 242</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="sample-size-calculation.html#cb74-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(<span class="fu">log</span>(OR)<span class="sc">-</span>delta)<span class="sc">*</span><span class="fu">sqrt</span>(nB)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(kappa<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>(pB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pB)))</span>
<span id="cb74-2"><a href="sample-size-calculation.html#cb74-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>(z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="sc">-</span>z<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha)))</span></code></pre></div>
<pre><code>## [1] 0.800018</code></pre>
</div>
<div id="correlation" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Correlation</h3>
<p><span class="math display">\[
H_0: \rho \leq 0.25 \text { and } H_1: \rho&gt;0.25
\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="sample-size-calculation.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.r.test</span>(<span class="at">r =</span> <span class="fl">0.25</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      approximate correlation power calculation (arctangh transformation) 
## 
##               n = 133.2803
##               r = 0.25
##       sig.level = 0.05
##           power = 0.9
##     alternative = greater</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="sample-size-calculation.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate a series of correlation coefficients and power values</span></span>
<span id="cb78-2"><a href="sample-size-calculation.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb78-3"><a href="sample-size-calculation.html#cb78-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>)</span>
<span id="cb78-4"><a href="sample-size-calculation.html#cb78-4" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">length</span>(r)</span>
<span id="cb78-5"><a href="sample-size-calculation.html#cb78-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb78-6"><a href="sample-size-calculation.html#cb78-6" aria-hidden="true" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p)</span>
<span id="cb78-7"><a href="sample-size-calculation.html#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="sample-size-calculation.html#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取样本大小</span></span>
<span id="cb78-9"><a href="sample-size-calculation.html#cb78-9" aria-hidden="true" tabindex="-1"></a>samsize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nr <span class="sc">*</span> np), <span class="at">dim =</span> <span class="fu">c</span>(nr, np))</span>
<span id="cb78-10"><a href="sample-size-calculation.html#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="sample-size-calculation.html#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np) {</span>
<span id="cb78-12"><a href="sample-size-calculation.html#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nr) {</span>
<span id="cb78-13"><a href="sample-size-calculation.html#cb78-13" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">pwr.r.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">r =</span> r[j], <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb78-14"><a href="sample-size-calculation.html#cb78-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">power =</span> p[i], <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb78-15"><a href="sample-size-calculation.html#cb78-15" aria-hidden="true" tabindex="-1"></a>        samsize[j, i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb78-16"><a href="sample-size-calculation.html#cb78-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-17"><a href="sample-size-calculation.html#cb78-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="sample-size-calculation.html#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="sample-size-calculation.html#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建图形</span></span>
<span id="cb78-20"><a href="sample-size-calculation.html#cb78-20" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(r)</span>
<span id="cb78-21"><a href="sample-size-calculation.html#cb78-21" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samsize))</span>
<span id="cb78-22"><a href="sample-size-calculation.html#cb78-22" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb78-23"><a href="sample-size-calculation.html#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb78-24"><a href="sample-size-calculation.html#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Correlation Coefficient (r)&quot;</span>, </span>
<span id="cb78-25"><a href="sample-size-calculation.html#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Sample Size (n)&quot;</span>)</span>
<span id="cb78-26"><a href="sample-size-calculation.html#cb78-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-27"><a href="sample-size-calculation.html#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加功效曲线</span></span>
<span id="cb78-28"><a href="sample-size-calculation.html#cb78-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np) {</span>
<span id="cb78-29"><a href="sample-size-calculation.html#cb78-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(r, samsize[, i], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> colors[i])</span>
<span id="cb78-30"><a href="sample-size-calculation.html#cb78-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-31"><a href="sample-size-calculation.html#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fu">seq</span>(<span class="dv">0</span>, yrange[<span class="dv">2</span>], <span class="dv">50</span>), <span class="at">lty =</span> <span class="dv">2</span>, </span>
<span id="cb78-32"><a href="sample-size-calculation.html#cb78-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb78-33"><a href="sample-size-calculation.html#cb78-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="fu">seq</span>(xrange[<span class="dv">1</span>], xrange[<span class="dv">2</span>], <span class="fl">0.02</span>), </span>
<span id="cb78-34"><a href="sample-size-calculation.html#cb78-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb78-35"><a href="sample-size-calculation.html#cb78-35" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Sample Size Estimation for Correlation Studies</span><span class="sc">\n</span><span class="st">Sig=0.05 (Two-tailed)&quot;</span>)</span>
<span id="cb78-36"><a href="sample-size-calculation.html#cb78-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Power&quot;</span>, <span class="fu">as.character</span>(p), </span>
<span id="cb78-37"><a href="sample-size-calculation.html#cb78-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> colors)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Correlation%20test-1.png" width="672" /></p>
</div>
<div id="correlated-binary-data-ophthalmologic-studies" class="section level3" number="8.6.3">
<h3><span class="header-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</h3>
<ul>
<li><a href="https://sci-hub.se/10.1016/s0197-2456(01)00131-3">Sample Size and Power Calculations with Correlated Binary Data</a></li>
<li><a href="https://sci-hub.do/10.1001/archopht.1992.01080170112036">Sample Size Calculations for Ophthalmologic Studies</a></li>
</ul>
<p>It is assumed that one eye of each subject will be randomly assigned to receive eye-specific experimental treatments (such as extraocular muscle surgery), and the other eye will receive control treatments. This design will be very powerful when the correlation in the outcome measure between the eyes is reasonably high. However, this design assumes that the treatment of both eyes is pollution-free, and there is no generalized patient response, such as sympathetic ophthalmia. Such effects tend to obscure the differences between treatments.</p>
<p><strong>Two Eyes per Subject, Systemic Treatments</strong></p>
<p>Suppose that each patient will be random¬ ized to receive either a systemic, experimen¬ tal treatment (eg, oral steroids) or a placebo. Each subject will contribute two eyes to the analysis, and the within-subject outcomes are likely to be correlated. A measure of the correlation between eyes is the intraclass correlation coefficient, r, which has range of -1 to 1. Usually r is positive, indicating, for example, that the amount of visual field loss is high or low in both eyes, simultaneously. Most readers are familiar with the Pear¬ son Correlation Coefficient, commonly used and reported. Unlike the Pearson measure, the intraclass correlation coefficient is appli¬ cable only when both values for each subject are measured on the same scale and both have the same mean and SD.</p>
<ul>
<li>If all eyes are uncorrelated, a standard two-sample t-test can be used to detect group differences.</li>
<li>However, if there is a correlation between the eyes, the test will give invalid results, thereby making the null hypothesis more rejected. 5 Just divide the standard t-statistic by the square root of (1 + r) to calculate a valid t-test. In order to calculate the number of eyes required for each treatment group, we can use the following formula to calculate and then simply multiply it by the number (1 + r)</li>
</ul>
<p><span class="math display">\[n=(1+r)\left[2 s^{2}\left(z_{\alpha / 2}+z_{\beta}\right)^{2}\right] / d^{2}\]</span></p>
<p><strong>Mixed Single-Eye and Double-Eye Eligible Patients</strong></p>
<p>For systemic treatments, both one- and two-eye eligible patients could be included in the study. Sample size computation in this situation is only slightly more difficult. One computes the sample
size with formula (1) or formula (2) given above, as appropriate, and then multiplies the resulting
value by the factor
<span class="math display">\[
1+2 r p_{2} /\left(p_{1}+2 p_{2}\right)
\]</span>
where pi is the proportion of patients ex- pected to have one eye eligible, and <span class="math inline">\(\mathrm{p} 2=1\)</span> - pi is the
proportion of two-eye eligi- ble patients. This formula assumes that both treatment groups will
have the same ratio of unilateral to bilateral eligible patients</p>
</div>
</div>
<div id="multiple-test" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Multiple test</h2>
<p>Multiple comparisons and multiple testing procedures is their <strong>reduced power</strong>. Adjusted p-values are larger and simultaneous confidence intervals are wider, making it more difficult to reach firm conclusions. However, if you design your study with multiple inferences in mind, you can ensure that meaningful differences will be flagged as “statistically significant” with high probability, even when you use an MCP.</p>
<p>Power is <strong>not so easily defined</strong> in multiple testing situations as it is in single testing situations; there are multiple definitions, each of which is useful for different situations. Another difficulty lies in the complexity of the methods themselves: with complex closure-based methods, simply analyzing the data is difficult enough, let alone calculating power.</p>
<div id="definitions-of-power" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Definitions of Power</h3>
<p>In single testing situations, power is defined as the probability of correctly rejecting a false null hypothesis, that is, the probability of correctly “finding significance.” More precisely,</p>
<p>Power <span class="math inline">\(=P\left(\right.\)</span> reject <span class="math inline">\(H_{0} \mid H_{0}\)</span> is false).</p>
<p>To perform this calculation, you must specify the condition ” <span class="math inline">\(H_{0}\)</span> is false” precisely.</p>
<p>In multiple testing and multiple comparisons applications, power is more complex since there are multiple parameters with multiple null hypotheses <span class="math inline">\(H_{0 i}\)</span>. Definitions include</p>
<ul>
<li>Complete Power <span class="math inline">\(=P\left(\right.\)</span> reject all <span class="math inline">\(H_{0 i}\)</span> that are false)</li>
<li>Minimal Power <span class="math inline">\(=P\left(\right.\)</span> reject at least one <span class="math inline">\(H_{0 i}\)</span> that is false)</li>
<li>Individual Power <span class="math inline">\(=P\left(\right.\)</span> reject a particular <span class="math inline">\(H_{0 i}\)</span> that is false)</li>
<li>Proportional Power = Expected Proportion of false <span class="math inline">\(H_{0 i}\)</span> that are rejected.</li>
</ul>
<p>A simple example illustrates that these power measures vary greatly. Suppose you plan to test hypotheses <span class="math inline">\(H_{1}, H_{2}, H_{3}\)</span>, and <span class="math inline">\(H_{4}\)</span> using independent tests whose powers (individually) are <span class="math inline">\(0.5,0.5\)</span>, <span class="math inline">\(0.8\)</span>, and <span class="math inline">\(0.8\)</span> respectively. Then</p>
<ul>
<li>Complete Power <span class="math inline">\(=0.5 \times 0.5 \times 0.8 \times 0.8=0.16\)</span></li>
<li>Minimal Power <span class="math inline">\(=1-(1-0.5) \times(1-0.5) \times(1-0.8) \times(1-0.8)=0.99\)</span></li>
<li>Individual Power <span class="math inline">\(=0.5\)</span> (say, assuming <span class="math inline">\(H_{1}\)</span> is the test of interest)</li>
<li>Proportional Power <span class="math inline">\(=(0.5+0.5+0.8+0.8) / 4=0.65\)</span></li>
</ul>
<p><strong>Complete Power</strong></p>
<p>Complete power appears the most attractive, since you obviously would like to reject all false hypotheses. However, compared to the rejection probability for an individual false hypothesis, it is relatively unlikely that you will reject all false hypotheses.</p>
<p>Nevertheless, complete power is required in some cases. For example, if a combination of two pharmaceutical products is to be approved for general use, it should be shown as superior to both individual products. Thus, both null hypotheses must be rejected. As discussed in a report from the International Conference for Harmonisation Guidelines on Statistical Principles for Clinical Trials (ICH, 1998), “If the purpose of the trial is to demonstrate effects on all of the designated primary variables, then there is no need for adjustment of the type I error, but the impact on type II error and sample size should be carefully considered.”</p>
<p><strong>Minimal Power</strong></p>
<p>Minimal power tells you the probability that you will find at least one significant result in your study, among hypotheses that are truly false. If your study only requires that at least one effect be demonstrated, then you should use minimal power.</p>
<p>This might occur, for example, in an <strong>early phase of development of a pharmaceutical product</strong>, where only a “proof of concept” is needed. If it can be shown that the product has at least some effect, then proof of concept is shown. Minimal power is also useful because it corresponds to the FWE rate: when the alternative differences all tend toward zero, the minimal power tends toward FWE. As with the complete power, computing the minimal power requires that you specify all the alternatives precisely; and again, while exact computations are infeasible, simulation yields results that are accurate enough for design purposes.</p>
<p><strong>Individual Power</strong></p>
<p>Among the various methods, individual power is the easiest to calculate, since it is just like “ordinary” power, except with multiplicity-adjusted critical values. Also, it can be calculated exactly, without resorting to simulations.</p>
<ul>
<li>Tests use critical points from MCPs: primary endpoint.</li>
<li>Just interested in one hypothesis, then you can test that one without any multiplicity adjustment, and you can use ordinary power calculations.</li>
</ul>
</div>
<div id="bonferroni-tests-individual-power" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</h3>
<p>Bonferroni <span class="math inline">\(\alpha / k\)</span> rather than the usual <span class="math inline">\(\alpha\)</span> is used for Test. Suppose you have a number <span class="math inline">\((k)\)</span> of <span class="math inline">\(t\)</span> statistics of the form
<span class="math display">\[
t=\frac{\bar{y}-\bar{x}}{\hat{\sigma} \sqrt{2 / n}}
\]</span>
so that a Bonferroni rejection is given by
<span class="math display">\[
|t|&gt;t_{1-\alpha^{\prime} / 2, d f e}
\]</span>
where <span class="math inline">\(\alpha=\alpha / k\)</span> and <span class="math inline">\(d f e=2 n-2\)</span>. To calculate the rejection probability, use the fact that <span class="math inline">\(t\)</span> has the noncentral Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(d f e=2 n-2\)</span> and noncentrality parameter
<span class="math display">\[
\Delta=(\delta / \sigma) \sqrt{n / 2}
\]</span>
where <span class="math inline">\(\delta=\mu_{y}-\mu_{x}\)</span>.</p>
<pre><code>%let MuDiff = 5;
%let Sigma = 10.0;
%let alpha = .05;
%let k = 4;
ods graphics on;
proc power;
 twosamplemeans
 meandiff = &amp;MuDiff
 stddev = &amp;Sigma
 alpha = %sysevalf(&amp;alpha / &amp;k)
 npergroup = 2 to 100 by 2
 power = .;
 plot x=n markers=analysis
 yopts=(ref=.8 crossref=yes);
run;
ods graphics off; </code></pre>
</div>
<div id="tukeys-method-individual-power" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> Tukey’s method (Individual Power)</h3>
<blockquote>
<p>in balanced one-way ANOVA for all pairwise comparisons</p>
</blockquote>
<p>To detect a significant difference between <span class="math inline">\(\mu_{i}\)</span> and <span class="math inline">\(\mu_{i^{\prime}}\)</span>, you must have
<span class="math display">\[
\left|t_{i, i^{\prime}}\right|=\left|\frac{\bar{y}_{i}-\bar{y}_{i^{\prime}}}{\hat{\sigma} \sqrt{2 / n}}\right|&gt;c_{\alpha}
\]</span>
where
<span class="math display">\[
c_{\alpha}=\frac{q_{1-\alpha, g, g(n-1)}^{R}}{\sqrt{2}}
\]</span>
is the critical value used for Tukey’s method. To calculate these probabilities, again note that <span class="math inline">\(t_{i, i^{\prime}}\)</span> has the noncentral Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(d f e=g(n-1)\)</span> and noncentrality parameter
<span class="math display">\[
\Delta=(\delta / \sigma) \sqrt{n / 2}
\]</span>
In order to compute the individual power for single-step Tukey tests, you need to specify the following:</p>
<ul>
<li><span class="math inline">\(d\)</span> is the “meaningful difference”</li>
<li><span class="math inline">\(\sigma\)</span> is an estimate (or guess) of the within-group standard deviation of the response</li>
<li><span class="math inline">\(g\)</span> is the number of groups</li>
<li><span class="math inline">\(n\)</span> is the within-group sample size</li>
<li><span class="math inline">\(\alpha\)</span> is the desired FWE level</li>
</ul>
<pre><code>%IndividualPower(
MCP = RANGE, /* RANGE, DUNNETT2, DUNNETT1, OR MAXMOD */
g = 5, /* number of groups (exclude control for DUNNETT) */
d = 4, /* meaningful mean difference */
s = 3 /* estimate (guess) of standard deviation */
 ); </code></pre>
</div>
<div id="dunnetts-two-sided-tests-individual-power" class="section level3" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</h3>
<p>In order to detect a significant difference for a particular <span class="math inline">\(\mu_{i}-\mu_{0}\)</span> comparison when <span class="math inline">\(\mu_{i}-\mu_{0}=d\)</span>. Again, the value <span class="math inline">\(d\)</span> is a specified number that is a “meaningful” difference in the particular problem context. Then you need
<span class="math display">\[
\left|t_{i 0}\right|=\left|\frac{\bar{y}_{i}-\bar{y}_{0}}{\hat{\sigma} \sqrt{2 / n}}\right|&gt;q_{1-\alpha, g,(g+1)(n-1)}^{D 2}
\]</span>
to reject a hypothesis, and the power of the test, using the Individual Power definition, is the probability of this event. To calculate these probabilities, use the fact that the distribution of <span class="math inline">\(\left|t_{i 0}\right|\)</span> is non-central Student’s <span class="math inline">\(t\)</span> with <span class="math inline">\(d f e=(g+1)(n-1)\)</span> and noncentrality parameter as given above by <span class="math inline">\(\Delta\)</span>.</p>
<p>For example, suppose that you have <span class="math inline">\(g=6\)</span> groups (excluding control), and you want to detect a difference of <span class="math inline">\(\mu_{i}-\mu_{0}=5\)</span> for a particular comparison, and guess that the standard deviation of the measurement is <span class="math inline">\(\sigma=3.5\)</span>.</p>
<pre><code>%IndividualPower(MCP = DUNNETT2,
 G = 6 ,
 D = 5 ,
 S = 3.5 ); </code></pre>
</div>
<div id="combined-power-simpower-and-plotsimpower" class="section level3" number="8.7.5">
<h3><span class="header-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</h3>
<p>Complete, minimal, and proportional power involve several hypotheses simultaneously. As such, their calculations are complicated by the fact that they depend on the <strong>specific alternative settings for all non-null hypotheses</strong>, not just the alternative setting for a particular test of interest. Calculations are further complicated for complete and proportional power because they require the <strong>multivariate non-central distribution of the test statistics</strong>. The result of this complication is that calculating the power analytically is often infeasible for the combined power definitions. However, as in the case of computing the tests themselves, <strong>simulation</strong> can yield useful, if slightly imprecise, results.</p>
<pre><code>%SimPower(method = &lt;value&gt; ,
 nrep = &lt;number&gt; ,
 n = &lt;number&gt; or &lt;(n1,n2,...)&gt; ,
 s = &lt;number&gt; ,
 FWE = &lt;number&gt; ,
 TrueMeans = &lt;(m1,m2,...)&gt; ,
 seed = &lt;value&gt; );</code></pre>
<ul>
<li>METHOD is the multiple comparisons method, whether
<ul>
<li>all pairwise comparisons (METHOD = TUKEY, the default)</li>
<li>two-sided comparisons with control (METHOD = DUNNETT)</li>
<li>one-sided comparisons with a control (either METHOD = DUNNETTL or METHOD = DUNNETTU) or REGWQ</li>
<li>specify SIMULATE, so long as you also specify DIFF= to say what types of diffs, and you can also include STEPDOWN(TYPE= ), where the TYPE= variable is LOGICAL, LOGICAL(0), LOGICAL(1),…, or FREE</li>
</ul></li>
<li>NREP is the number of simulations, with 1000 as the default.</li>
<li>N is the within-group sample size (if equal) or list of within-group sample sizes (if unequal).</li>
<li>S is the underlying population standard deviation</li>
<li>FWE is the desired FWE, with 0.05 as the default.</li>
<li>TRUEMEANS lists the true group means.</li>
<li>SEED is the seed value, with 0 (computer clock time) as the default.</li>
</ul>
<p>%PlotSimPower macro to Simulate and Graph Combined Power</p>
<pre><code>%PlotSimPower(method = &lt;value&gt; ,
 nrep = &lt;number&gt; ,
 s = &lt;number&gt; ,
 FWE = &lt;number&gt; ,
 TrueMeans = &lt;(m1,m2,...)&gt; ,
 seed = &lt;value&gt; ,
 stop = &lt;value&gt;/&lt;number&gt; ,
 target = &lt;value&gt; ); </code></pre>
<ul>
<li>STOP specifies the target value of a given type of power that will be used as a stopping criterion. The syntax is type/max, where type is either Complete, Minimal, or Proportional, and where max is a maximum power at which to stop the simulation. The default is Complete/0.9, meaning that the simulation stops at the sample size n for which the complete power is greater than or equal to 0.9 (with 95% confidence).</li>
<li>TARGET is the desired power level. The default is 0.8.</li>
</ul>
<div id="all-pairwise-comparisons" class="section level4" number="8.7.5.1">
<h4><span class="header-section-number">8.7.5.1</span> <strong>All Pairwise Comparisons</strong></h4>
<pre><code>%SimPower(TrueMeans = (10, 5, 5, 0, 0),
 S = 5 ,
 N = 10 ,
 Seed = 12345 );</code></pre>
</div>
<div id="logically-constrained-step-down-tests" class="section level4" number="8.7.5.2">
<h4><span class="header-section-number">8.7.5.2</span> <strong>logically constrained step-down tests</strong></h4>
<pre><code>%SimPower(TrueMeans = (10,5,5,0,0) ,
 S = 5 ,
 N = 20 ,
 Seed = 12345 ,
 method = Simulate diff=All Stepdown(Type=Logical));</code></pre>
</div>
<div id="dunnett-comparisons-with-a-control-two-sided" class="section level4" number="8.7.5.3">
<h4><span class="header-section-number">8.7.5.3</span> <strong>DUNNETT Comparisons with a Control Two-Sided</strong></h4>
<pre><code>%SimPower(TrueMeans =(10,5,5,0,0),
 S = 5 ,
 N = 10 ,
 Seed = 12345 ,
 Method = DUNNETT );
 
*** Method = DUNNETTL One-Sided Comparisons with a Control</code></pre>
<p>Method=TUKEY, Nominal FWE=0.05, Seed=12345, True means = (-.1, -.2, .1, .05), n=2, s=500 Seed=12345, nrep=4000</p>
<p><span class="math display">\[
\begin{array}{lcc}
\hline \text { Quantity } &amp; \text { Estimate } &amp; --95 \% \mathrm{Cl}-\mathrm{-}- \\
\text { Complete Power } &amp; 0.00000 &amp; (0.000,0.000) \\
\text { Minimal Power } &amp; 0.04525 &amp; (0.039,0.052) \\
\text { Proportional Power } &amp; 0.01425 &amp; (0.012,0.017) \\
\text { Directional FWE } &amp; 0.02775 &amp; (0.023,0.033) \\
\hline
\end{array}
\]</span></p>
<pre><code>%PlotSimPower(TrueMeans = (10,5,5,0,0),
 S = 5 ,
 Seed = 12345 ,
 Method = Dunnett ); </code></pre>
<div class="figure" style="text-align: center">
<img src="02_Plots/Dunnett_Power.PNG" alt="Figure: Plotting Simulated Complete Power of Two-Sided Comparisons with a Control" width="100%" />
<p class="caption">
(#fig:Plotting Simulated Complete Power)Figure: Plotting Simulated Complete Power of Two-Sided Comparisons with a Control
</p>
</div>
</div>
<div id="step-down-dunnett" class="section level4" number="8.7.5.4">
<h4><span class="header-section-number">8.7.5.4</span> <strong>Step-down Dunnett</strong></h4>
<pre><code>%SimPower(TrueMeans = (10,5,5,0,0) ,
 S = 5 ,
 N = 20 ,
 Seed = 12345 ,
 Method = SIMULATE DIFF=CONTROLL STEPDOWN); </code></pre>
</div>
</div>
<div id="dunnett-set-up-close-tests-in-r" class="section level3" number="8.7.6">
<h3><span class="header-section-number">8.7.6</span> Dunnett Set up Close Tests in R</h3>
<p><strong>Assumptions</strong>:</p>
<ol style="list-style-type: decimal">
<li>The k treatment groups have identical treatment effect size.</li>
<li>The sample allocation ratio is pre-specified, and meanwhile the samples to be assigned to each of the k treatment groups are expected to be equal at size n. </li>
<li>The alternative hypotheses are one-sided.</li>
</ol>
<p>With the violations assumption 2, the sample size could not be evaluated numerically, and with the violation of assumption 1 and 3, the evaluation of sample size needs great computational effort and thus not implemented. In the situation, simulation-based evaluation is suggested.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="sample-size-calculation.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## https://cran.r-project.org/web/packages/DunnettTests/DunnettTests.pdf</span></span>
<span id="cb89-2"><a href="sample-size-calculation.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;DunnettTests&#39;</span>)</span>
<span id="cb89-3"><a href="sample-size-calculation.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="do">## comparing means of k treatment groups to the mean of one control group</span></span>
<span id="cb89-4"><a href="sample-size-calculation.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The k treatment groups have identical treatment effect size.</span></span>
<span id="cb89-5"><a href="sample-size-calculation.html#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="do">## The alternative hypotheses are one-sided.</span></span>
<span id="cb89-6"><a href="sample-size-calculation.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nvDT</span>(<span class="at">ratio=</span><span class="dv">1</span>, <span class="at">power=</span><span class="fl">0.9</span>, <span class="at">r=</span><span class="dv">1</span>, <span class="at">k=</span><span class="dv">2</span>, <span class="at">mu=</span><span class="fl">0.0606</span>, <span class="at">mu0=</span><span class="sc">-</span><span class="fl">0.039</span>, <span class="at">contrast=</span><span class="st">&quot;means&quot;</span>, </span>
<span id="cb89-7"><a href="sample-size-calculation.html#cb89-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">sigma =</span> <span class="fl">0.1188</span>,</span>
<span id="cb89-8"><a href="sample-size-calculation.html#cb89-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">dist=</span><span class="st">&quot;zdist&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">testcall=</span><span class="st">&quot;SU&quot;</span>)</span></code></pre></div>
<pre><code>## $`least sample size required in each treatment groups`
## [1] 25
## 
## $`least sample size required in the control group`
## [1] 25</code></pre>
</div>
</div>
<div id="time-to-event-data" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Time-To-Event Data</h2>
<div id="cox-ph-2-sided-equality" class="section level3" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> Cox PH, 2-Sided Equality</h3>
<p>The hazard ratio is then the ratio of the hazards between two groups. Letting <span class="math inline">\(\theta\)</span> represent the hazard ratio, the hypotheses of interest are
<span class="math display">\[
\begin{array}{l}
H_{0}: \theta=\theta_{0} \\
H_{1}: \theta \neq \theta_{0}
\end{array}
\]</span>
where <span class="math inline">\(\theta_{0}\)</span> is the hazard ratio hypothesized under the null hypothesis. <span class="math inline">\(p_E\)</span> is the overall probability of the event occurring within the study period. <span class="math inline">\(p_{A}\)</span> and <span class="math inline">\(p_{B}\)</span> are the proportions of the sample size allotted to the two groups, named ‘A’ and ‘B’</p>
<p><span class="math display">\[
n=\frac{1}{p_{A} p_{B} p_{E}}\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\ln (\theta)-\ln \left(\theta_{0}\right)}\right)^{2}
\]</span>
<span class="math display">\[
1-\beta=\Phi\left(z-z_{1-\alpha / 2}\right)+\Phi\left(-z-z_{1-\alpha / 2}\right) \quad, \quad z=\left(\ln (\theta)-\ln \left(\theta_{0}\right)\right) \sqrt{n p_{A} p_{B} p_{E}}
\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="sample-size-calculation.html#cb91-1" aria-hidden="true" tabindex="-1"></a>hr<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb91-2"><a href="sample-size-calculation.html#cb91-2" aria-hidden="true" tabindex="-1"></a>hr0<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb91-3"><a href="sample-size-calculation.html#cb91-3" aria-hidden="true" tabindex="-1"></a>pE<span class="ot">=</span><span class="fl">0.8</span></span>
<span id="cb91-4"><a href="sample-size-calculation.html#cb91-4" aria-hidden="true" tabindex="-1"></a>pA<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb91-5"><a href="sample-size-calculation.html#cb91-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb91-6"><a href="sample-size-calculation.html#cb91-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="fl">0.20</span></span>
<span id="cb91-7"><a href="sample-size-calculation.html#cb91-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">n=</span>((<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">/</span>(<span class="fu">log</span>(hr)<span class="sc">-</span><span class="fu">log</span>(hr0)))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">*</span>pE))</span></code></pre></div>
<pre><code>## [1] 81.68207</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="sample-size-calculation.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(n) </span></code></pre></div>
<pre><code>## [1] 82</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="sample-size-calculation.html#cb95-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Power=</span><span class="fu">pnorm</span>((<span class="fu">log</span>(hr)<span class="sc">-</span><span class="fu">log</span>(hr0))<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="sc">*</span>pA<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pA)<span class="sc">*</span>pE)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
</div>
<div id="log-rank-tests-for-competing-risks" class="section level3" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</h3>
<p><a href="https://ncss-wpengine.netdna-ssl.com/wp-content/themes/ncss/pdf/Procedures/PASS/Logrank_Tests_Accounting_for_Competing_Risks.pdf">Logrank Tests Accounting for Competing Risks</a>: Clinical trials are often designed to test the equality of two survival distributions. The two-sample t-test is not appropriate in this case because time-to-event data is usually not normally distributed and many individuals survive past the end of the study, resulting in censored observations. Instead, the logrank test is used to compare the two survival distributions because it is easy to apply and is usually more powerful than an analysis based simply on proportions. It compares survival across the whole spectrum of time, not at just one or two points, and accounts for censoring. When analyzing time-to-event data and calculating power and sample size, a complication arises when individuals in the study die from risk factors that are not directly related to the risk factor of interest. For example, a researcher may wish to determine if a new drug for some disease improves patient survival time when compared to a standard treatment. Therefore, the researchers would be interested to know how long each patient lives until he or she dies from the disease. However, during the course of the study, patients may also die from other risks such as myocardial infarction, diabetes, or even an accident. When a patient dies from one of these other risk factors, then the main event of interest cannot be observed, so the true time-to-event of the disease for that patient can never be determined. In this example the main event of interest would be death directly attributable to the disease. All of the other types of death are called competing risks.</p>
<p><strong>Assumptions</strong></p>
<p>The power and sample size calculations in the module for the logrank test are based on the following assumptions:</p>
<ul>
<li>Failure times for the event of interest and competing risks are independent.</li>
<li>Failure times are exponentially distributed.</li>
<li>Uniform entry of subjects into the trial during the accrual period</li>
</ul>
<p><strong>Cumulative Incidence Function</strong></p>
<ol style="list-style-type: decimal">
<li><p>在没有竞争风险且没有指数假设的情况下，在时间 <span class="math inline">\(T_{0}\)</span>, 第 <span class="math inline">\(i\)</span> 组的兴趣事件为
<span class="math display">\[
F_{e v, i}\left(T_{0}\right)=1-\exp \left\{-T_{0} \times h_{e v, i}\right\}
\]</span>
where <span class="math inline">\(h_{e v, i}\)</span> is the hazard rate for the event of interest in group <span class="math inline">\(i\)</span>.
注意, 在没有竞争风险的情况下
<span class="math display">\[
F_{e v, i}\left(T_{0}\right)=1-S_{e v, i}\left(T_{0}\right)
\]</span>
<span class="math inline">\(S_{e v, i}\left(T_{0}\right)\)</span> is the cumulative survival function</p></li>
<li><p>在存在竞争风险的情况下，在时间 <span class="math inline">\(T_{0}\)</span> 的第 <span class="math inline">\(i\)</span> 组中
感兴趣事件的累积发生率函数为
<span class="math display">\[
F_{e v, i}(T 0)=\frac{h_{e v, i}}{h_{e v, i}+h_{c r, i}}\left(1-\exp \left\{-T 0 \times\left(h_{e v, i}+h_{c r, i}\right)\right\}\right)
\]</span>
<span class="math inline">\(h_{c r, i}\)</span> is the hazard rate for competing risks in group <span class="math inline">\(i\)</span>.
竞争风险的累积发生率函数为
<span class="math display">\[
F_{c r, i}(T 0)=\frac{h_{c r, i}}{h_{e v, i}+h_{c r, i}}\left(1-\exp \left\{-T 0 \times\left(h_{e v, i}+h_{c r, i}\right)\right\}\right)
\]</span>
<span class="math inline">\(h_{e v, i}\)</span> is the hazard rate for the event of interest in group <span class="math inline">\(i\)</span>.</p></li>
<li><p>通过求解该方程组, 可从累积发生率计算 <span class="math inline">\(i\)</span> 组中的危险率
<span class="math display">\[
\begin{array}{l}
h_{e v, i}=F_{e v, i}(T 0) \times\left(\frac{-\ln \left(1-F_{e v, i}(T 0)-F_{c r, i}(T 0)\right)}{T 0 \times\left(F_{e v, i}(T 0)+F_{c r, i}(T 0)\right)}\right) \\
h_{c r, i}=F_{c r, i}(T 0) \times\left(\frac{-\ln \left(1-F_{e v, i}(T 0)-F_{c r, i}(T 0)\right)}{T 0 \times\left(F_{e v, i}(T 0)+F_{c r, i}(T 0)\right)}\right)
\end{array}
\]</span></p></li>
</ol>
<p><strong>Cumulative Survival Function</strong></p>
<p><span class="math display">\[
\begin{array}{l}
S_{e v, i}(T 0)=\exp \left\{-T 0 \times h_{e v, i}\right\} \\
S_{c r, i}(T 0)=\exp \left\{-T 0 \times h_{c r, i}\right\}
\end{array}
\]</span>
The cumulative survival function is often estimated non-parametrically using the Kaplan-Meier curve. The
hazard rates for the event of interest and competing risks in group <span class="math inline">\(i\)</span> are calculated from the cumulative
survival functions as
<span class="math display">\[
\begin{array}{l}
h_{e v, i}=\left(\frac{-\ln \left(S_{e v, i}(T 0)\right)}{T 0}\right) \\
h_{c r, i}=\left(\frac{-\ln \left(S_{c r, i}(T 0)\right)}{T 0}\right)
\end{array}
\]</span></p>
<p><strong>Hazard Ratio</strong></p>
<p>Hazard rate for the treatment group divided by the hazard rate for the control group.
<span class="math display">\[H R=\left(\frac{h_{e v, 2}}{h_{e v, 1}}\right)\]</span></p>
<p><strong>Probability of Event</strong></p>
<p>With the risk rate of the event of interest and the competitive risk, the probability of observing the event of interest in the <span class="math inline">\(i\)</span> group<span class="math inline">\(\operatorname{Pr}_{e v, i}\)</span> 为:
<span class="math display">\[
\operatorname{Pr}_{e v, i}=\frac{h_{e v, i}}{h_{e v, i}+h_{c r, i}}\left(1-\frac{\exp \left\{-(T-R) \times\left(h_{e v, i}+h_{c r, i}\right)\right\}-\exp \left\{-T \times\left(h_{e v, i}+h_{c r, i}\right)\right\}}{R \times\left(h_{e v, i}+h_{c r, i}\right)}\right)
\]</span>
- <span class="math inline">\(T\)</span> is the total time of trial
- <span class="math inline">\(R\)</span> is the accrual time.
- The follow-up time is calculated as <span class="math inline">\(T-R\)</span>.
The overall probability of observing the event of interest during the study in both groups is given as
<span class="math display">\[
\operatorname{Pr}_{e v}=p_{1} \operatorname{Pr}_{e v, 1}+\left(1-p_{1}\right) \operatorname{Pr}_{e v, 2}
\]</span>
where <span class="math inline">\(p_{1}\)</span> is the proportion of subjects in the group <span class="math inline">\(\$ 1, \$\)</span> the control group.</p>
<p><strong>Number of Events</strong></p>
<ul>
<li>The total required number of events (for the event of interest), <span class="math inline">\(E\)</span></li>
<li>The number of events in group <span class="math inline">\(i\)</span> is <span class="math inline">\(E_{i}\)</span>
<span class="math display">\[
\begin{array}{l}
E=N \times \operatorname{Pr}_{e v} \\
E_{i}=n_{i} \times \operatorname{Pr}_{e v, i}
\end{array}
\]</span></li>
</ul>
<p><strong>Logrank Test Statistic</strong></p>
<p>The power and sample size formulas presented below are for the logrank test statistic, which is given by
<span class="math display">\[
L=\frac{\sum_{k=1}^{E}\left(I_{k}-\frac{Y_{1 i}}{Y_{1 i}+Y_{2 i}}\right)}{\left[\sum_{k=1}^{E}\left(\frac{Y_{1 i} Y_{2 i}}{\left(Y_{1 i}+Y_{2 i}\right)^{2}}\right)\right]^{-1 / 2}}
\]</span></p>
<ul>
<li><span class="math inline">\(E\)</span> 感兴趣类型的事件数</li>
<li><span class="math inline">\(Y_{i j}\)</span> 观察到的事件之前处于风险中的主体数prior to the <span class="math inline">\(j^{\text {th }}\)</span> in the <span class="math inline">\(i^{\text {th }}\)</span> group,</li>
<li><span class="math inline">\(I_{k}\)</span> is is a binary variable indicating whether the <span class="math inline">\(k^{\text {th }}\)</span> event of the type of interest is from group 1 or
not.</li>
<li><span class="math inline">\(L\)</span> 遵循标准正态分布</li>
</ul>
<p><strong>Power and Sample Size Calculations</strong></p>
<p>The power can be calculated using</p>
<p><span class="math display">\[
z_{1-\beta}=(-) \sqrt{E \times p_{1}\left(1-p_{1}\right)} \log (H R)-z_{1-\alpha / 2}
\]</span>
- <span class="math inline">\(p_{1}\)</span> proportion of subjects in group 1, the control group
- <span class="math inline">\(E\)</span> total number of events for the risk factor of interest</p>
<p><span class="math display">\[
E=\left(\frac{1}{p_{1}\left(1-p_{1}\right)}\right) \times\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\log (H R)}\right)^{2}
\]</span>
The overall sample size can be computed from <span class="math inline">\(E\)</span> and <span class="math inline">\(\operatorname{Pr}_{e v}\)</span> as
<span class="math display">\[
N=\frac{E}{\operatorname{Pr}_{e v}}=\left(\frac{1}{p_{1}\left(1-p_{1}\right) \times \operatorname{Pr}_{e v}}\right) \times\left(\frac{z_{1-\alpha / 2}+z_{1-\beta}}{\log (H R)}\right)^{2}
\]</span>
The individual group sample sizes are calculated as
<span class="math display">\[
\begin{array}{l}
n_{1}=N \times p_{1} \\
n_{2}=N \times\left(1-p_{1}\right)
\end{array}
\]</span></p>
<p>Considering the loss to Follow-Up, <span class="math inline">\(W\)</span> is the proportion lost to follow-up.
<span class="math display">\[
N_{\text {adjusted }}=\frac{N}{(1-W)}
\]</span></p>
<p><strong>R Implementation</strong></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="sample-size-calculation.html#cb97-1" aria-hidden="true" tabindex="-1"></a>LogrankCR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(local, beta, S_ev1, S_ev2, S_cr, P1, P2, T, R, w, alpha_2){</span>
<span id="cb97-2"><a href="sample-size-calculation.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Quantile from standard normal distribution</span></span>
<span id="cb97-3"><a href="sample-size-calculation.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  z_power <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>beta, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb97-4"><a href="sample-size-calculation.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  z_local <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>local, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb97-5"><a href="sample-size-calculation.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-6"><a href="sample-size-calculation.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Hazard Ratio</span></span>
<span id="cb97-7"><a href="sample-size-calculation.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  H_ev1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_ev1)<span class="sc">/</span>T</span>
<span id="cb97-8"><a href="sample-size-calculation.html#cb97-8" aria-hidden="true" tabindex="-1"></a>  H_ev2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_ev2)<span class="sc">/</span>T</span>
<span id="cb97-9"><a href="sample-size-calculation.html#cb97-9" aria-hidden="true" tabindex="-1"></a>  H_cr <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(S_cr)<span class="sc">/</span>T</span>
<span id="cb97-10"><a href="sample-size-calculation.html#cb97-10" aria-hidden="true" tabindex="-1"></a>  HR <span class="ot">&lt;-</span> H_ev2<span class="sc">/</span>H_ev1</span>
<span id="cb97-11"><a href="sample-size-calculation.html#cb97-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-12"><a href="sample-size-calculation.html#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Probability of observing event of interest in the group</span></span>
<span id="cb97-13"><a href="sample-size-calculation.html#cb97-13" aria-hidden="true" tabindex="-1"></a>  P_ev1 <span class="ot">&lt;-</span> (H_ev1<span class="sc">/</span>(H_ev1<span class="sc">+</span>H_cr))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>((<span class="fu">exp</span>(<span class="sc">-</span>(T<span class="sc">-</span>R)<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr))<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>T<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr)))<span class="sc">/</span>(R<span class="sc">*</span>(H_ev1<span class="sc">+</span>H_cr))))</span>
<span id="cb97-14"><a href="sample-size-calculation.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  P_ev2 <span class="ot">&lt;-</span> (H_ev2<span class="sc">/</span>(H_ev2<span class="sc">+</span>H_cr))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>((<span class="fu">exp</span>(<span class="sc">-</span>(T<span class="sc">-</span>R)<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr))<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>T<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr)))<span class="sc">/</span>(R<span class="sc">*</span>(H_ev2<span class="sc">+</span>H_cr))))</span>
<span id="cb97-15"><a href="sample-size-calculation.html#cb97-15" aria-hidden="true" tabindex="-1"></a>  P_ev <span class="ot">&lt;-</span> P1<span class="sc">*</span>P_ev1<span class="sc">+</span>P2<span class="sc">*</span>P_ev2</span>
<span id="cb97-16"><a href="sample-size-calculation.html#cb97-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-17"><a href="sample-size-calculation.html#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sample size without follow up lost</span></span>
<span id="cb97-18"><a href="sample-size-calculation.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>(P1<span class="sc">*</span>P2<span class="sc">*</span>P_ev))<span class="sc">*</span>(((z_local<span class="sc">+</span>z_power)<span class="sc">/</span><span class="fu">log</span>(HR))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb97-19"><a href="sample-size-calculation.html#cb97-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-20"><a href="sample-size-calculation.html#cb97-20" aria-hidden="true" tabindex="-1"></a>  N_Total <span class="ot">&lt;-</span> N<span class="sc">/</span>t</span>
<span id="cb97-21"><a href="sample-size-calculation.html#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## total number of events for the risk factor of interest</span></span>
<span id="cb97-22"><a href="sample-size-calculation.html#cb97-22" aria-hidden="true" tabindex="-1"></a>  E <span class="ot">&lt;-</span> N_Total<span class="sc">*</span>P_ev</span>
<span id="cb97-23"><a href="sample-size-calculation.html#cb97-23" aria-hidden="true" tabindex="-1"></a>  Z_final_Power <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sqrt</span>(E<span class="sc">*</span>P1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>P1))<span class="sc">*</span><span class="fu">log</span>(HR)<span class="sc">-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha_2, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb97-24"><a href="sample-size-calculation.html#cb97-24" aria-hidden="true" tabindex="-1"></a>  final_Power <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(Z_final_Power, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb97-25"><a href="sample-size-calculation.html#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="sample-size-calculation.html#cb97-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-27"><a href="sample-size-calculation.html#cb97-27" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">ceiling</span>(N<span class="sc">*</span>P1<span class="sc">*</span>P_ev1), <span class="fu">ceiling</span>(N<span class="sc">*</span>P2<span class="sc">*</span>P_ev2),</span>
<span id="cb97-28"><a href="sample-size-calculation.html#cb97-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">*</span>P1), <span class="fu">ceiling</span>(N<span class="sc">*</span>P2),</span>
<span id="cb97-29"><a href="sample-size-calculation.html#cb97-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">*</span>P1)<span class="sc">+</span> <span class="fu">ceiling</span>(N<span class="sc">*</span>P2), </span>
<span id="cb97-30"><a href="sample-size-calculation.html#cb97-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">*</span>P1<span class="sc">/</span>t)<span class="sc">+</span><span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">*</span>P2<span class="sc">/</span>t),</span>
<span id="cb97-31"><a href="sample-size-calculation.html#cb97-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">round</span>(final_Power<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),</span>
<span id="cb97-32"><a href="sample-size-calculation.html#cb97-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1), <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2),</span>
<span id="cb97-33"><a href="sample-size-calculation.html#cb97-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1)<span class="sc">+</span> <span class="fu">ceiling</span>(N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2),</span>
<span id="cb97-34"><a href="sample-size-calculation.html#cb97-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P1<span class="sc">/</span>t)<span class="sc">+</span> <span class="fu">ceiling</span>((<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>N<span class="sc">/</span>(<span class="dv">1</span><span class="fl">-0.25</span>)<span class="sc">*</span>P2<span class="sc">/</span>t))</span>
<span id="cb97-35"><a href="sample-size-calculation.html#cb97-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb97-36"><a href="sample-size-calculation.html#cb97-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-37"><a href="sample-size-calculation.html#cb97-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-38"><a href="sample-size-calculation.html#cb97-38" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="cf">function</span>(final_alpha, IIIA, IIIB, IIIC_HR, IIIC_LR){</span>
<span id="cb97-39"><a href="sample-size-calculation.html#cb97-39" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.0083</span></span>
<span id="cb97-40"><a href="sample-size-calculation.html#cb97-40" aria-hidden="true" tabindex="-1"></a>  local <span class="ot">&lt;-</span> alpha<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>t)</span>
<span id="cb97-41"><a href="sample-size-calculation.html#cb97-41" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(<span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIA,    <span class="at">S_ev2=</span><span class="fl">0.90</span>,    <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.4</span>, <span class="at">P2=</span><span class="fl">0.6</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha),</span>
<span id="cb97-42"><a href="sample-size-calculation.html#cb97-42" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIB,    <span class="at">S_ev2=</span><span class="fl">0.90</span>,    <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.6</span>, <span class="at">P2=</span><span class="fl">0.4</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha),</span>
<span id="cb97-43"><a href="sample-size-calculation.html#cb97-43" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">LogrankCR2</span>(<span class="at">local=</span>local, <span class="at">beta=</span><span class="fl">0.1</span>, <span class="at">S_ev1 =</span> IIIC_HR, <span class="at">S_ev2=</span>IIIC_LR, <span class="at">S_cr=</span><span class="fl">0.95</span>, <span class="at">P1=</span><span class="fl">0.9</span>, <span class="at">P2=</span><span class="fl">0.1</span>, <span class="at">T=</span><span class="fl">5.0000000001</span>, <span class="at">R=</span><span class="fl">0.0000000001</span>, <span class="at">w=</span><span class="fl">0.25</span>, <span class="at">alpha_2=</span>final_alpha))</span>
<span id="cb97-44"><a href="sample-size-calculation.html#cb97-44" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(out_table)</span>
<span id="cb97-45"><a href="sample-size-calculation.html#cb97-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(out_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Event HR&quot;</span>,<span class="st">&quot;Event LR&quot;</span>,<span class="st">&quot;NIA HR&quot;</span>,<span class="st">&quot;NIA LR&quot;</span>,<span class="st">&quot;NIA&quot;</span>,<span class="st">&quot;NRc&quot;</span>,<span class="st">&quot;Power&quot;</span>,<span class="st">&quot;FU HR&quot;</span>,<span class="st">&quot;FU LR&quot;</span>, <span class="st">&quot;FU IA&quot;</span>, <span class="st">&quot;FU Rc&quot;</span>)</span>
<span id="cb97-46"><a href="sample-size-calculation.html#cb97-46" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(out_table)</span>
<span id="cb97-47"><a href="sample-size-calculation.html#cb97-47" aria-hidden="true" tabindex="-1"></a>  sum[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb97-48"><a href="sample-size-calculation.html#cb97-48" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(out_table,sum)</span>
<span id="cb97-49"><a href="sample-size-calculation.html#cb97-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_table)</span>
<span id="cb97-50"><a href="sample-size-calculation.html#cb97-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-51"><a href="sample-size-calculation.html#cb97-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-52"><a href="sample-size-calculation.html#cb97-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-53"><a href="sample-size-calculation.html#cb97-53" aria-hidden="true" tabindex="-1"></a><span class="do">### If interim analysis is required</span></span>
<span id="cb97-54"><a href="sample-size-calculation.html#cb97-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rpact&quot;</span>)</span>
<span id="cb97-55"><a href="sample-size-calculation.html#cb97-55" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">getDesignGroupSequential</span>(<span class="at">sided =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.0083</span>, </span>
<span id="cb97-56"><a href="sample-size-calculation.html#cb97-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">informationRates =</span> <span class="fu">c</span>(<span class="dv">500</span><span class="sc">/</span><span class="dv">600</span>, <span class="dv">1</span>), </span>
<span id="cb97-57"><a href="sample-size-calculation.html#cb97-57" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">typeOfDesign =</span> <span class="st">&quot;asP&quot;</span>)</span>
<span id="cb97-58"><a href="sample-size-calculation.html#cb97-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb97-59"><a href="sample-size-calculation.html#cb97-59" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">500</span><span class="sc">/</span><span class="dv">700</span></span>
<span id="cb97-60"><a href="sample-size-calculation.html#cb97-60" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">out</span>(<span class="fl">0.003544</span>, <span class="fl">0.650</span>, <span class="fl">0.642</span>, <span class="fl">0.521</span>, <span class="fl">0.9</span>), </span>
<span id="cb97-61"><a href="sample-size-calculation.html#cb97-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Sample size calculation for Scenario 2.2 t= 500/700&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 8.1: </span>Sample size calculation for Scenario 2.2 t= 500/700</caption>
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="10%" />
<col width="10%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Event HR</th>
<th align="right">Event LR</th>
<th align="right">NIA HR</th>
<th align="right">NIA LR</th>
<th align="right">NIA</th>
<th align="right">NRc</th>
<th align="right">Power</th>
<th align="right">FU HR</th>
<th align="right">FU LR</th>
<th align="right">FU IA</th>
<th align="right">FU Rc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">21</td>
<td align="right">9</td>
<td align="right">61</td>
<td align="right">92</td>
<td align="right">153</td>
<td align="right">62</td>
<td align="right">96.02</td>
<td align="right">82</td>
<td align="right">122</td>
<td align="right">204</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">5</td>
<td align="right">69</td>
<td align="right">46</td>
<td align="right">115</td>
<td align="right">47</td>
<td align="right">96.02</td>
<td align="right">92</td>
<td align="right">62</td>
<td align="right">154</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">47</td>
<td align="right">2</td>
<td align="right">99</td>
<td align="right">11</td>
<td align="right">110</td>
<td align="right">45</td>
<td align="right">96.02</td>
<td align="right">132</td>
<td align="right">15</td>
<td align="right">147</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">378</td>
<td align="right">154</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">505</td>
<td align="right">203</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="estimation-in-diagnostic-test" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Estimation in diagnostic test</h2>
<p>Source <a href="https://www.sciencedirect.com/science/article/pii/S1532046414000501#s0030">Sample size estimation in diagnostic test studies of biomedical informatics</a></p>
<div id="adequate-sensitivityspecificity" class="section level3" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> Adequate sensitivity/specificity</h3>
<p>Determine the number of cases to estimate sensitivity <span class="math inline">\((\mathrm{Se})\)</span> of new diagnostic test. Similarly, one may estimate specificity <span class="math inline">\((\mathrm{Sp})\)</span>. Since sensitivity (or specificity) is a proportion, for estimation of sensitivity (or specificity) alone when the diseased status is known, the formula for sampler size with <span class="math inline">\((1-\alpha) \%\)</span> confidence level and with maximum marginal error of estimate of <span class="math inline">\(d\)</span> for constructing confidence interval of true value of sensitivity (or specificity) using normal approximation is driven as follows:
<span class="math display">\[n=\frac{Z_{\frac{\alpha}{2}}^{2} \widehat{P}(1-\widehat{P})}{d^{2}}\]</span>
Simply one can drive the proportion of cases to controls as follows
<span class="math display">\[\frac{n_{\text {casss }}}{n_{\text {coutrols }}}=\frac{\text { Prev }}{1-\text { Prev }}\]</span>
Thus, the total sample sizes based on sensitivity and specificity respectively are
<span class="math display">\[n_{\mathrm{Se}}=\frac{Z_{\frac{\alpha}{2}}^{3} \widehat{\operatorname{Se}}(1-\widehat{\mathrm{Se}})}{d^{2} \times \mathrm{Prev}}\]</span>
<span class="math display">\[n_{\mathrm{Sp}}=\frac{Z_{\frac{\alpha}{2}}^{2} \widehat{\operatorname{Sp}}(1-\widehat{\mathrm{Sp}})}{d^{2} \times(1-\mathrm{Prev})}\]</span></p>
<p>For example, if the Se is primary interested in diagnostic screening purpose and lets the pre-determined values of Se and prevalence of disease as 80% and 10% respectively. In order the maximum marginal error of estimate does not exceed from 7% with 95% confidence level, the total required sample size can be driven by plugging the above values as follows:
<span class="math display">\[
n_{\mathrm{Se}}=\frac{1.96^{2} \times 0.8 \times 0.20}{0.07^{2} \times 0.10}=1254
\]</span></p>
<p><strong>R Implementation with Person CI</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="sample-size-calculation.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb98-2"><a href="sample-size-calculation.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb98-3"><a href="sample-size-calculation.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb98-4"><a href="sample-size-calculation.html#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="sample-size-calculation.html#cb98-5" aria-hidden="true" tabindex="-1"></a>SE_v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.85</span>,<span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb98-6"><a href="sample-size-calculation.html#cb98-6" aria-hidden="true" tabindex="-1"></a>SP_v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.90</span>,<span class="fl">0.97</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb98-7"><a href="sample-size-calculation.html#cb98-7" aria-hidden="true" tabindex="-1"></a>SampleSize <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(SE_v,SP_v)</span>
<span id="cb98-8"><a href="sample-size-calculation.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(SampleSize) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SE_v&quot;</span>,<span class="st">&quot;SP_v&quot;</span>)</span>
<span id="cb98-9"><a href="sample-size-calculation.html#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="sample-size-calculation.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="do">### the maximum marginal error of estimate does not exceed from 5% with 95% confidence level</span></span>
<span id="cb98-11"><a href="sample-size-calculation.html#cb98-11" aria-hidden="true" tabindex="-1"></a>d_SE <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb98-12"><a href="sample-size-calculation.html#cb98-12" aria-hidden="true" tabindex="-1"></a>d_SP <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb98-13"><a href="sample-size-calculation.html#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-14"><a href="sample-size-calculation.html#cb98-14" aria-hidden="true" tabindex="-1"></a>SampleSize_table <span class="ot">&lt;-</span> SampleSize <span class="sc">%&gt;%</span></span>
<span id="cb98-15"><a href="sample-size-calculation.html#cb98-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb98-16"><a href="sample-size-calculation.html#cb98-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">### prevalence for COVID cases is 1/3</span></span>
<span id="cb98-17"><a href="sample-size-calculation.html#cb98-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_SE =</span> <span class="fu">ceiling</span>((<span class="fu">qnorm</span>(<span class="fl">0.025</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> SE_v<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SE_v))<span class="sc">/</span>(d_SE<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb98-18"><a href="sample-size-calculation.html#cb98-18" aria-hidden="true" tabindex="-1"></a>    <span class="do">### prevalence for non COVID cases is 1-1/3</span></span>
<span id="cb98-19"><a href="sample-size-calculation.html#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_SP =</span> <span class="fu">ceiling</span>((<span class="fu">qnorm</span>(<span class="fl">0.025</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> SP_v<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>SP_v))<span class="sc">/</span>(d_SP<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1-1</span><span class="sc">/</span><span class="dv">3</span>))),</span>
<span id="cb98-20"><a href="sample-size-calculation.html#cb98-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> n_SE)</span>
<span id="cb98-21"><a href="sample-size-calculation.html#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="sample-size-calculation.html#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="do">### Calculation the CI based on clopper-pearson method</span></span>
<span id="cb98-23"><a href="sample-size-calculation.html#cb98-23" aria-hidden="true" tabindex="-1"></a>SampleSize_table<span class="sc">$</span>LL <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.data.frame</span>(<span class="fu">BinomCI</span>(SampleSize_table<span class="sc">$</span>N<span class="sc">*</span>SampleSize_table<span class="sc">$</span>SE_v, </span>
<span id="cb98-24"><a href="sample-size-calculation.html#cb98-24" aria-hidden="true" tabindex="-1"></a>                                               SampleSize_table<span class="sc">$</span>N, <span class="at">conf.level =</span> <span class="fl">0.975</span>, <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>), <span class="at">method =</span> <span class="fu">c</span>( <span class="st">&quot;clopper-pearson&quot;</span>),<span class="at">tol =</span> <span class="fl">0.0001</span>))[<span class="dv">2</span>],<span class="dv">3</span>)</span>
<span id="cb98-25"><a href="sample-size-calculation.html#cb98-25" aria-hidden="true" tabindex="-1"></a>SampleSize_table<span class="sc">$</span>UL <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">BinomCI</span>(SampleSize_table<span class="sc">$</span>N<span class="sc">*</span>SampleSize_table<span class="sc">$</span>SE_v, </span>
<span id="cb98-26"><a href="sample-size-calculation.html#cb98-26" aria-hidden="true" tabindex="-1"></a>                                            SampleSize_table<span class="sc">$</span>N, <span class="at">conf.level =</span> <span class="fl">0.975</span>, <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>),  <span class="at">method =</span> <span class="fu">c</span>( <span class="st">&quot;clopper-pearson&quot;</span>),<span class="at">tol =</span> <span class="fl">0.0001</span>))[<span class="dv">3</span>]</span>
<span id="cb98-27"><a href="sample-size-calculation.html#cb98-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-28"><a href="sample-size-calculation.html#cb98-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(SampleSize_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">SE_v</th>
<th align="right">SP_v</th>
<th align="right">n_SE</th>
<th align="right">n_SP</th>
<th align="right">N</th>
<th align="left">LL</th>
<th align="left">UL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.85</td>
<td align="right">0.9</td>
<td align="right">588</td>
<td align="right">208</td>
<td align="right">588</td>
<td align="left">0.819</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">0.86</td>
<td align="right">0.9</td>
<td align="right">556</td>
<td align="right">208</td>
<td align="right">556</td>
<td align="left">0.828</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="right">0.87</td>
<td align="right">0.9</td>
<td align="right">522</td>
<td align="right">208</td>
<td align="right">522</td>
<td align="left">0.838</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">0.88</td>
<td align="right">0.9</td>
<td align="right">487</td>
<td align="right">208</td>
<td align="right">487</td>
<td align="left">0.848</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="right">0.89</td>
<td align="right">0.9</td>
<td align="right">452</td>
<td align="right">208</td>
<td align="right">452</td>
<td align="left">0.857</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</div>
<div id="testing-sensitivity-or-specificity" class="section level3" number="8.9.2">
<h3><span class="header-section-number">8.9.2</span> Testing sensitivity (or specificity)</h3>
<p><strong>Sample size for testing sensitivity (or specificity) of single diagnostic test</strong></p>
<p>Suppose <span class="math inline">\(P_{0}\)</span> denote the pre-determined value of sensitivity or specificity of new diagnostic test. In comparing the test’s accuracy to fixed value of <span class="math inline">\(P_{0}\)</span>, the null and alternative hypothesis is
<span class="math display">\[\mathrm{H}_{0}: \mathrm{Se}=P_{0}$ versus $\mathrm{H}_{1}: \mathrm{Se} \neq P_{0}$ (or $\left.\mathrm{Se}=P_{1}\right)\]</span>
where <span class="math inline">\(P_{1}\)</span> is the value of sensitivity (or specificity) under alternative hypothesis. Using normal approximation as a general rule, Z-score under the null and alternative hypothesis can defined and thus the required sample size for cases is driven as follows:</p>
<p><span class="math display">\[
n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{P_{0}\left(1-P_{0}\right)}+Z_{\beta} \sqrt{P_{1}\left(1-P_{1}\right)}\right]^{2}}{\left(P_{1}-P_{0}\right)^{2}}
\]</span></p>
<p><strong>Sample size for comparing the sensitivity (or specificity) of two diagnostic tests</strong></p>
<p>For studies comparing sensitivity and/or specificity of two tests of unpaired design. In comparing the diagnostic accuracy of two alternative tasks for two independent samples, suppose <span class="math inline">\(P_{1}\)</span> and <span class="math inline">\(P_{2}\)</span> denote the expected proportion (Se or Sp) of two alternative diagnostic tests respectively. For testing hypothesis:
<span class="math display">\[\mathrm{H}_{0}: \mathrm{P}_{1}=\mathrm{P}_{2} \ \text{versus} \ \mathrm{H}_{1} :P_{1} \neq P_{2}\]</span>, the required sample size with equal size based on normal approximation of binomial data with <span class="math inline">\(1-\alpha\)</span> confidence level and <span class="math inline">\(1-\beta\)</span> power is
<span class="math display">\[n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{2 \times \bar{P}(1-\bar{P})}+Z_{\beta} \sqrt{P_{1}\left(1-P_{1}\right)+P_{2}\left(1-P_{2}\right)}\right]^{2}}{\left(P_{1}-P_{2}\right)^{2}}\]</span>
where <span class="math inline">\(\bar{P}\)</span> the average of <span class="math inline">\(P_{1}\)</span> and <span class="math inline">\(P_{2}\)</span> and <span class="math inline">\(Z_{\alpha}, Z_{\beta}\)</span> is are the standard normal <span class="math inline">\(Z\)</span> values corresponding to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (the probability of type I and type II errors respectively).</p>
</div>
<div id="likelihood-ratio-estimation" class="section level3" number="8.9.3">
<h3><span class="header-section-number">8.9.3</span> Likelihood ratio estimation</h3>
<p>As we described when test yields positive or negative results, sensitivity and specificity are the two inherent indexes of accuracy, but LR that <strong>combines the sensitivity and specificity of test as uni-dimensional index</strong>, is a greater of interest. A test with higher LR^+ has a greater value of rule in the disease while a test with lower value of LR<sup>−</sup> has a higher value of rule out disease. These two indexes are particularly interesting in comparative studies of two or multiple tests. The test with greater value of LR^+ and lower values of LR<sup>−</sup> has more diagnostic abilities in the classification of true status of diseased and nondiseased. Thus, positive LR and negative LR play an important rule for clinical decision and they can be used in estimating sample size in diagnostic test.</p>
<p>Suppose <span class="math inline">\(\widehat{P}_{1}\)</span> and <span class="math inline">\(\widehat{P}_{2}\)</span> denote the <strong>sensitivity and 1 -specificity</strong> of a test respectively and <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> denote the sample size for diseased and nondiseased. The ratio estimator of <span class="math inline">\(\mathrm{LR}^{\perp}=\frac{\widehat{P}_{1}}{\widehat{P}_{2}}\)</span> is skewed and the logarithm transformation can be used to convert its distribution to normal approximately. Thus, <span class="math inline">\(\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}}\)</span> can be assumed that asymptotically normally distributed with standard error of <span class="math inline">\(\sqrt{\frac{1-\widehat{P}_{1}}{n_{1} \hat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\)</span> and therefore <span class="math inline">\((1-\alpha) \%\)</span> confidence interval for <span class="math inline">\(\log \left(\mathrm{LR}^{+}\right)\)</span> is as
follows:
<span class="math display">\[\log \left(\mathrm{LR}^{+}\right)=\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}} \pm Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\hat{P}_{1}}{n_{1} \widehat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\]</span>
With the presumption of equal sample size for diseased and nondiseased (i.e. <span class="math inline">\(\left.n_{1}=n_{2}=n\right)\)</span>, then the required sample size for each group of cases and controls can be calculated by solving the Eq. (6.10) as follows:
<span class="math display">\[n=\frac{\left(Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\hat{P}_{1}}{\hat{P}_{1}}+\frac{1-\hat{P}_{2}}{\hat{P}_{2}}}\right)^{2}}{\left(\log (\mathrm{LR}+)-\log \frac{\hat{P}_{1}}{\hat{P}_{2}}\right)^{2}}\]</span></p>
<p>In another condition, a diagnostic test may be useful, if negative LR is lower than a pre-determined value. Then, the sample size would be calculated based on the confidence bond of negative LR. Similarly, one could drive a confidence interval for <span class="math inline">\(\mathrm{LR}^{-}\)</span> as follows:
<span class="math display">\[\log \left(\mathrm{LR}^{-}\right)=\left(\log \frac{\widehat{P}_{1}}{\widehat{P}_{2}} \pm Z_{\frac{\alpha}{2}} \sqrt{\frac{1-\widehat{P}_{1}}{n_{1} \widehat{P}_{1}}+\frac{1-\widehat{P}_{2}}{n_{2} \widehat{P}_{2}}}\right)\]</span>
where <span class="math inline">\(\widehat{P}_{1}=\mathrm{Sp}\)</span> and <span class="math inline">\(\widehat{P}_{2}=1-\mathrm{Se}\)</span></p>
</div>
<div id="roc-index-of-accuracy" class="section level3" number="8.9.4">
<h3><span class="header-section-number">8.9.4</span> ROC index of accuracy</h3>
<p><strong>Sample size for estimating accuracy index</strong></p>
<p>ROC curves show the trade off between sensitivity and specificity and the area under the curve (AUC) is considered as an index of accuracy. The AUC can be estimated parametric (binormal model) and nonparametric (Wilcoxon statistic) approaches. Both approaches allow estimating the sampling variability of AUC. In diagnostic studies, involving ROC analysis, for the purpose of estimating or testing AUC, the clinicians should decide the number of patients and controls needed in study protocol. Suppose a clinical researcher wishes to estimate the diagnostic accuracy as defined by AUC in which the marginal error of estimate (i.e. the difference between true AUC and its estimate) does not exceed from a pre-determined value of <span class="math inline">\(d\)</span> with <span class="math inline">\((1-\alpha) \%\)</span> confidence level (e.g. <span class="math inline">\(95 \%)\)</span>. Using normal approximation in constructing confidence interval for AUC, we have
<span class="math display">\[Z_{\frac{\alpha}{2}} \mathrm{SE}(\widehat{\mathrm{AUC}}) \leqslant d\]</span>
By squaring two sides of equation, then
<span class="math display">\[Z_{\frac{\alpha}{2}}^{2} \operatorname{Var}(\widehat{\mathrm{AUC}})=d^{2}\]</span></p>
<p><strong>The variance of nonparametric AUC</strong></p>
<p>The variance of nonparametric AUC (Wilcoxon statistic) is estimated using the methods that proposed by Bamber [48] as
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\frac{\mathrm{AUC}(1-\mathrm{AUC})+\left(n_{1}-1\right)\left(Q_{1}-\mathrm{AUC}^{2}\right)+\left(n_{2}-1\right)\left(Q_{2}-\mathrm{AUC}^{2}\right)}{n_{1} n_{2}}\]</span>
Hanley and McNeil [7] used exponential approximation to estimate <span class="math inline">\(\mathrm{Q}_{1}\)</span> and <span class="math inline">\(\mathrm{Q}_{2}\)</span> as
<span class="math display">\[Q_{1}=\frac{\mathrm{AUC}}{2-\mathrm{AUC}} \quad\]</span> and <span class="math display">\[\quad Q_{2}=\frac{2 \mathrm{AUC}^{2}}{1+\mathrm{AUC}}\]</span>
that allows one to estimate the variance of AUC and its SE. Thus, the variance of AUC under the null and also alternative hypothesis can be estimated easily.
For studies with continuous test results <span class="math inline">\(\operatorname{Var}(\widehat{\mathrm{AUC}})\)</span> can be written approximately
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\frac{Q_{1}}{r}+Q_{2}-\operatorname{AUC}^{2}\left(\frac{1}{r}+1\right)\]</span>
where <span class="math inline">\(\mathrm{r}\)</span> the ratio of sample size of controls to cases <span class="math inline">\(\left(r=\frac{n_{2}}{n_{1}}\right)\)</span>.</p>
<p><strong>The variance of parametric AUC</strong></p>
<p>The two parameters of ROC curves based on binormal assumption are defined as <span class="math inline">\(a=\frac{\mu_{2}-\mu_{1}}{\sigma_{1}}\)</span> and <span class="math inline">\(b=\frac{\sigma_{1}}{\sigma_{2}}\)</span> where <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\sigma_{1}\)</span> the mean and standard deviation of distribution for nondiseased and <span class="math inline">\(\mu_{2}\)</span> and <span class="math inline">\(\sigma_{2}\)</span> are for diseased distribution respectively. The area under curve with binormal model is <span class="math inline">\(\mathrm{AUC}=\varphi\left[\frac{a}{1+b^{2}}\right]\)</span> where <span class="math inline">\(\varphi\)</span> is the cumulative distribution function. Delta method can be used to estimate
variance and SE of AUC. With an approximation when the ratio of SD is close to one (i.e. <span class="math inline">\(b=1\)</span> ) the binormal estimator of variance of <span class="math inline">\((\widehat{\mathrm{AUC}})\)</span> is
<span class="math display">\[\operatorname{Var}(\widehat{\mathrm{AUC}})=\left(0.0099 \times e^{-a^{2} / 2}\right) \times\left(\frac{5 a^{2}+8}{n_{2}}+\frac{a^{2}+8}{n_{1}}\right)\]</span>
where <span class="math inline">\(a=\varphi^{-1}(\mathrm{AUC}) \times 1.414\)</span> and <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> are the sample size for nondiseased and diseased.</p>
<p>Lets <span class="math inline">\(V(\widehat{\mathrm{AUC}})=n \operatorname{Var}((\widehat{\mathrm{AUC}})\)</span>. Thus, the required sample size for each group of nondiseased and diseased is
<span class="math display">\[n=\frac{Z_{\frac{\alpha}{2}}^{2} V(\widehat{\mathrm{AUC}})}{d^{2}}\]</span></p>
<p><strong>Sample size for testing accuracy of quantitative diagnostic test of single modality</strong></p>
<p><span class="math display">\[
\begin{array}{l}
\mathrm{H}_{0}: \mathrm{AUC}=\mathrm{AUC}_{0} \text { versus } \mathrm{H}_{1}: \mathrm{AUC} \neq \mathrm{AUC}_{0} \\
\text { (i. e. } \left.\mathrm{AUC}=\mathrm{AUC}_{1}\right)
\end{array}
\]</span></p>
<p><span class="math display">\[
n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{V_{\mathrm{H} 0}(\widehat{\mathrm{AUC}})} \perp Z_{\beta} \sqrt{V_{\mathrm{Hl}}(\widehat{\mathrm{AUC}})}\right]^{2}}{\left[\mathrm{AUC}_{1}-\mathrm{AUC}_{0}\right]^{2}}
\]</span></p>
<p><strong>Sample size for comparing accuracy of two diagnostic tests</strong></p>
<p><span class="math display">\[\mathrm{H}_{0}: \mathrm{AUC}_{1}=\mathrm{AUC}_{2}$ versus $\mathrm{H}_{1}: \mathrm{AUC}_{1} \neq \mathrm{AUC}_{2}\]</span></p>
<p>The required sample sizes for each group are driven as
<span class="math display">\[n=\frac{\left[Z_{\frac{\alpha}{2}} \sqrt{V_{\mathrm{H} 0}\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)} \perp Z_{\beta} \sqrt{V_{\mathrm{H} 1}\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)}\right]}{\left[\mathrm{AUC}_{1}-\mathrm{AUC}_{2}\right]^{2}}\]</span>
where
<span class="math display">\[V\left(\widehat{\mathrm{AUC}}_{1}-\widehat{\mathrm{AUC}}_{2}\right)=n \operatorname{Var}\left(\widehat{\mathrm{AUC}}_{1}\right)+n \operatorname{Var}\left(\widehat{\mathrm{AUC}}_{2}\right)-2 n \operatorname{Cov}\left(\widehat{\mathrm{AUC}}_{1}, \widehat{\mathrm{AUC}}_{2}\right)\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="non-parametric-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-Sample-Size.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
