<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 24 Clinic Trail Design | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 24 Clinic Trail Design | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 24 Clinic Trail Design | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-analysis.html"/>
<link rel="next" href="group-sequential-design.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#coord" id="toc-coord"><span class="toc-section-number">4.4.3</span> coord</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.5</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.6</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.7</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#reorder" id="toc-reorder"><span class="toc-section-number">4.5.2</span> Reorder</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.3</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.5</span> Dot + Box Plot</a></li>
<li><a href="ggplot2.html#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.5.6</span> Violin Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#nominal-response" id="toc-nominal-response"><span class="toc-section-number">13.6.2</span> Nominal Response</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.3</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clinic-trail-design" class="section level1" number="24">
<h1><span class="header-section-number">Chapter 24</span> Clinic Trail Design</h1>
<div id="htmlwidget-cc9eda45e2f8913a9dd0" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-cc9eda45e2f8913a9dd0">{"x":{"data":"# \n## Clinic Trail Design\n### Regulation\n### Randomization\n#### Simple randomization\n#### Block randomization\n#### Stratified randomization\n### Phase I Trials Design\n#### Introduction\n##### Single ascending dose\n##### Multiple ascending dose\n### Pharmacokinetic Analysis (PK package）\n#### AUC\n#### AUC in complete data design\n#### AUC in repeated complete data design\n#### Bioequivalence between AUCs\n#### Two-phase half-life estimation by biexponential model\n#### Two-phase half-life estimation by linear fitting\n#### Estimation of various PK parameters\n### Phase II Trials Design\n#### Introduction\n#### Gehan's design\n#### Fleming's Two-Stage design\n#### Simon's 2-Stage Design\n#### Jonckheere-Terptsra (JT) trend test\n#### Cochran-Armitage (CA) trend test\n#### MCP-Mod\n#### Two Stage Phase II Design for Response and Toxicity\n### Phase III Trials Design\n#### Non-inferiority and Equivalence Three-armed trial\n#### Pigeot Method\n### Medical Devices Postmarketing Surveillance (PMS)\n#### Phase IV and PMS","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="regulation" class="section level2" number="24.1">
<h2><span class="header-section-number">24.1</span> Regulation</h2>
<ul>
<li>ICH Guideline for Good Clinical Practice E6 – current version</li>
<li>ICH E9 Statistical principles for clinical trials</li>
<li>Declaration of Helsinki – Ethical Principles for Medical research
Involving Human Subjects – current version</li>
<li>ISO 14155 – Clinical investigation of medical devices for human
subjects – Good Clinical Practice – current version</li>
<li>ISO 20916 - In vitro diagnostic medical devices — Clinical
performance studies using specimens from human subjects — Good
study practice – current version</li>
<li>EMA (European Medicines Agency) Missing data in confirmatory
clinical trials</li>
<li>EMA (European Medicines Agency) Investigation of bioequivalence</li>
<li>Eegulation (EU) 536/2014</li>
</ul>
<p>试者分配给分析集。</p>
</div>
<div id="randomization" class="section level2" number="24.2">
<h2><span class="header-section-number">24.2</span> Randomization</h2>
<div id="simple-randomization" class="section level3" number="24.2.1">
<h3><span class="header-section-number">24.2.1</span> Simple randomization</h3>
<p>Randomization based on a single sequence of random assignments is known
as simple randomization.</p>
<blockquote>
<p>对于两个治疗组（对照组与治疗组），硬币的侧面（即正面-对照组，反面-治疗）确定每个受试者的分配。其他方法包括使用经过洗牌的纸牌（例如，偶数控制，奇数处理）或掷骰子（例如，低于并等于3控制，超过3处理）这种随机方法简单易行，可在临床研究中实施。在大型临床研究中，可以相信简单随机会在组之间生成相似数量的主题。但是，在相对较小的样本量临床研究中，随机化结果可能会出现问题，从而导致组中参与者的数量不相等。</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="clinic-trail-design.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb1-2"><a href="clinic-trail-design.html#cb1-2" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-3"><a href="clinic-trail-design.html#cb1-3" aria-hidden="true" tabindex="-1"></a>simple.list <span class="ot">&lt;-</span> <span class="fu">sample</span>(treatment, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="clinic-trail-design.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(simple.list,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## B
## A
## A
## A
## A
## A
## A
## B
## A
## B
## B
## B
## A
## A
## A
## A
## A
## B
## A
## A</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="clinic-trail-design.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(simple.list)</span></code></pre></div>
<pre><code>## simple.list
##  A  B 
## 14  6</code></pre>
</div>
<div id="block-randomization" class="section level3" number="24.2.2">
<h3><span class="header-section-number">24.2.2</span> Block randomization</h3>
<p>The block randomization method is designed to randomize subjects into
groups that result in equal sample sizes. This method is used to ensure
a balance in sample size across groups over time. Blocks are small and
balanced with predetermined group assignments, which keeps the numbers
of subjects in each group similar at all times. The block size is
determined by the researcher and should be a multiple of the number of
groups (i.e., with two treatment groups, block size of either 4, 6, or
8). Blocks are best used in smaller increments as researchers can more
easily control balance.</p>
<blockquote>
<p>块随机化方法旨在将受试者随机分组，从而产生相同的样本量。使用此方法可确保随着时间的推移，各个组之间的样本量保持平衡。区块很小，并且通过预定的小组分配来平衡，这使每个小组中的被试人数始终保持相似。区块大小由研究人员确定，并且应为组数的倍数（即，对于两个治疗组，区块大小为4、6或8）。最好以较小的增量使用块，因为研究人员可以更轻松地控制平衡。</p>
</blockquote>
<p>After block size has been determined, all possible balanced combinations
of assignment within the block (i.e., equal number for all groups within
the block) must be calculated. Blocks are then randomly chosen to
determine the patients’ assignment into the groups.</p>
<blockquote>
<p>确定块大小后，必须计算该块内分配的所有可能平衡组合（即，该块内所有组的数量均相等）。然后随机选择块来确定患者的分组。</p>
</blockquote>
<p><strong>Example 以区组长度4为例</strong></p>
<ul>
<li>一个区组内的4个研究对象可以有6种排列方式：1. AABB, 2. ABAB, 3.
ABBA, 4. BAAB, 5. BABA, 6. BBAA</li>
<li>确定好所有的排列形式后，接下来需要将6个区组随机排列。我们可以用各种方式（如SPSS、Excel、SAS等）产生一串随机数字.
因为只有6种排列方式，因此可以只选择1-6之间的数字，25126423121362555343526422</li>
<li>按照上述随机数字排列区组</li>
</ul>
<p><strong>BLOCKED RANDOMIZATION USING THE PROC PLAN</strong></p>
<pre><code>* randomization within block;
%macro ran_block (blockNum);
…
%if &amp;seed= %then %do;
 proc plan;
 factors N=&amp;blocksize / noprint;
 output data=One out=Two
 run;
%end;
%else %do;
 Proc plan seed=%eval (&amp;seed+blockNum);
 Factors N=&amp;blockSize / noprint;
 Output data=One out=Two;
 Run;
%end;
…
%mend ran_block;</code></pre>
<p><strong>BLOCKED RANDOMIZATION USING psych Package</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="clinic-trail-design.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb6-2"><a href="clinic-trail-design.html#cb6-2" aria-hidden="true" tabindex="-1"></a>my.cond <span class="ot">&lt;-</span> <span class="fu">block.random</span> (<span class="at">n=</span><span class="dv">96</span>,<span class="fu">c</span>( <span class="at">drug=</span><span class="dv">2</span>,<span class="at">time=</span><span class="dv">3</span>,<span class="at">imp=</span><span class="dv">2</span>)) </span>
<span id="cb6-3"><a href="clinic-trail-design.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">headtail</span>(my.cond) </span></code></pre></div>
<pre><code>##     blocks drug time imp
## S1       1    1    2   1
## S2       1    1    3   1
## S3       1    1    3   2
## S4       1    2    2   2
## ...    ...  ...  ... ...
## S93      8    2    3   2
## S94      8    1    3   1
## S95      8    2    1   1
## S96      8    2    1   2</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="clinic-trail-design.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualizing block randomization</span></span>
<span id="cb8-2"><a href="clinic-trail-design.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span> (my.cond)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/psych-1.png" width="672" /></p>
<p><strong>BLOCKED RANDOMIZATION USING blockrand Package</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="clinic-trail-design.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Generate a block randomization for a clinical trial;</span></span>
<span id="cb9-2"><a href="clinic-trail-design.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;blockrand&quot;</span>)</span>
<span id="cb9-3"><a href="clinic-trail-design.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb9-4"><a href="clinic-trail-design.html#cb9-4" aria-hidden="true" tabindex="-1"></a>block.list <span class="ot">&lt;-</span> <span class="fu">blockrand</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">num.levels =</span> <span class="dv">2</span>,<span class="at">block.sizes =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9-5"><a href="clinic-trail-design.html#cb9-5" aria-hidden="true" tabindex="-1"></a>block.list</span></code></pre></div>
<pre><code>##    id block.id block.size treatment
## 1   1        1          4         A
## 2   2        1          4         A
## 3   3        1          4         B
## 4   4        1          4         B
## 5   5        2          4         A
## 6   6        2          4         B
## 7   7        2          4         A
## 8   8        2          4         B
## 9   9        3          4         B
## 10 10        3          4         A
## 11 11        3          4         A
## 12 12        3          4         B
## 13 13        4          4         A
## 14 14        4          4         B
## 15 15        4          4         B
## 16 16        4          4         A
## 17 17        5          4         A
## 18 18        5          4         B
## 19 19        5          4         B
## 20 20        5          4         A</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="clinic-trail-design.html#cb11-1" aria-hidden="true" tabindex="-1"></a>block.list2 <span class="ot">&lt;-</span> <span class="fu">blockrand</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">num.levels =</span> <span class="dv">2</span>,<span class="at">block.sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb11-2"><a href="clinic-trail-design.html#cb11-2" aria-hidden="true" tabindex="-1"></a>block.list2</span></code></pre></div>
<pre><code>##    id block.id block.size treatment
## 1   1        1          4         A
## 2   2        1          4         B
## 3   3        1          4         A
## 4   4        1          4         B
## 5   5        2          2         A
## 6   6        2          2         B
## 7   7        3          2         B
## 8   8        3          2         A
## 9   9        4          4         A
## 10 10        4          4         A
## 11 11        4          4         B
## 12 12        4          4         B
## 13 13        5          4         A
## 14 14        5          4         B
## 15 15        5          4         A
## 16 16        5          4         B
## 17 17        6          4         A
## 18 18        6          4         B
## 19 19        6          4         B
## 20 20        6          4         A</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="clinic-trail-design.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(block.list2)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/blockrand-1.png" width="672" /></p>
</div>
<div id="stratified-randomization" class="section level3" number="24.2.3">
<h3><span class="header-section-number">24.2.3</span> Stratified randomization</h3>
<p>The stratified randomization method addresses the need to control and
balance the influence of covariates. This method can be used to achieve
balance among groups in terms of subjects’ baseline characteristics
(covariates). Specific covariates must be identified by the researcher
who understands the potential influence each covariate has on the
dependent variable. Stratified randomization is achieved by generating a
separate block for each combination of covariates, and subjects are
assigned to the appropriate block of covariates. After all subjects have
been identified and assigned into blocks, simple randomization is
performed within each block to assign subjects to one of the groups.</p>
<blockquote>
<p>分层随机方法解决了控制和平衡协变量影响的需求。此方法可用于在受试者的基线特征（协变量）方面实现组间的平衡。研究人员必须确定特定的协变量，他们必须了解每个协变量对因变量的潜在影响。分层随机化是通过为协变量的每种组合生成一个单独的块来实现的，并将主题分配给合适的协变量块。在确定了所有主题并将其分配到块中之后，在每个块内执行简单的随机化以将主题分配给其中一个组。</p>
</blockquote>
<p><span class="math display">\[
\begin{array}{|l|c|c|}
\hline \text { Stratum } &amp; \text { Age Group } &amp; \text { Severity Score } \\
\hline 1 &amp; \geq 50 \text { years } &amp; \geq 7 \\
\hline 2 &amp; &lt;50 \text { years } &amp; \geq 7 \\
\hline 3 &amp; \geq 50 \text { years } &amp; &lt;7 \\
\hline 4 &amp; &lt;50 \text { years } &amp; &lt;7 \\
\hline
\end{array}
\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="clinic-trail-design.html#cb14-1" aria-hidden="true" tabindex="-1"></a>over50.severe.list <span class="ot">&lt;-</span> <span class="fu">blockrand</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">num.levels =</span> <span class="dv">2</span>,</span>
<span id="cb14-2"><a href="clinic-trail-design.html#cb14-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">block.sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), </span>
<span id="cb14-3"><a href="clinic-trail-design.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">stratum=</span><span class="st">&#39;Over 50, Severe&#39;</span>,<span class="at">id.prefix=</span><span class="st">&#39;O50_S&#39;</span>, <span class="at">block.prefix=</span><span class="st">&#39;O50_S&#39;</span>)</span>
<span id="cb14-4"><a href="clinic-trail-design.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">headtail</span>(over50.severe.list)</span></code></pre></div>
<pre><code>##           id         stratum block.id block.size treatment
## 1   O50_S001 Over 50, Severe  O50_S01          4         A
## 2   O50_S002 Over 50, Severe  O50_S01          4         B
## 3   O50_S003 Over 50, Severe  O50_S01          4         B
## 4   O50_S004 Over 50, Severe  O50_S01          4         A
## ...     &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;        ...      &lt;NA&gt;
## 99  O50_S099 Over 50, Severe  O50_S21          8         B
## 100 O50_S100 Over 50, Severe  O50_S21          8         B
## 101 O50_S101 Over 50, Severe  O50_S21          8         A
## 102 O50_S102 Over 50, Severe  O50_S21          8         A</code></pre>
</div>
</div>
<div id="phase-i-trials-design" class="section level2" number="24.3">
<h2><span class="header-section-number">24.3</span> Phase I Trials Design</h2>
<div id="introduction" class="section level3" number="24.3.1">
<h3><span class="header-section-number">24.3.1</span> Introduction</h3>
<p>The primary aims of Phase 1 Clinical Trials are to determine the
<strong>safety, tolerability and pharmacokinetics (PK)</strong> of a compound. Trials
have historically been conducted in the logical sequence of single
ascending dose, multiple ascending dose, examination of preliminary
effect of food on exposure, and potential drug-drug interaction, with
assessments to determine the effect of gender, age, bioavailability and
bioequivalence performed as necessary. Additional studies may be
performed, including definitive electrocardiogram (ECG) investigations
to thoroughly evaluate the QT/QTc prolongation potential of a compound,
which can increase the risk of potentially fatal proarrhythmias.</p>
<blockquote>
<p>1期临床试验的主要目的是确定化合物的安全性，耐受性和药代动力学（PK)。
历史上，按单次递增剂量，多次递增剂量，检查食物对暴露的初步效果以及潜在的药物相互作用的逻辑顺序进行试验，并进行评估以确定性别，年龄，生物利用率和生物等效性的影响
必要的。
可能还会进行其他研究，包括确定性心电图（ECG）检查，以彻底评估化合物的QT
/ QTc延长潜力，这可能会增加致命性心律失常的风险。</p>
</blockquote>
<div id="single-ascending-dose" class="section level4" number="24.3.1.1">
<h4><span class="header-section-number">24.3.1.1</span> Single ascending dose</h4>
<p>Single ascending dose These are studies in which a small group of
subjects receive a single dose of the compound in a clinical setting,
usually a Clinical Research Unit (CRU). Close safety monitoring and
usually PK assessments are performed for a predetermined time. If the
compound is deemed to be well tolerated, and the PK data are broadly as
expected, dose escalation occurs, either within the same group or a
further group of healthy subjects, according to the approved protocol.
Dose escalation usually continues until the maximum dose has been
attained per the protocol unless predefined maximum exposure is reached
or intolerable side effects become apparent. Additionally, dose
escalation may be discontinued (or may proceed more cautiously than
planned) if there is evidence of a supra-proportional relationship
between dose and exposure, such that exposures at higher dose levels
become difficult to predict.</p>
<blockquote>
<p>一小部分受试者在临床环境（通常是临床研究单位（CRU））中接受单剂量的化合物。在预定的时间内进行密切的安全监控和通常的PK评估。如果认为该化合物具有良好的耐受性，并且PK数据大致符合预期，则根据批准的方案，在同一组或另一组健康受试者中会发生剂量增加。除非根据预定义的最大暴露量或出现无法忍受的副作用，否则剂量递增通常会一直持续到按照方案达到最大剂量。另外，如果有证据表明剂量与暴露量之间存在超比例关系，则可以停止剂量递增（或者可能比计划更谨慎地进行），从而难以预测更高剂量水平的暴露量。</p>
</blockquote>
<p>Studies usually include sequential groups in a parallel design for
maximum exposure or are of a crossover design to provide more
information on dose linearity. To minimize the effect of bias, subjects
are usually randomly assigned to treatment using computer generated
randomization codes produced by Statisticians. Studies are usually
placebo controlled to determine whether effects observed are due to the
study drug or environmental conditions, and are often conducted in a
single (subject) blinded manner to allow informed decision on dose
escalation, with safety and PK data being available for investigator
review.</p>
<blockquote>
<p>研究通常包括平行设计中的顺序组，以最大程度地暴露；或者交叉设计，以提供有关剂量线性的更多信息。为了使偏差的影响最小化，通常使用统计学家产生的计算机生成的随机编码将受试者随机分配到治疗中。研究通常由安慰剂控制，以确定观察到的效果是否是由于研究药物或环境条件引起的，并且通常以单（受试者）盲法进行，以允许就剂量递增做出明智的决定，并提供安全性和PK数据供研究者审查。</p>
</blockquote>
</div>
<div id="multiple-ascending-dose" class="section level4" number="24.3.1.2">
<h4><span class="header-section-number">24.3.1.2</span> Multiple ascending dose</h4>
<p>These studies are conducted to elucidate the pharmacokinetics (PK) and
pharmacodynamics (PD) of multiple doses of the compound, again usually
in a CRU (Clinical Research Unit). The dose levels and dosing intervals
(ie, time between consecutive doses) are selected as those that are
predicted to be safe from single dose data. Samples are collected and
analyzed to allow the determination of PK profiles and a better
understanding of how the drug is processed by the body; with multiple
dosing, a key part of the PK analysis is to identify if accumulation of
the drug occurs. As for single ascending dose studies, dose escalation
proceeds according to the protocol assuming strict safety and PK
criteria are met. Dose levels and dosing frequency are chosen to achieve
therapeutic drug levels within the systemic circulation that are
maintained at steady state for several days to allow appropriate safety
parameters to be monitored. It is usual for 2 3 dose levels to be
studied, at and above the expected therapeutic dose level(s) to
determine the ‘safety margin’ for repeat dose administration.</p>
<blockquote>
<p>进行这些研究以阐明多剂量化合物的药代动力学（PK）和药效学（PD），通常也要在CRU（临床研究单位）中进行。选择剂量水平和给药间隔（即连续剂量之间的时间）作为从单剂量数据预测是安全的剂量水平和剂量间隔。收集样本并进行分析，以便确定PK曲线并更好地了解药物如何被人体处理；通过多次给药，PK分析的关键部分是确定是否发生了药物蓄积。对于单次递增剂量研究，假定符合严格的安全性和PK标准，则按照方案进行剂量递增。选择剂量水平和给药频率以达到全身循环内维持稳定状态数天的治疗药物水平，以监测合适的安全性参数。通常，在预期治疗剂量水平或更高剂量下研究2
3个剂量水平，以确定重复剂量给药的”安全裕度”。</p>
</blockquote>
</div>
</div>
</div>
<div id="pharmacokinetic-analysis-pk-package" class="section level2" number="24.4">
<h2><span class="header-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</h2>
<p>Noncompartmental PK parameters, such as <span class="math inline">\(C_{\max }\)</span> time to peak (maximum) plasma drug concentration ( <span class="math inline">\(\left.t_{\max }\right)\)</span>, area under the plasma concentration-time curve calculated from time 0 to the last measurable concentration at time <span class="math inline">\(t\)</span> (AUC <span class="math inline">\(_{0-t}\)</span> ), area under the plasma concentration-time curve from time 0 to infinity <span class="math inline">\(\left(\mathrm{AUC}_{0-\infty}\right), t_{1 / 2}, \mathrm{CL} / \mathrm{F}\)</span>, apparent volume of distribution <span class="math inline">\((\mathrm{Vz} / \mathrm{F})\)</span>, and percentage of <span class="math inline">\(\mathrm{AUC}_{0-\infty}\)</span> due to extrapolation from the time for the last quantifiable concentration to infinity (AUC%extrap), were calculated from the plasma concentration-time data. Actual sampling times were used in the calculations. Descriptive statistics (N, mean, standard deviation [SD], percentage of coefficient of variation [CV%], geometric mean, geometric CV%, median, minimum, and maximum) were provided for concentrations at each time point and for all PK parameters.</p>
<p>To assess the effect of food on the pomalidomide liquid formulation, an ANOVA model, with treatment as a fixed effect and subject as a random effect, was performed on the natural log-transformed AUCs and Cmax for Treatment C (test formulation, fed) and Treatment B (test formulation, fasted) from Treatment Periods 1, 2, and 3. The geometric mean values and percentage ratios (Treatment C/Treatment B) of the geometric mean values between Treatments C and B were presented, along with the 90% CIs for the ratios. For tmax, a nonparametric analysis was used to produce a median difference between treatments. The median, median difference (fed–fasted), and 90% CI of the median difference were obtained from the Hodges–Lehmann estimate. The P-value was derived from the Wilcoxon signed-rank test.</p>
<p><a href="https://www.dovepress.com/a-phase-i-open-label-randomized-crossover-study-in-healthy-subjects-to-peer-reviewed-fulltext-article-CPAA">Source</a></p>
<div id="auc" class="section level3" number="24.4.1">
<h3><span class="header-section-number">24.4.1</span> AUC</h3>
<ul>
<li><code>auc</code>: Estimation of confidence intervals for the area under the concentration versus time curve</li>
</ul>
<p>Calculation of confidence intervals for an AUC (from 0 to the last time point) or for the difference between two AUCs for serial sampling, batch and complete data designs. The AUC (from 0 to the last time point) is calculated using the linear trapezoidal rule on the arithmetic means at the different time points.</p>
<ul>
<li>The t method uses the critical value from a t-distribution with Satterthwaite’s approximation (Satterthwaite, 1946) to the degrees of freedom for calculation of confidence intervals as presented in Tang-Liu and Burke (1988), Nedelman et al (1995), Holder et al (1999), Jaki and Wolfsegger (2009) and Jaki and Wolfsegger (2012).</li>
<li>The z method uses the critical value from a normal distribution for calculation of confidence intervals as presented in Bailer (1988) or in Jaki and Wolfsegger (2009).</li>
<li>The boott method uses bootstrap-t confidence intervals as presented in Jaki and Wolfsegger (2009). Using boott an additional strata variable for bootstrapping can be specified in the case of serial sampling.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="clinic-trail-design.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PK)</span>
<span id="cb16-2"><a href="clinic-trail-design.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="clinic-trail-design.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## serial sampling design: example from Nedelman et al. (1995)</span></span>
<span id="cb16-4"><a href="clinic-trail-design.html#cb16-4" aria-hidden="true" tabindex="-1"></a>conc.m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">391</span>, <span class="dv">396</span>, <span class="dv">649</span>, <span class="dv">1990</span>, <span class="dv">3290</span>, <span class="dv">3820</span>, <span class="dv">844</span>, <span class="dv">1650</span>, <span class="fl">75.7</span>, <span class="dv">288</span>)</span>
<span id="cb16-5"><a href="clinic-trail-design.html#cb16-5" aria-hidden="true" tabindex="-1"></a>conc.f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">353</span>, <span class="dv">384</span>, <span class="dv">625</span>, <span class="dv">1410</span>, <span class="dv">1020</span>, <span class="dv">1500</span>, <span class="dv">933</span>, <span class="dv">1030</span>, <span class="dv">0</span>, <span class="fl">80.5</span>)</span>
<span id="cb16-6"><a href="clinic-trail-design.html#cb16-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">24</span>, <span class="dv">24</span>)</span>
<span id="cb16-7"><a href="clinic-trail-design.html#cb16-7" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">conc=</span>conc.m, <span class="at">time=</span>time, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&#39;t&#39;</span>,<span class="st">&#39;z&#39;</span>), <span class="at">design=</span><span class="st">&#39;ssd&#39;</span>)</span>
<span id="cb16-8"><a href="clinic-trail-design.html#cb16-8" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">conc=</span>conc.f, <span class="at">time=</span>time, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&#39;t&#39;</span>,<span class="st">&#39;z&#39;</span>), <span class="at">design=</span><span class="st">&#39;ssd&#39;</span>)</span>
<span id="cb16-9"><a href="clinic-trail-design.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res1)</span></code></pre></div>
<pre><code>## Confidence intervals for a serial sampling design
## 
##  Point estimate
## 
##                  est       se
## AUC to tlast 26765.8 4313.421
## 
##  Confidence Intervals
## 
##                                                    lower    upper
## 95% CI using a t distribution for AUC to tlast -5469.646 59001.25
## 95% CI using a z distribution for AUC to tlast 18311.650 35219.95
## 
## degrees of freedom: 1.302807</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="clinic-trail-design.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res1, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5000</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>))</span>
<span id="cb18-2"><a href="clinic-trail-design.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res2, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-3"><a href="clinic-trail-design.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">25</span>, <span class="at">y=</span><span class="dv">5000</span>, <span class="at">xjust=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">21</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>),</span>
<span id="cb18-4"><a href="clinic-trail-design.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Male&#39;</span>, <span class="st">&#39;Female&#39;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="clinic-trail-design.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## batch design: example from Jaki and Wolfsegger (2009),</span></span>
<span id="cb19-2"><a href="clinic-trail-design.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## originally in Holder et al. (1999) using data for call</span></span>
<span id="cb19-3"><a href="clinic-trail-design.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Rats)</span>
<span id="cb19-4"><a href="clinic-trail-design.html#cb19-4" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Rats,Rats<span class="sc">$</span>dose<span class="sc">==</span><span class="dv">100</span>)</span>
<span id="cb19-5"><a href="clinic-trail-design.html#cb19-5" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Rats,Rats<span class="sc">$</span>dose<span class="sc">==</span><span class="dv">300</span>)</span>
<span id="cb19-6"><a href="clinic-trail-design.html#cb19-6" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">data=</span>data1,<span class="at">method=</span><span class="st">&#39;t&#39;</span>, <span class="at">design=</span><span class="st">&#39;batch&#39;</span>)</span>
<span id="cb19-7"><a href="clinic-trail-design.html#cb19-7" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">data=</span>data2,<span class="at">method=</span><span class="st">&#39;t&#39;</span>, <span class="at">design=</span><span class="st">&#39;batch&#39;</span>)</span>
<span id="cb19-8"><a href="clinic-trail-design.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res1, <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>))</span>
<span id="cb19-9"><a href="clinic-trail-design.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res2, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-10"><a href="clinic-trail-design.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">8</span>, <span class="at">xjust=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>),</span>
<span id="cb19-11"><a href="clinic-trail-design.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Dose of 100&#39;</span>, <span class="st">&#39;Dose of 300&#39;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="clinic-trail-design.html#cb20-1" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Rats,Rats<span class="sc">$</span>dose<span class="sc">==</span><span class="dv">100</span> <span class="sc">|</span> Rats<span class="sc">$</span>dose<span class="sc">==</span><span class="dv">300</span>)</span>
<span id="cb20-2"><a href="clinic-trail-design.html#cb20-2" aria-hidden="true" tabindex="-1"></a>data3<span class="sc">$</span>group <span class="ot">&lt;-</span> data3<span class="sc">$</span>dose</span>
<span id="cb20-3"><a href="clinic-trail-design.html#cb20-3" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">data=</span>data3,<span class="at">method=</span><span class="st">&#39;t&#39;</span>, <span class="at">design=</span><span class="st">&#39;batch&#39;</span>)</span>
<span id="cb20-4"><a href="clinic-trail-design.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res3,<span class="at">bygroup=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="clinic-trail-design.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## complete data design example</span></span>
<span id="cb21-2"><a href="clinic-trail-design.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">## originally in Hand and Crowler (1996)</span></span>
<span id="cb21-3"><a href="clinic-trail-design.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Glucose)</span>
<span id="cb21-4"><a href="clinic-trail-design.html#cb21-4" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Glucose, date<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb21-5"><a href="clinic-trail-design.html#cb21-5" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Glucose, date<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb21-6"><a href="clinic-trail-design.html#cb21-6" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">conc=</span>data1<span class="sc">$</span>conc, <span class="at">time=</span>data1<span class="sc">$</span>time, <span class="at">design=</span><span class="st">&#39;complete&#39;</span>, <span class="at">method=</span><span class="st">&#39;t&#39;</span>)</span>
<span id="cb21-7"><a href="clinic-trail-design.html#cb21-7" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="at">conc=</span>data2<span class="sc">$</span>conc, <span class="at">time=</span>data2<span class="sc">$</span>time, <span class="at">design=</span><span class="st">&#39;complete&#39;</span>, <span class="at">method=</span><span class="st">&#39;t&#39;</span>)</span>
<span id="cb21-8"><a href="clinic-trail-design.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res1, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb21-9"><a href="clinic-trail-design.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res2, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-4.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="clinic-trail-design.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## more informative plot</span></span>
<span id="cb22-2"><a href="clinic-trail-design.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">type=</span><span class="st">&#39;n&#39;</span>, <span class="at">main=</span><span class="st">&#39;Complete Data Design&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Time&#39;</span>,</span>
<span id="cb22-3"><a href="clinic-trail-design.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&#39;Concentration&#39;</span>)</span>
<span id="cb22-4"><a href="clinic-trail-design.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(Glucose<span class="sc">$</span>id)){</span>
<span id="cb22-5"><a href="clinic-trail-design.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">unique</span>(Glucose<span class="sc">$</span>date)){</span>
<span id="cb22-6"><a href="clinic-trail-design.html#cb22-6" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(Glucose, id<span class="sc">==</span>i <span class="sc">&amp;</span> date<span class="sc">==</span>j)</span>
<span id="cb22-7"><a href="clinic-trail-design.html#cb22-7" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(j<span class="sc">==</span><span class="dv">1</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;red&#39;</span>)</span>
<span id="cb22-8"><a href="clinic-trail-design.html#cb22-8" aria-hidden="true" tabindex="-1"></a>lty <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(j<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-9"><a href="clinic-trail-design.html#cb22-9" aria-hidden="true" tabindex="-1"></a>pch <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(j<span class="sc">==</span><span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">21</span>)</span>
<span id="cb22-10"><a href="clinic-trail-design.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>temp<span class="sc">$</span>time, <span class="at">y=</span>temp<span class="sc">$</span>conc, <span class="at">col=</span>col, <span class="at">lty=</span>lty, <span class="at">pch=</span>pch, <span class="at">type=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb22-11"><a href="clinic-trail-design.html#cb22-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-12"><a href="clinic-trail-design.html#cb22-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-13"><a href="clinic-trail-design.html#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">30</span>, <span class="at">y=</span><span class="dv">5</span>, <span class="at">xjust=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">21</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb22-14"><a href="clinic-trail-design.html#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Date 1&#39;</span>, <span class="st">&#39;Date 2&#39;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-5.png" width="672" /></p>
</div>
<div id="auc-in-complete-data-design" class="section level3" number="24.4.2">
<h3><span class="header-section-number">24.4.2</span> AUC in complete data design</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="clinic-trail-design.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PK)</span>
<span id="cb23-2"><a href="clinic-trail-design.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="do">## dataset Indometh of package datasets</span></span>
<span id="cb23-3"><a href="clinic-trail-design.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate individual AUCs</span></span>
<span id="cb23-4"><a href="clinic-trail-design.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(datasets)</span>
<span id="cb23-5"><a href="clinic-trail-design.html#cb23-5" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-6"><a href="clinic-trail-design.html#cb23-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(Indometh<span class="sc">$</span>Subject)), <span class="at">ncol=</span><span class="dv">2</span>))</span>
<span id="cb23-7"><a href="clinic-trail-design.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;auc&#39;</span>)</span>
<span id="cb23-8"><a href="clinic-trail-design.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="clinic-trail-design.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(Indometh<span class="sc">$</span>Subject)){</span>
<span id="cb23-10"><a href="clinic-trail-design.html#cb23-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(Indometh, i<span class="sc">==</span>Subject)</span>
<span id="cb23-11"><a href="clinic-trail-design.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  res[row, <span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb23-12"><a href="clinic-trail-design.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  res[row, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">auc.complete</span>(<span class="at">data=</span>temp[,<span class="fu">c</span>(<span class="st">&quot;conc&quot;</span>,<span class="st">&quot;time&quot;</span>)])<span class="sc">$</span>est[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb23-13"><a href="clinic-trail-design.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  row <span class="ot">&lt;-</span> row <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb23-14"><a href="clinic-trail-design.html#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-15"><a href="clinic-trail-design.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res)</span></code></pre></div>
<pre><code>##   id     auc
## 1  1 1.55375
## 2  2 2.67875
## 3  3 2.59375
## 4  4 2.24625
## 5  5 1.69750
## 6  6 2.58375</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="clinic-trail-design.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to get geometric mean and corresponding CI</span></span>
<span id="cb25-2"><a href="clinic-trail-design.html#cb25-2" aria-hidden="true" tabindex="-1"></a>gm.ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">conf.level=</span><span class="fl">0.95</span>){</span>
<span id="cb25-3"><a href="clinic-trail-design.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x=</span><span class="fu">log</span>(x), <span class="at">conf.level=</span>conf.level)</span>
<span id="cb25-4"><a href="clinic-trail-design.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gm=</span><span class="fu">as.double</span>(<span class="fu">exp</span>(res<span class="sc">$</span>estimate)), </span>
<span id="cb25-5"><a href="clinic-trail-design.html#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lower=</span><span class="fu">exp</span>(res<span class="sc">$</span>conf.int[<span class="dv">1</span>]),</span>
<span id="cb25-6"><a href="clinic-trail-design.html#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">upper=</span><span class="fu">exp</span>(res<span class="sc">$</span>conf.int[<span class="dv">2</span>]))</span>
<span id="cb25-7"><a href="clinic-trail-design.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb25-8"><a href="clinic-trail-design.html#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="clinic-trail-design.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># geometric mean and corresponding CI: assuming log-normal distributed AUCs</span></span>
<span id="cb25-10"><a href="clinic-trail-design.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gm.ci</span>(res[,<span class="dv">2</span>], <span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##         gm    lower    upper
## 1 2.176674 1.698257 2.789865</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="clinic-trail-design.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arithmetic mean and corresponding CI: assuming normal distributed AUCs</span></span>
<span id="cb27-2"><a href="clinic-trail-design.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or at least asymptotic normal distributed arithmetic mean</span></span>
<span id="cb27-3"><a href="clinic-trail-design.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x=</span>res[,<span class="dv">2</span>], <span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  res[, 2]
## t = 11.129, df = 5, p-value = 0.0001021
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  1.711541 2.739709
## sample estimates:
## mean of x 
##  2.225625</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="clinic-trail-design.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively: function auc.complete to calcluate arithmetic mean </span></span>
<span id="cb29-2"><a href="clinic-trail-design.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">300874</span>)</span>
<span id="cb29-3"><a href="clinic-trail-design.html#cb29-3" aria-hidden="true" tabindex="-1"></a>Indometh<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">as.character</span>(Indometh<span class="sc">$</span>Subject)</span>
<span id="cb29-4"><a href="clinic-trail-design.html#cb29-4" aria-hidden="true" tabindex="-1"></a>Indometh <span class="ot">&lt;-</span> Indometh[<span class="fu">order</span>(Indometh<span class="sc">$</span>id, Indometh<span class="sc">$</span>time),]</span>
<span id="cb29-5"><a href="clinic-trail-design.html#cb29-5" aria-hidden="true" tabindex="-1"></a>Indometh <span class="ot">&lt;-</span> Indometh[<span class="fu">order</span>(Indometh<span class="sc">$</span>time),]</span>
<span id="cb29-6"><a href="clinic-trail-design.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.complete</span>(<span class="at">conc=</span>Indometh<span class="sc">$</span>conc, <span class="at">time=</span>Indometh<span class="sc">$</span>time, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;t&quot;</span>))</span></code></pre></div>
<pre><code>## Estimation for a complete data design
## 
##              Estimate   SE    95% t-CI
## AUC to tlast     2.23 0.20 (1.71;2.74)</code></pre>
</div>
<div id="auc-in-repeated-complete-data-design" class="section level3" number="24.4.3">
<h3><span class="header-section-number">24.4.3</span> AUC in repeated complete data design</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="clinic-trail-design.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PK)</span>
<span id="cb31-2"><a href="clinic-trail-design.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="clinic-trail-design.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">## example for comparing AUCs assessed in a repeated complete data design</span></span>
<span id="cb31-4"><a href="clinic-trail-design.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (dataset: Glucose)</span></span>
<span id="cb31-5"><a href="clinic-trail-design.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate individual AUCs</span></span>
<span id="cb31-6"><a href="clinic-trail-design.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Glucose)</span>
<span id="cb31-7"><a href="clinic-trail-design.html#cb31-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(Glucose<span class="sc">$</span>id))<span class="sc">*</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb31-8"><a href="clinic-trail-design.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;auc&#39;</span>)</span>
<span id="cb31-9"><a href="clinic-trail-design.html#cb31-9" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-10"><a href="clinic-trail-design.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(Glucose<span class="sc">$</span>id)){</span>
<span id="cb31-11"><a href="clinic-trail-design.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">unique</span>(Glucose<span class="sc">$</span>date)){</span>
<span id="cb31-12"><a href="clinic-trail-design.html#cb31-12" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(Glucose, id<span class="sc">==</span>i <span class="sc">&amp;</span> date<span class="sc">==</span>j)</span>
<span id="cb31-13"><a href="clinic-trail-design.html#cb31-13" aria-hidden="true" tabindex="-1"></a>res[row, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(i,j)</span>
<span id="cb31-14"><a href="clinic-trail-design.html#cb31-14" aria-hidden="true" tabindex="-1"></a>res[row, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">auc.complete</span>(<span class="at">data=</span>temp[,<span class="fu">c</span>(<span class="st">&quot;conc&quot;</span>,<span class="st">&quot;time&quot;</span>)])<span class="sc">$</span>est[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb31-15"><a href="clinic-trail-design.html#cb31-15" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> row <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-16"><a href="clinic-trail-design.html#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-17"><a href="clinic-trail-design.html#cb31-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-18"><a href="clinic-trail-design.html#cb31-18" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> res[<span class="fu">order</span>(res<span class="sc">$</span>id, res<span class="sc">$</span>date),]</span>
<span id="cb31-19"><a href="clinic-trail-design.html#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res)</span></code></pre></div>
<pre><code>##    id date    auc
## 1   1    1 18.600
## 2   1    2 35.300
## 3   2    1 33.200
## 4   2    2 21.400
## 5   3    1 34.700
## 6   3    2 14.600
## 7   4    1 17.000
## 8   4    2 22.150
## 9   5    1 28.575
## 10  5    2 27.750
## 11  6    1  9.650
## 12  6    2 24.825
## 13  7    1 57.600
## 14  7    2 31.800</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="clinic-trail-design.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming log-normally distributed AUCs</span></span>
<span id="cb33-2"><a href="clinic-trail-design.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># geometric means and corresponding two-sided CIs per date</span></span>
<span id="cb33-3"><a href="clinic-trail-design.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(res<span class="sc">$</span>auc, res<span class="sc">$</span>date, gm.ci)</span></code></pre></div>
<pre><code>## $`1`
##         gm    lower    upper
## 1 24.80982 14.46001 42.56755
## 
## $`2`
##         gm    lower    upper
## 1 24.53494 18.71898 32.15789</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="clinic-trail-design.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparison of AUCs using ratio of geometric means and corresponding two-sided CI</span></span>
<span id="cb35-2"><a href="clinic-trail-design.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># repeated experiment</span></span>
<span id="cb35-3"><a href="clinic-trail-design.html#cb35-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">log</span>(auc)<span class="sc">~</span>date, <span class="at">data=</span>res, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">conf.level=</span><span class="fl">0.90</span>)</span>
<span id="cb35-4"><a href="clinic-trail-design.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">as.double</span>(model<span class="sc">$</span>estimate))</span></code></pre></div>
<pre><code>## [1] 1.011204</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="clinic-trail-design.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(model<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>## [1] 0.6196065 1.6502947
## attr(,&quot;conf.level&quot;)
## [1] 0.9</code></pre>
</div>
<div id="bioequivalence-between-aucs" class="section level3" number="24.4.4">
<h3><span class="header-section-number">24.4.4</span> Bioequivalence between AUCs</h3>
<p>Confidence intervals for the ratio of independent or dependent area under the concentration versus time curves (AUCs) to the last time point.</p>
<p>The fieller method is based on Fieller’s theorem (1954) which uses the asymptotic standard errors of the individual AUCs and a critical value from a t-distribution with Satterthwaite’s approximation (1946) to the degrees of freedom for calculation of confidence intervals. The z method is based onthe limit distribution for the ratio using the critical value from a normal distribution for calculation of confidence intervals.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="clinic-trail-design.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb39-2"><a href="clinic-trail-design.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="do">### For API access and XML processing and CSM analysis</span></span>
<span id="cb39-3"><a href="clinic-trail-design.html#cb39-3" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;PK&quot;</span>,<span class="st">&quot;knitr&quot;</span>,<span class="st">&quot;kableExtra&quot;</span>,<span class="st">&quot;sjPlot&quot;</span>)</span>
<span id="cb39-4"><a href="clinic-trail-design.html#cb39-4" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb39-5"><a href="clinic-trail-design.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb39-6"><a href="clinic-trail-design.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb39-7"><a href="clinic-trail-design.html#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-8"><a href="clinic-trail-design.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-9"><a href="clinic-trail-design.html#cb39-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-10"><a href="clinic-trail-design.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(packages)</span></code></pre></div>
<pre><code>##         PK      knitr kableExtra     sjPlot 
##       TRUE       TRUE       TRUE       TRUE</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="clinic-trail-design.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## example of a serial sampling design from Nedelman et al. (1995)</span></span>
<span id="cb41-2"><a href="clinic-trail-design.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CPI975)</span>
<span id="cb41-3"><a href="clinic-trail-design.html#cb41-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(CPI975,dose<span class="sc">&gt;=</span><span class="dv">30</span>)</span>
<span id="cb41-4"><a href="clinic-trail-design.html#cb41-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>concadj <span class="ot">&lt;-</span> data<span class="sc">$</span>conc <span class="sc">/</span> data<span class="sc">$</span>dose</span>
<span id="cb41-5"><a href="clinic-trail-design.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="clinic-trail-design.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fieller and z-interval for ratio of dose-normalized AUCs</span></span>
<span id="cb41-7"><a href="clinic-trail-design.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">eqv</span>(<span class="at">conc=</span>data<span class="sc">$</span>concadj, <span class="at">time=</span>data<span class="sc">$</span>time, <span class="at">group=</span>data<span class="sc">$</span>dose, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;z&quot;</span>,<span class="st">&quot;fieller&quot;</span>), <span class="at">design=</span><span class="st">&quot;ssd&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a serial sampling design
## 
##                                    Estimate    SE 90% fieller-CI
## ratio of independent AUCs to tlast    0.938 0.166   (0.676;1.28)
## 
##                                    Estimate    SE     90% z-CI
## ratio of independent AUCs to tlast    0.938 0.166 (0.665;1.21)</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="clinic-trail-design.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap-t interval for ratio of dose-normalized AUCs stratified for sex</span></span>
<span id="cb43-2"><a href="clinic-trail-design.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">310578</span>)</span>
<span id="cb43-3"><a href="clinic-trail-design.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eqv</span>(<span class="at">conc=</span>data<span class="sc">$</span>concadj, <span class="at">time=</span>data<span class="sc">$</span>time, <span class="at">group=</span>data<span class="sc">$</span>dose, <span class="at">method=</span><span class="st">&quot;boott&quot;</span>,</span>
<span id="cb43-4"><a href="clinic-trail-design.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">strata=</span>data<span class="sc">$</span>sex, <span class="at">nsample=</span><span class="dv">500</span>, <span class="at">design=</span><span class="st">&quot;ssd&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a serial sampling design
## 
##                                    Estimate    SE 90% boott-CI
## ratio of independent AUCs to tlast    0.938 0.166 (0.794;1.11)</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="clinic-trail-design.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example of an independent batch design from Yeh (1990)</span></span>
<span id="cb45-2"><a href="clinic-trail-design.html#cb45-2" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">batch1=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="fl">4.690</span>,<span class="fl">2.070</span>,<span class="fl">6.450</span>,<span class="fl">0.1</span>,<span class="fl">0.852</span>,<span class="fl">0.136</span>,</span>
<span id="cb45-3"><a href="clinic-trail-design.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fl">4.690</span>,<span class="fl">4.060</span>,<span class="fl">6.450</span>,<span class="fl">0.531</span>,<span class="fl">1.2</span>,<span class="fl">0.607</span>),</span>
<span id="cb45-4"><a href="clinic-trail-design.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="at">batch2=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="fl">1.3</span>,<span class="fl">3.2</span>,<span class="fl">0.074</span>,<span class="fl">0.164</span>,<span class="fl">0.267</span>, <span class="fl">6.68</span>,<span class="fl">3.83</span>,<span class="fl">6.08</span>,<span class="fl">0.669</span>,<span class="fl">1.21</span>,<span class="fl">0.878</span>,</span>
<span id="cb45-5"><a href="clinic-trail-design.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fl">8.13</span>,<span class="fl">9.54</span>,<span class="fl">6.29</span>,<span class="fl">0.923</span>,<span class="fl">1.65</span>,<span class="fl">1.04</span>),</span>
<span id="cb45-6"><a href="clinic-trail-design.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="at">batch3=</span><span class="fu">c</span>(<span class="fl">9.360</span>,<span class="dv">13</span>,<span class="fl">5.48</span>,<span class="fl">1.090</span>,<span class="fl">1.370</span>,<span class="fl">1.430</span>, <span class="fl">5.180</span>,<span class="fl">5.180</span>,<span class="fl">2.79</span>,<span class="fl">0.804</span>,<span class="fl">1.47</span>,<span class="fl">1.26</span>,</span>
<span id="cb45-7"><a href="clinic-trail-design.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.060</span>,<span class="fl">2.15</span>,<span class="fl">0.827</span>,<span class="fl">0.217</span>,<span class="fl">0.42</span>,<span class="fl">0.35</span>))</span>
<span id="cb45-8"><a href="clinic-trail-design.html#cb45-8" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">batch1=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">6</span>)),</span>
<span id="cb45-9"><a href="clinic-trail-design.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="at">batch2=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.5</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">6</span>,<span class="dv">6</span>)),</span>
<span id="cb45-10"><a href="clinic-trail-design.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="at">batch3=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">8</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">12</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">24</span>,<span class="dv">6</span>)))</span>
<span id="cb45-11"><a href="clinic-trail-design.html#cb45-11" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">batch1=</span><span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">each=</span><span class="dv">3</span>),<span class="dv">3</span>), <span class="at">batch2=</span><span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">each=</span><span class="dv">3</span>),<span class="dv">3</span>),</span>
<span id="cb45-12"><a href="clinic-trail-design.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="at">batch3=</span><span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">each=</span><span class="dv">3</span>),<span class="dv">3</span>))</span>
<span id="cb45-13"><a href="clinic-trail-design.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">eqv</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">group=</span>group, <span class="at">dependent=</span><span class="cn">FALSE</span>, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;fieller&quot;</span>),</span>
<span id="cb45-14"><a href="clinic-trail-design.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="at">conf.level=</span><span class="fl">0.90</span>, <span class="at">design=</span><span class="st">&quot;batch&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a batch design
## 
##                                    Estimate    SE 90% fieller-CI
## ratio of independent AUCs to tlast     5.25 0.925    (3.77;7.17)</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="clinic-trail-design.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## example of a complete data design from Hand and Crowder (1996)</span></span>
<span id="cb47-2"><a href="clinic-trail-design.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Glucose)</span>
<span id="cb47-3"><a href="clinic-trail-design.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">271184</span>)</span>
<span id="cb47-4"><a href="clinic-trail-design.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eqv</span>(<span class="at">conc=</span>Glucose<span class="sc">$</span>conc, <span class="at">time=</span>Glucose<span class="sc">$</span>time, <span class="at">group=</span>Glucose<span class="sc">$</span>date,</span>
<span id="cb47-5"><a href="clinic-trail-design.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="at">dependent=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;fieller&quot;</span>, <span class="st">&quot;z&quot;</span>), <span class="at">conf.level=</span><span class="fl">0.90</span>,</span>
<span id="cb47-6"><a href="clinic-trail-design.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="at">design=</span><span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a complete data design
## 
##                                  Estimate    SE 90% fieller-CI
## ratio of dependent AUCs to tlast     1.12 0.253   (0.656;1.67)
## 
##                                  Estimate    SE     90% z-CI
## ratio of dependent AUCs to tlast     1.12 0.253 (0.704;1.54)</code></pre>
</div>
<div id="two-phase-half-life-estimation-by-biexponential-model" class="section level3" number="24.4.5">
<h3><span class="header-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</h3>
<p>Estimation of initial and terminal half-life using the biexponential <span class="math inline">\(y=a 1 \star \exp (-b 1 \star x)+a 2 \star \exp (-b 2 \star x)\)</span> model with a parameterization to ensure <span class="math inline">\(\mathrm{b} 1&gt;\mathrm{b} 2&gt;0\)</span> fitted by the least squares criteria with function optim of package base with method “Nelder-Mead”. Curve peeling (Foss, 1969) is used get start values for nonlinear model fitting. When no adequate starting values are determined by curve peeling, a single exponential model is fitted with starting values obtained from an OLS regression on log transformed values with a parameterization to ensure a slope <span class="math inline">\(&gt;0\)</span>.</p>
<p>Fitting on the log-scale is based on the transform-both-sides approach described for example in chapter 4 of Bonate (2006) which is useful for some error distributions. An additional discussion regarding weighting schemes can be found in Gabrielsson and Weiner (2000, pages 368-374).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="clinic-trail-design.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb49-2"><a href="clinic-trail-design.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">### For API access and XML processing and CSM analysis</span></span>
<span id="cb49-3"><a href="clinic-trail-design.html#cb49-3" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;PK&quot;</span>,<span class="st">&quot;knitr&quot;</span>,<span class="st">&quot;kableExtra&quot;</span>,<span class="st">&quot;sjPlot&quot;</span>)</span>
<span id="cb49-4"><a href="clinic-trail-design.html#cb49-4" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb49-5"><a href="clinic-trail-design.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb49-6"><a href="clinic-trail-design.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb49-7"><a href="clinic-trail-design.html#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-8"><a href="clinic-trail-design.html#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-9"><a href="clinic-trail-design.html#cb49-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-10"><a href="clinic-trail-design.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(packages)</span></code></pre></div>
<pre><code>##         PK      knitr kableExtra     sjPlot 
##       TRUE       TRUE       TRUE       TRUE</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="clinic-trail-design.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### example from Pinheiro J.C. and Bates D.M. (2000, page 279)</span></span>
<span id="cb51-2"><a href="clinic-trail-design.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### dataset Indometh of package datasets</span></span>
<span id="cb51-3"><a href="clinic-trail-design.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(datasets)</span>
<span id="cb51-4"><a href="clinic-trail-design.html#cb51-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(Indometh, Subject<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb51-5"><a href="clinic-trail-design.html#cb51-5" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> data<span class="sc">$</span>time</span>
<span id="cb51-6"><a href="clinic-trail-design.html#cb51-6" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> data<span class="sc">$</span>conc</span>
<span id="cb51-7"><a href="clinic-trail-design.html#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="clinic-trail-design.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="do">## fitting on observed and log-scale</span></span>
<span id="cb51-9"><a href="clinic-trail-design.html#cb51-9" aria-hidden="true" tabindex="-1"></a>res.obs <span class="ot">&lt;-</span> <span class="fu">biexp</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">log.scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb51-10"><a href="clinic-trail-design.html#cb51-10" aria-hidden="true" tabindex="-1"></a>res.log <span class="ot">&lt;-</span> <span class="fu">biexp</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">log.scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-11"><a href="clinic-trail-design.html#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="clinic-trail-design.html#cb51-12" aria-hidden="true" tabindex="-1"></a>res.obs<span class="sc">$</span>parms <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="clinic-trail-design.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;fitting on observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-14"><a href="clinic-trail-design.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-6">Table 24.1: </span>fitting on observed
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
initial
</th>
<th style="text-align:right;">
terminal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
halflife
</td>
<td style="text-align:right;">
0.3110178
</td>
<td style="text-align:right;">
3.5560198
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
2.2286415
</td>
<td style="text-align:right;">
0.1949222
</td>
</tr>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
2.8277042
</td>
<td style="text-align:right;">
0.4989805
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="clinic-trail-design.html#cb52-1" aria-hidden="true" tabindex="-1"></a>res.log<span class="sc">$</span>parms <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="clinic-trail-design.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;fitting on log-scale&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="clinic-trail-design.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-6">Table 24.1: </span>fitting on log-scale
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
initial
</th>
<th style="text-align:right;">
terminal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
halflife
</td>
<td style="text-align:right;">
0.2372868
</td>
<td style="text-align:right;">
2.6423652
</td>
</tr>
<tr>
<td style="text-align:left;">
slope
</td>
<td style="text-align:right;">
2.9211372
</td>
<td style="text-align:right;">
0.2623207
</td>
</tr>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
3.1792811
</td>
<td style="text-align:right;">
0.6673897
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="clinic-trail-design.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot Con-Time curve</span></span>
<span id="cb53-2"><a href="clinic-trail-design.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.obs, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(time)), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb53-3"><a href="clinic-trail-design.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.log, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(time)), <span class="at">las=</span><span class="dv">1</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb53-4"><a href="clinic-trail-design.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">5</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;fitted on observed scale&quot;</span>, <span class="st">&quot;fitted on log-scale&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="clinic-trail-design.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Biexponential model</span></span>
<span id="cb54-2"><a href="clinic-trail-design.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## get residuals using function nls with tol=Inf</span></span>
<span id="cb54-3"><a href="clinic-trail-design.html#cb54-3" aria-hidden="true" tabindex="-1"></a>parms.obs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a1=</span>res.obs<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">b1=</span>res.obs<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">a2=</span>res.obs<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb54-4"><a href="clinic-trail-design.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="at">b2=</span>res.obs<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb54-5"><a href="clinic-trail-design.html#cb54-5" aria-hidden="true" tabindex="-1"></a>parms.log <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a1=</span>res.log<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">b1=</span>res.log<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">a2=</span>res.log<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb54-6"><a href="clinic-trail-design.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="at">b2=</span>res.log<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb54-7"><a href="clinic-trail-design.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="do">## get residuals using function nls with tol=Inf</span></span>
<span id="cb54-8"><a href="clinic-trail-design.html#cb54-8" aria-hidden="true" tabindex="-1"></a>parms.obs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a1=</span>res.obs<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">b1=</span>res.obs<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">a2=</span>res.obs<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb54-9"><a href="clinic-trail-design.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="at">b2=</span>res.obs<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb54-10"><a href="clinic-trail-design.html#cb54-10" aria-hidden="true" tabindex="-1"></a>parms.log <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a1=</span>res.log<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">b1=</span>res.log<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">a2=</span>res.log<span class="sc">$</span>parms[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb54-11"><a href="clinic-trail-design.html#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="at">b2=</span>res.log<span class="sc">$</span>parms[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb54-12"><a href="clinic-trail-design.html#cb54-12" aria-hidden="true" tabindex="-1"></a>mod.obs <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time), <span class="at">start=</span>parms.obs,</span>
<span id="cb54-13"><a href="clinic-trail-design.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="at">control=</span><span class="fu">nls.control</span>(<span class="at">tol=</span><span class="cn">Inf</span>))</span>
<span id="cb54-14"><a href="clinic-trail-design.html#cb54-14" aria-hidden="true" tabindex="-1"></a>mod.log <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time), <span class="at">start=</span>parms.log,</span>
<span id="cb54-15"><a href="clinic-trail-design.html#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="at">control=</span><span class="fu">nls.control</span>(<span class="at">tol=</span><span class="cn">Inf</span>))</span>
<span id="cb54-16"><a href="clinic-trail-design.html#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="clinic-trail-design.html#cb54-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb54-18"><a href="clinic-trail-design.html#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="do">### ## identical estimates to mod.log but different SEs</span></span>
<span id="cb54-19"><a href="clinic-trail-design.html#cb54-19" aria-hidden="true" tabindex="-1"></a>mod.logconc <span class="ot">&lt;-</span> <span class="fu">nls</span>(<span class="fu">log</span>(conc)<span class="sc">~</span><span class="fu">log</span>(a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time)), <span class="at">start=</span>parms.log,</span>
<span id="cb54-20"><a href="clinic-trail-design.html#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="at">control=</span><span class="fu">nls.control</span>(<span class="at">tol=</span><span class="cn">Inf</span>))</span>
<span id="cb54-21"><a href="clinic-trail-design.html#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(mod.log,mod.logconc) </span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Dependent variable
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Dependent variable
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
a1
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.55 – 4.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.002</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06 – 6.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.054
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
b1
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.18 – 5.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.040</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.47 – 5.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>0.026</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
a2
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.18 – 1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.104
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.31 – 1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>0.003</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
b2
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.13 – 0.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.159
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.16 – 0.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
11
</td>
</tr>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="clinic-trail-design.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## different approach using weighted least squares (WLS) in nls</span></span>
<span id="cb55-2"><a href="clinic-trail-design.html#cb55-2" aria-hidden="true" tabindex="-1"></a>mod.ols <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time), <span class="at">start=</span>parms.obs)</span>
<span id="cb55-3"><a href="clinic-trail-design.html#cb55-3" aria-hidden="true" tabindex="-1"></a>mod.wls1 <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time), <span class="at">start=</span>parms.obs,</span>
<span id="cb55-4"><a href="clinic-trail-design.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="at">weight=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">predict</span>(mod.ols)<span class="sc">^</span><span class="dv">1</span>)</span>
<span id="cb55-5"><a href="clinic-trail-design.html#cb55-5" aria-hidden="true" tabindex="-1"></a>mod.wls2 <span class="ot">&lt;-</span> <span class="fu">nls</span>(conc <span class="sc">~</span> a1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b1<span class="sc">*</span>time) <span class="sc">+</span> a2<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>b2<span class="sc">*</span>time), <span class="at">start=</span>parms.obs,</span>
<span id="cb55-6"><a href="clinic-trail-design.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="at">weight=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">predict</span>(mod.ols)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-7"><a href="clinic-trail-design.html#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="clinic-trail-design.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">split.screen</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="clinic-trail-design.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screen</span>(<span class="dv">1</span>)</span>
<span id="cb57-2"><a href="clinic-trail-design.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>,<span class="fl">0.35</span>), <span class="at">y=</span><span class="fu">resid</span>(mod.obs), <span class="at">x=</span><span class="fu">predict</span>(mod.obs), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb57-3"><a href="clinic-trail-design.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&#39;Fitted using biexp on observed scale&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Predicted&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Residual&#39;</span>)</span>
<span id="cb57-4"><a href="clinic-trail-design.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb57-5"><a href="clinic-trail-design.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">screen</span>(<span class="dv">2</span>)</span>
<span id="cb57-6"><a href="clinic-trail-design.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>,<span class="fl">0.35</span>), <span class="at">y=</span><span class="fu">resid</span>(mod.log), <span class="at">x=</span><span class="fu">predict</span>(mod.log), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb57-7"><a href="clinic-trail-design.html#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&#39;Fitted using biexp on log-scale&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Predicted&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Residual&#39;</span>)</span>
<span id="cb57-8"><a href="clinic-trail-design.html#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb57-9"><a href="clinic-trail-design.html#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">screen</span>(<span class="dv">3</span>)</span>
<span id="cb57-10"><a href="clinic-trail-design.html#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>,<span class="fl">0.35</span>), <span class="at">y=</span><span class="fu">resid</span>(mod.wls1), <span class="at">x=</span><span class="fu">predict</span>(mod.wls1), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb57-11"><a href="clinic-trail-design.html#cb57-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&#39;Fitted using nls with weights 1/predict(mod.ols)^1&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Predicted&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Residual&#39;</span>)</span>
<span id="cb57-12"><a href="clinic-trail-design.html#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb57-13"><a href="clinic-trail-design.html#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="fu">screen</span>(<span class="dv">4</span>)</span>
<span id="cb57-14"><a href="clinic-trail-design.html#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>,<span class="fl">0.35</span>), <span class="at">y=</span><span class="fu">resid</span>(mod.wls2), <span class="at">x=</span><span class="fu">predict</span>(mod.wls2), <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb57-15"><a href="clinic-trail-design.html#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&#39;Fitted using nls with weights 1/predict(mod.ols)^2&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;Predicted&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Residual&#39;</span>)</span>
<span id="cb57-16"><a href="clinic-trail-design.html#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="clinic-trail-design.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">close.screen</span>(<span class="at">all.screens=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="two-phase-half-life-estimation-by-linear-fitting" class="section level3" number="24.4.6">
<h3><span class="header-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</h3>
<p>Estimation of initial and terminal half-life based on the method of Lee et al. (1990). This method uses a two-phase linear regression approach separate the model into two straight lines based on the selection of the log10 transformed concentration values. For two-phase models the initial and terminal half-lives were determined from the slopes of the regression lines. If a single-phase model is selected by this method, the corresponding half-life is utilized as both initial and terminal phase half-life. Half-life is determined only for decreasing initial and terminal phases.</p>
<ul>
<li>The method ols uses the ordinary least squares regression (OLS) to fit regression lines</li>
<li>The method lad uses the absolute deviation regression (LAD) to fit regression lines by using the algorithm as described in Birkes and Dodge (chapter 4, 1993) for calculation of regression estimates.</li>
<li>The method hub uses the Huber M regression to fit regression lines. Huber M-estimates are calculated by non-linear estimation using the function optim, where OLS regression parameters are used as starting values. The function that is minimized involved k = 1.5<em>1.483</em>MAD, where MAD is defined as the median of absolute deviation of residuals obtained by a least absolute deviation (LAD) regression based on the observed data. The initial value of MAD is used and not updated during iterations (Holland and Welsch, 1977).</li>
<li>The method npr uses the nonparametric regression to fit regression lines by using the algorithm as described in Birkes and Dodge (chapter 6, 1993) for calculation of regression estimates.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="clinic-trail-design.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb59-2"><a href="clinic-trail-design.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="do">### For API access and XML processing and CSM analysis</span></span>
<span id="cb59-3"><a href="clinic-trail-design.html#cb59-3" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;PK&quot;</span>,<span class="st">&quot;knitr&quot;</span>,<span class="st">&quot;kableExtra&quot;</span>,<span class="st">&quot;sjPlot&quot;</span>)</span>
<span id="cb59-4"><a href="clinic-trail-design.html#cb59-4" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb59-5"><a href="clinic-trail-design.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb59-6"><a href="clinic-trail-design.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb59-7"><a href="clinic-trail-design.html#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-8"><a href="clinic-trail-design.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-9"><a href="clinic-trail-design.html#cb59-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-10"><a href="clinic-trail-design.html#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(packages)</span></code></pre></div>
<pre><code>##         PK      knitr kableExtra     sjPlot 
##       TRUE       TRUE       TRUE       TRUE</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="clinic-trail-design.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## When lt=TRUE, the best two-phase model where terminal half-life &gt;= initial half-life &gt;= 0 is selected. When lt=FALSE, the best two-phase model among all possible tuples of regression is selected which can result in longer initial half-life than terminal half-life and/or in half-lifes &lt; 0</span></span>
<span id="cb61-2"><a href="clinic-trail-design.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="clinic-trail-design.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### example for preparation 1 from Lee et al. (1990)</span></span>
<span id="cb61-4"><a href="clinic-trail-design.html#cb61-4" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">4.0</span>, <span class="fl">8.0</span>, <span class="fl">12.0</span>, <span class="fl">24.0</span>)</span>
<span id="cb61-5"><a href="clinic-trail-design.html#cb61-5" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">72</span>, <span class="dv">61</span>, <span class="dv">54</span>, <span class="dv">36</span>, <span class="dv">6</span>)</span>
<span id="cb61-6"><a href="clinic-trail-design.html#cb61-6" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">lee</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">method=</span><span class="st">&#39;ols&#39;</span>, <span class="at">points=</span><span class="dv">2</span>, <span class="at">lt=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-7"><a href="clinic-trail-design.html#cb61-7" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">lee</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">method=</span><span class="st">&#39;ols&#39;</span>, <span class="at">points=</span><span class="dv">2</span>, <span class="at">lt=</span><span class="cn">FALSE</span>) </span>
<span id="cb61-8"><a href="clinic-trail-design.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res1, <span class="at">log=</span><span class="st">&#39;y&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))</span>
<span id="cb61-9"><a href="clinic-trail-design.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res2, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="clinic-trail-design.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### dataset Indometh of package datasets</span></span>
<span id="cb62-2"><a href="clinic-trail-design.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(datasets)</span>
<span id="cb62-3"><a href="clinic-trail-design.html#cb62-3" aria-hidden="true" tabindex="-1"></a>res5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol=</span><span class="dv">3</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(Indometh<span class="sc">$</span>Subject))))</span>
<span id="cb62-4"><a href="clinic-trail-design.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res5) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;ID&#39;</span>, <span class="st">&#39;initial&#39;</span>, <span class="st">&#39;terminal&#39;</span>)</span>
<span id="cb62-5"><a href="clinic-trail-design.html#cb62-5" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-6"><a href="clinic-trail-design.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(Indometh<span class="sc">$</span>Subject)){</span>
<span id="cb62-7"><a href="clinic-trail-design.html#cb62-7" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(Indometh, Subject<span class="sc">==</span>i)</span>
<span id="cb62-8"><a href="clinic-trail-design.html#cb62-8" aria-hidden="true" tabindex="-1"></a>res5[row, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">unique</span>(temp<span class="sc">$</span>Subject)</span>
<span id="cb62-9"><a href="clinic-trail-design.html#cb62-9" aria-hidden="true" tabindex="-1"></a>res5[row, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="fu">lee</span>(<span class="at">conc=</span>temp<span class="sc">$</span>conc, <span class="at">time=</span>temp<span class="sc">$</span>time, <span class="at">method=</span><span class="st">&#39;lad&#39;</span>)<span class="sc">$</span>parms[<span class="dv">1</span>,]</span>
<span id="cb62-10"><a href="clinic-trail-design.html#cb62-10" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> row <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb62-11"><a href="clinic-trail-design.html#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="clinic-trail-design.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res5)</span></code></pre></div>
<pre><code>##   ID   initial terminal
## 1  1 0.4952051 3.067124
## 2  1 0.4882644 2.765073
## 3  1 0.8358964 6.838045
## 4  1 0.8015541 6.134248
## 5  1 0.3606737 4.482386
## 6  1 0.6410667 2.375232</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="clinic-trail-design.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## geometric means and corresponding two-sided CIs</span></span>
<span id="cb64-2"><a href="clinic-trail-design.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(res5<span class="sc">$</span>initial)))</span></code></pre></div>
<pre><code>## [1] 0.5784385</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="clinic-trail-design.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">t.test</span>(<span class="fu">log</span>(res5<span class="sc">$</span>initial), <span class="at">conf.level=</span><span class="fl">0.95</span>)<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>## [1] 0.4112240 0.8136468
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="clinic-trail-design.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(res5<span class="sc">$</span>terminal)))</span></code></pre></div>
<pre><code>## [1] 3.948127</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="clinic-trail-design.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">t.test</span>(<span class="fu">log</span>(res5<span class="sc">$</span>terminal), <span class="at">conf.level=</span><span class="fl">0.95</span>)<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>## [1] 2.492314 6.254309
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
</div>
<div id="estimation-of-various-pk-parameters" class="section level3" number="24.4.7">
<h3><span class="header-section-number">24.4.7</span> Estimation of various PK parameters</h3>
<p>Non-compartmental estimation of the area under the concentration versus time curve (AUC) to the last time point, AUC to infinity, area under the first moment curve (AUMC) to infinity, mean residence time (MRT), non-compartmental half-life, total clearance and volume of distribution at steady state.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="clinic-trail-design.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb72-2"><a href="clinic-trail-design.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">### For API access and XML processing and CSM analysis</span></span>
<span id="cb72-3"><a href="clinic-trail-design.html#cb72-3" aria-hidden="true" tabindex="-1"></a>packages<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;PK&quot;</span>,<span class="st">&quot;knitr&quot;</span>,<span class="st">&quot;kableExtra&quot;</span>,<span class="st">&quot;sjPlot&quot;</span>)</span>
<span id="cb72-4"><a href="clinic-trail-design.html#cb72-4" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb72-5"><a href="clinic-trail-design.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb72-6"><a href="clinic-trail-design.html#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb72-7"><a href="clinic-trail-design.html#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-8"><a href="clinic-trail-design.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-9"><a href="clinic-trail-design.html#cb72-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-10"><a href="clinic-trail-design.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(packages)</span></code></pre></div>
<pre><code>##         PK      knitr kableExtra     sjPlot 
##       TRUE       TRUE       TRUE       TRUE</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="clinic-trail-design.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### serial sampling designs</span></span>
<span id="cb74-2"><a href="clinic-trail-design.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">## example for a serial sampling data design from Wolfsegger and Jaki (2009)</span></span>
<span id="cb74-3"><a href="clinic-trail-design.html#cb74-3" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">2.01</span>, <span class="fl">2.85</span>, <span class="fl">2.43</span>, <span class="fl">0.85</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">0.46</span>, <span class="fl">0.35</span>, <span class="fl">0.63</span>, <span class="fl">0.39</span>, <span class="fl">0.32</span>,</span>
<span id="cb74-4"><a href="clinic-trail-design.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.45</span>, <span class="fl">0.11</span>, <span class="fl">0.18</span>, <span class="fl">0.19</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.06</span>)</span>
<span id="cb74-5"><a href="clinic-trail-design.html#cb74-5" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">60</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">6</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">9</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">16</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">24</span>,<span class="dv">3</span>))</span>
<span id="cb74-6"><a href="clinic-trail-design.html#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34534</span>)</span>
<span id="cb74-7"><a href="clinic-trail-design.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">nca.ssd</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">n.tail=</span><span class="dv">4</span>, <span class="at">dose=</span><span class="dv">200</span>, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;z&quot;</span>,<span class="st">&quot;boott&quot;</span>),</span>
<span id="cb74-8"><a href="clinic-trail-design.html#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="at">conf.level=</span><span class="fl">0.95</span>, <span class="at">nsample=</span><span class="dv">500</span>)</span></code></pre></div>
<pre><code>## Estimation for a serial sampling design
## 
##                                        Estimate     SE       95% z-CI
## AUC to tlast                              11.25  0.530 (10.21; 12.29)
## AUC to infinity                           11.98  0.534 (10.93; 13.03)
## AUMC to infinity                          85.63  6.781 (72.34; 98.92)
## Mean residence time                        7.15  0.496 ( 6.18;  8.12)
## non-compartmental half-life                4.96  0.344 ( 4.28;  5.63)
## Clearance                                 16.70  0.744 (15.24; 18.16)
## Volume of distribution at steady state   119.35 10.216 (99.33;139.38)
## 
##                                        Estimate     SE   95% boott-CI
## AUC to tlast                              11.25  0.530 ( 9.84; 12.46)
## AUC to infinity                           11.98  0.534 (10.50; 13.08)
## AUMC to infinity                          85.63  6.781 (52.84; 99.15)
## Mean residence time                        7.15  0.496 ( 5.73;  8.21)
## non-compartmental half-life                4.96  0.344 ( 3.97;  5.69)
## Clearance                                 16.70  0.744 (15.24; 18.91)
## Volume of distribution at steady state   119.35 10.216 (94.14;146.61)</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="clinic-trail-design.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### batch design:</span></span>
<span id="cb76-2"><a href="clinic-trail-design.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="do">## a batch design example from Holder et al. (1999).</span></span>
<span id="cb76-3"><a href="clinic-trail-design.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Rats)</span>
<span id="cb76-4"><a href="clinic-trail-design.html#cb76-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(Rats,Rats<span class="sc">$</span>dose<span class="sc">==</span><span class="dv">100</span>)</span>
<span id="cb76-5"><a href="clinic-trail-design.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nca</span>(<span class="at">data=</span>data, <span class="at">n.tail=</span><span class="dv">4</span>, <span class="at">dose=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;z&quot;</span>,</span>
<span id="cb76-6"><a href="clinic-trail-design.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="at">conf.level=</span><span class="fl">0.95</span>, <span class="at">design=</span><span class="st">&quot;batch&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a batch design
## 
##                                        Estimate     SE        95% z-CI
## AUC to tlast                              39.47  7.310 ( 25.14; 53.80)
## AUC to infinity                           40.68  7.396 ( 26.18; 55.17)
## AUMC to infinity                         332.35 74.792 (185.76;478.94)
## Mean residence time                        8.17  0.682 (  6.83;  9.51)
## non-compartmental half-life                5.66  0.473 (  4.74;  6.59)
## Clearance                                  2.46  0.447 (  1.58;  3.33)
## Volume of distribution at steady state    20.08  3.444 ( 13.33; 26.83)</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="clinic-trail-design.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### complete data design</span></span>
<span id="cb78-2"><a href="clinic-trail-design.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="do">## example from Gibaldi and Perrier (1982, page 436) for individual PK parameters</span></span>
<span id="cb78-3"><a href="clinic-trail-design.html#cb78-3" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.165</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>)</span>
<span id="cb78-4"><a href="clinic-trail-design.html#cb78-4" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">65.03</span>, <span class="fl">28.69</span>, <span class="fl">10.04</span>, <span class="fl">4.93</span>, <span class="fl">2.29</span>, <span class="fl">1.36</span>, <span class="fl">0.71</span>, <span class="fl">0.38</span>)</span>
<span id="cb78-5"><a href="clinic-trail-design.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># using the wrapper function</span></span>
<span id="cb78-6"><a href="clinic-trail-design.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nca</span>(<span class="at">conc=</span>conc, <span class="at">time=</span>time, <span class="at">n.tail=</span><span class="dv">3</span>, <span class="at">dose=</span><span class="fl">1E6</span>, <span class="at">design=</span><span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<pre><code>## Estimation for a complete data design
## 
##                                        Estimate SE 95% z-CI
## AUC to tlast                              47.50 NA  (NA;NA)
## AUC to infinity                           48.99 NA  (NA;NA)
## AUMC to infinity                          87.22 NA  (NA;NA)
## Mean residence time                        1.78 NA  (NA;NA)
## non-compartmental half-life                1.23 NA  (NA;NA)
## Clearance                              20411.00 NA  (NA;NA)
## Volume of distribution at steady state 36334.94 NA  (NA;NA)</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="clinic-trail-design.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># direct call</span></span>
<span id="cb80-2"><a href="clinic-trail-design.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># nca.complete(conc=conc, time=time, n.tail=3, dose=1E6)</span></span></code></pre></div>
</div>
</div>
<div id="phase-ii-trials-design" class="section level2" number="24.5">
<h2><span class="header-section-number">24.5</span> Phase II Trials Design</h2>
<div id="introduction-1" class="section level3" number="24.5.1">
<h3><span class="header-section-number">24.5.1</span> Introduction</h3>
<ul>
<li><p>Phase IIa: Proof-of-Concept (50/100) 强调快速评估，早期无效评估</p>
<ul>
<li>Emphasise quick evaluation, early futility assessment</li>
<li>Find proof of positive response for proposed treatment to
recommend for further clinical trial evaluation</li>
<li>Example Methods: One sample, Fleming Test, Simon’s Design</li>
</ul></li>
<li><p>Phase IIb: Dose-Finding (100/1000)
未知的剂量反应曲线，获得正确的模型/剂量</p>
<ul>
<li>Unknown dose-response curve, get right model/doses</li>
<li>Find dose-response curve to see dose-response relationship,
evaluate if strong enough response &amp; if so select Phase III
doses</li>
<li>Examples Methods: Contrast tests, Cochran-Armitage, MCP-Mod</li>
</ul></li>
</ul>
<p>II期临床试验的主要目的是评估相对少数患者的治疗效果，以确定是否应该在大规模比较试验中研究治疗。 它们在药物开发过程中发挥着关键作用，因为结果决定了是否进行 III 期试验。 描述和比较了 Gehan、Fleming、Simon 和 Ensign 提出的 II 期临床试验的多阶段设计。 Gehan 和 Simon 的设计有两个阶段，Fleming 的设计可以有两个或多个阶段，Ensign 的三阶段设计结合了 Gehan 的第一阶段和 Simon 的两个阶段。</p>
<blockquote>
<p>Kramar, A., Potvin, D., &amp; Hill, C. (1996). Multistage designs for phase II clinical trials: statistical issues in cancer research. British Journal of Cancer, 74(8), 1317–1320. <a href="doi:10.1038/bjc.1996.537" class="uri">doi:10.1038/bjc.1996.537</a></p>
</blockquote>
<p>对治疗的反应将被总结为成功或失败。在肿瘤学中，成功通常被定义为完全反应或客观反应，其中也包括部分反应。</p>
<p>治疗效果由参数 <span class="math inline">\(\pi\)</span> 评估，即给定人群中成功的真实比例。如果这个真实的成功比例小于或等于预定值 <span class="math inline">\(p_{0}\)</span>，我们称之为最大无效率，则认为治疗的有效性不足。如果成功的真实比例大于或等于预定值 <span class="math inline">\(p_{1}\)</span>，我们称之为最低有效率，则认为该治疗对 III 期试验的进一步研究是足够有效的。</p>
<p>大多数统计方法都是为将患者纳入 II 期试验而开发的。至少分为两个阶段。在最简单的情况下，<span class="math inline">\(r_{1}\)</span> 患者被包括在第一阶段，并且观察到 <span class="math inline">\(r_{1}\)</span> 成功。根据 <span class="math inline">\(r_{1}\)</span> 的值，要么停止试验，要么继续招募 <span class="math inline">\(n_{2}\)</span> 患者进入第二阶段，其中观察到 <span class="math inline">\(r_{2}\)</span> 成功。在 <span class="math inline">\(n_{1}+n_{2}\)</span> 名患者中，累计成功次数为 <span class="math inline">\(R_{2}=r_{1}+r_{2}\)</span>。根据观察到的累积成功次数<span class="math inline">\(R_{k}\)</span>，继续累积患者。每个阶段<span class="math inline">\(k\)</span>的一般程序如下：</p>
<ul>
<li>如果成功的总数 <span class="math inline">\(R_{\mathbf{k}}\)</span> 小于预定值，我们称之为决策的下限截止点，则认为治疗不够有效。然后拒绝功效的假设。与该决定相关的错误风险 <span class="math inline">\(\beta_{k}\)</span>（II 类错误）是在 <span class="math inline">\(k\)</span> 阶段结束时拒绝疗效的概率，而事实上治疗导致成功率至少等于 <span class="math inline">\(p_{ 1}\)</span></li>
<li>如果成功的总数<span class="math inline">\(R_{k}\)</span>大于或等于预定值，我们称之为决策的上界点。则认为该治疗对 III 期试验的进一步研究足够有效。因此，无效的假设被拒绝。与此决定相关的错误风险 <span class="math inline">\(\boldsymbol{x}_{k}\)</span>（I 类错误）是在 <span class="math inline">\(k\)</span> 阶段结束时得出有利于疗效的结论，而事实上治疗无效，即当成功率为 <span class="math inline">\(p_{0}\)</span> 或更少时。</li>
<li>如果成功的总数介于下界和上界之间，则试验继续进行，并通过纳入更多患者进入下一阶段。</li>
</ul>
<p>在最后一个阶段结束时，有一个截止点。如果成功的总数至少等于这个分界点，则得出有利于疗效的结论，如果成功的总数低于分界点，则得出结论为治疗无效。</p>
</div>
<div id="gehans-design" class="section level3" number="24.5.2">
<h3><span class="header-section-number">24.5.2</span> Gehan’s design</h3>
<p>Gehan (1961) 提出了一种设计，该设计在前 <span class="math inline">\(n_{1}\)</span> 名患者中未观察到成功时及早拒绝无效治疗。如果在第一阶段没有观察到成功，则试验停止并且认为治疗无效，然而，在第一阶段结束时，无论观察到多少成功，都无法得出有效性结论， 如果至少有一个成功，则审判进入第二阶段。第二阶段的目标是在给定的精度下估计成功的真实比例<span class="math inline">\(\pi\)</span>。精度定义为 <span class="math inline">\(\pi\)</span> 的估计标准误差。</p>
<p>Gehan的设计简单易懂。在治疗非常有效的情况下不停止的试验是相当令人满意的。然而，它往往会使更多的患者接受无效的治疗，这可能会引发伦理问题，尤其是在治疗严重疾病时。</p>
</div>
<div id="flemings-two-stage-design" class="section level3" number="24.5.3">
<h3><span class="header-section-number">24.5.3</span> Fleming’s Two-Stage design</h3>
<p>Fleming (1982) 开发了具有两个或三个阶段的设计。这些设计允许在中间结果极端时提前终止试验，无论是有利于疗效还是治疗无效。在第一步。估计患者总数，就好像一个人正在计划一个单阶段试验，错误率 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span>，成功率分别大于 <span class="math inline">\(p_{1}\)</span> 和小于 po。然后阶段数是任意选择，通常在 2 到 3 之间，患者总数在不同阶段之间任意分配，一般均等。在最后一步中，截止点由 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的所需值定义。</p>
<p>Flemang 的设计被推荐用于当一个人想要在有效性被证明已经证明时立即终止试验。在功效假设下，它具有最高的早期终止概率。在 Fleming 的设计中，患者总数估计为如果一个人计划使用选定的错误率进行单阶段试验。然后任意选择每个阶段的样本量，并且决策制定规则由所需的 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 值定义。</p>
<blockquote>
<p>One-Sample Multiple Testing Procedure for Phase II Clinical Trials</p>
</blockquote>
<blockquote>
<p>II期临床试验，以评估特定治疗方案的抗肿瘤”疗效”和该方案的毒性。通常基于”回归概率”
p来评估治疗效果。也就是说，接受治疗方案的合格患者发生方案中确切定义的肿瘤消退的可能性。通常，II期试验被设计为具有一个阶段，在该阶段中，N名可评估的患者应征，接受治疗并随后进行观察，从而确定经历消退的人数S。显然，可以从数据中获得p
= S / N给出的p的点估计。
除了推导p的点估计值外，通常最不容易制定测试程序来决定是否需要进一步研究治疗方案。</p>
</blockquote>
<p>It is the purpose of this report to inspect a one-sided multiple testing
procedure and compare its behavior with that of the obvious single-stage
test procedure, as well as with that of other multiple testing
procedures which are currently employed for such decisions. Note that,
as opposed to a single-stage procedure, in a multiple testing procedure
patients accrue in several stages, testing being performed at each stage
after appropriate patient accrual has been completed. Such a procedure
has the property that patient accruat could be terminated, and a final
decision reached, after any test. This feature is particularly appealing
in a clinical setting where there are compelling ethical reasons to
terminate a Phase II trial early if the initial proportion of patients
experiencing a tumor regression is low.</p>
<blockquote>
<p>本报告的目的是检查单面多重测试程序，并将其行为与明显的单阶段测试程序以及当前用于此类决策的其他多重测试程序的行为进行比较。注意，与单阶段过程相反，在多个测试过程中，患者分多个阶段累积，在适当的患者累积完成后，在每个阶段进行测试。这样的程序具有可以在任何测试后终止患者累积并达到最终决定的特性。如果有令人信服的伦理理由，如果最初经历肿瘤消退的患者比例很低，则有令人信服的伦理理由提早终止II期临床试验</p>
</blockquote>
<p><strong>Single”Stage Procedure</strong></p>
<p>The single-stage procedure can be based upon the statistic
<span class="math inline">\(\hat{p}=S / N\)</span>, by rejecting <span class="math inline">\(H_{0}\)</span> whenever <span class="math inline">\(\hat{p}\)</span> is large.
Hence, the required sample size <span class="math inline">\(N\)</span> can be determined by observing that
<span class="math inline">\(S\)</span> has a binomial distribution, <span class="math inline">\(\operatorname{Bin}(N, p) ;\)</span> i.e.
<span class="math inline">\(\operatorname{pr}(S=x)=\left(\frac{N}{x}\right) p^{x}(1-p)^{N-x}\)</span> for
<span class="math inline">\(x=\)</span> <span class="math inline">\(0,1,2, \ldots, N\)</span>. Alternatively, one can observe that, for
<span class="math inline">\(N p \geqslant 10, \quad Y(p) \equiv\)</span>
<span class="math inline">\((S-N p) /\{N p(1-p)\}^{\frac{1}{2}}\)</span> has approximately a normal
distribution with zero mean and unit variance. The single-stage
procedure would then reject <span class="math inline">\(H_{0}\)</span> whenever
<span class="math inline">\(Y\left(p_{0}\right)&gt;Z_{1-\alpha} ;\)</span> i.e. whenever
<span class="math inline">\(S \geqslant N p_{0}+Z_{1-\alpha}\left\{N p_{0}\left(1-p_{0}\right)\right\}^{\frac{1}{2}}\)</span>,
where <span class="math inline">\(Z_{u}\)</span> denotes the <span class="math inline">\(u\)</span> -quantile of the normal distribution. It
is straightforward to show that the sample size required for this
singlestage procedure to have significance level <span class="math inline">\(\alpha\)</span> and power
<span class="math inline">\(1-\beta\)</span> is approximately <span class="math display">\[
\left.N=\mathbf{(}\left[Z_{1-\beta}\left\{p_{\mathrm{A}}\left(1-p_{\mathrm{A}}\right)\right\}^{\frac{1}{2}}+Z_{1-\alpha}\left\{p_{0}\left(1-p_{0}\right)\right\}^{\frac{1}{2}}\right] /\left(p_{\mathrm{A}}-p_{0}\right)\right)^{2}
\]</span> <span class="math inline">\(S\)</span> has a discrete binomial distribution rather than a continuous
normal distribution. In fact, calculations have shown that, to avoid the
possibility of obtaining an anti-conservative test procedure as a result
of this discreteness, the single-stage procedure should more
appropriately reject <span class="math inline">\(H_{0}\)</span> whenever <span class="math display">\[
S \geqslant\left[N p_{0}+Z_{1-\alpha}\left\{N p_{0}\left(1-p_{0}\right)\right\}^{\frac{1}{3}}\right]^{*}+1,
\]</span></p>
<p><strong>Mulfiple Testing Procedures</strong></p>
<blockquote>
<p>由于前面提到的道德考虑以及稍后讨论的效率考虑，考虑对单阶段过程进行多种测试替代是很有意义的。</p>
</blockquote>
<p>Suppose that one decides to perform <span class="math inline">\(K\)</span> tests and to allow <span class="math inline">\(n_{i}\)</span>
patients to accrue between the <span class="math inline">\((i-1)\)</span> th and <span class="math inline">\(i\)</span> th tests, so
<span class="math inline">\(N \equiv n_{1}+\cdots+n_{K}\)</span>. Let <span class="math inline">\(s_{1}\)</span>, <span class="math inline">\(i=1, \ldots, K\)</span>, represent
the number of regressions among the <span class="math inline">\(n_{i}\)</span> patients, so <span class="math inline">\(S=\)</span>
<span class="math inline">\(s_{1}+\cdots+s_{K} .\)</span> Furthermore, denote the set of acceptance points
(of <span class="math inline">\(H_{0}\)</span> ) by <span class="math inline">\(\left(a_{1}, a_{2}, \ldots, a_{K}\right)\)</span> and the set
of rejection points (of <span class="math inline">\(H_{0}\)</span> ) by
<span class="math inline">\(\left(r_{1}, r_{2}, \ldots, r_{K}\right)\)</span>. Setting <span class="math inline">\(a_{K}=r_{K}-1\)</span>,
Schultz et al. (1973) defined the general multiple testing procedure as
follows. At Test <span class="math inline">\(g(g=1, \ldots, K)\)</span>,</p>
<ul>
<li>if <span class="math inline">\(\sum_{i=1}^{\mathrm{g}} s_{i} \leqslant a_{\mathrm{g}}\)</span>, stop
sampling and reject <span class="math inline">\(H_{\mathrm{A}}: p \geqslant p_{\mathrm{A}}\)</span>
(or, with greater certainty, reject
<span class="math inline">\(\left.\tilde{H}_{\mathrm{A}}: p \geqslant \tilde{p}_{\mathrm{A}}\right)\)</span></li>
<li>if <span class="math inline">\(\sum_{i=1}^{\mathrm{g}} s_{i} \geqslant r_{\mathrm{g}}\)</span>, stop
sampling and reject <span class="math inline">\(H_{0}: p \leqslant p_{0}\)</span></li>
<li>if <span class="math inline">\(a_{\mathrm{g}}&lt;\sum_{i=1}^{\mathrm{g}} s_{i}&lt;r_{\mathrm{g}}\)</span>,
continue to Test <span class="math inline">\(\mathrm{g}+1\)</span></li>
</ul>
</div>
<div id="simons-2-stage-design" class="section level3" number="24.5.4">
<h3><span class="header-section-number">24.5.4</span> Simon’s 2-Stage Design</h3>
<p>Simon (1989) 提出了两种设计，每一种都有两个阶段。 Simon 的 Optimum 设计最大限度地减少了接受无效治疗的患者的平均数量，而他的 Minimax 设计最大限度地减少了所需的最大样本量。在这些设计中，与 Fleming 的设计不同，研究者并未指定每个阶段的患者数量，而是最小化约束的结果。</p>
<p>在 Simon’s另一方面，Ensign 的设计，样本量不是由研究者定义的，而是取决于最小化标准。 在Simon’s Optimum设计中，在治疗无效的假设下，试验提前终止的概率很大，平均患者数最少。对于极其罕见的疾病，因此应计率较低，Simoa 的 Minimax 设计将优于 Optimum 设计，因为它限制了研究的最长持续时间。</p>
<p><strong>Reference</strong>: Simon, R. (1989). Optimal two-stage designs for phase II
clinical trials. Controlled Clinical Trials, 10(1), 1–10.
<a href="doi:10.1016/0197-2456(89)90015-9" class="uri">doi:10.1016/0197-2456(89)90015-9</a></p>
<p>癌症治疗的 II 期研究是用于获得治疗抗肿瘤效果程度的初步估计的非对照试验。
I
期试验提供有关治疗的最大耐受剂量的信息，这很重要，因为大多数癌症治疗必须以最大剂量进行才能获得最大效果。然而，I
期试验通常每个剂量水平仅治疗 3 至 6 名患者，并且患者的癌症诊断各不相同
[1]。因此，这些试验提供很少或根本没有关于抗肿瘤活性的信息。肿瘤缩小至少
50% 的患者比例是大多数 II
期试验的主要终点，尽管这种反应的持久性也令人感兴趣。此类试验不受控制，不能确定治疗的”有效性”或药物在治疗疾病中的作用。新抗癌药物的
II
期试验的目的是确定该药物是否对特定类型的肿瘤具有足够的活性以保证其进一步开发。进一步的开发可能意味着将药物与其他药物结合，对病情较轻的患者进行评估，或启动
III 期研究，将生存结果与标准治疗的结果进行比较。</p>
<p>联合方案的 II
期试验，以确定治疗是否有足够的前景，以保证对标准治疗进行主要的对照临床评估。此处开发的设计基于检验零假设<span class="math inline">\(H_0: P \le P_0\)</span>.
即真实响应概率小于某个无趣的水平
<span class="math inline">\(P_0\)</span>.如果原假设为真，那么我们要求得出结论认为该药物有足够的希望可以在其他临床试验中接受进一步研究的概率应该小于<span class="math inline">\(\alpha\)</span>。我们还要求，如果一个指定的替代假设
<span class="math inline">\(P \ge P_1\)</span>真实反应概率至少是某个理想的目标水平<span class="math inline">\(P_1\)</span>
为真，那么拒绝该药物进行进一步研究的概率应该小于<span class="math inline">\(\beta\)</span>。除了这些限制之外，我们还希望尽量减少接受低活性药物治疗的患者数量。出于管理多机构临床试验的实际考虑，我们将把注意力集中在两阶段设计上。</p>
<p>Simon’s Design is 2-stage design with early futility stopping, tests
null “poor” response vs alternative “good” response. If the numbers of
patients studied in the first and second stage are denoted by <span class="math inline">\(n_{1}\)</span>
and <span class="math inline">\(n_{2}\)</span> respectively, then the expected sample size is
<span class="math inline">\(\mathrm{EN}=n_{1}+(1-\)</span> PET) <span class="math inline">\(n_{2}\)</span>, where PET represents the
probability of early termination after the first stage. The decision of
whether or not to terminate after the first stage will be based on the
number of responses observed for those <span class="math inline">\(n_{1}\)</span> patients. The expected
sample size EN and the probability of early termination depend on the
true probability of response <span class="math inline">\(p\)</span>. We will terminate the experiment at
the end of the first stage and reject the drug if <span class="math inline">\(r_{1}\)</span> or fewer
responses are observed. This occurs with probability PET
<span class="math inline">\(=B\left(r_{1} ; p, n_{1}\right)\)</span>, where <span class="math inline">\(B\)</span> denotes the cumulative
binomial distribution. We will reject the drug at the end of the second
stage if <span class="math inline">\(r\)</span> or fewer responses are observed. Hence the probability of
rejecting a drug with success probability <span class="math inline">\(p\)</span> is <span class="math display">\[
B\left(r_{1} ; p, n_{1}\right)+\sum_{x=r_{1}+1}^{\min \left[n_{1}, r\right]} b\left(x ; p, n_{1}\right) B\left(r-x ; p, n_{2}\right),
\]</span> where <span class="math inline">\(b\)</span> denotes the binomial probability mass function.</p>
<p>For specified values of <span class="math inline">\(p_{0}, p_{1}, \alpha\)</span>, and <span class="math inline">\(\beta\)</span> we have
determined optimal designs by enumeration using exact binomial
probabilities. For each value of total sample size <span class="math inline">\(n\)</span> and each value of
<span class="math inline">\(n_{1}\)</span> in the range <span class="math inline">\((1, n-1)\)</span> we determined the integer values of
<span class="math inline">\(r_{1}\)</span> and <span class="math inline">\(r\)</span>, which satisfied the two constraints and minimized the
expected sample size when <span class="math inline">\(p=p_{0}\)</span>. This was found by searching over
the range <span class="math inline">\(r_{1} \in\left(0, n_{1}\right)\)</span>. For each value of <span class="math inline">\(r_{1}\)</span> we
determined the maximum value of <span class="math inline">\(r\)</span> that satisfied the type 2 error
constraint. We then examine whether that set of parameters
<span class="math inline">\(\left(n, n_{1}, r_{1}, r\right)\)</span> satisfied the type 1 error constraint.
If it did, then we compared the expected sample size to the minimum
achieved by previous feasible designs and continued the search over
<span class="math inline">\(r_{1}\)</span>. Keeping <span class="math inline">\(n\)</span> fixed we searched over the range of <span class="math inline">\(n_{1}\)</span> to find
the optimal two-stage design for that maximum sample size <span class="math inline">\(n\)</span>. The
search over <span class="math inline">\(n\)</span> ranged from a lower value of about <span class="math display">\[
\bar{p}(1-\bar{p})\left[\frac{z_{1-\alpha}+z_{1-\beta}}{p_{1}-p_{0}}\right]^{2}
\]</span> where <span class="math inline">\(\vec{p}=\left(p_{0}+p_{1}\right) / 2\)</span>. We checked below this
starting point to ensure that we had determined the smallest maximum
sample size <span class="math inline">\(n\)</span> for which there was a nontrivial
<span class="math inline">\(\left(n_{1}, n_{2}&gt;0\right)\)</span> two-stage design that satisfied the error
probability constraints. The enumeration procedure searched upwards from
this minimum value of <span class="math inline">\(n\)</span> until it was clear that the optimum had been
determined. The minimum expected sample size for fixed <span class="math inline">\(n\)</span> is not a
unimodal function of <span class="math inline">\(n\)</span> because of discreteness of the underlying
binomial distributions. Nevertheless, eventually as <span class="math inline">\(n\)</span> increased the
value of the local minima increased and it was clear that a global
minimum had been found.</p>
<table>
<colgroup>
<col width="6%" />
<col width="93%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><code>ph2simon(pu, pa, ep1, ep2, nmax=100)</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pu</td>
<td>unacceptable response rate</td>
</tr>
<tr class="even">
<td>pa</td>
<td>response rate that is desirable</td>
</tr>
<tr class="odd">
<td>ep1</td>
<td>threshold for the probability of declaring drug desirable under p0</td>
</tr>
<tr class="even">
<td>ep2</td>
<td>threshold for the probability of rejecting the drug under p1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="clinic-trail-design.html#cb81-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;./02_Plots/Simon_twoStage.PNG&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Simon-Two-Stages-Design-1"></span>
<img src="02_Plots/Simon_twoStage.PNG" alt="Figure: Simon’s 2-Stage Design" width="70%" />
<p class="caption">
Figure 24.1: Figure: Simon’s 2-Stage Design
</p>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="clinic-trail-design.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## `ph2simon(pu, pa, ep1, ep2, nmax=100)`</span></span>
<span id="cb82-2"><a href="clinic-trail-design.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;clinfun&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;clinfun&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="clinic-trail-design.html#cb84-1" aria-hidden="true" tabindex="-1"></a>Simon <span class="ot">&lt;-</span> <span class="fu">ph2simon</span>(<span class="fl">0.2</span>, <span class="fl">0.35</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="at">nmax=</span><span class="dv">150</span>)</span>
<span id="cb84-2"><a href="clinic-trail-design.html#cb84-2" aria-hidden="true" tabindex="-1"></a>Simon</span></code></pre></div>
<pre><code>## 
##  Simon 2-stage Phase II design 
## 
## Unacceptable response rate:  0.2 
## Desirable response rate:  0.35 
## Error rates: alpha =  0.05 ; beta =  0.05 
## 
##         r1 n1  r   n EN(p0) PET(p0)
## Optimal 11 50 28 109  67.07  0.7107
## Minimax 15 68 25  95  75.44  0.7244</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="clinic-trail-design.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Simon)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Simon-Two-Stages-Design-2"></span>
<img src="bookdown-demo_files/figure-html/Simon-Two-Stages-Design-2.png" alt="Figure: Simon’s 2-Stage Design" width="70%" />
<p class="caption">
Figure 24.2: Figure: Simon’s 2-Stage Design
</p>
</div>
</div>
<div id="jonckheere-terptsra-jt-trend-test" class="section level3" number="24.5.5">
<h3><span class="header-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</h3>
<p>In some safety and efficacy studies, it is of interest to determine if
an increase in the dose yields an increase (or decrease) in the
response. The statistical analysis for such a situation is called a
dose-response or trend analysis. We want to see a trend here, not just a
difference in groups. Typically, patients in a dose-response study are
randomized to K + 1 treatment groups (a placebo dose and K increasing
doses of the drug). The response variables of interest may be binary,
ordinal, or continuous (in some circumstances, the response variable may
be a time-to-event variable). In some instances, trend tests can be
sensitive and reveal a mild trend where pair-wise comparisons would not
be able to find significant differences and not be as helpful.</p>
<blockquote>
<p>在一些安全性和功效研究中，确定剂量增加是否会导致反应增加（或减少）是很有意义的。
针对这种情况的统计分析称为剂量响应或趋势分析。
我们希望在这里看到一种趋势，而不仅仅是群体上的差异。
通常，剂量反应研究中的患者被随机分为K +
1个治疗组（安慰剂剂量和K递增剂量的药物）。
感兴趣的响应变量可以是二进制，有序或连续的（在某些情况下，响应变量可以是事件发生时间的变量）。
在某些情况下，趋势测试可能很敏感，并显示出轻微的趋势，在这种趋势下，成对比较将无法发现明显的差异，并且没有太大的帮助。</p>
</blockquote>
<p>For the sake of illustration, suppose that the response is continuous
and that we want to determine if there is a trend in the K + 1
population means.</p>
<blockquote>
<p>为了说明起见，假设响应是连续的，并且我们要确定K +
1总体均值中是否存在趋势。</p>
</blockquote>
<p>A one-sided hypothesis testing framework for investigating an increasing
trend is <span class="math display">\[H_{0}: \mu_{0}=\mu_{1}=\cdots=\mu_{K}\]</span> versus
<span class="math display">\[H_{1}: \mu_{0} \leq \mu_{1} \leq \cdots \leq \mu_{K}\]</span> with at least
one strict inequality} A one-sided hypothesis testing framework for
investigating a decreasing trend is
<span class="math display">\[H_{0}: \mu_{0}=\mu_{1}=\cdots=\mu_{K}\]</span> versus
<span class="math display">\[H_{1}: \mu_{0} \geq \mu_{1} \geq \cdots \geq \mu_{K}\]</span> with at least
one strict inequality} A two-sided hypothesis testing framework for
investigating a trend is <span class="math display">\[H_{0}: \mu_{0}=\mu_{1}=\cdots=\mu_{K}\]</span>
versus <span class="math display">\[H_{1}: \mu_{0} \leq \mu_{1} \leq \cdots \leq \mu_{K}\]</span> or
<span class="math display">\[\mu_{0} \geq \mu_{1} \geq \cdots \geq \mu_{K}\]</span> with at least one
strict inequality}</p>
<p><strong>Jonckheere-Terptsra (JT) trend test</strong></p>
<p>For a continuous response, an appropriate test is the
Jonckheere-Terptsra (JT) trend test that was developed in the 1950s. The
JT trend test is based on a sum of Mann-Whitney-Wilcoxon tests :</p>
<p><span class="math display">\[JT=\sum_{k=0}^{K-1}\sum_{k&#39;=1}^{K}MWW_{kk&#39;}\]</span> where <span class="math inline">\(M W W_{, kk&#39;}\)</span> is
the Mann-Whitney-Wilcoxon test for comparing group <span class="math inline">\(\mathrm{k}\)</span> to group
<span class="math inline">\(k^{\prime}, 0 \leq k&lt;k^{\prime} \leq K\)</span>. Essentially, each of the pairs
of groups is compared against one another and then summed up. In this
way this test looks for trends.</p>
<p>As an example of how the JT statistic is constructed, suppose there are
four dose groups in a study (<strong>placebo, low dose, mid-dose, and high
dose</strong>). Then the JT trend test is the sum of six Mann-Whitney-Wilcoxon
test statistics.</p>
<p>Next, we assume that the <span class="math inline">\(K+1\)</span> groups have a homogeneous population
variance, <span class="math inline">\(\sigma^{2}\)</span>. The population variance is estimated by the
pooled sample variance, <span class="math inline">\(s^{2}\)</span>, and it has d degrees of freedom: <span class="math display">\[
s^{2}=\frac{1}{d} \sum_{k=0}^{K} \sum_{i=1}^{n_{k}}\left(Y_{k i}-\bar{Y}_{k}\right)^{2}, d=\sum_{k=0}^{K}\left(n_{k}-1\right)
\]</span> Letting <span class="math inline">\(c_{k}=2 k-K, k=0,1, \ldots, K\)</span>, the numerator reduces to <span class="math display">\[
\sum_{k=0}^{K} c_{k} \bar{Y}_{k}
\]</span> Then the trend statistic is: <span class="math display">\[
T=\left(\sum_{k=0}^{K} c_{k} \bar{Y}_{k}\right) /\left(\sqrt{s^{2} \sum_{k=0}^{K} \frac{c_{k}^{2}}{n_{k}^{2}}}\right)
\]</span></p>
<p>The T trend statistic can be constructed by using the CONTRAST statement
in SAS PROC GLM.</p>
<p>The JT trend test works well for binary and ordinal data, as well as
being available for continuous data. Another trend test for binary data
is the Cochran-Armitage (CA) trend test. The difference between the JT
and CA trend tests is that for the latter test, the actual dose levels
can be specified. In other words, instead of designating the dose levels
as low, mid, or high, the actual numerical dose levels can be used in
the CA trend test, such as 20 mg, 60, 180 mg.</p>
<blockquote>
<p>JT趋势测试适用于二进制和有序数据，也可用于连续数据。
二进制数据的另一种趋势测试是Cochran-Armitage（CA）趋势测试。
JT和CA趋势测试之间的区别在于，对于后者的测试，可以指定实际剂量水平。
换句话说，代替将剂量水平指定为低，中或高，可以在CA趋势测试中使用实际的数字剂量水平，例如20
mg，60、180 mg。</p>
</blockquote>
<pre><code>*** Constructing JT trend tests;
proc format;
value groupfmt 0=&#39;Placebo&#39; 1=&#39;20 mg&#39; 2=&#39;60 mg&#39; 3=&#39;180 mg&#39;;
value reactfmt 0=&#39;F&#39; 1=&#39;S&#39;;
run;
data 
contin;
input group subject response;
cards;
0 01 27
0 02 28
0 03 27
0 04 31
0 05 34
0 06 32
1 01 31
1 02 35
1 03 34
1 04 32
1 05 31
1 06 33
2 01 32
2 02 33
2 03 30
2 04 34
2 05 37
2 06 36
3 01 40
3 02 39
3 03 41
3 04 38
3 05 42
3 06 43
;
run;
proc glm 
data=contin;
class group;
model response=group;
contrast &#39;Trend Test&#39; group -1.5 -0.5 0.5 1.5;
title &quot;Parametric Trend Test for Continuous Data&quot;;
run;
proc freq 
data=contin;
tables group*response/jt;
title &quot;Jonckheere-Terpstra Trend Test for Continuous Data&quot;;
run;
data 
binary;
set contin;
if group=0 then dose=0;
if group=1 then dose=20;
if group=2 then dose=60;
if group=3 then dose=180;
if response&lt;32 then react=0;
if response&gt;=32 then react=1;
format react reactfmt.;
run;
proc freq 
data=binary;
tables react*group/jt trend;
exact jt trend;
title &quot;Jonckheere-Terpstra and Cochran-Armitage Trend Tests for Binary Data&quot;;
title2 &quot;Ordinal Scores&quot;;
run;
proc freq 
data=binary;
tables react*dose/jt trend;
exact jt trend;
title &quot;Jonckheere-Terpstra and Cochran-Armitage Trend Tests for Binary Data&quot;;
title2 &quot;Dose Scores&quot;;
run;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="clinic-trail-design.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clinfun)</span>
<span id="cb88-2"><a href="clinic-trail-design.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb88-3"><a href="clinic-trail-design.html#cb88-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rep</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb88-4"><a href="clinic-trail-design.html#cb88-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb88-5"><a href="clinic-trail-design.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">jonckheere.test</span>(x<span class="fl">+0.3</span><span class="sc">*</span>g, g)</span></code></pre></div>
<pre><code>## 
##  Jonckheere-Terpstra test
## 
## data:  
## JT = 629, p-value = 0.02734
## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="clinic-trail-design.html#cb90-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="co"># tied data</span></span>
<span id="cb90-2"><a href="clinic-trail-design.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jonckheere.test</span>(x<span class="fl">+0.3</span><span class="sc">*</span>g, g)</span></code></pre></div>
<pre><code>## 
##  Jonckheere-Terpstra test
## 
## data:  
## JT = 639, p-value = 0.01741
## alternative hypothesis: two.sided</code></pre>
</div>
<div id="cochran-armitage-ca-trend-test" class="section level3" number="24.5.6">
<h3><span class="header-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</h3>
<p>Perform a Cochran Armitage test for trend in binomial proportions across
the levels of a single variable. This test is appropriate only when one
variable has two levels and the other variable is ordinal. The two-level
variable represents the response, and the other represents an
explanatory variable with ordered levels. The null hypothesis is the
hypothesis of no trend, which means that the binomial proportion is the
same for all levels of the explanatory variable.</p>
<blockquote>
<p>单个变量水平上的二项式比例趋势执行Cochran Armitage测试。
仅当一个变量具有两个级别而另一个变量为序数时，才适合使用此测试。
两级变量代表响应，另一级代表有序等级的解释变量。
零假设是没有趋势的假设，这意味着对于解释变量的所有级别，二项式比例都是相同的。</p>
</blockquote>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="clinic-trail-design.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DescTools&quot;</span>)</span>
<span id="cb92-2"><a href="clinic-trail-design.html#cb92-2" aria-hidden="true" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">7</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">byrow=</span><span class="cn">TRUE</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="at">resp=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">dose=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb92-3"><a href="clinic-trail-design.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Desc</span>(dose)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------------------------ 
## dose (matrix, array)
## 
## Summary: 
## n: 40, rows: 2, columns: 4
## 
## Pearson&#39;s Chi-squared test:
##   X-squared = 6.6667, df = 3, p-value = 0.08332
## Log likelihood ratio (G-test) test of independence:
##   G = 7.2877, X-squared df = 3, p-value = 0.06327
## Mantel-Haenszel Chi-squared:
##   X-squared = 3.4667, df = 1, p-value = 0.06262
## 
## Warning message:
##   Exp. counts &lt; 5: Chi-squared approx. may be incorrect!!
## 
## 
## Phi-Coefficient        0.408
## Contingency Coeff.     0.378
## Cramer&#39;s V             0.408
## 
##                                                
##        dose       0      1      2      3    Sum
## resp                                           
##                                                
## 0      freq      10      9     10      7     36
##        perc   25.0%  22.5%  25.0%  17.5%  90.0%
##        p.row  27.8%  25.0%  27.8%  19.4%      .
##        p.col 100.0%  90.0% 100.0%  70.0%      .
##                                                
## 1      freq       0      1      0      3      4
##        perc    0.0%   2.5%   0.0%   7.5%  10.0%
##        p.row   0.0%  25.0%   0.0%  75.0%      .
##        p.col   0.0%  10.0%   0.0%  30.0%      .
##                                                
## Sum    freq      10     10     10     10     40
##        perc   25.0%  25.0%  25.0%  25.0% 100.0%
##        p.row      .      .      .      .      .
##        p.col      .      .      .      .      .
## </code></pre>
<p><img src="bookdown-demo_files/figure-html/CA-trend-test%20-1.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="clinic-trail-design.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CochranArmitageTest</span>(dose, <span class="st">&quot;increasing&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Cochran-Armitage test for trend
## 
## data:  dose
## Z = -1.8856, dim = 4, p-value = 0.02967
## alternative hypothesis: increasing</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="clinic-trail-design.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CochranArmitageTest</span>(dose)</span></code></pre></div>
<pre><code>## 
##  Cochran-Armitage test for trend
## 
## data:  dose
## Z = -1.8856, dim = 4, p-value = 0.05935
## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="clinic-trail-design.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CochranArmitageTest</span>(dose, <span class="st">&quot;decreasing&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Cochran-Armitage test for trend
## 
## data:  dose
## Z = -1.8856, dim = 4, p-value = 0.9703
## alternative hypothesis: decreasing</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="clinic-trail-design.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Test independence using permutation test</span></span>
<span id="cb100-2"><a href="clinic-trail-design.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;coin&quot;</span>)</span>
<span id="cb100-3"><a href="clinic-trail-design.html#cb100-3" aria-hidden="true" tabindex="-1"></a>lungtumor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">48</span>)),</span>
<span id="cb100-4"><a href="clinic-trail-design.html#cb100-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tumor =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">2</span>)),</span>
<span id="cb100-5"><a href="clinic-trail-design.html#cb100-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">7</span>)),</span>
<span id="cb100-6"><a href="clinic-trail-design.html#cb100-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">15</span>))))</span>
<span id="cb100-7"><a href="clinic-trail-design.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">independence_test</span>(tumor <span class="sc">~</span> dose, <span class="at">data =</span> lungtumor, <span class="at">teststat =</span> <span class="st">&quot;quad&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic General Independence Test
## 
## data:  tumor by dose
## chi-squared = 10.638, df = 1, p-value = 0.001108</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="clinic-trail-design.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Test propotion </span></span>
<span id="cb102-2"><a href="clinic-trail-design.html#cb102-2" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(lungtumor<span class="sc">$</span>dose, lungtumor<span class="sc">$</span>tumor)</span>
<span id="cb102-3"><a href="clinic-trail-design.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">CochranArmitageTest</span>(tab)</span></code></pre></div>
<pre><code>## 
##  Cochran-Armitage test for trend
## 
## data:  tab
## Z = -3.2735, dim = 3, p-value = 0.001062
## alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="clinic-trail-design.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## similar to</span></span>
<span id="cb104-2"><a href="clinic-trail-design.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.trend.test</span>(tab[,<span class="dv">1</span>], <span class="fu">apply</span>(tab,<span class="dv">1</span>, sum))</span></code></pre></div>
<pre><code>## 
##  Chi-squared Test for Trend in Proportions
## 
## data:  tab[, 1] out of apply(tab, 1, sum) ,
##  using scores: 1 2 3
## X-squared = 10.716, df = 1, p-value = 0.001062</code></pre>
</div>
<div id="mcp-mod" class="section level3" number="24.5.7">
<h3><span class="header-section-number">24.5.7</span> MCP-Mod</h3>
<blockquote>
<p>传统上，剂量反应研究的设计和分析分为两种策略：一种基于多重比较程序（MCP），另一种基于建模。
然而，这些方法具有其缺点。 Bretz等。
（2005年）提出了一种用于剂量寻找研究的方法，称为MCP-Mod，将MCP原理与建模技术相结合。
他们的方法为剂量估算提供了建模的灵活性，同时保留了对与MCP相关的错误指定进行建模的鲁棒性。preserving
the robustness to model misspecification associated with MCP.</p>
</blockquote>
<p>MCP-Mod (Multiple Comparisons Procedure - Modelling) is an increasingly
popular statistical methodology. It can generate superior statistical
evidence from Phase II trials with regards to dose selection. The FDA &amp;
EMA both recently approved this as fit-for-purpose (FFP). MCP-Mod is a
two-step approach for analyzing Phase II dose-finding data, targeting
two of the main Phase II objectives:</p>
<blockquote>
<p>MCP-Mod（多重比较程序-建模）是一种越来越流行的统计方法。
在剂量选择方面，它可以从II期试验中获得更好的统计证据。
FDA和EMA最近都批准此为适用目的（FFP）。是用于分析II期剂量查找数据的两步方法，目标是II期的两个主要目标</p>
</blockquote>
<ul>
<li>Establish that the drug works as intended 确定该药物可按预期工作</li>
<li>Determine the appropriate doses for Phase III testing
确定用于III期测试的合适剂量</li>
</ul>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th>M
C
P</th>
<th>Robust but restricted to selected doses as nominal variable
功能强大，但仅限于所选剂量作为标称变量</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>M
o
d</td>
<td>Flexible quantitative approach but reliant on model choice
灵活的定量方法，但依赖于模型选择</td>
</tr>
<tr class="even">
<td>M
C
P
-
M
o
d</td>
<td>Design Stage: Select candidate models &amp; generate optimal tests
选择候选模型并生成最佳测试 MCP Stage: Select best model(s) w/
appropriate contrasts but control FWER
选择具有适当对比度的最佳模型，但控制FWER Mod Stage: Model using
best model and find target dose(s) of interest
使用最佳模型进行建模并找到感兴趣的目标剂量</td>
</tr>
</tbody>
</table>
<p>The strength of MCP-Mod lies in providing flexibility in characterizing
the expected dose-response curve by allowing multiple models to be
evaluated at the same time while still giving results that are efficient
and control the error rates.</p>
<blockquote>
<p>MCP-Mod的优势在于，通过允许同时评估多个模型，同时仍然提供有效的结果并控制错误率，可灵活地表征预期的剂量反应曲线。</p>
</blockquote>
<p>MCP-Mod过程包含5个步骤，但分为两个不同的阶段。</p>
<ul>
<li><p>The first step (MCP-step) is used to assess the presence of a dose
response signal using a trend test deducted from a set of
pre-specified candidate models.
第一步（MCP步骤）用于使用从一组预先指定的候选模型中扣除的趋势测试来评估剂量响应信号的存在。</p>
<ul>
<li><p>Define a suitable study population to represent the underlying
true dose-response shape.
定义合适的研究人群以代表潜在的真实剂量反应形状。</p></li>
<li><p>Pre-Specify the candidate dose response models based on
available information. These are based on assessment of relevant
metrics such as type I error rate, power to detect a significant
dose-response shape, and the power to find the minimal effective
dose. 根据可用信息预先指定候选剂量反应模型。
这些是基于对相关指标的评估，例如I型错误率，检测出显着剂量反应形状的功效以及找到最小有效剂量的功效</p></li>
<li><p>Dose determination and sample size calculation to achieve
targeted performance characteristics.
剂量确定和样本量计算可实现目标性能特征。</p></li>
</ul></li>
<li><p>The second step (Mod-step) relies on parametric modeling or model
averaging to find the “optimal’ dose for confirmatory trials.
第二步（修改步骤）依赖于参数化建模或模型平均，以找到用于验证性试验的”最佳”剂量。</p>
<ul>
<li><p>Later, a candidate model is selected using model selection
criteria like Akaike Information Criterion (AIC) or Bayesian
Information Criterion (BIC) or averaging.
使用模型选择标准（如Akaike信息准则（AIC）或贝叶斯信息准则（BIC））或平均来选择候选模型。</p></li>
<li><p>Dose-response and target dose estimation based on selected
models. (Mod part of MCP-Mod).
基于所选模型的剂量反应和目标剂量估计。</p></li>
</ul></li>
</ul>
</div>
<div id="two-stage-phase-ii-design-for-response-and-toxicity" class="section level3" number="24.5.8">
<h3><span class="header-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</h3>
<p>Phase II designs are often used to determine whether a new procedure or
treatment is likely to meet a basic level of efficacy to warrant further
development or evaluation. Phase IIa designs are focussed on the
proof-of-concept part of Phase II trials. They aim to show the potential
efficacy and safety of a proposed treatment. Two-stage designs are
common to allow for flexibility to stop trials early for futility as
Phase II is the most common failure point in drug evaluation.</p>
<blockquote>
<p>II期设计通常用于确定新程序或治疗是否有可能满足基本的疗效水平，以保证进一步的开发或评估。
IIa期设计的重点是II期试验的概念验证部分。他们的目的是表明拟议疗法的潜在疗效和安全性。由于II期是药物评估中最常见的失败点，因此通常采用两阶段设计，以便灵活地提前终止试验，因为徒劳无功。</p>
</blockquote>
<p>The method outlined in Bryant and Day (1995). As mentioned, often
evaluation of toxicity is listed as a primary objective in Phase IIa
trials. The Bryant and Day design is a two stage phase IIa design with a
coprimary endpoint which allows one to evaluate both the efficacy and
the toxicity of the drug or treatment within a single design.</p>
<blockquote>
<p>遵循Bryant and
Day（1995）中概述的方法。如前所述，在IIa期试验中，经常将毒性评估列为主要目标。
Bryant和Day设计是具有共同主要终点的IIa阶段两阶段设计，该设计使人们可以在单个设计中评估药物或治疗的功效和毒性。</p>
</blockquote>
<p>Phase IIa methods like Simon’s Design looking for evidence of “response”
and will stop early if no signal. Phase IIb changed significantly by
combining robust MCP with modelling rather than separating these
objectives</p>
</div>
</div>
<div id="phase-iii-trials-design" class="section level2" number="24.6">
<h2><span class="header-section-number">24.6</span> Phase III Trials Design</h2>
<p>Phase III clinical trials are the <strong>gold standard</strong> to demonstrate the
effects of an experimental therapy compared to standard therapy for a
disease of interest. The first step when planning a phase III trial is
to specify the statistical hypothesis that the trial purports to test,
which is usually that the experimental therapy provides some efficacy
benefit over standard therapy, without adding significant harm. In a
phase III trial, a pre-specified number of patients from the target
population are randomized to receive experimental or standard therapy.
The patients are treated and followed up according to a protocol that
also defines the endpoints of interest, in particular the primary
endpoint which is chosen to reflect a clinical benefit of experimental
therapy over standard therapy. The trial data are typically monitored by
an independent committee who may recommend stopping the trial early, if
appropriate. The benefit of experimental therapy over standard therapy,
if any, may be observed across all patients, or may be confined to a
subset of patients.</p>
<blockquote>
<p>III期临床试验是金标准，可证明与标准疗法相比，对于目标疾病而言，实验疗法的效果。计划进行III期临床试验的第一步是明确说明该试验所要测试的统计假设，通常是实验性疗法比标准疗法具有一定的疗效，而又不会增加明显的危害。在III期试验中，将来自目标人群的预先指定数量的患者随机分配接受实验或标准治疗。根据还定义了目标终点的方案对患者进行治疗和随访，特别是选择主要终点以反映实验治疗相对于标准治疗的临床益处。审判数据通常由独立委员会进行监控，如果合适的话，委员会可能建议尽早停止审判。实验疗法相对于标准疗法的益处（如果有的话）可以在所有患者中观察到，或仅限于一部分患者。</p>
</blockquote>
<div id="non-inferiority-and-equivalence-three-armed-trial" class="section level3" number="24.6.1">
<h3><span class="header-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</h3>
<p>Non-inferiority testing is a common hypothesis test in the development
of generic medicine and medical devices. The most common design compares
the proposed non-inferior treatment to the standard treatment alone but
this leaves uncertain if the treatment effect is the same as from
previous studies. This “assay sensitivity” problem can be resolved by
using a three-arm trial which includes placebo alongside the new and
reference treatments for direct comparison.</p>
<blockquote>
<p>非劣势性检验是仿制药和医疗器械开发中常见的假设检验。
最常见的设计将建议的非劣效治疗与标准治疗进行了比较，但是这些治疗效果是否与以前的研究相同，尚不确定。
可以通过三臂试验解决该”测定敏感性”问题，该试验包括安慰剂以及新药和参考药，以进行直接比较。</p>
</blockquote>
<blockquote>
<p>三臂NI试验可以同时测试参考相对于安慰剂的优越性，以及实验治疗相对于参考的NI的优越性。由于两样本非劣效试验中不包含安慰剂臂,无法确定阳性对照药的有效性,带来了诸如阳性对照药的测定灵敏度及稳定性无法确证等问题。因此,由于外部确证性,非劣效试验要求达到很高的质量。在伦理学条件允许下,增加安慰剂臂以达到内部确证不失为一个好的选择。包含安慰剂臂的三臂非劣效试验既能评价试验药是否非劣效于阳性对照药,又能评价试验药是否优效于安慰剂。</p>
</blockquote>
<p>Design method of the three-arm non-inferiority trial</p>
<ul>
<li>以固定值为非劣效界值的传统的检验方法</li>
<li>以阳性对照效应的一部分为非劣效界值的将检验整合的Pigeot法。(相同样本含量时,Pigeot法的检验效能更高,充分利用了所有样本量的信息,提高了检验效率,降低了临床试验的成本)</li>
</ul>
</div>
<div id="pigeot-method" class="section level3" number="24.6.2">
<h3><span class="header-section-number">24.6.2</span> Pigeot Method</h3>
<p>有文献推荐充分利用所加的安慰剂组的信息，将△定义为阳性药效应(阳性药疗效与安慰剂疗效的差)的一部分，即对于计量资料
<span class="math display">\[\Delta=f \cdot\left(\mu_{R}-\mu_{P}\right), f \geqslant-1\]</span>
美国FDA推荐，为一1／2作为确定非劣效界值的一种方法。Pigeot等人哺1对于非劣效界值的确定正是基于这一方法，非劣效的假设检验由传统的
<span class="math display">\[\mathrm{H}_{0}: \mu_{E}-\mu_{R} \leqslant \Delta, \mathrm{H}{1}: \mu{\varepsilon}-\mu_{R}&gt;\Delta\]</span>
转化为:
<span class="math display">\[\mathrm{H}{0}: \mu{E}-\mu{R} \leqslant f\left(\mu{R}-\mu{P}\right) \text { vs } \mathrm{H}{1}: \mu{E}-\mu{R}&gt;f\left(\mu{R}-\mu{P}\right)\]</span>
其中 <span class="math inline">\(E, R\)</span> 和 <span class="math inline">\(P\)</span> 分别代表试验药、阳性对照药和安 时剂,
<span class="math inline">\(\mu_{E}, \mu_{R}\)</span> 和 <span class="math inline">\(\mu_{P}\)</span> 分别为试验组、阳性对照组 和安慰
剂组的总体均数。令 <span class="math inline">\(f=\theta-1, \theta \in[0, \infty)\)</span>, <span class="math display">\[
\mathrm{H}_{0}: \mu_{\mathrm{E}}-\mu_{\mathrm{P}} \leqslant \theta\left(\mu_{R}-\mu_{P}\right) \mathrm{vs} \mathrm{H}_{1}: \mu_{E}-\mu_{P}&gt;\theta\left(\mu_{R}-\mu_{P}\right)
\]</span></p>
<!-- --------------------------------------------------------- -->
</div>
</div>
<div id="medical-devices-postmarketing-surveillance-pms" class="section level2" number="24.7">
<h2><span class="header-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</h2>
<div id="phase-iv-and-pms" class="section level3" number="24.7.1">
<h3><span class="header-section-number">24.7.1</span> Phase IV and PMS</h3>
<p>Studies the side effects caused over time by a new treatment after it
has been approved and is on the market. These trials look for side
effects that were not seen in earlier trials and may also study how well
a new treatment works over a long period of time.</p>
<blockquote>
<p>研究经过批准并投放市场的新疗法随时间推移所引起的副作用。
这些试验寻找的副作用是早期试验中未见的，也可能研究新疗法在很长一段时间内的效果。</p>
</blockquote>
<p>Postmarketing surveillance (PMS), also known as post-market
surveillance, is the practice of monitoring the safety of a
pharmaceutical drug or medical device after it has been released on the
market and is an important part of the science of pharmacovigilance.
Since drugs and medical devices are approved on the basis of clinical
trials, which involve relatively small numbers of people who have been
selected for this purpose – meaning that they normally do not have
other medical conditions that may exist in the general population –
postmarketing surveillance can further refine, or confirm or deny, the
safety of a drug or device after it is used in the general population by
large numbers of people who have a wide variety of medical conditions.
。 Postmarketing surveillance uses a number of approaches to monitor
drug and device safety, including spontaneous reporting databases,
prescription event monitoring, electronic health records, patient
registries, and record linkage between health databases.</p>
<blockquote>
<p>上市后监视（PMS），也称为上市后监视，是监视已投放市场的药物或医疗器械的安全性的实践，并且是药物警戒学的重要组成部分。由于药品和医疗器械是根据临床试验批准的，因此涉及的人数量相对较少，这意味着他们通常不具有普通人群中可能存在的其他医疗状况，因此售后监测可以在具有广泛医疗状况的大量人在普通人群中使用药物或设备后，进一步完善，确认或否认药物或设备的安全性.
上市后监视使用多种方法来监视药物和设备安全，包括自发报告数据库，处方事件监视，电子健康记录，患者注册表以及健康数据库之间的记录链接。</p>
</blockquote>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="group-sequential-design.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/25-Clinic-Trial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
