<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Advanced Survival Analysis | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Advanced Survival Analysis | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Advanced Survival Analysis | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2021-09-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="survival-analysis.html"/>
<link rel="next" href="count-data-regression.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html"><i class="fa fa-check"></i><b>2</b> Data Management in SAS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#input-data-into-sas"><i class="fa fa-check"></i><b>2.1</b> Input data into SAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#native-datasets-input"><i class="fa fa-check"></i><b>2.1.1</b> Native datasets input</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#reading-free-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.2</b> Reading free formatted data instream</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.3</b> Reading fixed formatted data instream</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file"><i class="fa fa-check"></i><b>2.1.4</b> INFILE: Reading fixed formatted data from an external file</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-the-sas-file"><i class="fa fa-check"></i><b>2.1.5</b> Write the SAS File</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#import-csv-data"><i class="fa fa-check"></i><b>2.1.6</b> Import csv data</a></li>
<li class="chapter" data-level="2.1.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#import"><i class="fa fa-check"></i><b>2.1.7</b> %Import</a></li>
<li class="chapter" data-level="2.1.8" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#url"><i class="fa fa-check"></i><b>2.1.8</b> URL</a></li>
<li class="chapter" data-level="2.1.9" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files"><i class="fa fa-check"></i><b>2.1.9</b> Infile Read multiple raw data files</a></li>
<li class="chapter" data-level="2.1.10" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#generate-automatic-file-name"><i class="fa fa-check"></i><b>2.1.10</b> Generate automatic file name</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#format-in-sas"><i class="fa fa-check"></i><b>2.2</b> Format in SAS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#proc-format"><i class="fa fa-check"></i><b>2.2.1</b> Proc format</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries"><i class="fa fa-check"></i><b>2.2.2</b> Copy and combine SAS format libraries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#array"><i class="fa fa-check"></i><b>2.3</b> Array</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#defining"><i class="fa fa-check"></i><b>2.3.1</b> Defining</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#format-multiple-variables"><i class="fa fa-check"></i><b>2.3.2</b> Format multiple variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#arrays"><i class="fa fa-check"></i><b>2.3.3</b> 2*2 arrays</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables"><i class="fa fa-check"></i><b>2.3.4</b> Dynamic Element List using Macro Variables</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#carry-over-values"><i class="fa fa-check"></i><b>2.3.5</b> Carry over values</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#retain"><i class="fa fa-check"></i><b>2.4</b> Retain</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#change-from-basilne"><i class="fa fa-check"></i><b>2.4.1</b> Change from Basilne</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#variable-names-and-types"><i class="fa fa-check"></i><b>2.5</b> Variable Names and Types</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#convert-all-numeric-to-char"><i class="fa fa-check"></i><b>2.5.1</b> Convert all numeric to char*</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#get-all-the-numeric-variable-names"><i class="fa fa-check"></i><b>2.5.2</b> Get all the numeric variable names</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-variable-names-as-macro-variables"><i class="fa fa-check"></i><b>2.5.3</b> Write all variable names as macro variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-observations-as-macro-variable"><i class="fa fa-check"></i><b>2.5.4</b> Write all observations as macro variable</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-some-variables"><i class="fa fa-check"></i><b>2.5.5</b> Rename some variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-with-suffix"><i class="fa fa-check"></i><b>2.5.6</b> Rename with suffix</a></li>
<li class="chapter" data-level="2.5.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-array-variables"><i class="fa fa-check"></i><b>2.5.7</b> Rename array variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-exists-for-validation"><i class="fa fa-check"></i><b>2.6</b> Check exists for validation</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-exists"><i class="fa fa-check"></i><b>2.6.1</b> Check datasets exists</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-and-variables"><i class="fa fa-check"></i><b>2.6.2</b> Check datasets and Variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-if-empty"><i class="fa fa-check"></i><b>2.6.3</b> Check datasets if empty</a></li>
<li class="chapter" data-level="2.6.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#sysfunc-get-the-observations"><i class="fa fa-check"></i><b>2.6.4</b> %sysfunc get the observations</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#proc-transpose"><i class="fa fa-check"></i><b>2.7</b> Proc Transpose</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#numeric"><i class="fa fa-check"></i><b>2.7.1</b> <em>numeric</em></a></li>
<li class="chapter" data-level="2.7.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#in-processing"><i class="fa fa-check"></i><b>2.7.2</b> In processing</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#clean-up"><i class="fa fa-check"></i><b>2.8</b> Clean Up</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#basic-setting"><i class="fa fa-check"></i><b>2.8.1</b> Basic setting</a></li>
<li class="chapter" data-level="2.8.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-datasets"><i class="fa fa-check"></i><b>2.8.2</b> Delete datasets</a></li>
<li class="chapter" data-level="2.8.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#deleting-formats"><i class="fa fa-check"></i><b>2.8.3</b> Deleting Formats</a></li>
<li class="chapter" data-level="2.8.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#remove-assigned-formats"><i class="fa fa-check"></i><b>2.8.4</b> Remove assigned formats</a></li>
<li class="chapter" data-level="2.8.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro-variables"><i class="fa fa-check"></i><b>2.8.5</b> Delete macro variables</a></li>
<li class="chapter" data-level="2.8.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro"><i class="fa fa-check"></i><b>2.8.6</b> Delete Macro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-in-r.html"><a href="data-management-in-r.html"><i class="fa fa-check"></i><b>3</b> Data Management in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#set-up"><i class="fa fa-check"></i><b>3.1</b> Set up</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#load-package"><i class="fa fa-check"></i><b>3.1.1</b> Load Package</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#working-path"><i class="fa fa-check"></i><b>3.1.2</b> Working path</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#basic-data-management"><i class="fa fa-check"></i><b>3.2</b> Basic data management</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#apply-family"><i class="fa fa-check"></i><b>3.2.1</b> apply family</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-readr"><i class="fa fa-check"></i><b>3.3</b> Package readr</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet"><i class="fa fa-check"></i><b>3.3.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#basic-importimput"><i class="fa fa-check"></i><b>3.3.2</b> Basic import/imput</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#copy-from-clipboard"><i class="fa fa-check"></i><b>3.3.3</b> Copy from clipboard</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#save-and-write-objective-in-r"><i class="fa fa-check"></i><b>3.3.4</b> Save and write objective in R</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#save-the-plot"><i class="fa fa-check"></i><b>3.3.5</b> Save the plot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-tidyr"><i class="fa fa-check"></i><b>3.4</b> Package tidyr</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-1"><i class="fa fa-check"></i><b>3.4.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#pivoting"><i class="fa fa-check"></i><b>3.4.2</b> Pivoting</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#gather-and-spread"><i class="fa fa-check"></i><b>3.4.3</b> gather and spread</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#separate-and-unite"><i class="fa fa-check"></i><b>3.4.4</b> separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-dplyr"><i class="fa fa-check"></i><b>3.5</b> Package dplyr</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-2"><i class="fa fa-check"></i><b>3.5.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#across"><i class="fa fa-check"></i><b>3.5.2</b> across</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#arrange"><i class="fa fa-check"></i><b>3.5.3</b> arrange</a></li>
<li class="chapter" data-level="3.5.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#coalesce"><i class="fa fa-check"></i><b>3.5.4</b> coalesce</a></li>
<li class="chapter" data-level="3.5.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#filter"><i class="fa fa-check"></i><b>3.5.5</b> filter</a></li>
<li class="chapter" data-level="3.5.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#if_else"><i class="fa fa-check"></i><b>3.5.6</b> if_else</a></li>
<li class="chapter" data-level="3.5.7" data-path="data-management-in-r.html"><a href="data-management-in-r.html#join"><i class="fa fa-check"></i><b>3.5.7</b> join</a></li>
<li class="chapter" data-level="3.5.8" data-path="data-management-in-r.html"><a href="data-management-in-r.html#mutate"><i class="fa fa-check"></i><b>3.5.8</b> mutate</a></li>
<li class="chapter" data-level="3.5.9" data-path="data-management-in-r.html"><a href="data-management-in-r.html#select"><i class="fa fa-check"></i><b>3.5.9</b> select</a></li>
<li class="chapter" data-level="3.5.10" data-path="data-management-in-r.html"><a href="data-management-in-r.html#summarise"><i class="fa fa-check"></i><b>3.5.10</b> summarise</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-stringr"><i class="fa fa-check"></i><b>3.6</b> Package stringr</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-3"><i class="fa fa-check"></i><b>3.6.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-forcats"><i class="fa fa-check"></i><b>3.7</b> Package forcats</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-4"><i class="fa fa-check"></i><b>3.7.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-lubridate"><i class="fa fa-check"></i><b>3.8</b> Package lubridate</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#cheat-sheet-5"><i class="fa fa-check"></i><b>3.8.1</b> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>4</b> SQL</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sql.html"><a href="sql.html#mysql-management"><i class="fa fa-check"></i><b>4.1</b> MySQL: Management</a></li>
<li class="chapter" data-level="4.2" data-path="sql.html"><a href="sql.html#mysql-php-in-processing"><i class="fa fa-check"></i><b>4.2</b> MySQL PHP (In processing)</a></li>
<li class="chapter" data-level="4.3" data-path="sql.html"><a href="sql.html#proc-sql-in-sas"><i class="fa fa-check"></i><b>4.3</b> PROC SQL in SAS</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sql.html"><a href="sql.html#inreoduction"><i class="fa fa-check"></i><b>4.3.1</b> Inreoduction</a></li>
<li class="chapter" data-level="4.3.2" data-path="sql.html"><a href="sql.html#create-normal-table"><i class="fa fa-check"></i><b>4.3.2</b> Create Normal Table</a></li>
<li class="chapter" data-level="4.3.3" data-path="sql.html"><a href="sql.html#creating-tables-like-an-existing-table"><i class="fa fa-check"></i><b>4.3.3</b> Creating Tables like an Existing Table</a></li>
<li class="chapter" data-level="4.3.4" data-path="sql.html"><a href="sql.html#inserting-rows"><i class="fa fa-check"></i><b>4.3.4</b> Inserting Rows</a></li>
<li class="chapter" data-level="4.3.5" data-path="sql.html"><a href="sql.html#delete-rows-and-table"><i class="fa fa-check"></i><b>4.3.5</b> Delete Rows and Table</a></li>
<li class="chapter" data-level="4.3.6" data-path="sql.html"><a href="sql.html#new-columns-using-summary-function"><i class="fa fa-check"></i><b>4.3.6</b> New Columns using Summary Function</a></li>
<li class="chapter" data-level="4.3.7" data-path="sql.html"><a href="sql.html#aggregation-summary"><i class="fa fa-check"></i><b>4.3.7</b> Aggregation: Summary</a></li>
<li class="chapter" data-level="4.3.8" data-path="sql.html"><a href="sql.html#conditionality-if"><i class="fa fa-check"></i><b>4.3.8</b> Conditionality (If)</a></li>
<li class="chapter" data-level="4.3.9" data-path="sql.html"><a href="sql.html#filtering-aggregated-data-having"><i class="fa fa-check"></i><b>4.3.9</b> Filtering Aggregated Data (HAVING)</a></li>
<li class="chapter" data-level="4.3.10" data-path="sql.html"><a href="sql.html#select-operator-union"><i class="fa fa-check"></i><b>4.3.10</b> Select Operator (Union…)</a></li>
<li class="chapter" data-level="4.3.11" data-path="sql.html"><a href="sql.html#loap"><i class="fa fa-check"></i><b>4.3.11</b> Loap</a></li>
<li class="chapter" data-level="4.3.12" data-path="sql.html"><a href="sql.html#join-1"><i class="fa fa-check"></i><b>4.3.12</b> Join</a></li>
<li class="chapter" data-level="4.3.13" data-path="sql.html"><a href="sql.html#reordering-rows-proc-sort"><i class="fa fa-check"></i><b>4.3.13</b> Reordering Rows (Proc Sort)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sql.html"><a href="sql.html#package-dbi-in-processing"><i class="fa fa-check"></i><b>4.4</b> Package DBI (In processing)</a></li>
<li class="chapter" data-level="4.5" data-path="sql.html"><a href="sql.html#package-sparklyr-in-processing"><i class="fa fa-check"></i><b>4.5</b> Package sparklyr (In processing)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>5</b> ggplot2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2.html"><a href="ggplot2.html#parametric-rendering"><i class="fa fa-check"></i><b>5.1</b> Parametric Rendering</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ggplot2.html"><a href="ggplot2.html#grammar"><i class="fa fa-check"></i><b>5.1.1</b> Grammar</a></li>
<li class="chapter" data-level="5.1.2" data-path="ggplot2.html"><a href="ggplot2.html#coord"><i class="fa fa-check"></i><b>5.1.2</b> coord</a></li>
<li class="chapter" data-level="5.1.3" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>5.1.3</b> facet</a></li>
<li class="chapter" data-level="5.1.4" data-path="ggplot2.html"><a href="ggplot2.html#geom"><i class="fa fa-check"></i><b>5.1.4</b> geom</a></li>
<li class="chapter" data-level="5.1.5" data-path="ggplot2.html"><a href="ggplot2.html#position"><i class="fa fa-check"></i><b>5.1.5</b> position</a></li>
<li class="chapter" data-level="5.1.6" data-path="ggplot2.html"><a href="ggplot2.html#scale"><i class="fa fa-check"></i><b>5.1.6</b> scale</a></li>
<li class="chapter" data-level="5.1.7" data-path="ggplot2.html"><a href="ggplot2.html#stat"><i class="fa fa-check"></i><b>5.1.7</b> stat</a></li>
<li class="chapter" data-level="5.1.8" data-path="ggplot2.html"><a href="ggplot2.html#color"><i class="fa fa-check"></i><b>5.1.8</b> Color</a></li>
<li class="chapter" data-level="5.1.9" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>5.1.9</b> Thema</a></li>
<li class="chapter" data-level="5.1.10" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>5.1.10</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ggplot2.html"><a href="ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>5.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ggplot2.html"><a href="ggplot2.html#grouping-aesthetic"><i class="fa fa-check"></i><b>5.2.1</b> Grouping Aesthetic</a></li>
<li class="chapter" data-level="5.2.2" data-path="ggplot2.html"><a href="ggplot2.html#facet-1"><i class="fa fa-check"></i><b>5.2.2</b> facet</a></li>
<li class="chapter" data-level="5.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_smooth"><i class="fa fa-check"></i><b>5.2.3</b> geom_smooth</a></li>
<li class="chapter" data-level="5.2.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-plot"><i class="fa fa-check"></i><b>5.2.4</b> Dot Plot</a></li>
<li class="chapter" data-level="5.2.5" data-path="ggplot2.html"><a href="ggplot2.html#label-and-title"><i class="fa fa-check"></i><b>5.2.5</b> Label and Title</a></li>
<li class="chapter" data-level="5.2.6" data-path="ggplot2.html"><a href="ggplot2.html#residuals"><i class="fa fa-check"></i><b>5.2.6</b> Residuals</a></li>
<li class="chapter" data-level="5.2.7" data-path="ggplot2.html"><a href="ggplot2.html#encircling"><i class="fa fa-check"></i><b>5.2.7</b> Encircling</a></li>
<li class="chapter" data-level="5.2.8" data-path="ggplot2.html"><a href="ggplot2.html#dumbbell-plot"><i class="fa fa-check"></i><b>5.2.8</b> Dumbbell Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>5.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot2.html"><a href="ggplot2.html#general-appearance"><i class="fa fa-check"></i><b>5.3.1</b> General appearance</a></li>
<li class="chapter" data-level="5.3.2" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>5.3.2</b> Themes</a></li>
<li class="chapter" data-level="5.3.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_freqpoly"><i class="fa fa-check"></i><b>5.3.3</b> geom_freqpoly()</a></li>
<li class="chapter" data-level="5.3.4" data-path="ggplot2.html"><a href="ggplot2.html#marginal-histogram-boxplot"><i class="fa fa-check"></i><b>5.3.4</b> Marginal Histogram / Boxplot</a></li>
<li class="chapter" data-level="5.3.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>5.3.5</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>5.4</b> Bar plot</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic"><i class="fa fa-check"></i><b>5.4.1</b> Aesthetic</a></li>
<li class="chapter" data-level="5.4.2" data-path="ggplot2.html"><a href="ggplot2.html#proportion"><i class="fa fa-check"></i><b>5.4.2</b> Proportion</a></li>
<li class="chapter" data-level="5.4.3" data-path="ggplot2.html"><a href="ggplot2.html#coord-1"><i class="fa fa-check"></i><b>5.4.3</b> coord</a></li>
<li class="chapter" data-level="5.4.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity"><i class="fa fa-check"></i><b>5.4.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="5.4.5" data-path="ggplot2.html"><a href="ggplot2.html#ranking"><i class="fa fa-check"></i><b>5.4.5</b> Ranking</a></li>
<li class="chapter" data-level="5.4.6" data-path="ggplot2.html"><a href="ggplot2.html#means-and-error-bars"><i class="fa fa-check"></i><b>5.4.6</b> Means and error bars</a></li>
<li class="chapter" data-level="5.4.7" data-path="ggplot2.html"><a href="ggplot2.html#waffle-chart"><i class="fa fa-check"></i><b>5.4.7</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ggplot2.html"><a href="ggplot2.html#box-plot"><i class="fa fa-check"></i><b>5.5</b> Box plot</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ggplot2.html"><a href="ggplot2.html#varwidth"><i class="fa fa-check"></i><b>5.5.1</b> varwidth</a></li>
<li class="chapter" data-level="5.5.2" data-path="ggplot2.html"><a href="ggplot2.html#reorder"><i class="fa fa-check"></i><b>5.5.2</b> Reorder</a></li>
<li class="chapter" data-level="5.5.3" data-path="ggplot2.html"><a href="ggplot2.html#fill"><i class="fa fa-check"></i><b>5.5.3</b> Fill</a></li>
<li class="chapter" data-level="5.5.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity-1"><i class="fa fa-check"></i><b>5.5.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="5.5.5" data-path="ggplot2.html"><a href="ggplot2.html#dot-box-plot"><i class="fa fa-check"></i><b>5.5.5</b> Dot + Box Plot</a></li>
<li class="chapter" data-level="5.5.6" data-path="ggplot2.html"><a href="ggplot2.html#violin-plot"><i class="fa fa-check"></i><b>5.5.6</b> Violin Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ggplot2.html"><a href="ggplot2.html#other-rendering"><i class="fa fa-check"></i><b>5.6</b> Other rendering</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i><b>5.6.1</b> Annotation</a></li>
<li class="chapter" data-level="5.6.2" data-path="ggplot2.html"><a href="ggplot2.html#text-ggtext"><i class="fa fa-check"></i><b>5.6.2</b> Text: ggtext</a></li>
<li class="chapter" data-level="5.6.3" data-path="ggplot2.html"><a href="ggplot2.html#text-ggrepel"><i class="fa fa-check"></i><b>5.6.3</b> Text: ggrepel</a></li>
<li class="chapter" data-level="5.6.4" data-path="ggplot2.html"><a href="ggplot2.html#arrage-gridextra"><i class="fa fa-check"></i><b>5.6.4</b> Arrage: gridExtra</a></li>
<li class="chapter" data-level="5.6.5" data-path="ggplot2.html"><a href="ggplot2.html#interactive-charts-plotly"><i class="fa fa-check"></i><b>5.6.5</b> Interactive charts: plotly</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ggplot2.html"><a href="ggplot2.html#diagrammer"><i class="fa fa-check"></i><b>5.7</b> DiagrammeR</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-flowchart-using-grviz"><i class="fa fa-check"></i><b>5.7.1</b> Basic flowchart using <code>grViz</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="ggplot2.html"><a href="ggplot2.html#graphviz-attributes"><i class="fa fa-check"></i><b>5.7.2</b> Graphviz Attributes</a></li>
<li class="chapter" data-level="5.7.3" data-path="ggplot2.html"><a href="ggplot2.html#gantt-chart"><i class="fa fa-check"></i><b>5.7.3</b> Gantt chart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html"><i class="fa fa-check"></i><b>6</b> Proc Sqplot (In Processing)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#ods"><i class="fa fa-check"></i><b>6.1</b> ODS</a></li>
<li class="chapter" data-level="6.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#introduction-1"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#scatter-plot-1"><i class="fa fa-check"></i><b>6.3</b> Scatter Plot</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#vector-in-scatter-plot"><i class="fa fa-check"></i><b>6.3.1</b> Vector in scatter Plot</a></li>
<li class="chapter" data-level="6.3.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#add-predict-curve"><i class="fa fa-check"></i><b>6.3.2</b> Add predict curve</a></li>
<li class="chapter" data-level="6.3.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#grouping"><i class="fa fa-check"></i><b>6.3.3</b> grouping</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#bar-chart"><i class="fa fa-check"></i><b>6.4</b> Bar chart</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#group-and-using-freq"><i class="fa fa-check"></i><b>6.4.1</b> Group and using freq</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#histogram-1"><i class="fa fa-check"></i><b>6.5</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html"><i class="fa fa-check"></i><b>7</b> Descriptive Statistics in SAS</a>
<ul>
<li class="chapter" data-level="7.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-freq"><i class="fa fa-check"></i><b>7.1</b> PROC FREQ</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-table-names"><i class="fa fa-check"></i><b>7.1.1</b> ODS Table Names</a></li>
<li class="chapter" data-level="7.1.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-plots"><i class="fa fa-check"></i><b>7.1.2</b> ODS Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-univariate"><i class="fa fa-check"></i><b>7.2</b> PROC UNIVARIATE</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#histogram-statement"><i class="fa fa-check"></i><b>7.2.1</b> HISTOGRAM Statement</a></li>
<li class="chapter" data-level="7.2.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#cdfplot-statement"><i class="fa fa-check"></i><b>7.2.2</b> CDFPLOT Statement</a></li>
<li class="chapter" data-level="7.2.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ppplot-statement"><i class="fa fa-check"></i><b>7.2.3</b> PPPLOT Statement</a></li>
<li class="chapter" data-level="7.2.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#probplot-and-qqplot-statement"><i class="fa fa-check"></i><b>7.2.4</b> PROBPLOT and QQPLOT Statement</a></li>
<li class="chapter" data-level="7.2.5" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-tables"><i class="fa fa-check"></i><b>7.2.5</b> ODS Tables</a></li>
<li class="chapter" data-level="7.2.6" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-graphics"><i class="fa fa-check"></i><b>7.2.6</b> ODS Graphics</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-means"><i class="fa fa-check"></i><b>7.3</b> PROC MEANS</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-summary-statistics"><i class="fa fa-check"></i><b>7.3.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="7.3.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#autoname-option"><i class="fa fa-check"></i><b>7.3.2</b> AUTONAME Option</a></li>
<li class="chapter" data-level="7.3.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#chartype-option"><i class="fa fa-check"></i><b>7.3.3</b> CHARTYPE Option</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-tabulate"><i class="fa fa-check"></i><b>7.4</b> PROC TABULATE</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-syntax-for-proc-tabulate"><i class="fa fa-check"></i><b>7.4.1</b> Basic Syntax for PROC TABULATE</a></li>
<li class="chapter" data-level="7.4.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#identification-of-desired-statistics"><i class="fa fa-check"></i><b>7.4.2</b> Identification of Desired Statistics</a></li>
<li class="chapter" data-level="7.4.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#in-processing-1"><i class="fa fa-check"></i><b>7.4.3</b> In processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>8</b> Descriptive Statistics in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-pape"><i class="fa fa-check"></i><b>8.1</b> Package pape</a></li>
<li class="chapter" data-level="8.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-summarytools"><i class="fa fa-check"></i><b>8.2</b> Package summarytools</a></li>
<li class="chapter" data-level="8.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-comparegroups"><i class="fa fa-check"></i><b>8.3</b> Package compareGroups</a></li>
<li class="chapter" data-level="8.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary"><i class="fa fa-check"></i><b>8.4</b> Package sjPlot for Models Summary</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#tab_model-and-options"><i class="fa fa-check"></i><b>8.4.1</b> tab_model and options</a></li>
<li class="chapter" data-level="8.4.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#mixed-models"><i class="fa fa-check"></i><b>8.4.2</b> Mixed Models</a></li>
<li class="chapter" data-level="8.4.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#plot_model"><i class="fa fa-check"></i><b>8.4.3</b> plot_model</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-kableextra"><i class="fa fa-check"></i><b>8.5</b> Package kableExtra</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#kable_styling"><i class="fa fa-check"></i><b>8.5.1</b> kable_styling</a></li>
<li class="chapter" data-level="8.5.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#columnrow-specification"><i class="fa fa-check"></i><b>8.5.2</b> Column/Row Specification</a></li>
<li class="chapter" data-level="8.5.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#grouping-columnsrows"><i class="fa fa-check"></i><b>8.5.3</b> Grouping columns/rows</a></li>
<li class="chapter" data-level="8.5.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#add-footnote"><i class="fa fa-check"></i><b>8.5.4</b> Add Footnote</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html"><i class="fa fa-check"></i><b>9</b> Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#distribution"><i class="fa fa-check"></i><b>9.1</b> Distribution</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#quantile-function-in-sas"><i class="fa fa-check"></i><b>9.1.1</b> Quantile Function in SAS</a></li>
<li class="chapter" data-level="9.1.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-distribution"><i class="fa fa-check"></i><b>9.1.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="9.1.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>9.1.3</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="9.1.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multinomial-distribution"><i class="fa fa-check"></i><b>9.1.4</b> Multinomial distribution</a></li>
<li class="chapter" data-level="9.1.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#normal-distribution"><i class="fa fa-check"></i><b>9.1.5</b> Normal Distribution</a></li>
<li class="chapter" data-level="9.1.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>9.1.6</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="9.1.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#poisson-distribution"><i class="fa fa-check"></i><b>9.1.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="9.1.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#exponential-distribution"><i class="fa fa-check"></i><b>9.1.8</b> Exponential distribution</a></li>
<li class="chapter" data-level="9.1.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#gamma-distribution"><i class="fa fa-check"></i><b>9.1.9</b> Gamma distribution</a></li>
<li class="chapter" data-level="9.1.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#weibull-distribution"><i class="fa fa-check"></i><b>9.1.10</b> Weibull Distribution</a></li>
<li class="chapter" data-level="9.1.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#beta-distribution"><i class="fa fa-check"></i><b>9.1.11</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#point-estimates"><i class="fa fa-check"></i><b>9.2</b> Point Estimates</a></li>
<li class="chapter" data-level="9.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-proportions"><i class="fa fa-check"></i><b>9.3</b> Test Proportion(s)</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-ci-for-small-samples"><i class="fa fa-check"></i><b>9.3.1</b> Binomial CI for Small Samples</a></li>
<li class="chapter" data-level="9.3.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-binom"><i class="fa fa-check"></i><b>9.3.2</b> Package binom</a></li>
<li class="chapter" data-level="9.3.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#ci_single_proportion"><i class="fa fa-check"></i><b>9.3.3</b> %CI_Single_Proportion</a></li>
<li class="chapter" data-level="9.3.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#incidence-rate-ci"><i class="fa fa-check"></i><b>9.3.4</b> Incidence rate CI</a></li>
<li class="chapter" data-level="9.3.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-pwr"><i class="fa fa-check"></i><b>9.3.5</b> Package: pwr</a></li>
<li class="chapter" data-level="9.3.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportion-2-sided-equality-based-on-wald-ci"><i class="fa fa-check"></i><b>9.3.6</b> 1-Sample Proportion, 2-Sided Equality based on Wald CI</a></li>
<li class="chapter" data-level="9.3.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportion-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>9.3.7</b> 1-Sample Proportion Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="9.3.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportion-equivalence"><i class="fa fa-check"></i><b>9.3.8</b> 1-Sample Proportion Equivalence</a></li>
<li class="chapter" data-level="9.3.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-2-sided-equality-based-on-wald-ci"><i class="fa fa-check"></i><b>9.3.9</b> 2-Sample Proportions, 2-Sided Equality based on Wald CI</a></li>
<li class="chapter" data-level="9.3.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>9.3.10</b> 2-Sample Proportions Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="9.3.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-proportions-equivalence"><i class="fa fa-check"></i><b>9.3.11</b> 2-Sample Proportions Equivalence</a></li>
<li class="chapter" data-level="9.3.12" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test"><i class="fa fa-check"></i><b>9.3.12</b> Paired Proportions: McNemar’s Z-test</a></li>
<li class="chapter" data-level="9.3.13" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#chi-square-test"><i class="fa fa-check"></i><b>9.3.13</b> Chi-square test</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-means"><i class="fa fa-check"></i><b>9.4</b> Test Mean(s)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality"><i class="fa fa-check"></i><b>9.4.1</b> One Sample Mean 2-Sided Equality</a></li>
<li class="chapter" data-level="9.4.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>9.4.2</b> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="9.4.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-mean-equivalence"><i class="fa fa-check"></i><b>9.4.3</b> 1-Sample Mean Equivalence</a></li>
<li class="chapter" data-level="9.4.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-2-sided-equality"><i class="fa fa-check"></i><b>9.4.4</b> 2-Sample Means, 2-Sided Equality</a></li>
<li class="chapter" data-level="9.4.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-1-sided"><i class="fa fa-check"></i><b>9.4.5</b> 2-Sample Means, 1-Sided</a></li>
<li class="chapter" data-level="9.4.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority"><i class="fa fa-check"></i><b>9.4.6</b> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li class="chapter" data-level="9.4.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#sample-means-equivalence"><i class="fa fa-check"></i><b>9.4.7</b> 2-Sample Means Equivalence</a></li>
<li class="chapter" data-level="9.4.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test"><i class="fa fa-check"></i><b>9.4.8</b> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li class="chapter" data-level="9.4.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-k-means"><i class="fa fa-check"></i><b>9.4.9</b> Test k Means</a></li>
<li class="chapter" data-level="9.4.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#anova-using-pwr.anova.test"><i class="fa fa-check"></i><b>9.4.10</b> Anova using <code>pwr.anova.test</code></a></li>
<li class="chapter" data-level="9.4.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#average-bioequivalence"><i class="fa fa-check"></i><b>9.4.11</b> Average Bioequivalence</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#other-methods"><i class="fa fa-check"></i><b>9.5</b> Other Methods</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#odds-ratio"><i class="fa fa-check"></i><b>9.5.1</b> Odds Ratio</a></li>
<li class="chapter" data-level="9.5.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlation"><i class="fa fa-check"></i><b>9.5.2</b> Correlation</a></li>
<li class="chapter" data-level="9.5.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies"><i class="fa fa-check"></i><b>9.5.3</b> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multiple-test"><i class="fa fa-check"></i><b>9.6</b> Multiple test</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#definitions-of-power"><i class="fa fa-check"></i><b>9.6.1</b> Definitions of Power</a></li>
<li class="chapter" data-level="9.6.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#bonferroni-tests-individual-power"><i class="fa fa-check"></i><b>9.6.2</b> Bonferroni Tests (Individual Power)</a></li>
<li class="chapter" data-level="9.6.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#tukeys-method-individual-power"><i class="fa fa-check"></i><b>9.6.3</b> Tukey’s method (Individual Power)</a></li>
<li class="chapter" data-level="9.6.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power"><i class="fa fa-check"></i><b>9.6.4</b> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li class="chapter" data-level="9.6.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower"><i class="fa fa-check"></i><b>9.6.5</b> Combined Power %SimPower and %PlotSimPower</a></li>
<li class="chapter" data-level="9.6.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r"><i class="fa fa-check"></i><b>9.6.6</b> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#time-to-event-data"><i class="fa fa-check"></i><b>9.7</b> Time-To-Event Data</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#cox-ph-2-sided-equality"><i class="fa fa-check"></i><b>9.7.1</b> Cox PH, 2-Sided Equality</a></li>
<li class="chapter" data-level="9.7.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks"><i class="fa fa-check"></i><b>9.7.2</b> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#estimation-in-diagnostic-test"><i class="fa fa-check"></i><b>9.8</b> Estimation in diagnostic test</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#adequate-sensitivityspecificity"><i class="fa fa-check"></i><b>9.8.1</b> Adequate sensitivity/specificity</a></li>
<li class="chapter" data-level="9.8.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#testing-sensitivity-or-specificity"><i class="fa fa-check"></i><b>9.8.2</b> Testing sensitivity (or specificity)</a></li>
<li class="chapter" data-level="9.8.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#likelihood-ratio-estimation"><i class="fa fa-check"></i><b>9.8.3</b> Likelihood ratio estimation</a></li>
<li class="chapter" data-level="9.8.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#roc-index-of-accuracy"><i class="fa fa-check"></i><b>9.8.4</b> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parametric-test.html"><a href="parametric-test.html"><i class="fa fa-check"></i><b>10</b> Parametric Test</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parametric-test.html"><a href="parametric-test.html#binomial-test"><i class="fa fa-check"></i><b>10.1</b> Binomial test</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula"><i class="fa fa-check"></i><b>10.1.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="10.1.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation"><i class="fa fa-check"></i><b>10.1.2</b> R implementation</a></li>
<li class="chapter" data-level="10.1.3" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation"><i class="fa fa-check"></i><b>10.1.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="parametric-test.html"><a href="parametric-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>10.2</b> Fisher’s Exact Test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-2"><i class="fa fa-check"></i><b>10.2.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-1"><i class="fa fa-check"></i><b>10.2.2</b> SAS implementation</a></li>
<li class="chapter" data-level="10.2.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-1"><i class="fa fa-check"></i><b>10.2.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="parametric-test.html"><a href="parametric-test.html#mcnemars-test"><i class="fa fa-check"></i><b>10.3</b> McNemar’s test</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-3"><i class="fa fa-check"></i><b>10.3.1</b> introduction</a></li>
<li class="chapter" data-level="10.3.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-2"><i class="fa fa-check"></i><b>10.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="10.3.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-2"><i class="fa fa-check"></i><b>10.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="parametric-test.html"><a href="parametric-test.html#cochranmantelhaenszel-test"><i class="fa fa-check"></i><b>10.4</b> Cochran–Mantel–Haenszel Test</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-3"><i class="fa fa-check"></i><b>10.4.1</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="parametric-test.html"><a href="parametric-test.html#correlation-test"><i class="fa fa-check"></i><b>10.5</b> Correlation Test</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="parametric-test.html"><a href="parametric-test.html#pearson-correlation"><i class="fa fa-check"></i><b>10.5.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="10.5.2" data-path="parametric-test.html"><a href="parametric-test.html#spearman-correlation"><i class="fa fa-check"></i><b>10.5.2</b> Spearman correlation</a></li>
<li class="chapter" data-level="10.5.3" data-path="parametric-test.html"><a href="parametric-test.html#kendall-correlation"><i class="fa fa-check"></i><b>10.5.3</b> Kendall correlation</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="parametric-test.html"><a href="parametric-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>10.6</b> Two Sample T-Test</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="parametric-test.html"><a href="parametric-test.html#inreoduction-1"><i class="fa fa-check"></i><b>10.6.1</b> Inreoduction</a></li>
<li class="chapter" data-level="10.6.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-3"><i class="fa fa-check"></i><b>10.6.2</b> SAS implementation</a></li>
<li class="chapter" data-level="10.6.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-4"><i class="fa fa-check"></i><b>10.6.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="parametric-test.html"><a href="parametric-test.html#normality-test"><i class="fa fa-check"></i><b>10.7</b> Normality test</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-4"><i class="fa fa-check"></i><b>10.7.1</b> SAS implementation</a></li>
<li class="chapter" data-level="10.7.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-5"><i class="fa fa-check"></i><b>10.7.2</b> R implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>11</b> ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="anova.html"><a href="anova.html#unstructured-models"><i class="fa fa-check"></i><b>11.1</b> Unstructured Models</a></li>
<li class="chapter" data-level="11.2" data-path="anova.html"><a href="anova.html#balanced-one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>11.2</b> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="anova.html"><a href="anova.html#modeling-assumptions-and-basic-analysis"><i class="fa fa-check"></i><b>11.2.1</b> Modeling Assumptions and Basic Analysis</a></li>
<li class="chapter" data-level="11.2.2" data-path="anova.html"><a href="anova.html#parameter-estimates"><i class="fa fa-check"></i><b>11.2.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="11.2.3" data-path="anova.html"><a href="anova.html#r-implementation-6"><i class="fa fa-check"></i><b>11.2.3</b> R Implementation</a></li>
<li class="chapter" data-level="11.2.4" data-path="anova.html"><a href="anova.html#sas-implementation-5"><i class="fa fa-check"></i><b>11.2.4</b> SAS Implementation</a></li>
<li class="chapter" data-level="11.2.5" data-path="anova.html"><a href="anova.html#model-diagnosis"><i class="fa fa-check"></i><b>11.2.5</b> Model Diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="anova.html"><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>11.3</b> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="11.4" data-path="anova.html"><a href="anova.html#two-ways-anova-test"><i class="fa fa-check"></i><b>11.4</b> Two-Ways ANOVA Test</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="anova.html"><a href="anova.html#introduction-4"><i class="fa fa-check"></i><b>11.4.1</b> Introduction</a></li>
<li class="chapter" data-level="11.4.2" data-path="anova.html"><a href="anova.html#r-implementation-7"><i class="fa fa-check"></i><b>11.4.2</b> R implementation</a></li>
<li class="chapter" data-level="11.4.3" data-path="anova.html"><a href="anova.html#sas-implementation-6"><i class="fa fa-check"></i><b>11.4.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="11.4.4" data-path="anova.html"><a href="anova.html#unbalanced-design"><i class="fa fa-check"></i><b>11.4.4</b> Unbalanced design</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="anova.html"><a href="anova.html#heteroscedastic-responses"><i class="fa fa-check"></i><b>11.5</b> Heteroscedastic Responses</a></li>
<li class="chapter" data-level="11.6" data-path="anova.html"><a href="anova.html#repeated-measures-anova-data"><i class="fa fa-check"></i><b>11.6</b> Repeated Measures ANOVA Data</a></li>
<li class="chapter" data-level="11.7" data-path="anova.html"><a href="anova.html#multivariate-responses-with-normally-distributed-data"><i class="fa fa-check"></i><b>11.7</b> Multivariate Responses with Normally Distributed Data</a></li>
<li class="chapter" data-level="11.8" data-path="anova.html"><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>11.8</b> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li class="chapter" data-level="11.9" data-path="anova.html"><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>11.9</b> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multiple-comparison.html"><a href="multiple-comparison.html"><i class="fa fa-check"></i><b>12</b> Multiple-Comparison</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-5"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiplicity-problem"><i class="fa fa-check"></i><b>12.1.1</b> Multiplicity Problem</a></li>
<li class="chapter" data-level="12.1.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#error-rates"><i class="fa fa-check"></i><b>12.1.2</b> Error Rates</a></li>
<li class="chapter" data-level="12.1.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-adjusted-p"><i class="fa fa-check"></i><b>12.1.3</b> The adjusted P</a></li>
<li class="chapter" data-level="12.1.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#basic-statistical-concepts"><i class="fa fa-check"></i><b>12.1.4</b> Basic Statistical Concepts</a></li>
<li class="chapter" data-level="12.1.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#functions-in-glht-package-in-r"><i class="fa fa-check"></i><b>12.1.5</b> Functions in glht package in R</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-and-šidák-methods"><i class="fa fa-check"></i><b>12.2</b> Bonferroni and Šidák Methods</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#lsd-least-significance-difference"><i class="fa fa-check"></i><b>12.2.1</b> LSD (least significance difference)</a></li>
<li class="chapter" data-level="12.2.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák"><i class="fa fa-check"></i><b>12.2.2</b> Šidák</a></li>
<li class="chapter" data-level="12.2.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni"><i class="fa fa-check"></i><b>12.2.3</b> Bonferroni</a></li>
<li class="chapter" data-level="12.2.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot"><i class="fa fa-check"></i><b>12.2.4</b> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova"><i class="fa fa-check"></i><b>12.3</b> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#ls-means"><i class="fa fa-check"></i><b>12.3.1</b> LS-Means</a></li>
<li class="chapter" data-level="12.3.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-multivariate-t-distribution"><i class="fa fa-check"></i><b>12.3.2</b> The Multivariate t Distribution</a></li>
<li class="chapter" data-level="12.3.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha"><i class="fa fa-check"></i><b>12.3.3</b> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li class="chapter" data-level="12.3.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution"><i class="fa fa-check"></i><b>12.3.4</b> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li class="chapter" data-level="12.3.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons"><i class="fa fa-check"></i><b>12.3.5</b> Tukey’s Method for All Pairwise Comparisons</a></li>
<li class="chapter" data-level="12.3.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically"><i class="fa fa-check"></i><b>12.3.6</b> Displaying Pairwise Comparisons Graphically</a></li>
<li class="chapter" data-level="12.3.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><i class="fa fa-check"></i><b>12.3.7</b> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li class="chapter" data-level="12.3.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control"><i class="fa fa-check"></i><b>12.3.8</b> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li class="chapter" data-level="12.3.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><i class="fa fa-check"></i><b>12.3.9</b> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><i class="fa fa-check"></i><b>12.4</b> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-model-and-estimates"><i class="fa fa-check"></i><b>12.4.1</b> The Model and Estimates</a></li>
<li class="chapter" data-level="12.4.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukey-kramer-method"><i class="fa fa-check"></i><b>12.4.2</b> Tukey-Kramer Method</a></li>
<li class="chapter" data-level="12.4.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#alternative-simulation-based-method"><i class="fa fa-check"></i><b>12.4.3</b> Alternative Simulation-Based Method</a></li>
<li class="chapter" data-level="12.4.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#pairwise-comparisons-with-control"><i class="fa fa-check"></i><b>12.4.4</b> Pairwise Comparisons with Control</a></li>
<li class="chapter" data-level="12.4.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom"><i class="fa fa-check"></i><b>12.4.5</b> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>12.5</b> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation"><i class="fa fa-check"></i><b>12.5.1</b> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li class="chapter" data-level="12.5.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method"><i class="fa fa-check"></i><b>12.5.2</b> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li class="chapter" data-level="12.5.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction"><i class="fa fa-check"></i><b>12.5.3</b> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters"><i class="fa fa-check"></i><b>12.6</b> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#scheffés-method"><i class="fa fa-check"></i><b>12.6.1</b> Scheffés Method</a></li>
<li class="chapter" data-level="12.6.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#finding-the-maximal-contrast"><i class="fa fa-check"></i><b>12.6.2</b> Finding the Maximal Contrast</a></li>
<li class="chapter" data-level="12.6.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#working-hotelling-method"><i class="fa fa-check"></i><b>12.6.3</b> Working-Hotelling method</a></li>
<li class="chapter" data-level="12.6.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#discrete-approximation-method"><i class="fa fa-check"></i><b>12.6.4</b> Discrete approximation method</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity"><i class="fa fa-check"></i><b>12.7</b> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-of-heteroscedasticity"><i class="fa fa-check"></i><b>12.7.1</b> Introduction of heteroscedasticity</a></li>
<li class="chapter" data-level="12.7.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#satterthwaite-approximation"><i class="fa fa-check"></i><b>12.7.2</b> Satterthwaite Approximation</a></li>
<li class="chapter" data-level="12.7.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>12.7.3</b> MaxT Method under Heteroscedasticity</a></li>
<li class="chapter" data-level="12.7.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#minp-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>12.7.4</b> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-and-stepwise-testing-methods"><i class="fa fa-check"></i><b>12.8</b> Closed and Stepwise Testing Methods</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-family-of-hypotheses"><i class="fa fa-check"></i><b>12.8.1</b> Closed Family of Hypotheses</a></li>
<li class="chapter" data-level="12.8.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-holm-method"><i class="fa fa-check"></i><b>12.8.2</b> Bonferroni-Holm Method</a></li>
<li class="chapter" data-level="12.8.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák-holm-method"><i class="fa fa-check"></i><b>12.8.3</b> Šidák-Holm Method</a></li>
<li class="chapter" data-level="12.8.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-fisher-combination-method"><i class="fa fa-check"></i><b>12.8.4</b> Closed Fisher Combination Method</a></li>
<li class="chapter" data-level="12.8.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#simes-hommel-method"><i class="fa fa-check"></i><b>12.8.5</b> Simes-Hommel Method</a></li>
<li class="chapter" data-level="12.8.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hochbergs-ok-step-up"><i class="fa fa-check"></i><b>12.8.6</b> Hochberg’s O(k) Step-Up</a></li>
<li class="chapter" data-level="12.8.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences"><i class="fa fa-check"></i><b>12.8.7</b> Sequential Testing with Fixed Sequences</a></li>
<li class="chapter" data-level="12.8.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods"><i class="fa fa-check"></i><b>12.8.8</b> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts"><i class="fa fa-check"></i><b>12.9</b> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#incorporating-logical-constraints"><i class="fa fa-check"></i><b>12.9.1</b> Incorporating Logical Constraints</a></li>
<li class="chapter" data-level="12.9.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#shaffers-method"><i class="fa fa-check"></i><b>12.9.2</b> Shaffer’s Method</a></li>
<li class="chapter" data-level="12.9.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#extended-shaffer-royen-method"><i class="fa fa-check"></i><b>12.9.3</b> Extended Shaffer-Royen Method</a></li>
<li class="chapter" data-level="12.9.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#step-down-dunnett-test"><i class="fa fa-check"></i><b>12.9.4</b> Step-down Dunnett test</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-with-binary-data"><i class="fa fa-check"></i><b>12.10</b> Multiple Comparisons with Binary Data</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-6"><i class="fa fa-check"></i><b>12.10.1</b> Introduction</a></li>
<li class="chapter" data-level="12.10.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes"><i class="fa fa-check"></i><b>12.10.2</b> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>13</b> Non-Parametric Test</a>
<ul>
<li class="chapter" data-level="13.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#two-samples-hypotheses-testing"><i class="fa fa-check"></i><b>13.1</b> Two Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples"><i class="fa fa-check"></i><b>13.1.1</b> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li class="chapter" data-level="13.1.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched"><i class="fa fa-check"></i><b>13.1.2</b> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li class="chapter" data-level="13.1.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>13.1.3</b> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="13.1.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>13.1.4</b> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="13.1.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions"><i class="fa fa-check"></i><b>13.1.5</b> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#several-samples-hypotheses-testing"><i class="fa fa-check"></i><b>13.2</b> Several Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples"><i class="fa fa-check"></i><b>13.2.1</b> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li class="chapter" data-level="13.2.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter"><i class="fa fa-check"></i><b>13.2.2</b> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#tests-for-categorical-data"><i class="fa fa-check"></i><b>13.3</b> Tests for Categorical Data</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test"><i class="fa fa-check"></i><b>13.3.1</b> Spearman Rank Correlation Coefficient Test</a></li>
<li class="chapter" data-level="13.3.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#fisher-exact-test"><i class="fa fa-check"></i><b>13.3.2</b> Fisher Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-test"><i class="fa fa-check"></i><b>13.4</b> Permutation test</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#introduction-7"><i class="fa fa-check"></i><b>13.4.1</b> Introduction</a></li>
<li class="chapter" data-level="13.4.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#package-coin"><i class="fa fa-check"></i><b>13.4.2</b> Package: coin</a></li>
<li class="chapter" data-level="13.4.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data"><i class="fa fa-check"></i><b>13.4.3</b> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li class="chapter" data-level="13.4.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data"><i class="fa fa-check"></i><b>13.4.4</b> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li class="chapter" data-level="13.4.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles"><i class="fa fa-check"></i><b>13.4.5</b> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#nonparametric-regression"><i class="fa fa-check"></i><b>13.5</b> Nonparametric Regression</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>14</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation-1"><i class="fa fa-check"></i><b>14.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>14.1.1</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="14.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>14.1.2</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="14.1.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient"><i class="fa fa-check"></i><b>14.1.3</b> Kendall rank correlation coefficient</a></li>
<li class="chapter" data-level="14.1.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#intraclass-correlation"><i class="fa fa-check"></i><b>14.1.4</b> Intraclass correlation</a></li>
<li class="chapter" data-level="14.1.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualize-the-correlation-in-r"><i class="fa fa-check"></i><b>14.1.5</b> Visualize the correlation in R</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>14.2</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#assumpions"><i class="fa fa-check"></i><b>14.2.1</b> Assumpions</a></li>
<li class="chapter" data-level="14.2.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#interpretation"><i class="fa fa-check"></i><b>14.2.2</b> Interpretation</a></li>
<li class="chapter" data-level="14.2.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#matrix-solution"><i class="fa fa-check"></i><b>14.2.3</b> Matrix Solution</a></li>
<li class="chapter" data-level="14.2.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>14.2.4</b> Gauss-Markov Theorem</a></li>
<li class="chapter" data-level="14.2.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#limitation"><i class="fa fa-check"></i><b>14.2.5</b> limitation</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-statistics"><i class="fa fa-check"></i><b>14.3</b> Model Statistics</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#residuals-standard-error"><i class="fa fa-check"></i><b>14.3.1</b> Residuals Standard Error</a></li>
<li class="chapter" data-level="14.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>14.3.2</b> R-Squared and Adjusted R-Squared</a></li>
<li class="chapter" data-level="14.3.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#t-statistic"><i class="fa fa-check"></i><b>14.3.3</b> T Statistic</a></li>
<li class="chapter" data-level="14.3.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#f-statistic"><i class="fa fa-check"></i><b>14.3.4</b> F Statistic</a></li>
<li class="chapter" data-level="14.3.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>14.3.5</b> Confidence Intervals</a></li>
<li class="chapter" data-level="14.3.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>14.3.6</b> Likelihood-ratio test</a></li>
<li class="chapter" data-level="14.3.7" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#accuracy"><i class="fa fa-check"></i><b>14.3.7</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>14.4</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-error-assumptions"><i class="fa fa-check"></i><b>14.4.1</b> Checking Error Assumptions</a></li>
<li class="chapter" data-level="14.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#finding-unusual-observations"><i class="fa fa-check"></i><b>14.4.2</b> Finding Unusual Observations</a></li>
<li class="chapter" data-level="14.4.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-the-structure-of-the-model"><i class="fa fa-check"></i><b>14.4.3</b> Checking the Structure of the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#sas-implementation-proc-reg"><i class="fa fa-check"></i><b>14.5</b> SAS implementation Proc Reg</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#options"><i class="fa fa-check"></i><b>14.5.1</b> Options</a></li>
<li class="chapter" data-level="14.5.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#diagnose"><i class="fa fa-check"></i><b>14.5.2</b> Diagnose</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-implementation-8"><i class="fa fa-check"></i><b>14.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html"><i class="fa fa-check"></i><b>15</b> Advanced Linear Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#model-selection"><i class="fa fa-check"></i><b>15.1</b> Model Selection</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-methods"><i class="fa fa-check"></i><b>15.1.1</b> Selection Methods</a></li>
<li class="chapter" data-level="15.1.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-criteria"><i class="fa fa-check"></i><b>15.1.2</b> Selection Criteria</a></li>
<li class="chapter" data-level="15.1.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#k--fold-cross-validation"><i class="fa fa-check"></i><b>15.1.3</b> k- Fold Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#practical-difficulties-using-ols"><i class="fa fa-check"></i><b>15.2</b> Practical Difficulties using OLS</a></li>
<li class="chapter" data-level="15.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#skewness"><i class="fa fa-check"></i><b>15.3</b> Skewness</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#introduction-8"><i class="fa fa-check"></i><b>15.3.1</b> Introduction</a></li>
<li class="chapter" data-level="15.3.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#baisc-transformation"><i class="fa fa-check"></i><b>15.3.2</b> Baisc Transformation</a></li>
<li class="chapter" data-level="15.3.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#box-cox-power-transformation"><i class="fa fa-check"></i><b>15.3.3</b> Box-Cox Power Transformation</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#scale-1"><i class="fa fa-check"></i><b>15.4</b> Scale</a></li>
<li class="chapter" data-level="15.5" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#interaction"><i class="fa fa-check"></i><b>15.5</b> Interaction</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>15.5.1</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="15.5.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#plotting-interactions"><i class="fa fa-check"></i><b>15.5.2</b> Plotting Interactions</a></li>
<li class="chapter" data-level="15.5.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#check-linearity-assumption"><i class="fa fa-check"></i><b>15.5.3</b> Check linearity assumption</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#collinearity"><i class="fa fa-check"></i><b>15.6</b> Collinearity</a></li>
<li class="chapter" data-level="15.7" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#problems-with-the-error"><i class="fa fa-check"></i><b>15.7</b> Problems with the Error</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#generalized-least-squares"><i class="fa fa-check"></i><b>15.7.1</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="15.7.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>15.7.2</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="15.7.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#robust-regression"><i class="fa fa-check"></i><b>15.7.3</b> Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#shrinkage-methods"><i class="fa fa-check"></i><b>15.8</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#principal-components-analzsis"><i class="fa fa-check"></i><b>15.8.1</b> Principal Components Analzsis</a></li>
<li class="chapter" data-level="15.8.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#partial-least-squares"><i class="fa fa-check"></i><b>15.8.2</b> Partial Least Squares</a></li>
<li class="chapter" data-level="15.8.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>15.8.3</b> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>16</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-9"><i class="fa fa-check"></i><b>16.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>16.1.1</b> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li class="chapter" data-level="16.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#more-fundamental-problem-outside-01"><i class="fa fa-check"></i><b>16.1.2</b> More fundamental problem outside [0,1]</a></li>
<li class="chapter" data-level="16.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-model"><i class="fa fa-check"></i><b>16.1.3</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="16.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-of-the-logistic-model"><i class="fa fa-check"></i><b>16.1.4</b> Estimation of the Logistic Model</a></li>
<li class="chapter" data-level="16.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#convergence-problems"><i class="fa fa-check"></i><b>16.1.5</b> Convergence Problems</a></li>
<li class="chapter" data-level="16.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#use-exact-methods."><i class="fa fa-check"></i><b>16.1.6</b> Use exact methods.</a></li>
<li class="chapter" data-level="16.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#use-penalized-likelihood"><i class="fa fa-check"></i><b>16.1.7</b> Use penalized likelihood</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-modell"><i class="fa fa-check"></i><b>16.2</b> Logit Modell</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-10"><i class="fa fa-check"></i><b>16.2.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-9"><i class="fa fa-check"></i><b>16.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="16.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-7"><i class="fa fa-check"></i><b>16.2.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="16.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#multicollinearity"><i class="fa fa-check"></i><b>16.2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="16.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance"><i class="fa fa-check"></i><b>16.2.5</b> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li class="chapter" data-level="16.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test"><i class="fa fa-check"></i><b>16.2.6</b> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="16.2.7" data-path="logistic-regression.html"><a href="logistic-regression.html#statistics-measuring-predictive-power-r2"><i class="fa fa-check"></i><b>16.2.7</b> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="16.2.8" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>16.2.8</b> ROC Curves</a></li>
<li class="chapter" data-level="16.2.9" data-path="logistic-regression.html"><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics"><i class="fa fa-check"></i><b>16.2.9</b> Predicted Values, Residuals, and Influence Statistics</a></li>
<li class="chapter" data-level="16.2.10" data-path="logistic-regression.html"><a href="logistic-regression.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>16.2.10</b> Unobserved Heterogeneity</a></li>
<li class="chapter" data-level="16.2.11" data-path="logistic-regression.html"><a href="logistic-regression.html#plotting-effects-of-predictor-variables"><i class="fa fa-check"></i><b>16.2.11</b> Plotting Effects of Predictor Variables</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="logistic-regression.html"><a href="logistic-regression.html#probit-modell"><i class="fa fa-check"></i><b>16.3</b> Probit Modell</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-11"><i class="fa fa-check"></i><b>16.3.1</b> Introduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation"><i class="fa fa-check"></i><b>16.3.2</b> R Implemetation</a></li>
<li class="chapter" data-level="16.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-8"><i class="fa fa-check"></i><b>16.3.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="logistic-regression.html"><a href="logistic-regression.html#complementary-log-log-modell"><i class="fa fa-check"></i><b>16.4</b> Complementary log-log-Modell</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation-1"><i class="fa fa-check"></i><b>16.4.1</b> R Implemetation</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multi-category-logit-model"><i class="fa fa-check"></i><b>16.5</b> Multi-category logit model</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomialverteilung"><i class="fa fa-check"></i><b>16.5.1</b> Multinomialverteilung</a></li>
<li class="chapter" data-level="16.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#mehrkategoriales-logit-modell"><i class="fa fa-check"></i><b>16.5.2</b> Mehrkategoriales Logit-Modell</a></li>
<li class="chapter" data-level="16.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-10"><i class="fa fa-check"></i><b>16.5.3</b> R Implementation</a></li>
<li class="chapter" data-level="16.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-9"><i class="fa fa-check"></i><b>16.5.4</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="logistic-regression.html"><a href="logistic-regression.html#ordinal-cumulative-logit-model"><i class="fa fa-check"></i><b>16.6</b> Ordinal Cumulative Logit Model</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-11"><i class="fa fa-check"></i><b>16.6.1</b> R Implementation</a></li>
<li class="chapter" data-level="16.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-10"><i class="fa fa-check"></i><b>16.6.2</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="logistic-regression.html"><a href="logistic-regression.html#adjacent-categories-model"><i class="fa fa-check"></i><b>16.7</b> Adjacent Categories Model</a></li>
<li class="chapter" data-level="16.8" data-path="logistic-regression.html"><a href="logistic-regression.html#continuation-ratio-model"><i class="fa fa-check"></i><b>16.8</b> Continuation Ratio Model</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html"><i class="fa fa-check"></i><b>17</b> Advanced Logistic Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>17.1</b> Logit Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table"><i class="fa fa-check"></i><b>17.1.1</b> Two-Way Table</a></li>
<li class="chapter" data-level="17.1.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#three-way-table"><i class="fa fa-check"></i><b>17.1.2</b> Three-Way Table</a></li>
<li class="chapter" data-level="17.1.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#four-way-table"><i class="fa fa-check"></i><b>17.1.3</b> Four-Way Table</a></li>
<li class="chapter" data-level="17.1.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#overdispersion"><i class="fa fa-check"></i><b>17.1.4</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>17.2</b> Loglinear Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table-1"><i class="fa fa-check"></i><b>17.2.1</b> Two-way Table</a></li>
<li class="chapter" data-level="17.2.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#problem-of-zeros"><i class="fa fa-check"></i><b>17.2.2</b> Problem of Zeros</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#discrete-choice-analysis"><i class="fa fa-check"></i><b>17.3</b> Discrete Choice Analysis</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logistic-strata"><i class="fa fa-check"></i><b>17.3.1</b> Logistic Strata</a></li>
<li class="chapter" data-level="17.3.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#conditional-logit-model"><i class="fa fa-check"></i><b>17.3.2</b> Conditional logit model</a></li>
<li class="chapter" data-level="17.3.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#ranked-data"><i class="fa fa-check"></i><b>17.3.3</b> Ranked Data</a></li>
<li class="chapter" data-level="17.3.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model"><i class="fa fa-check"></i><b>17.3.4</b> Heteroscedastic extreme value (HEV) Model</a></li>
<li class="chapter" data-level="17.3.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#nested-logit-model"><i class="fa fa-check"></i><b>17.3.5</b> Nested logit model</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data"><i class="fa fa-check"></i><b>17.4</b> Longitudinal and Other Clustered Data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#introduction-12"><i class="fa fa-check"></i><b>17.4.1</b> Introduction</a></li>
<li class="chapter" data-level="17.4.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#robust-standard-errors"><i class="fa fa-check"></i><b>17.4.2</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="17.4.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod"><i class="fa fa-check"></i><b>17.4.3</b> GEE Estimation with PROC GENMOD</a></li>
<li class="chapter" data-level="17.4.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix"><i class="fa fa-check"></i><b>17.4.4</b> Mixed Models with PROC GLIMMIX</a></li>
<li class="chapter" data-level="17.4.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression"><i class="fa fa-check"></i><b>17.4.5</b> Fixed-Effects with Conditional Logistic Regression</a></li>
<li class="chapter" data-level="17.4.6" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#hybrid-method"><i class="fa fa-check"></i><b>17.4.6</b> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>18</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="survival-analysis.html"><a href="survival-analysis.html#preliminary"><i class="fa fa-check"></i><b>18.1</b> Preliminary</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="survival-analysis.html"><a href="survival-analysis.html#probability-density-function"><i class="fa fa-check"></i><b>18.1.1</b> Probability density function</a></li>
<li class="chapter" data-level="18.1.2" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-distribution-function"><i class="fa fa-check"></i><b>18.1.2</b> Cumulative distribution function</a></li>
<li class="chapter" data-level="18.1.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-function"><i class="fa fa-check"></i><b>18.1.3</b> Survival function</a></li>
<li class="chapter" data-level="18.1.4" data-path="survival-analysis.html"><a href="survival-analysis.html#hazard-function"><i class="fa fa-check"></i><b>18.1.4</b> Hazard function</a></li>
<li class="chapter" data-level="18.1.5" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-hazard-function"><i class="fa fa-check"></i><b>18.1.5</b> Cumulative hazard function</a></li>
<li class="chapter" data-level="18.1.6" data-path="survival-analysis.html"><a href="survival-analysis.html#mean-residual-life"><i class="fa fa-check"></i><b>18.1.6</b> Mean Residual Life</a></li>
<li class="chapter" data-level="18.1.7" data-path="survival-analysis.html"><a href="survival-analysis.html#relation-between-functions"><i class="fa fa-check"></i><b>18.1.7</b> Relation between functions</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>18.2</b> Kaplan-Meier estimator</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="survival-analysis.html"><a href="survival-analysis.html#km-introduction"><i class="fa fa-check"></i><b>18.2.1</b> KM Introduction</a></li>
<li class="chapter" data-level="18.2.2" data-path="survival-analysis.html"><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function"><i class="fa fa-check"></i><b>18.2.2</b> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li class="chapter" data-level="18.2.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-curve-in-sas"><i class="fa fa-check"></i><b>18.2.3</b> Survival curve in SAS</a></li>
<li class="chapter" data-level="18.2.4" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-sas"><i class="fa fa-check"></i><b>18.2.4</b> KM Survival Plots in SAS</a></li>
<li class="chapter" data-level="18.2.5" data-path="survival-analysis.html"><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r"><i class="fa fa-check"></i><b>18.2.5</b> Convert Personal-level to Personal-period in R</a></li>
<li class="chapter" data-level="18.2.6" data-path="survival-analysis.html"><a href="survival-analysis.html#package-survfit-in-r"><i class="fa fa-check"></i><b>18.2.6</b> Package survfit in R</a></li>
<li class="chapter" data-level="18.2.7" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-r"><i class="fa fa-check"></i><b>18.2.7</b> KM Survival Plots in R</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="survival-analysis.html"><a href="survival-analysis.html#compare-the-survival-function"><i class="fa fa-check"></i><b>18.3</b> Compare the survival function</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="survival-analysis.html"><a href="survival-analysis.html#tests-of-equality-of-the-survival-function"><i class="fa fa-check"></i><b>18.3.1</b> Tests of equality of the survival function</a></li>
<li class="chapter" data-level="18.3.2" data-path="survival-analysis.html"><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement"><i class="fa fa-check"></i><b>18.3.2</b> Other nonparametric tests for STRATA statement</a></li>
<li class="chapter" data-level="18.3.3" data-path="survival-analysis.html"><a href="survival-analysis.html#multiple-comparisons"><i class="fa fa-check"></i><b>18.3.3</b> Multiple comparisons</a></li>
<li class="chapter" data-level="18.3.4" data-path="survival-analysis.html"><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr"><i class="fa fa-check"></i><b>18.3.4</b> Comparing survival functions using Log-Rank HR</a></li>
<li class="chapter" data-level="18.3.5" data-path="survival-analysis.html"><a href="survival-analysis.html#mantel-haenszel-hr"><i class="fa fa-check"></i><b>18.3.5</b> Mantel-Haenszel HR</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="survival-analysis.html"><a href="survival-analysis.html#accelerated-failure-time-aft-model"><i class="fa fa-check"></i><b>18.4</b> Accelerated failure time (AFT) model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-13"><i class="fa fa-check"></i><b>18.4.1</b> Introduction</a></li>
<li class="chapter" data-level="18.4.2" data-path="survival-analysis.html"><a href="survival-analysis.html#proc-lifereg"><i class="fa fa-check"></i><b>18.4.2</b> PROC LIFEREG</a></li>
<li class="chapter" data-level="18.4.3" data-path="survival-analysis.html"><a href="survival-analysis.html#residuum-distribution"><i class="fa fa-check"></i><b>18.4.3</b> Residuum distribution</a></li>
<li class="chapter" data-level="18.4.4" data-path="survival-analysis.html"><a href="survival-analysis.html#exponential-model"><i class="fa fa-check"></i><b>18.4.4</b> Exponential Model</a></li>
<li class="chapter" data-level="18.4.5" data-path="survival-analysis.html"><a href="survival-analysis.html#weibull-model"><i class="fa fa-check"></i><b>18.4.5</b> Weibull Model</a></li>
<li class="chapter" data-level="18.4.6" data-path="survival-analysis.html"><a href="survival-analysis.html#log-normal-model"><i class="fa fa-check"></i><b>18.4.6</b> Log-Normal Model</a></li>
<li class="chapter" data-level="18.4.7" data-path="survival-analysis.html"><a href="survival-analysis.html#log-logistic-model"><i class="fa fa-check"></i><b>18.4.7</b> Log-Logistic Model</a></li>
<li class="chapter" data-level="18.4.8" data-path="survival-analysis.html"><a href="survival-analysis.html#fit-statistics-for-model-comparsion"><i class="fa fa-check"></i><b>18.4.8</b> Fit statistics for model comparsion</a></li>
<li class="chapter" data-level="18.4.9" data-path="survival-analysis.html"><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas"><i class="fa fa-check"></i><b>18.4.9</b> Graphical method for distinguishing different distributions in SAS</a></li>
<li class="chapter" data-level="18.4.10" data-path="survival-analysis.html"><a href="survival-analysis.html#prediction-and-hazard-function"><i class="fa fa-check"></i><b>18.4.10</b> Prediction and hazard function</a></li>
<li class="chapter" data-level="18.4.11" data-path="survival-analysis.html"><a href="survival-analysis.html#left-censoring-and-interval-censoring"><i class="fa fa-check"></i><b>18.4.11</b> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>18.5</b> Cox Proportional Hazards Model</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-14"><i class="fa fa-check"></i><b>18.5.1</b> Introduction</a></li>
<li class="chapter" data-level="18.5.2" data-path="survival-analysis.html"><a href="survival-analysis.html#parameter-estimate"><i class="fa fa-check"></i><b>18.5.2</b> Parameter estimate</a></li>
<li class="chapter" data-level="18.5.3" data-path="survival-analysis.html"><a href="survival-analysis.html#parameter-test"><i class="fa fa-check"></i><b>18.5.3</b> Parameter test</a></li>
<li class="chapter" data-level="18.5.4" data-path="survival-analysis.html"><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas"><i class="fa fa-check"></i><b>18.5.4</b> Graphs of the survival and baseline hazard function in SAS</a></li>
<li class="chapter" data-level="18.5.5" data-path="survival-analysis.html"><a href="survival-analysis.html#check-proportional-hazards"><i class="fa fa-check"></i><b>18.5.5</b> Check proportional hazards</a></li>
<li class="chapter" data-level="18.5.6" data-path="survival-analysis.html"><a href="survival-analysis.html#dealing-with-nonproportionality"><i class="fa fa-check"></i><b>18.5.6</b> Dealing with nonproportionality</a></li>
<li class="chapter" data-level="18.5.7" data-path="survival-analysis.html"><a href="survival-analysis.html#model-diagnostics-1"><i class="fa fa-check"></i><b>18.5.7</b> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html"><i class="fa fa-check"></i><b>19</b> Advanced Survival Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#tied-or-discrete-data"><i class="fa fa-check"></i><b>19.1</b> Tied or Discrete Data</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#introduction-of-tie"><i class="fa fa-check"></i><b>19.1.1</b> Introduction of Tie</a></li>
<li class="chapter" data-level="19.1.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#discrete-cox-regression"><i class="fa fa-check"></i><b>19.1.2</b> Discrete Cox Regression</a></li>
<li class="chapter" data-level="19.1.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#logit-model-for-discrete-time"><i class="fa fa-check"></i><b>19.1.3</b> Logit model for Discrete time</a></li>
<li class="chapter" data-level="19.1.4" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#complementary-log-log-model-for-continuous-time-process"><i class="fa fa-check"></i><b>19.1.4</b> Complementary log-log model for continuous time process</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#time-dependent-covariates"><i class="fa fa-check"></i><b>19.2</b> Time-dependent covariates</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#introduction-15"><i class="fa fa-check"></i><b>19.2.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#programming-method"><i class="fa fa-check"></i><b>19.2.2</b> Programming method</a></li>
<li class="chapter" data-level="19.2.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#counting-method"><i class="fa fa-check"></i><b>19.2.3</b> Counting method</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#additive-hazards-regression-model"><i class="fa fa-check"></i><b>19.3</b> Additive Hazards Regression Model</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#preview"><i class="fa fa-check"></i><b>19.3.1</b> Preview</a></li>
<li class="chapter" data-level="19.3.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model"><i class="fa fa-check"></i><b>19.3.2</b> Lin and Ying’s additive hazards model</a></li>
<li class="chapter" data-level="19.3.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#aalens-additive-hazards-model"><i class="fa fa-check"></i><b>19.3.3</b> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#competing-risk"><i class="fa fa-check"></i><b>19.4</b> Competing Risk</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#introduction-16"><i class="fa fa-check"></i><b>19.4.1</b> Introduction</a></li>
<li class="chapter" data-level="19.4.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#type-specific-hazards"><i class="fa fa-check"></i><b>19.4.2</b> Type-specific hazards</a></li>
<li class="chapter" data-level="19.4.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model"><i class="fa fa-check"></i><b>19.4.3</b> Covariate effects via COX model</a></li>
<li class="chapter" data-level="19.4.4" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif"><i class="fa fa-check"></i><b>19.4.4</b> Cumulative incidence function (CIF)</a></li>
<li class="chapter" data-level="19.4.5" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#subdistribution-hazard-function"><i class="fa fa-check"></i><b>19.4.5</b> Subdistribution hazard function</a></li>
<li class="chapter" data-level="19.4.6" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#cause-specific-hazard-function"><i class="fa fa-check"></i><b>19.4.6</b> Cause-specific hazard function</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#clustered-events"><i class="fa fa-check"></i><b>19.5</b> Clustered Events</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#introduction-19"><i class="fa fa-check"></i><b>19.5.1</b> Introduction</a></li>
<li class="chapter" data-level="19.5.2" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal"><i class="fa fa-check"></i><b>19.5.2</b> Proportional hazards model which adopts a marginal</a></li>
<li class="chapter" data-level="19.5.3" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html#frailty-model"><i class="fa fa-check"></i><b>19.5.3</b> Frailty model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="count-data-regression.html"><a href="count-data-regression.html"><i class="fa fa-check"></i><b>20</b> Count Data Regression</a>
<ul>
<li class="chapter" data-level="20.1" data-path="count-data-regression.html"><a href="count-data-regression.html#introduction-of-count-data-regression"><i class="fa fa-check"></i><b>20.1</b> Introduction of Count Data Regression</a></li>
<li class="chapter" data-level="20.2" data-path="count-data-regression.html"><a href="count-data-regression.html#poisson-regression"><i class="fa fa-check"></i><b>20.2</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model"><i class="fa fa-check"></i><b>20.2.1</b> Model</a></li>
<li class="chapter" data-level="20.2.2" data-path="count-data-regression.html"><a href="count-data-regression.html#interpretation-of-estimated-coefficients"><i class="fa fa-check"></i><b>20.2.2</b> Interpretation of Estimated Coefficients</a></li>
<li class="chapter" data-level="20.2.3" data-path="count-data-regression.html"><a href="count-data-regression.html#overdispersion-1"><i class="fa fa-check"></i><b>20.2.3</b> Overdispersion</a></li>
<li class="chapter" data-level="20.2.4" data-path="count-data-regression.html"><a href="count-data-regression.html#adjustment-for-varying-time-spans"><i class="fa fa-check"></i><b>20.2.4</b> Adjustment for Varying Time Spans</a></li>
<li class="chapter" data-level="20.2.5" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-using-proc-genmod"><i class="fa fa-check"></i><b>20.2.5</b> SAS implementation using PROC GENMOD</a></li>
<li class="chapter" data-level="20.2.6" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-12"><i class="fa fa-check"></i><b>20.2.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="count-data-regression.html"><a href="count-data-regression.html#negative-binomial-regression"><i class="fa fa-check"></i><b>20.3</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-1"><i class="fa fa-check"></i><b>20.3.1</b> Model</a></li>
<li class="chapter" data-level="20.3.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-11"><i class="fa fa-check"></i><b>20.3.2</b> SAS implementation</a></li>
<li class="chapter" data-level="20.3.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-13"><i class="fa fa-check"></i><b>20.3.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-truncated-poisson-regression-model"><i class="fa fa-check"></i><b>20.4</b> Zero-truncated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-2"><i class="fa fa-check"></i><b>20.4.1</b> Model</a></li>
<li class="chapter" data-level="20.4.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-12"><i class="fa fa-check"></i><b>20.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="20.4.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-14"><i class="fa fa-check"></i><b>20.4.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-insflated-model"><i class="fa fa-check"></i><b>20.5</b> Zero-Insflated Model</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-3"><i class="fa fa-check"></i><b>20.5.1</b> Model</a></li>
<li class="chapter" data-level="20.5.2" data-path="count-data-regression.html"><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1"><i class="fa fa-check"></i><b>20.5.2</b> Interpretation of Estimated Coefficients</a></li>
<li class="chapter" data-level="20.5.3" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-13"><i class="fa fa-check"></i><b>20.5.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="20.5.4" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-15"><i class="fa fa-check"></i><b>20.5.4</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="count-data-regression.html"><a href="count-data-regression.html#hurdle-models"><i class="fa fa-check"></i><b>20.6</b> Hurdle models</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="count-data-regression.html"><a href="count-data-regression.html#model-4"><i class="fa fa-check"></i><b>20.6.1</b> Model</a></li>
<li class="chapter" data-level="20.6.2" data-path="count-data-regression.html"><a href="count-data-regression.html#sas-implementation-14"><i class="fa fa-check"></i><b>20.6.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="20.6.3" data-path="count-data-regression.html"><a href="count-data-regression.html#r-implementation-16"><i class="fa fa-check"></i><b>20.6.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html"><i class="fa fa-check"></i><b>21</b> Proportion Response Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#beta-regression"><i class="fa fa-check"></i><b>21.1</b> Beta Regression</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#model-5"><i class="fa fa-check"></i><b>21.1.1</b> Model</a></li>
<li class="chapter" data-level="21.1.2" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#sas-implementation-15"><i class="fa fa-check"></i><b>21.1.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="21.1.3" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#r-implementation-betareg"><i class="fa fa-check"></i><b>21.1.3</b> R Implementation “betareg”</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#zero-inflated-beta-regression"><i class="fa fa-check"></i><b>21.2</b> Zero-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.3" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.3</b> One-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.4" data-path="proportion-response-regression.html"><a href="proportion-response-regression.html#zero-one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.4</b> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mixed-model.html"><a href="mixed-model.html"><i class="fa fa-check"></i><b>22</b> Mixed Model</a>
<ul>
<li class="chapter" data-level="22.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-20"><i class="fa fa-check"></i><b>22.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="mixed-model.html"><a href="mixed-model.html#correlated-response-data"><i class="fa fa-check"></i><b>22.1.1</b> Correlated response data</a></li>
<li class="chapter" data-level="22.1.2" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-and-marginal-model"><i class="fa fa-check"></i><b>22.1.2</b> Hierarchical and Marginal model</a></li>
<li class="chapter" data-level="22.1.3" data-path="mixed-model.html"><a href="mixed-model.html#mle-in-marginal-model"><i class="fa fa-check"></i><b>22.1.3</b> MLE in Marginal model</a></li>
<li class="chapter" data-level="22.1.4" data-path="mixed-model.html"><a href="mixed-model.html#reml-in-marginal-model"><i class="fa fa-check"></i><b>22.1.4</b> REML in Marginal model</a></li>
<li class="chapter" data-level="22.1.5" data-path="mixed-model.html"><a href="mixed-model.html#variance-correction"><i class="fa fa-check"></i><b>22.1.5</b> Variance correction</a></li>
<li class="chapter" data-level="22.1.6" data-path="mixed-model.html"><a href="mixed-model.html#hypothesis-tests"><i class="fa fa-check"></i><b>22.1.6</b> Hypothesis tests</a></li>
<li class="chapter" data-level="22.1.7" data-path="mixed-model.html"><a href="mixed-model.html#residual-structure"><i class="fa fa-check"></i><b>22.1.7</b> Residual Structure</a></li>
<li class="chapter" data-level="22.1.8" data-path="mixed-model.html"><a href="mixed-model.html#converge-problems"><i class="fa fa-check"></i><b>22.1.8</b> Converge problems</a></li>
<li class="chapter" data-level="22.1.9" data-path="mixed-model.html"><a href="mixed-model.html#preface-of-linear-mixed-model"><i class="fa fa-check"></i><b>22.1.9</b> Preface of linear mixed model</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model"><i class="fa fa-check"></i><b>22.2</b> Random Slope and Intercept Model</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction"><i class="fa fa-check"></i><b>22.2.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.2.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-16"><i class="fa fa-check"></i><b>22.2.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.2.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-17"><i class="fa fa-check"></i><b>22.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model-with-covariance-structure"><i class="fa fa-check"></i><b>22.3</b> Random Slope and Intercept Model with Covariance Structure</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction-1"><i class="fa fa-check"></i><b>22.3.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.3.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-17"><i class="fa fa-check"></i><b>22.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.3.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-18"><i class="fa fa-check"></i><b>22.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="mixed-model.html"><a href="mixed-model.html#generalized-estimating-equation"><i class="fa fa-check"></i><b>22.4</b> Generalized Estimating Equation</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-of-gee"><i class="fa fa-check"></i><b>22.4.1</b> Introduction of GEE</a></li>
<li class="chapter" data-level="22.4.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-18"><i class="fa fa-check"></i><b>22.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.4.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-19"><i class="fa fa-check"></i><b>22.4.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-regression-model-for-normal-response"><i class="fa fa-check"></i><b>22.5</b> Hierarchical Regression Model for Normal Response</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-21"><i class="fa fa-check"></i><b>22.5.1</b> Introduction</a></li>
<li class="chapter" data-level="22.5.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-19"><i class="fa fa-check"></i><b>22.5.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.5.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-20"><i class="fa fa-check"></i><b>22.5.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html"><i class="fa fa-check"></i><b>23</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="23.1" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html#generalized-linear-mixed-model"><i class="fa fa-check"></i><b>23.1</b> Generalized Linear (Mixed) Model</a></li>
<li class="chapter" data-level="23.2" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html#generalized-linear-model"><i class="fa fa-check"></i><b>23.2</b> Generalized Linear Model</a></li>
<li class="chapter" data-level="23.3" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html#generalized-additive-models-1"><i class="fa fa-check"></i><b>23.3</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html#concept"><i class="fa fa-check"></i><b>23.3.1</b> Concept</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>24</b> Meta Analysis</a>
<ul>
<li class="chapter" data-level="24.1" data-path="meta-analysis.html"><a href="meta-analysis.html#introduction-22"><i class="fa fa-check"></i><b>24.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-for-different-data"><i class="fa fa-check"></i><b>24.1.1</b> meta-analysis for different data</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes"><i class="fa fa-check"></i><b>24.2</b> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="meta-analysis.html"><a href="meta-analysis.html#effect-measures"><i class="fa fa-check"></i><b>24.2.1</b> Effect Measures</a></li>
<li class="chapter" data-level="24.2.2" data-path="meta-analysis.html"><a href="meta-analysis.html#standardized-mean-difference"><i class="fa fa-check"></i><b>24.2.2</b> Standardized Mean Difference</a></li>
<li class="chapter" data-level="24.2.3" data-path="meta-analysis.html"><a href="meta-analysis.html#inverse-variance-weighted-average-method"><i class="fa fa-check"></i><b>24.2.3</b> Inverse variance-weighted average method</a></li>
<li class="chapter" data-level="24.2.4" data-path="meta-analysis.html"><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen"><i class="fa fa-check"></i><b>24.2.4</b> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li class="chapter" data-level="24.2.5" data-path="meta-analysis.html"><a href="meta-analysis.html#weighted-sum-of-z-scores"><i class="fa fa-check"></i><b>24.2.5</b> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="meta-analysis.html"><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes"><i class="fa fa-check"></i><b>24.3</b> Random Effects Model for Continuous Outcomes</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="meta-analysis.html"><a href="meta-analysis.html#introduction-23"><i class="fa fa-check"></i><b>24.3.1</b> Introduction</a></li>
<li class="chapter" data-level="24.3.2" data-path="meta-analysis.html"><a href="meta-analysis.html#implementation"><i class="fa fa-check"></i><b>24.3.2</b> Implementation</a></li>
<li class="chapter" data-level="24.3.3" data-path="meta-analysis.html"><a href="meta-analysis.html#hartung-knapp-adjustment"><i class="fa fa-check"></i><b>24.3.3</b> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-regression"><i class="fa fa-check"></i><b>24.4</b> Meta-Regression</a></li>
<li class="chapter" data-level="24.5" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-with-binary-outcomes"><i class="fa fa-check"></i><b>24.5</b> Meta-Analysis with Binary Outcomes</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="meta-analysis.html"><a href="meta-analysis.html#effect-measures-1"><i class="fa fa-check"></i><b>24.5.1</b> Effect Measures</a></li>
<li class="chapter" data-level="24.5.2" data-path="meta-analysis.html"><a href="meta-analysis.html#implementation-1"><i class="fa fa-check"></i><b>24.5.2</b> Implementation</a></li>
<li class="chapter" data-level="24.5.3" data-path="meta-analysis.html"><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction"><i class="fa fa-check"></i><b>24.5.3</b> Estimation in Sparse Data - Continuity correction</a></li>
<li class="chapter" data-level="24.5.4" data-path="meta-analysis.html"><a href="meta-analysis.html#peto-odds-ratio"><i class="fa fa-check"></i><b>24.5.4</b> Peto Odds Ratio</a></li>
<li class="chapter" data-level="24.5.5" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method"><i class="fa fa-check"></i><b>24.5.5</b> Fixed Effect Model: Inverse Variance Method</a></li>
<li class="chapter" data-level="24.5.6" data-path="meta-analysis.html"><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method"><i class="fa fa-check"></i><b>24.5.6</b> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li class="chapter" data-level="24.5.7" data-path="meta-analysis.html"><a href="meta-analysis.html#random-effects-model"><i class="fa fa-check"></i><b>24.5.7</b> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html"><i class="fa fa-check"></i><b>25</b> Group (Adaptive) Sequential Design</a>
<ul>
<li class="chapter" data-level="25.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#classical-designs-without-futility-stopping"><i class="fa fa-check"></i><b>25.1</b> Classical Designs without futility stopping</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#pocock-method"><i class="fa fa-check"></i><b>25.1.1</b> Pocock Method</a></li>
<li class="chapter" data-level="25.1.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#obrien-fleming-method"><i class="fa fa-check"></i><b>25.1.2</b> O’Brien &amp; Fleming Method</a></li>
<li class="chapter" data-level="25.1.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#wang-tsiatis-method"><i class="fa fa-check"></i><b>25.1.3</b> Wang &amp; Tsiatis Method</a></li>
<li class="chapter" data-level="25.1.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#rejection-bounds-and-local-p-values"><i class="fa fa-check"></i><b>25.1.4</b> Rejection bounds and Local p-values</a></li>
<li class="chapter" data-level="25.1.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#power-and-sample-size"><i class="fa fa-check"></i><b>25.1.5</b> Power and Sample size</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#classical-designs-with-binding-futility-stopping"><i class="fa fa-check"></i><b>25.2</b> Classical Designs with binding futility stopping</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#symmetric-designs"><i class="fa fa-check"></i><b>25.2.1</b> Symmetric designs</a></li>
<li class="chapter" data-level="25.2.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#one-sided-designs"><i class="fa fa-check"></i><b>25.2.2</b> One-Sided Designs</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#alpha-spending-function-approach"><i class="fa fa-check"></i><b>25.3</b> Alpha Spending Function Approach</a></li>
<li class="chapter" data-level="25.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#r-implementation-using-rpact"><i class="fa fa-check"></i><b>25.4</b> R Implementation using rpact</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#basic-functions"><i class="fa fa-check"></i><b>25.4.1</b> Basic Functions</a></li>
<li class="chapter" data-level="25.4.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries"><i class="fa fa-check"></i><b>25.4.2</b> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#sample-size"><i class="fa fa-check"></i><b>25.5</b> Sample Size</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia"><i class="fa fa-check"></i><b>25.5.1</b> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li class="chapter" data-level="25.5.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#two-groups-continuous-endpoint-without-ia"><i class="fa fa-check"></i><b>25.5.2</b> Two groups continuous endpoint (without IA)</a></li>
<li class="chapter" data-level="25.5.3" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#two-groups-binary-endpoint-without-ia"><i class="fa fa-check"></i><b>25.5.3</b> Two groups binary endpoint (without IA)</a></li>
<li class="chapter" data-level="25.5.4" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#group-sequential-designs-for-conti-and-binary"><i class="fa fa-check"></i><b>25.5.4</b> Group-sequential designs for conti and binary</a></li>
<li class="chapter" data-level="25.5.5" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#survival-endpoint"><i class="fa fa-check"></i><b>25.5.5</b> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="adaptive-designs.html"><a href="adaptive-designs.html"><i class="fa fa-check"></i><b>26</b> Adaptive designs</a>
<ul>
<li class="chapter" data-level="26.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#introduction-24"><i class="fa fa-check"></i><b>26.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#early-termination-due-to-futility"><i class="fa fa-check"></i><b>26.1.1</b> Early termination due to futility</a></li>
<li class="chapter" data-level="26.1.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#early-termination-due-to-efficacy"><i class="fa fa-check"></i><b>26.1.2</b> Early termination due to efficacy</a></li>
<li class="chapter" data-level="26.1.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#sample-size-reassessment"><i class="fa fa-check"></i><b>26.1.3</b> Sample size reassessment</a></li>
<li class="chapter" data-level="26.1.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint"><i class="fa fa-check"></i><b>26.1.4</b> Change or modification of the primary endpoint</a></li>
<li class="chapter" data-level="26.1.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#discontinuing-treatment-arms"><i class="fa fa-check"></i><b>26.1.5</b> Discontinuing treatment arms</a></li>
<li class="chapter" data-level="26.1.6" data-path="adaptive-designs.html"><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority"><i class="fa fa-check"></i><b>26.1.6</b> Switching between superiority and non-inferiority</a></li>
<li class="chapter" data-level="26.1.7" data-path="adaptive-designs.html"><a href="adaptive-designs.html#selection-of-the-patient-population"><i class="fa fa-check"></i><b>26.1.7</b> Selection of the patient population</a></li>
<li class="chapter" data-level="26.1.8" data-path="adaptive-designs.html"><a href="adaptive-designs.html#methods"><i class="fa fa-check"></i><b>26.1.8</b> Methods</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#general-theory"><i class="fa fa-check"></i><b>26.2</b> General Theory</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#stopping-boundary"><i class="fa fa-check"></i><b>26.2.1</b> Stopping Boundary</a></li>
<li class="chapter" data-level="26.2.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#power-and-adjusted-p-value"><i class="fa fa-check"></i><b>26.2.2</b> Power and Adjusted p-value</a></li>
<li class="chapter" data-level="26.2.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#stopping-probabilities-design-evaluation"><i class="fa fa-check"></i><b>26.2.3</b> Stopping Probabilities (Design Evaluation)</a></li>
<li class="chapter" data-level="26.2.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation"><i class="fa fa-check"></i><b>26.2.4</b> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li class="chapter" data-level="26.2.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation"><i class="fa fa-check"></i><b>26.2.5</b> Expected Sample Sizes (Design Evaluation)</a></li>
<li class="chapter" data-level="26.2.6" data-path="adaptive-designs.html"><a href="adaptive-designs.html#conditional-power-and-futility-index"><i class="fa fa-check"></i><b>26.2.6</b> Conditional Power and futility index</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-with-direct-combination-of-p-values"><i class="fa fa-check"></i><b>26.3</b> Method with Direct Combination of p-values</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-based-on-individual-p-values"><i class="fa fa-check"></i><b>26.3.1</b> Method Based on Individual p-values</a></li>
<li class="chapter" data-level="26.3.2" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values"><i class="fa fa-check"></i><b>26.3.2</b> Method Based on the Sum of p-values</a></li>
<li class="chapter" data-level="26.3.3" data-path="adaptive-designs.html"><a href="adaptive-designs.html#method-with-product-of-p-values"><i class="fa fa-check"></i><b>26.3.3</b> Method with Product of p-values</a></li>
<li class="chapter" data-level="26.3.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#fishers-product-test-combination-tests"><i class="fa fa-check"></i><b>26.3.4</b> Fisher’s product test (Combination Tests)</a></li>
<li class="chapter" data-level="26.3.5" data-path="adaptive-designs.html"><a href="adaptive-designs.html#fishers-product-test-with-early-rej.-and-acceptance"><i class="fa fa-check"></i><b>26.3.5</b> Fisher’s product test with early rej. and acceptance</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="adaptive-designs.html"><a href="adaptive-designs.html#inverse-normal-combination-function"><i class="fa fa-check"></i><b>26.4</b> Inverse normal combination function</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="propensity-score.html"><a href="propensity-score.html"><i class="fa fa-check"></i><b>27</b> Propensity Score</a>
<ul>
<li class="chapter" data-level="27.1" data-path="propensity-score.html"><a href="propensity-score.html#ate-att"><i class="fa fa-check"></i><b>27.1</b> ATE &amp; ATT</a></li>
<li class="chapter" data-level="27.2" data-path="propensity-score.html"><a href="propensity-score.html#propensity-score-matching"><i class="fa fa-check"></i><b>27.2</b> Propensity Score Matching</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>28</b> Missing Data</a>
<ul>
<li class="chapter" data-level="28.1" data-path="missing-data.html"><a href="missing-data.html#missing-mechanisms"><i class="fa fa-check"></i><b>28.1</b> Missing mechanisms</a></li>
<li class="chapter" data-level="28.2" data-path="missing-data.html"><a href="missing-data.html#compatibility-and-congeniality"><i class="fa fa-check"></i><b>28.2</b> Compatibility and Congeniality</a></li>
<li class="chapter" data-level="28.3" data-path="missing-data.html"><a href="missing-data.html#single-imputation"><i class="fa fa-check"></i><b>28.3</b> Single imputation</a></li>
<li class="chapter" data-level="28.4" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>28.4</b> Multiple imputation</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="missing-data.html"><a href="missing-data.html#joint-modeling-jm"><i class="fa fa-check"></i><b>28.4.1</b> Joint Modeling (JM)</a></li>
<li class="chapter" data-level="28.4.2" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice"><i class="fa fa-check"></i><b>28.4.2</b> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="missing-data.html"><a href="missing-data.html#bayesian-linear-regression"><i class="fa fa-check"></i><b>28.5</b> Bayesian linear regression</a></li>
<li class="chapter" data-level="28.6" data-path="missing-data.html"><a href="missing-data.html#predictive-mean-matching"><i class="fa fa-check"></i><b>28.6</b> Predictive Mean Matching</a></li>
<li class="chapter" data-level="28.7" data-path="missing-data.html"><a href="missing-data.html#mice-using-random-forest"><i class="fa fa-check"></i><b>28.7</b> MICE using random forest</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-survival-analysis" class="section level1" number="19">
<h1><span class="header-section-number">Chapter 19</span> Advanced Survival Analysis</h1>
<div id="tied-or-discrete-data" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Tied or Discrete Data</h2>
<div id="introduction-of-tie" class="section level3" number="19.1.1">
<h3><span class="header-section-number">19.1.1</span> Introduction of Tie</h3>
<p>In the process of model derivation, we assumed that there would be only one death observation at each point <span class="math inline">\(t_j\)</span>. If there are more than two observations, we call it the “Tie,” we have the following three tricky solutions</p>
<ol style="list-style-type: decimal">
<li>Average partial likelihood</li>
<li>Breslow</li>
<li>Efron</li>
</ol>
<p><strong>Average partial likelihood</strong></p>
<p>Since two individuals observe death at the same time at a certain time, we might as well use the average value as their contribution to likelihood!</p>
<p><span class="math display">\[\quad L_{j}(\beta)=\frac{1}{2} \frac{w_{2}}{\sum_{2,3,4} w_{j}} \frac{w_{3}}{\sum_{2,4} w_{j}}+\frac{1}{2} \frac{w_{3}}{\sum_{2,3,4} w_{j}} \frac{w_{2}}{\sum_{3,4} w_{j}}\]</span></p>
<ul>
<li>Advantages: the idea is simple and the most intuitive</li>
<li>Disadvantages: difficult to calculate</li>
</ul>
<p><strong>Breslow</strong></p>
<p>Idea: Use the above average partial likelihood approximation,</p>
<p><span class="math display">\[\quad \sum_{2,3,4} w_{j} \sum_{3,4} w_{j} \approx \sum_{2,3,4} w_{j} \sum_{2,4} w_{j} \approx\left(\sum_{2,3,4} w_{j}\right)^{2}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i}^{T} \beta\right)}{\prod_{r=0}^{d_{j}-1}\left(\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)-r \bar{w}\right)}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i} \beta\right)}{\left[\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)\right]^{d_{j}}}, \quad L_{j}(\beta)=\frac{\exp \left(\sum_{i \in D_{j}} x_{i} \beta\right)}{\left[\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)\right]^{d_{j}}}\]</span></p>
<ul>
<li>Advantages: simple calculation, similar to partial likelihood, easy to solve</li>
<li>Disadvantages: more deviation from the average partial likelihood</li>
</ul>
<p><strong>Efron</strong></p>
<p>Idea: Approximate between the above
<span class="math display">\[\sum_{2,3,4} w_{j} \sum_{3,4} w_{j} \approx \sum_{2,3,4} w_{j} \sum_{2,4} w_{j} \approx\left(\sum_{2,3,4} w_{j}-\bar{w}\right)^{2}\]</span>
<span class="math display">\[\quad L(\beta)=\prod_{j} \frac{\exp \left(\sum_{i \in D_{j}} x_{i}^{T} \beta\right)}{\prod_{r=0}^{d_{j}-1}\left(\sum_{k \in R_{j}} \exp \left(x_{k}^{T} \beta\right)-r \bar{w}\right)}\]</span></p>
<pre><code>PROC PHREG DATA=recid;
   MODEL week*arrest(0)=fin age race wexp mar paro prio / TIES=EFRON;
RUN; </code></pre>
</div>
<div id="discrete-cox-regression" class="section level3" number="19.1.2">
<h3><span class="header-section-number">19.1.2</span> Discrete Cox Regression</h3>
<p><strong>Modeling</strong></p>
<p><span class="math display">\[\quad \frac{\lambda_{i j}}{1-\lambda_{i j}}=\frac{\lambda_{0 j}}{1-\lambda_{0 j}} \exp \left(x_{i}^{T} \beta\right), \]</span>
Some forms of <span class="math inline">\(\lambda_{0 j}\)</span> can be omitted (using Cox partial likelihood method). This can be considered as an approximation of Cox Regression in discreteness. This form is actually caused by <span class="math inline">\(\lambda_{i j} \in(0,1)\)</span>, which can be considered as a probability in the discrete case.</p>
<p><strong>PROC PHREG</strong></p>
<p>PROC PHREG uses the <strong>Breslow approximation</strong> as the default value, but it also provides a better approximation proposed by Efron (1977) and two precise methods. These are specified in PROC PHREG by <strong>TIES = EXACT</strong> or <strong>TIES = DISCRETE</strong> as options in the MODEL statement. The difference is that</p>
<ul>
<li>The EXACT method assumes that the <strong>time sequence</strong> of related events is correct (but the time is unknown) (that is, the <strong>time is continuous</strong>)
<ul>
<li>Farewell and Prentice (1980) pointed out that as the number of contacts at a particular point in time becomes a <strong>large proportion of the number of cases at risk</strong>, the Breslow approximation will become worse.</li>
<li>EXACT may be more reasonable for most applications. Since the event may occur at any point in time, it is reasonable to assume that the connection is only the result of an inaccurate measurement of time, and there is a real but unknown time sequence. We can construct partiality (likelihood) in the usual way. However, without knowing the order, we must consider all possibilities.</li>
</ul></li>
<li>The DISCRETE method assumes that events do <strong>occur at the same time</strong>.
<ul>
<li>In fact, DISCRETE is not a proportional hazard model at all. However, this model does fall within the Cox regression framework. The DISCRETE model assumes that time is actually discrete, which is different from the EXACT model. When two or more events seem to happen at the same time, there is no underlying sequence-they actually happen at the same time</li>
</ul></li>
</ul>
</div>
<div id="logit-model-for-discrete-time" class="section level3" number="19.1.3">
<h3><span class="header-section-number">19.1.3</span> Logit model for Discrete time</h3>
<p>Cox’s discrete model can be described as follows. The time variable t can only take integer values. Assume that <span class="math inline">\(P_{it}\)</span> is the conditional probability of an event occurring in an individual at time <span class="math inline">\(t\)</span>, and assume that an event has not occurred in this individual. This possibility is sometimes called a discrete-time hazard. The model shows that <span class="math inline">\(P_{it}\)</span> is related to the covariate through a logarithmic regression equation
<span class="math display">\[
\log \left(\frac{P_{it}}{1-P_{it}}\right)=\alpha_{t}+\beta_{1} x_{i 1}+\ldots+\beta_{k} x_ {ik}
\]</span></p>
<pre><code>DATA jobyrs;
 SET jobdur;
 DO year=1 TO dur;
 IF year=dur AND event=1 THEN quit=1;
 ELSE quit=0;
 OUTPUT;
 END;
RUN; 

PROC LOGISTIC DATA=jobyrs;
 CLASS year / PARAM=GLM;
 MODEL quit(DESC)=ed prestige salary year;
RUN; </code></pre>
</div>
<div id="complementary-log-log-model-for-continuous-time-process" class="section level3" number="19.1.4">
<h3><span class="header-section-number">19.1.4</span> Complementary log-log model for continuous time process</h3>
<p>The logarithmic model assumes that events can only occur at discrete points in time. However, for most applications, the connection is because the event time is roughly measured, even though the event can actually occur at any point in time. The logit model lacks the invariance of the length of the time interval.
<span class="math display">\[\log \left[-\log \left(1-P_{i t}\right)\right]=\alpha_{t}+\beta_{1} x_{i t 1}+\ldots+\beta_{k} x_{i t k}\]</span></p>
<pre><code>DATA jobyrs;
 SET jobdur;
 DO year=1 TO dur;
 IF year=dur AND event=1 THEN quit=1;
 ELSE quit=0;
 OUTPUT;
 END;
RUN; 

PROC LOGISTIC DATA=jobyrs;
 CLASS year / PARAM=GLM;
 MODEL quit(DESC)=ed prestige salary year/ LINK=CLOGLOG;
RUN; </code></pre>
</div>
</div>
<div id="time-dependent-covariates" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> Time-dependent covariates</h2>
<div id="introduction-15" class="section level3" number="19.2.1">
<h3><span class="header-section-number">19.2.1</span> Introduction</h3>
<p>For a model with one time-invariant covariate and one time-dependent covariate, we have
<span class="math display">\[\log h_{i}(t)=\alpha(t)+\beta_{1} x_{i 1}+\beta_{2} x_{i 2}(t)\]</span></p>
<p>In order to deal with time-related covariates, PROC PHREG has two very different ways to set up data and specify models. If done correctly, these two methods will produce exactly the same results</p>
<ol style="list-style-type: decimal">
<li><strong>programming statements method</strong>: There is only one record per person, and information about time-related covariates is contained in multiple variables in that record. Then, define the time-related covariates in the programming statement as part of the PROC PHREG step.</li>
<li><strong>counting process method</strong>: Each person may have multiple records, and each record corresponds to the time interval at which all covariates remain constant. Once this special data set is constructed, the time-related covariates are treated the same as the time-invariant covariates.</li>
</ol>
<p>Including time-related covariates in the Cox model, generating time-related covariates by creating a function of the <strong>interaction of the predictor variables and survival time</strong>, and including them in the model. If any time-related covariates are important, these predictors are not proportional.</p>
<pre><code>proc phreg data=uis;
  model time*censor(0) = age race treat site agesite aget racet treatt sitet;
  aget = age*log(time);
  racet = race*log(time);
  treatt = treat*log(time);
  sitet = site*log(time);
  proportionality_test: test aget, racet, treat, sitet;
run;</code></pre>
</div>
<div id="programming-method" class="section level3" number="19.2.2">
<h3><span class="header-section-number">19.2.2</span> Programming method</h3>
<pre><code>*** If the patient has been transplanted on day t, define the time-related covariate; 
*** PLANT to be equal to 1, and it can be processed correctly; otherwise, PLANT is equal to 0;

PROC PHREG DATA=stan;
  MODEL surv1*dead(0)=plant surg ageaccpt / TIES=EFRON;
  IF wait&gt;=surv1 OR wait=. THEN plant=0; ELSE plant=1;
RUN;

*** sometimes including time-related covariates;

PROC PHREG DATA=stan;
  MODEL surv1*dead(0)=plant surg logage / TIES=EFRON;
  IF wait&gt;surv1 OR wait=. THEN plant=0; ELSE plant=1;
  logage=LOG(ageaccpt+surv1);
RUN;</code></pre>
</div>
<div id="counting-method" class="section level3" number="19.2.3">
<h3><span class="header-section-number">19.2.3</span> Counting method</h3>
<p>Construct a data set that contains multiple records per person. For those who have not received the transplant, only one record is required. The transplant recipient needs two records: one records the time interval between acceptance and transplantation (PLANT = 0), and the other records the interval time between transplantation and death or examination (PLANT = 1). The first time interval is coded as review. The second time interval can be censored or uncensored, depending on whether the person died during the observation period. Invariant variable when copying for two records. For each record, we also need two time variables, one for the beginning of the time interval and one for the end of the time interval. Both time variables are measured in the number of days since the study was accepted.</p>
<pre><code>DATA stanlong;
  SET stan;
  plant=0;
  start=0;

IF trans=0 THEN DO;
 dead2=dead;
 stop=surv1;
 IF stop=0 THEN stop=.1;
 OUTPUT;
END;

ELSE DO;
 stop=wait;
 IF stop=0 THEN stop=.1;
 dead2=0;
 OUTPUT;
 plant=1;
 start=wait;
 IF stop=.1 THEN start=.1;
 stop=surv1;
 dead2=dead;
 OUTPUT;
END;

RUN;

PROC PHREG DATA=stanlong;
 MODEL (start,stop)*dead2(0)=plant surg ageaccpt /TIES=EFRON;
RUN; </code></pre>
</div>
</div>
<div id="additive-hazards-regression-model" class="section level2" number="19.3">
<h2><span class="header-section-number">19.3</span> Additive Hazards Regression Model</h2>
<div id="preview" class="section level3" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Preview</h3>
<p>Currently, the most popular regression model for survival analysis is the cox proportional hazards model. Based on this model, the relation between failure times and pdimensional vector of independent variables <span class="math inline">\((\mathrm{X})\)</span> has the form</p>
<p><span class="math display">\[\lambda_{i}(t)=\lambda_{0}(t) \exp \left(\gamma_{1} X_{i 1}+\cdots+\gamma_{p} X_{i p}\right)\]</span></p>
<p>where <span class="math inline">\(\lambda_{0}(\mathrm{t})\)</span> is the baseline hazard function and <span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> is unknown timeindependent coefficients. The crucial assumption of proportional hazards in the Cox model means that the proportional effect of a treatment dose not vary with time (David, 1972 ).</p>
</div>
<div id="lin-and-yings-additive-hazards-model" class="section level3" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Lin and Ying’s additive hazards model</h3>
<p>This semiparametric additive hazards model the constant effects of covariates upon baseline hazard is additive. According to this model, hazard function for failure time (<span class="math inline">\(T_i\)</span>) has following relation with <span class="math inline">\(\mathrm{p}\)</span>-dimensional vector <span class="math inline">\(\mathrm{X}\)</span> (covariates).</p>
<p><span class="math display">\[\lambda_{i}(\mathrm{t})=\lambda_{0}(\mathrm{t})+\gamma_{1} \mathrm{x}_{i 1}(\mathrm{t})+\ldots \ldots+\gamma_{p} \mathrm{x}_{i p}(\mathrm{t})\]</span>
where is baseline hazard function. Coefficients <span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> are time independent additive effects (Lin and Ying, 1995).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="advanced-survival-analysis.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(addhazard)</span>
<span id="cb7-2"><a href="advanced-survival-analysis.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb7-3"><a href="advanced-survival-analysis.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nwtsco)</span>
<span id="cb7-4"><a href="advanced-survival-analysis.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">### using the first 100 rows in nwtsco to build an additive hazards model</span></span>
<span id="cb7-5"><a href="advanced-survival-analysis.html#cb7-5" aria-hidden="true" tabindex="-1"></a>nwts<span class="ot">&lt;-</span> nwtsco[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,]</span>
<span id="cb7-6"><a href="advanced-survival-analysis.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="advanced-survival-analysis.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">### fit the additive hazards model to the data</span></span>
<span id="cb7-8"><a href="advanced-survival-analysis.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">### the model-based standard errors are reported when setting robust = FALSE</span></span>
<span id="cb7-9"><a href="advanced-survival-analysis.html#cb7-9" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">ah</span>(<span class="fu">Surv</span>(trel,relaps) <span class="sc">~</span> age <span class="sc">+</span> instit, <span class="at">ties =</span> <span class="cn">FALSE</span>, <span class="at">data =</span> nwts, <span class="at">robust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-10"><a href="advanced-survival-analysis.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<pre><code>## Call:
## ah(formula = Surv(trel, relaps) ~ age + instit, data = nwts, 
##     robust = FALSE, ties = FALSE)
## 
##              coef         se   lower.95   upper.95     z p.value
## age     0.0001401  0.0012043 -0.0022204  0.0025006 0.116   0.907
## instit  0.0155257  0.0123040 -0.0085902  0.0396416 1.262   0.207</code></pre>
</div>
<div id="aalens-additive-hazards-model" class="section level3" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Aalen’s Additive Hazards Model</h3>
<p>In this non-parametric model the effects of covariates (constant or variable effect) upon baseline hazard is additive. According to this model, the relation between hazard function and failure time (<span class="math inline">\(T_i\)</span>) with p-dimensional vector <span class="math inline">\(X\)</span> (covariates) takes the form</p>
<p><span class="math display">\[\lambda_{i}(\mathrm{t})=\lambda_{0}(\mathrm{t})+\gamma_{1}(t) \mathrm{x}_{i 1}(\mathrm{t})+\ldots+\gamma_{p}(\mathrm{t}) \mathrm{x}_{\mathrm{p} p}(\mathrm{t})\]</span></p>
<p>where is baseline hazard function. Coefficients <span class="math inline">\(\gamma_{i}, i=1, \ldots, p\)</span> are time dependent additive effects. The Aalen’s model provides cumulative regression function plots (Aalen’s plot) that display how the effects of covariates change over the time. In the other words, Aalen’s plot shows time-dependent or constant effect of each covariate (Aalen, 1989). In this model, tests such as Kolmogorov-Smirnov test and Cramer Von Mises test have been presented for evaluating <strong>time invariant effect</strong> (Martinussen and Scheike, 2007 ).</p>
</div>
</div>
<div id="competing-risk" class="section level2" number="19.4">
<h2><span class="header-section-number">19.4</span> Competing Risk</h2>
<div id="introduction-16" class="section level3" number="19.4.1">
<h3><span class="header-section-number">19.4.1</span> Introduction</h3>
<p>Competing risk are said to be present when a patient is at risk of more than one mutually exclusive event, such as death from different cause which will prevent any other from happening. Competing risk models provide real world probabilities of death when competing events are present as opposed to standard survival models by allowing us to separate the probability of event into different causes.</p>
<p>In presence of competing events, the standard product-limit method of estimating survivor function for the event of interest <strong>yields biased results</strong> as the probability of occurrence is modified by an antecedent competing event.</p>
<p>The biggest drawback of competing risks analysis is the requirement that times for different event types be <strong>independent</strong> or <strong>at least that each event be noninformative</strong> for the others.</p>
</div>
<div id="type-specific-hazards" class="section level3" number="19.4.2">
<h3><span class="header-section-number">19.4.2</span> Type-specific hazards</h3>
<p>As before, let <span class="math inline">\(T_{i}\)</span> be a random variable denoting the time of death for person <span class="math inline">\(i\)</span>. Now let <span class="math inline">\(J_{i}\)</span> be a random variable denoting the type of death that occurred to person <span class="math inline">\(i\)</span>. Thus, <span class="math inline">\(J_{5}=2\)</span> means that person 5 died of cancer. We now define <span class="math inline">\(h_{i j}(t)\)</span>, the hazard for death type <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span> for person <span class="math inline">\(i\)</span>, as follows:</p>
<p><span class="math display">\[h_{i j}(t)=\lim _{\Delta t \rightarrow 0} \frac{\operatorname{Pr}\left(t&lt;T_{i}&lt;t+\Delta t, J_{i}=j \mid T_{i} \geq t\right)}{\Delta t}, \quad j=1, \ldots, 5\]</span></p>
<p>The overall hazard of death is just the sum of all the typespecific hazards:
<span class="math display">\[h_{i}(t)=\sum_{j} h_{i j}(t)\]</span>
Based on the type-specific hazards, we can also define type-specific survival functions:
<span class="math display">\[S_{j}(t)=\exp \left\{-\int_{0}^{t} h_{j}(u) d u\right\}\]</span></p>
<p>we can define the hypothetical variable <span class="math inline">\(T_{i j}\)</span> as the time at which the <span class="math inline">\(j_{t h}\)</span> event type either occurred to the ith person or would have occurred if other event types had not preceded it. In other words, we suppose that a person who dies of cancer at time <span class="math inline">\(T_{2}\)</span> would have later died of heart disease at time <span class="math inline">\(T_{1}\)</span> if the cancer death had not occurred. For a given set of <span class="math inline">\(T_{i j} \mathrm{~s}\)</span>, we only observe the one that is smallest. If we further assume that the <span class="math inline">\(T_{i j} \mathrm{~s}\)</span> are independent across event types, we can say that
<span class="math display">\[
S_{i j}(t)=\operatorname{Pr}\left(T_{i j}&gt;t\right)
\]</span>
That is, the type-specific survival function gives the probability that an event of type j occurs later than time t.</p>
<p><strong>Non-informative</strong></p>
<p>If the estimate is to be unbiased, the censor must be uninformative. For competitive risks, we must make exactly the same assumptions. In other words, we must assume that, on the condition of covariates, those who are at a particularly high (or low) risk of one type of event will not (or less) experience other types of events. Therefore, if we know that someone died of heart disease at the age of 50, that would not give us any information (except the information we derive from the covariates), and there is no information about his risk of dying from cancer at that age.</p>
</div>
<div id="covariate-effects-via-cox-model" class="section level3" number="19.4.3">
<h3><span class="header-section-number">19.4.3</span> Covariate effects via COX model</h3>
<ul>
<li>The first model treats all event types the same.</li>
<li>The second model focuses on type 3 by treating types 1 and 2 as censoring.</li>
<li>That’s followed by a model for type 2, treating types 1 and 3 as censoring</li>
</ul>
<p>These tests are only valid when using the Breslow method for handling ties or when there are no tied event times.
With tied event times: TIES=EFRON</p>
<pre><code>PROC PHREG DATA=leaders;
 MODEL years*lost(0)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
 
PROC PHREG DATA=leaders;
 MODEL years*lost(0,1,2)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
 
PROC PHREG DATA=leaders;
 MODEL years*lost(0,1,3)=manner start military age conflict
 loginc growth pop land literacy;
 STRATA region;
RUN;</code></pre>
</div>
<div id="cumulative-incidence-function-cif" class="section level3" number="19.4.4">
<h3><span class="header-section-number">19.4.4</span> Cumulative incidence function (CIF)</h3>
<div id="introduction-17" class="section level4" number="19.4.4.1">
<h4><span class="header-section-number">19.4.4.1</span> Introduction</h4>
<p>Based on type-specific survival functions:
<span class="math display">\[S_{j}(t)=\exp \left\{-\int_{0}^{t} h_{j}(u) d u\right\}\]</span></p>
<p>It can be interpreted as the probability that a person arrives at time <span class="math inline">\(t\)</span> without an event of type <span class="math inline">\(j\)</span> under the assumption that no other type of event may occur.
<span class="math display">\[F_{j}(t)=1-S_{j}(t)\]</span>
This is not considered a useful feature. Because the sum of the probabilities of various events that occurred before time t may usually exceed 1.
<span class="math display">\[\sum_{j} F_{j}(t) \ge 1\]</span>
Instead, many people prefer to estimate the cumulative incidence function, This equation estimates the probability that an event of type j happens to individual i before time t, in the presence of competing event types. which is defined as
<span class="math display">\[I_{j}(t)=\operatorname{Pr}\left(T_{i}&lt;t, J_{i}=j\right)\]</span>
The consistent estimate of the cumulative incidence function is given by
<span class="math display">\[\hat{I}_{j}(t)=\sum_{k \mid t_{k} \leq t} \hat{S}\left(t_{k}\right) \frac{d_{j k}}{n_{k}}\]</span></p>
<ul>
<li>where <span class="math inline">\(\hat{S}(t)\)</span> is the Kaplan-Meier estimate of the overall survivor function,</li>
<li><span class="math inline">\(d_{j k}\)</span> is the number of events of type <span class="math inline">\(j\)</span> that occurred at time <span class="math inline">\(t_{k}\)</span>,</li>
<li><span class="math inline">\(n_{k}\)</span> is the number at risk at time <span class="math inline">\(t_{k}\)</span>.</li>
<li>The ratio of <span class="math inline">\(d_{j k}\)</span> to <span class="math inline">\(n_{k}\)</span> is an estimate of the hazard of event type <span class="math inline">\(j\)</span> at time <span class="math inline">\(t_{k}\)</span></li>
</ul>
<p>An attractive feature of this estimator is
<span class="math display">\[
\hat{S}(t)+\sum_{j} \hat{I}_{j}(t)=1
\]</span></p>
<p>This says that at any time t, the probabilities for all the event types plus the probability of no event add up to 1.
Another attraction is that the method does not depend on the assumption that each event type is noninformative for other event types.</p>
</div>
<div id="proc-lifetest" class="section level4" number="19.4.4.2">
<h4><span class="header-section-number">19.4.4.2</span> Proc Lifetest</h4>
<p>For competitive risk data, PROC LIFETEST estimates the cumulative incidence function (CIF). If you have multiple data samples, it will estimate the CIF for each sample and compare the CIF between the samples by using the Gray test (Gray 1988). The estimated CIF is a step function, with a jump at each different time when the event of interest occurs. If there are a large number of such events, the estimated CIF table may be very long. If you are interested in the cumulative incidence of specific time points, you can use the TIMELIST = option in the PROC LIFETEST statement to specify these time points, and PROC LIFETEST only prints the estimated CIF values at these time points.</p>
<p><a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_lifetest_examples04.htm">source</a></p>
<ul>
<li>Censoring <span class="math inline">\(c_{i}=0\)</span></li>
<li>Without censoring (had a event) <span class="math inline">\(c_{i}=1\)</span></li>
<li>Competing events <span class="math inline">\(c_{i}=2\)</span></li>
</ul>
<pre><code>proc format;
    value RG 1=&#39;MelaGenix® Low Risk&#39; 0=&#39;MelaGenix® High Risk&#39;;
run;
*** IF censoring then Status = 0;
*** IF Melanoma-specific death then Status = 1;
*** IF other death then Status = 2;
data MSS_Dummy;
    input Days Status Group Site $ @@;
    format Group RG.;
    datalines;
   1179 1 1 A 
    378 0 1 B
    956 1 1 C 
    355 1 1 A
   1432 0 1 B
    262 1 1 B 
    819 2 1 C
    256 1 1 A 
   2256 2 1 B
    255 1 1 C 
   1171 1 1 A
    224 0 1 B 
   1325 1 1 C
    225 1 0 A 
   1325 2 1 B
   1256 1 1 A 
    256 2 0 B
    255 0 1 C 
   1171 2 1 A
    224 0 1 B 
    325 1 0 C
   1225 0 1 A 
    725 1 1 B
    287 2 1 C 
    217 0 0 A
    319 1 1 B 
   1255 2 1 A
    264 0 1 C 
    256 1 1 B
    237 0 0 C 
    291 1 1 A
   1156 0 0 B 
    323 0 0 C
    270 1 0 A 
    253 1 1 B
   1257 2 0 C 
    206 1 0 A
    242 0 1 B 
   1206 1 0 A
    157 1 0 C 
    237 1 1 B
   1249 0 0 B 
    211 1 0 C
    180 0 0 B 
    229 1 1 C
    226 1 0 A 
   1234 2 1 A
    268 0 0 B 
    209 1 0 C
;


*** Log Rank Test;
ods graphics on;
ods trace on;
ods output  CensoredSummary =_censorsum
            HomTests = _Hom; 
proc lifetest data=MSS_Dummy NOTABLE 
              outsurv = MSS_Dummy_Output 
              alpha = 0.0074 
              plots=(survival(atrisk)); 
    time Days*Status(0);
    strata Group / group = site;
run;
ods output close;
ods trace off; 
ods graphics off;


*** Cumulative incidence function (CIF);
ods graphics on;
proc lifetest data=MSS_Dummy 
              alpha = 0.0222
              plots=CIF(test) 
              timelist=0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0;
   time Days*Status(0)/eventcode=1;
   strata Group / order=internal;
run;
ods graphics off;</code></pre>
<p><strong>Stratified Gray’s Test</strong></p>
<p>Specify the GROUP= option in the STRATA statement, PROC LIFETEST enables you to perform a stratified test to evaluate the homogeneity of the CIFs between groups.</p>
<pre><code>ods graphics on;
proc lifetest data=MSS_Dummy 
              alpha = 0.0222
              plots=CIF(test) 
              timelist=0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0;
   time Days*Status(0)/eventcode=1;
   strata site  /group=Group order=internal;
run;
ods graphics off;</code></pre>
</div>
<div id="cif-macro" class="section level4" number="19.4.4.3">
<h4><span class="header-section-number">19.4.4.3</span> %CIF Macro</h4>
<p>The %CIF macro computes the crude cumulative incidence function estimates for homogeneous (no covariates) survival data whose endpoints are subjected to competing risks (Klein and Moeschberger, 2003). Standard errors and pointwise confidence limits are also computed. The estimated cumulative incidence curve is plotted as a step function using ODS graphics. You can also display the pointwise confidence limits in the plot by specifying the PLOTCL keyword in the OPTIONS= argument. If you do not want any plots, you can suppress it by specifying the NOPLOT keyword in the OPTIONS= argument.</p>
<p>If the data contains multiple samples identified by the GROUP= variable, the %CIF macro computes a cumulative incidence curve for each group, and the macro also compares cumulative incidence functions between groups using the method of Gray (1988).</p>
<pre><code>* cohort is the data name
* time is the survival time
* Ending y There is a risk of competition among multiple categories
     * 0 = Survival
     * 1 = Mainly concerned about ending A
     * 2 = Competitive risk event B
     
ods graphics on；ods html dpi＝300；

/*Do not group A total CIF*/
% cif(data＝cohort，out＝cif1_data，time＝time，status＝y，event＝1，censored＝0)；

/*CIF of gray’s comparison A between treat groups in operation group*/
% cif(data＝cohort，out＝cif1_data，time＝time，status＝y，
      event＝1，censored＝0，group＝treat)；
      
/*CIF of gray’s comparison B between treat groups in operation group*/
% cif(data＝cohort，out＝cif2_data，time＝time，status＝y，
      event＝2，censored＝0，group＝treat)；</code></pre>
<pre><code>
%macro CIF(
   data=,           /* Name of the input data set                             */
   out=cifEstimate, /* Name of the output data set that                       */
                    /* contains the cumulative incidence estimates            */
   time=Time,       /* Time variable                                          */
   status=Status,   /* Numeric variable whose values indicate  whether an     */
                    /* observation corresponds to the event of interest, the  */
                    /* competing event, or is censored                        */
   event=1,         /* Values of status= variable that correspond to the event*/
                    /* interest. Multiple values are separated by blanks      */
   censored=0,      /* Values of status= variable that correspond to censored */
                    /* observations. Multiple values are separated blanks     */
   group=,          /* Variable that defines the groups for comparison        */
   strata=,         /* Variable that defines the  strata for stratified test  */
   alpha=.05,       /* Complement of the confidence level for pointwise       */
                    /*confidence limits                                       */
   rho=0,           /* Power of the weight function in the test               */
   SE=1,            /* Method to compute the standard error of cumulative     */
                    /* incidence functions. 1=delta method;2=counting process */
   TITLE=,          /* First title for the cumulative incidence function      */
                    /* plot (without quote)                                   */
   TITLE2=,         /* Second title for the cumulative incidence function     */
                    /* plot (without quote)                                   */
   options=,        /* Multiple keywords are separated by blanks              */
                    /* NOPLOT suppresses plotting the cumulative incidence    */
                    /*        curves                                          */
                    /* PLOTCL plots the pointwise confidence limits for       */
                    /*        cumulative incidence curves                     */
                    /* NOCIFEST suppresses the CIF estimate table             */
                    /* NOTEST suppresses the test for differences among       */
                    /*        cumulative incidence functions                  */
                    /*                                                        */
   );;

%macro HL; %mend HL;
%local Confidence savenote noplotflag plotclflag notestflag nocifflag nev s11 inconsistentgrpnumflag;
%let savenote     = %sysfunc(getoption(notes));

options nonotes;


/* Check if time= and status= variables okey */
proc contents data=&amp;data noprint out=_c; run;

%let TimeVar=1;
%let StatusVar=1;
%let GroupVar=1;
%let StrataVar=1;
%let nocifflag=0;
%let inconsistentgrpnumflag=0;

data _null_;
   length x y $32;
   set _c;
   x=lowcase(NAME);
   y=lowcase(&quot;&amp;time&quot;);
   if x=y then do;
      if TYPE=1 then call symput(&#39;TimeVar&#39;, put(0,1.));
      else           call symput(&#39;TimeVar&#39;, put(2,1.));
   end;
   y=lowcase(&quot;&amp;status&quot;);
   if x=y then do;
      if TYPE=1 then call symput(&#39;StatusVar&#39;, put(0,1.));
      else           call symput(&#39;StatusVar&#39;, put(2,1.));
   end;
   %if ((&amp;group^=) ) %then %do;
           y=lowcase(&quot;&amp;group&quot;);
           if x=y then do;
                  if TYPE=1 then call symput(&#39;GroupVar&#39;, put(0,1.));
                  else           call symput(&#39;GroupVar&#39;, put(2,1.));
                  end;
           %end;
   %else
       call symput(&#39;GroupVar&#39;, put(3,1.));;

   %if ((&amp;strata^=) ) %then %do;
           y=lowcase(&quot;&amp;strata&quot;);
           if x=y then do;
                  if TYPE=1 then call symput(&#39;StrataVar&#39;, put(0,1.));
                  else           call symput(&#39;StrataVar&#39;, put(2,1.));
           end;
           %end;
   %else
                call symput(&#39;StrataVar&#39;, put(3,1.));;

run;


%if &amp;TimeVar=1 %then %do;
   %let _xrc_=
     %str(Variable &amp;time not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;TimeVar=2 %then %do;
   %let _xrc_=
     %str(Variable &amp;time is not a numeric variable);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;StatusVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;status not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;
%if &amp;StatusVar=2 %then %do;
   %let _xrc_=
    %str(Variable &amp;status is not a numeric variable);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;

%if &amp;GroupVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;group not found in the input data set);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;

%if &amp;StrataVar=1 %then %do;
   %let _xrc_=
    %str(Variable &amp;strata not found in the input data set);
    %put ERROR: &amp;_xrc_..;
   %goto exit;
%end;



data _null_;
   /*----- check OPTIONS= -----*/
   list= lowcase(symget(&#39;options&#39;));
   i = index(list, &#39;noplot&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;noplotflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;plotcl&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;plotclflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;notest&#39;); if i then substr(list, i, 6) = &#39; &#39;;
   call symput(&#39;notestflag&#39;, put(i gt 0, 1.));
   i = index(list, &#39;nocifest&#39;); if i then substr(list, i, 8) = &#39; &#39;;
   call symput(&#39;nocifestflag&#39;, put(i gt 0, 1.));

   /*----- Confidence Level -------*/
   alpha=.05;
   %if &amp;alpha ne %then %do; alpha=&amp;alpha; %end;
   call symput(&#39;Confidence&#39;,trim(put(100*(1-alpha),best8. -l)));
   /*---- No of event= and compete= values ----*/
   ne=countw(symget(&#39;event&#39;),&#39; &#39;);
   call symput(&#39;ne&#39;,put(ne,best8. -l));
   ncens=countw(symget(&#39;censored&#39;),&#39; &#39;);
   call symput(&#39;ncens&#39;,put(ncens,best8. -l));

run;


%if &amp;data= %then %do;
   %let _xrc_= %str(The DATA= parameter is not specified);
   %put ERROR: &amp;_xrc_..;
   %goto exit;
   %end;
%else
   %do;

   data _null_;
   set &amp;data;
   array event[&amp;ne] _temporary_(&amp;event);
   array censored[&amp;ncens] _temporary_(&amp;censored);;
   zevent=0;
   zcensored=0;
   do i=1 to &amp;ne;
     if &amp;status = event[i] then do;
       zevent=1;
       goto skip1;
     end;
   end;
   skip1:;

   do i=1 to &amp;ncens;
      if &amp;status = censored[i] then do;
         zcensored=1;
         go to skip2;
      end;
   end;
   skip2:;

   if zevent=1 and zcensored=1 then do;
      call symput(&#39;s11&#39;,trim(left(put(&amp;status,best8.))));
      stop;
   end;
   if zevent=1 then do;
       call symput(&#39;nev&#39;,put(1,1.));
   end;
   run;

%if &amp;nev eq %then %do;
  %let _xrc_=
    %str(The total number of EVENT is 0);
  %put ERROR: &amp;_xrc_..;
  %goto exit;
%end;

%if &amp;s11 ne %then %do;
  %let _xrc_=
    %str(&amp;Status=%sysfunc(trim(&amp;s11)) is both an EVENT= and CENSORED= value);
  %put ERROR: &amp;_xrc_..;
  %goto exit;
%end;
run;

data _null_;
   set &amp;data;
   length l $ 60;
   call vname(&amp;time, l);
   call symputx(&#39;tname&#39;, l, &#39;L&#39;);
   call label(&amp;time, l);
   call symputx(&#39;tlabel&#39;, l, &#39;L&#39;);
   %if ((&amp;group^=) ) %then %do;
      call vname(&amp;group, l);
      call symputx(&#39;gname&#39;, l, &#39;L&#39;);
      call label(&amp;group, l);
      call symputx(&#39;glabel&#39;,l , &#39;L&#39;);
      call symputx(&#39;grpFmt&#39;, VFORMAT(&amp;group));
      %end;
   %else %do;
      call symputx(&#39;glabel&#39;,&quot;Group&quot; , &#39;L&#39;);
          call symputx(&#39;gname&#39;, &quot;Group&quot;, &#39;L&#39;);;
      %end;

    %if ((&amp;strata^=) ) %then %do;
      call vname(&amp;strata, l);
      call symputx(&#39;stratname&#39;, l, &#39;L&#39;);
      call label(&amp;strata, l);
      call symputx(&#39;stratlabel&#39;,l , &#39;L&#39;);
      call symputx(&#39;stratFmt&#39;, VFORMAT(&amp;strata));
      %end;
   %else %do;
      call symputx(&#39;stratlabel&#39;,&quot;Strata&quot; , &#39;L&#39;);
          call symputx(&#39;stratname&#39;, &quot;Strata&quot;, &#39;L&#39;);;
      %end;


run;

/*create a data set by ignoring those missing observations*/
data &amp;data.1(drop=&amp;group);
   set &amp;data;
   %if ((&amp;group^=) ) %then %do;
      f&amp;group= put(&amp;group, &amp;grpFmt);
      IF CMISS(&amp;time,&amp;status, f&amp;group) &gt; 0 THEN DELETE;
      %end;
   %if ((&amp;strata^=) ) %then %do;
      f&amp;strata= put(&amp;strata, &amp;stratFmt);
      IF CMISS(&amp;time, &amp;status, f&amp;strata) &gt; 0 THEN  DELETE;
      %end;
   %end;


run;


data _null_;
   call symputx(&#39;nobs0&#39;,nobs0);
   stop;
   set &amp;data nobs=nobs0;
run;

data _null_;
   call symputx(&#39;nobs1&#39;,nobs1);
   stop;
   set &amp;data.1 nobs=nobs1;
run;


%if &amp;nobs0&gt;&amp;nobs1 %then %do;
   %put NOTE: There are %eval(&amp;nobs0-&amp;nobs1) missing observations;

%end;


proc iml;
   use &amp;data.1;
   read all var{&amp;time} into time;
   read all var{&amp;status} into status;
   nobs= nrow(time);
   %if %bquote(&amp;group)= %then %do;
     group= j(nobs,1,1);
   %end;
   %else %do;
   read all var{f&amp;group} into group;
   %end;


   %if %bquote(&amp;strata)= %then %do;
     strat= j(nobs,1,1);
   %end;
   %else %do;
     read all var{f&amp;strata} into strat;
   %end;


   close &amp;data.1;

* subroutine to calculate the cumulative incidence and variance;
start estimate_cif(y, causecode) global(time, cif, vcif1, vcif2, n2);
/*************************************************************
* y is the failure times (sorted in increasing order);
* ic is the indicator for censoring
*   (= 0 if censored, =1 if failed from any cause);
* icc is the indicator for failure from the cause of interest
*   (= 0 if failed from cause of interest, =1 otherwise);
* n is the # of observations (length of y);
* n2 = n+2:  the number of the unique time points from cause 1 with 2 extra points (0 and largest time point within this group);
* ut is the unique failure times from the cause of interest;
* cif is the estimated cumulative incidence function;
* vcif1 and vcif2 are the estimated variance of cif from Marubini method and Gray method respectively;
**************************************************************/
   surv_km= 1;
   v11= 0; v21= 0;
   v12= 0; v22= 0;
   v13= 0; v23= 0;


   cif_pos= 1;
   n= nrow(y);
   nrisk=n;

   ut=unique(y)`;
   n_ut=nrow(ut);

   cif= j(n2,1,0);
   vcif1= j(n2,1,0);
   vcif2= j(n2,1,0);


   do i=1 to n_ut;
      *compute the number of events of interest and competing events;
      nevent=sum(causecode[loc(y=ut[i])]=1);
      ncompetevent=sum(causecode[loc(y=ut[i])]=2);
      n_allevents = nevent+ ncompetevent;

      *compute survival function and cumulative incidence function;
      if n_allevents^= 0 then do; *overall survival changes whenever a failure occurs;
         if (i&gt;1)  then nrisk =n - min(loc(y=ut[i]))+ 1 ;
         surv_km_n= surv_km* (nrisk- n_allevents)/ nrisk;
         if nevent&gt; 0 then do;
            cif_pos= cif_pos + 1;
            cif[cif_pos]= cif[cif_pos- 1]+ surv_km * nevent/ nrisk;
            end;


            * variance estimator using delta method- (10.12) in Marubini and Valsecchi (1995);
            * Analysing Survival Data from Clinical Trials and Observational Studies;
            t1=0;
            if (nrisk- n_allevents&gt;0) then         t1= n_allevents/ nrisk/ (nrisk- n_allevents);
            t2= surv_km* nevent/ nrisk/ nrisk;
            t3= surv_km* (1- nevent/ nrisk)* t2;
            t4= cif[cif_pos]* cif[cif_pos];
            v11= v11+ t1;
            v12= v12- 2* (cif[cif_pos]* t1+ t2);
            v13= v13+ t4* t1+ 2* cif[cif_pos]* t2 + t3;
            vcif1[cif_pos]= t4* v11+ cif[cif_pos]* v12+ v13;



            *variance estimator using counting process- Gray (1988);

            if (ncompetevent&gt; 0 &amp; surv_km_n&gt; 0) then do;
               vt1=1;
               if( ncompetevent &gt; 1) then vt1= 1- (ncompetevent - 1)/(nrisk- 1);
               vt2= surv_km* surv_km* vt1* ncompetevent/(nrisk* nrisk);
               vt3= 1/ surv_km_n;
               vt4= cif[cif_pos]/ surv_km_n;
               v21= v21+ vt2* vt4* vt4;
               v22= v22+ vt2* vt3* vt4;
               v23= v23+ vt2* vt3* vt3;
               end;
            if (nevent&gt; 0) then do;
               vt1=1;
               if( nevent&gt; 1 ) then vt1= 1-(nevent- 1)/(nrisk- 1);
               vt2= surv_km* surv_km* vt1* nevent/(nrisk* nrisk);
               if surv_km_n&gt; 0 then vt3= 1/ surv_km_n; else vt3= 0;
               vt4= 1+ vt3* cif[cif_pos];
               v21= v21+ vt2* vt4* vt4;
               v22= v22+ vt2* vt3* vt4;
               v23= v23+ vt2* vt3* vt3;
               vcif2[cif_pos]= v21 - 2*cif[cif_pos]*v22 +  cif[cif_pos]*cif[cif_pos]*v23;
               end;

            surv_km= surv_km_n;

         end;


   end;       /*end do i=*/


   if cif_pos&lt; n2 then do;
      /*deal with the largest time point with the group*/
      cif_pos= cif_pos+ 1;
      time[cif_pos]= ut[n_ut];
      cif[cif_pos]= cif[cif_pos- 1];
      vcif1[cif_pos]= vcif1[cif_pos- 1];
      vcif2[cif_pos]= vcif2[cif_pos- 1];

   end;
   if (sum(vcif1&lt;0)&gt;0) then   vcif1[loc(vcif1&lt;0)]=0;
   if (sum(vcif2&lt;0)&gt;0) then   vcif2[loc(vcif2&lt;0)]=0;


   vcif1= sqrt(vcif1);
   vcif2= sqrt(vcif2);

finish estimate_cif;



/* subroutine for calculating k-sample test statitsics and variance within stratum;
* for competing risk for Gray&#39;s method (1988);*/
start test_ksample(y, causecode, ig, rho) global(score, vcov);
*  y is the failure times (sorted in ascending order)
*  causecode is cause indicator
*   (= 0 if censored, =1 if failed from the cause of interest,
*       2 if failed from some other causes.)
*  ig denotes group membership

*  rho is the power of the weight function in the test statistic


   *  ng denotes the number of groups, ng1= ng- 1;
   ng= ncol(unique(ig));
   * risk set size in each at the current failure time (= sample size at 0);
   nrisk= j(ng,1,0);

   do i= 1 to ng;
      nrisk[i]= nrisk[i] + sum(ig=i);
   end;

   ng1=ng-1;
   ng2= ng* ng1/ 2;
   score= j(ng1,1,0);
   vcov= j(ng2,1,0);

   l= 0;
   cifgleft= j(ng,1,0);
   cifg=  j(ng,1,0);
   cif0left= 0;
   cif0= 0;

   vtvec=  j(ng,1,0);
   skmgleft= j(ng,1,1);
   skmg= j(ng,1,1);


   vtmatrix= j(ng1,ng,0);
   c= j(ng,ng,0);


   ll= 1;

   ut=unique(y)`;
   n_ut=nrow(ut);

   do i=1 to n_ut;
         d= j(3,ng,0);
         yloc=loc(y=ut[i]);
      do ii= yloc[1] to yloc[ncol(yloc)];
         k= causecode[ii]+ 1;   * causes code:0, 1, 2;
         d[k,ig[ii]]= d[k,ig[ii]] + 1;
      end;
      nd1= d[2,+];
      nd2= d[3,+];

      if (nd1^= 0 | nd2^= 0) then do;
         *hdot is sum(hhat), Rdot is sum(R), skmgleft is Shat, nrisk is Y, cifgleft is CIF;
         hdot= 0; Rdot= 0;
         do g= 1 to ng;
            if (nrisk[g]&gt; 0) then do;
               td= d[2,g] + d[3,g];
               skmg[g]= skmgleft[g]* (nrisk[g]- td)/ nrisk[g];
               cifg[g]= cifgleft[g]+ skmgleft[g]* d[2,g]/ nrisk[g];
               hdot= hdot+ nrisk[g]/ skmgleft[g];
               Rdot= Rdot+ nrisk[g]* (1 - cifgleft[g])/ skmgleft[g];
               end;
         end;

         cif0= cif0left+ nd1/hdot;
         grho= (1- cif0left)**rho;

         * score statistic;
         do g=1 to ng1;
            if (nrisk[g]&gt; 0) then score[g]= score[g]+ grho* (d[2,g]- nd1* nrisk[g]* (1- cifgleft[g])/ skmgleft[g]/ Rdot);
         end;

         a= j(ng, ng,0);
         do g= 1 to ng;
            if (nrisk[g]&gt; 0) then do;
               t1= nrisk[g]/ skmgleft[g];
               a[g,g]= grho* t1* (1- t1/ hdot);
               c[g,g]= c[g,g]+ a[g,g]* nd1/hdot/(1- cif0left);
               k= g + 1;
               *if (k&lt;= ng) then do j= k to ng;
               do j= g+1 to ng;
                  if (nrisk[j]&gt; 0) then do;
                     a[g,j]= - grho* t1* nrisk[j]/ skmgleft[j]/ hdot; a[j,g]= a[g,j];
                     c[g,j]= c[g,j]+ a[g,j]* nd1/ hdot/ (1 - cif0left); c[j,g]= c[g,j];
                     end;
               end;
               end;
         end;


         * variance estimators;
         if nd1&gt; 0 then do k=1 to ng;
            if (nrisk[k]&gt; 0) then do;
               if skmg[k]&gt; 0 then vt1= 1- (1- cif0)/ skmg[k]; else vt1= 1;
               if nd1&gt; 1 then vt2= 1- (nd1- 1)/ (hdot* skmgleft[k]- 1); else vt2= 1;
               vt3= vt2* skmgleft[k]* nd1/ (hdot* nrisk[k]);
               vtvec[k]= vtvec[k]+ vt1* vt1* vt3;
               do g= 1 to ng1;
                  vt4= a[g,k]- vt1* c[g,k];
                  vtmatrix[g,k]= vtmatrix[g,k]+ vt4* vt1* vt3;
                  do j=1 to g;
                     l= g* (g- 1)/ 2+ j;
                     vt5= a[j,k]- vt1* c[j,k];
                     vcov[l]= vcov[l]+ vt3* vt4* vt5;
                  end;
               end;
               end;
            end;

         if (nd2^= 0) then do k=1 to ng;
            if (skmg[k]&gt; 0 &amp; d[3,k]&gt; 0) then do;
               vt1= (1- cif0)/ skmg[k];
               vt2= 1;
               if (d[3,k]&gt; 1) then vt2= 1- (d[3,k] - 1)/ (nrisk[k]- 1);
               vt3= vt2* ((skmgleft[k]** 2)* d[3,k])/ (nrisk[k]** 2);
               vtvec[k]= vtvec[k]+ vt1* vt1* vt3;
               do g=1 to ng1;
                  vt4= vt1* c[g,k];
                  vtmatrix[g,k]= vtmatrix[g,k]- vt4* vt1* vt3;
                  do j=1 to g;
                     l= g* (g- 1)/ 2+ j;
                     vt5= vt1* c[j,k];
                     vcov[l]= vcov[l]+ vt3* vt4* vt5;
                  end;
               end;
               end;
            end; /*if (nd2^= 0)*/

         end; /*if (nd1^= 0 | nd2^= 0)*/

      *update the risk sets and the index of the next failure time;

      do ii= yloc[1] to yloc[ncol(yloc)];
         nrisk[ig[ii]]= nrisk[ig[ii]] - 1;
      end;
      cif0left= cif0;
      cifgleft= cifg;
      skmgleft= skmg;



   end;  /* end do i=*/

   pos= 0;
   do g= 1 to ng1;
      do j= 1 to g;
         pos= pos+ 1;
         do k= 1 to ng;
            vcov[pos]= vcov[pos]+ c[g,k]* c[j,k]* vtvec[k];
            vcov[pos]= vcov[pos]+ c[g,k]* vtmatrix[j,k];
            vcov[pos]= vcov[pos]+ c[j,k]* vtmatrix[g,k];
         end;
      end;
   end;

finish test_ksample;





   * subroutines end and the calculation starts here;
   * status need to be numerical value;

   x= time|| status;

   *call sort(x, {1 2});
   call sortndx(sidx, x, {1 2});
   x=x[sidx,];



   group=group[sidx];
   strat=strat[sidx];
   ugg= unique(group);
   ng= ncol(ugg);
   call symput(&#39;ng&#39;,left(char(ng)));

   * censind= 0 if censored, =1 if failed;

   censList={&amp;censored}`;
   eventList={&amp;event}`;
   censind=j(nrow(x),1,0);

   eventind=censind;
   do i= 1 to &amp;ncens;
     censind= censind |(x[,2]= censList[i]);
   end;
   do i= 1 to &amp;ne;
     eventind= eventind |(x[,2]= eventList[i]);
   end;

   causecode= 2* (^censind)- eventind;


   * prepare the data;
   x= x|| censind|| causecode;
   if ng&gt; 1 then do;
      ng1= ng - 1;
      ng2= ng* ng1/ 2;
      vv= j(ng1,ng1,0); *the final covariance matrix;
      vcov_st= j(ng2,1,0);  vcov= vcov_st; *vcov_st for each stratum, vs add v across strata ;
      score_st= j(ng1,1,0); score= score_st; *s is test statiatics by stratum,ss add s across strata;

   end;

   ust= unique(strat);
   nstrata= ncol(ust);
   call symput(&#39;nstrata&#39;,left(char(nstrata)));

  /* calculate CIF and  variance*/
   if (&amp;nocifflag=0) then do;

          do k= 1 to nstrata;

                  do g= 1 to ng;
                         gind= (group= ugg[g]);
                         *ncg= sum(gind);
                         * subset of data for group g and stratum k;
                         grpstra=(gind= 1) &amp; (strat= ust[k]) &amp; (x[,4]=1);

                         if (sum(grpstra)&gt;0) then do;

                                 xsub= x[loc((gind= 1) &amp; (strat= ust[k])), ];

                                 * aa are failure times for cause 1, n2 is the length of CIF;
                                 aa= xsub[loc(xsub[,4]= 1), 1];
                                 n2 = ncol(unique(aa))+ 2;

                                 run estimate_cif(xsub[,1], xsub[,4]);

                                 time1=0//(unique(aa))`//xsub[nrow(xsub),1];
                                 tmp= time1|| cif|| vcif1|| vcif2;  *time,CI,variance,group;
                                 if (g= 1 &amp; k=1) then do;
                                        cifEST= tmp;
                                        grpLabel=j(n2,1,ugg[g]);
                                        if(nstrata&gt;1) then stratLabel=j(n2,1,ust[k]);

                                        end;
                                 else  do;
                                        cifEST= cifEST//tmp;
                                        grpLabel= grpLabel//j(n2,1,ugg[g]);
                                        if(nstrata&gt;1) then stratLabel=stratLabel//j(n2,1,ust[k]);
                                        end;
                                end; /*(sum(grpstra)&gt;0)*/
                  end;
           end;



      /*create SAS data set for CIF estimate*/
      cifloc=loc(cifEST[,2]&gt;0);
      ncif= nrow(cifEST);
      lowci=j(ncif, 1, 0);
      upci =j(ncif, 1, 0);
      z=probit(1-&amp;alpha/2.0);

      /*confidence intervals:  log-log tranform*/
      lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
      upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));

      if (&amp;SE=1) then do;
         /*Counting process method -- Gray*/
         lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 4]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 4]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         cifEST=cifEST[, (1:2||4)];
         cifEST = cifEST || lowci || upci;
         create &amp;out.plot from cifEST[colname={&quot;&amp;tname&quot; &quot;CIF&quot; &quot;StdErr&quot; &quot;LowerCI&quot; &quot;UpperCI&quot;}];
         end;
      else do;
         /*Delta Method -- Marubini*/
         lowci[cifloc] = cifEST[cifloc, 2]##exp((-z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         upci[cifloc] = cifEST[cifloc, 2]##exp((z*cifEST[cifloc, 3]) /(cifEST[cifloc,2]#LOG(cifEST[cifloc,2])));
         cifEST=cifEST[,(1:3)];
         cifEST = cifEST|| lowci || upci;
         create &amp;out.plot from cifEST[colname={&quot;&amp;tname&quot; &quot;CIF&quot; &quot;StdErr&quot; &quot;LowerCI&quot; &quot;UpperCI&quot;}];
         end;



      append from cifEST;
      close &amp;out.plot;

      create _outgrpLabel from grpLabel[colname={&quot;&amp;gname&quot;}] ;
                append  from grpLabel;
      close _outgrpLabel;

          if (nstrata&gt;1) then do;
                  create outstratLabel from stratLabel[colname={&quot;&amp;stratname&quot;}] ;
                        append  from stratLabel;
                  close outstratLabel;
                  end;


   end;


   /* start Gray&#39;s K-sample test, and strata is allowed;
   * merge the data;*/


   if ( ng&gt;1 &amp;(^&amp;notestflag)) then do;
      /* recode the group member id from 1 to ng*/
      grpcode=j(nrow(x), 1, 0);
      do g= 1 to ng;
        grpcode[loc(group= ugg[g])]=g;
      end;



      do k= 1 to nstrata;
         * subset of data for stratum k;
         xsub= x[loc(strat= ust[k]), ];
                 grpcodesub=grpcode[loc(strat= ust[k])];
                 if (ncol(unique(grpcodesub))=ng) then do;

                        Run test_ksample(xsub[,1], xsub[,4], grpcodesub, &amp;rho);
                        score_st= score_st+ score;
                        vcov_st= vcov_st+ vcov;
                        end;
                 else
                        call symput(&#39;inconsistentgrpnumflag&#39;,left(char(1)));


      end;


      pos= 0;
      do i= 1 to ng1;
         do j= 1 to i;
            pos= pos+ 1;
            vv[i,j]= vcov_st[pos];
            vv[j,i]= vv[i,j];
         end;
      end;

      * test statistic and p-value;

      test_stat= score_st`* ginv(vv)* score_st;
      df= ng1;
      pval= 1- probchi(test_stat, df);
      Test=  test_stat || df || pval;
      create TestResult from Test[colname={ &quot;test_stat&quot; &quot;df&quot; &quot;pval&quot;}];
      append from Test;
      close TestResult;

      end;

quit; /*Exit Proc IML*/


/*create the output data for the cumulative incidence estimates for the CIF plot */

%if &amp;nocifflag %then %do; %put WARNING: No CIF is computed when both STRATA and GROUP are specified; %goto exit2; %end;
data &amp;out.plot;
   merge _outgrpLabel &amp;out.plot;
   if (0) then set &amp;data(keep=&amp;tname);
run;


%if (&amp;nstrata&gt;1) %then %do;
  data &amp;out.plot;
    label &amp;stratname=&quot;&amp;stratlabel&quot;;
    merge outstratLabel &amp;out.plot;
  run;
%end;

data &amp;out(%if %bquote(&amp;group)= %then drop=&amp;gname;);
   set &amp;out.plot;
   %if (&amp;nstrata&gt;1) %then %do;
      by &amp;stratname &amp;gname;
          %end;
   %else %do;
          by &amp;gname;;
      %end;
   if not last.&amp;gname;


run;

%if( ^&amp;nocifestflag ) %then  %do;
Title &quot;Cumulative Incidence Estimates  with &amp;Confidence% Confidence Limits&quot;;
proc print data=&amp;out NOOBS Label;
   label   LowerCI= &quot;Lower &amp;Confidence% Limits&quot;
           UpperCI=&quot;Upper  &amp;Confidence% Limits&quot;;
run;
%end;

/*plot the CIF curves*/

%if &amp;noplotflag %then %goto exit2;
    %if (%bquote(&amp;title)=) %then
        %if (&amp;plotclflag ) %then
            %let title= Cumulative Incidence Functions with &amp;Confidence% Confidence Intervals;
            %else
                %let title= Cumulative Incidence Functions;;




title &#39;&amp;title&#39;;
title2 &#39;&amp;title2&#39;;


%if (&amp;ng&gt;1 ) %then %let groupopt=group=&amp;gname;
%else %let groupOpt=;

%if (&amp;nstrata=1) %then %do;
        proc sgplot data=&amp;out.plot;
           label CIF=&#39;Cumulative Incidence&#39;;
           *yaxis values=(0 .1 .2 .3 .4 .5 .6 .7 .8 .9 1.0);
           step y=CIF x=&amp;tname / &amp;groupOpt  name=&quot;cif&quot;;
           %if &amp;plotclflag %then
                band x=&amp;tname lower=LowerCI upper=UpperCI / group=&amp;gname fill transparency=.5
                                                     modelname=&#39;cif&#39; legendlabel=&#39;&#39;;;

        run;
        %end;
%else %do;

        proc sgpanel data=&amp;out.plot;
           panelby &amp;stratname;
           label CIF=&#39;Cumulative Incidence&#39;;
           *rowaxis values=(0 .1 .2 .3 .4 .5 .6 .7 .8 .9 1.0);

           step y=CIF x=&amp;tname / &amp;groupOpt  name=&quot;cif&quot;;
           %if &amp;plotclflag %then
               band x=&amp;tname lower=LowerCI upper=UpperCI / group=&amp;gname fill transparency=.5
                                                          modelname=&#39;cif&#39; legendlabel=&#39;&#39;;;

        run;
        %end;



%exit2:
   %if (&amp;inconsistentgrpnumflag) %then %do; %put WARNING: The test is not available because the &amp;group number is not the same across the strata; %goto exit; %end;
   %if ( &amp;ng&gt;1 &amp;(^&amp;notestflag)) %then %do;
       Title &quot;Gray&#39;s Test for Equality of Cumulative Incidence Functions&quot;;
       proc print data=testresult NOOBS Label;
       label test_stat=&quot;Chi-Square&quot;
                 df=&quot;DF&quot;
                 pval= &quot;Pr &gt; Chi-Square&quot;;
           format pval pvalue6.4;
       run;
   %end;

%exit:
Title ;
Title2 ;
proc datasets nolist;
     delete &amp;data.1 _outgrpLabel _c;
run;

options &amp;savenote;

%mend CIF



/*****************************************************************/
 /*          S A S   A U T O C A L L   L I B R A R Y              */
 /*                                                               */
 /*   NAME : CIF                                                  */
 /*   TITLE: Estimate Cumulative Incidence Function and           */
 /*          Compare Cumulative Incidence Functions across Samples*/
 /* PRODUCT: STAT                                                 */
 /*  SYSTEM: ALL                                                  */
 /*    KEYS: survival data, failure probability, competing risks  */
 /*   PROCS:                                                      */
 /*    DATA:                                                      */
 /* SUPPORT: Guixian Lin                UPDATE:  Mar2012          */
 /*     REF: Klein  and Moeschberger   (2003)                     */
 /*          Marubini and Valsecchi    (1995)                     */
 /*          Gray                      (1988)                     */
 /*    MISC: The %CIF macro requires Base SAS and SAS/IML.        */
 /*          SAS/GRAPH is also required in SAS 9.2                */
 /*****************************************************************/


/*------------------------------------------------------------------
The %CIF macro computes the crude cumulative incidence function
estimates for homogeneous (no covariates) survival data whose
endpoints are subjected to competing risks (Klein and
Moeschberger, 2003). Standard errors and pointwise confidence
limits are also computed. The estimated cumulative incidence curve
is plotted as a  step function using ODS graphics. You can also
display the pointwise confidence limits in the plot by specifying
the PLOTCL keyword in the OPTIONS= argument. If you do not want any
plots, you can suppress it by specifying the NOPLOT keyword in the
OPTIONS= argument.

If the data contains multiple samples identified by the GROUP= variable,
the %CIF macro computes a cumulative incidence curve for each group, and
the macro also compares cumulative incidence functions between groups
using the method of Gray (1988).


--------------------------------------
EXAMPLES:

-----Example 1:

Consider the data in Table 10.1 of Marubini and
Valsecchi (1995). The data include two treatment groups (A and B), and
two competing events (1 and 2). The variable status has 3 distinct
values: value 0 indicates a censored time, and values 1 and 2 represent
two competing events.


Here we illustrate how to estimate the cumulative incidence function within
each group with the event of interest(=2), and test whether there is any
difference  between these two cumulative incidence functions.


data a (drop=_i_);
   array type1(10) _temporary_ (1 13 17 30 34 41 78 100 119 169);
   array type2(20) _temporary_ (1 6 8 13 13 15 33 37 44 45
                                63 80 89 89 91 132 144 171 183 240);
   array type3(5)  _temporary_ (34 60 63 149 207);
   do _i_=1 to 10;
      Status=1;
      t=type1{_i_};
      output;
      end;
   do _i_=1 to 20;
      Status=2;
      t=type2{_i_};
      output;
      end;
   do _i_=1 to 5;
      Status=0;
      t=type3{_i_};
      output;
      end;
run;

data b (drop=_i_);
   array type1(10) _temporary_ (7 16 16 20 39 49 56 73 93 113);
   array type2(20) _temporary_ (1 2 4 6 8 9 10 13 17 17
                                17 18 18 27 29 39 50 69 76 110);
   array type3(5)  _temporary_ (34 60 63 78 149);
   do _i_=1 to 10;
      Status=1;
      t=type1{_i_};
      output;
      end;
   do _i_=1 to 20;
      Status=2;
      t=type2{_i_};
      output;
      end;
   do _i_=1 to 5;
      Status=0;
      t=type3{_i_};
      output;
      end;
run;

data ab;
   label t=&quot;Weeks&quot;;
   set a(in=ina) b;
   if ina then group=&#39;A&#39;;
   else        group=&#39;B&#39;;

run;



%CIF(data=ab, out=est, time=t, status=status, group=group, event=2, title=CIF curves, title2=for Status=2);




-----Example 2:
Consider the data on 137 Bone Marrow Transplant Patients in Appendix D of Klein
and Moeschberger (2003). In this data, Patients are grouped into 3 categories:
ALL (38 patients), AML low risk (54 patients), and AML high risk (45). The competing
events are relapse and death in remission.  The variables used in the
example are:
Gender: patient gender (1-Male, 0-Female)
Status: event indicator (0=censored, 1=death in remission, 2=relapse)
   Grp: disease categories (1-ALL, 2-AML low risk, 3-AML high risk)
 Ftime: failure time.

The following DATA step creates the SAS data set BMT. Here we use the data set BMT
to illustrate how to compute the cumulative incidence functions with the event of interest
for different groups, and test whether there is any difference between the CIF across
groups using stratified data by specifying the strata= variables.


proc format;
   value grpLabel 1=&#39;ALL&#39; 2=&#39;AML low risk&#39; 3=&#39;AML high risk&#39;;
run;

data BMT;
        input DIAGNOSIS Ftime Status Gender@@;
        label Ftime=&quot;Days&quot;;
        format Diagnosis grpLabel.;
datalines;
1       2081       0       1       1       1602    0       1
1       1496       0       1       1       1462    0       0
1       1433       0       1       1       1377    0       1
1       1330       0       1       1       996     0       1
1       226        0       0       1       1199    0       1
1       1111       0       1       1       530     0       1
1       1182       0       0       1       1167    0       0
1       418        2       1       1       383     1       1
1       276        2       0       1       104     1       1
1       609        1       1       1       172     2       0
1       487        2       1       1       662     1       1
1       194        2       0       1       230     1       0
1       526        2       1       1       122     2       1
1       129        1       0       1       74      1       1
1       122        1       0       1       86      2       1
1       466        2       1       1       192     1       1
1       109        1       1       1       55      1       0
1       1          2       1       1       107     2       1
1       110        1       0       1       332     2       1
2       2569       0       1       2       2506    0       1
2       2409       0       1       2       2218    0       1
2       1857       0       0       2       1829    0       1
2       1562       0       1       2       1470    0       1
2       1363       0       1       2       1030    0       0
2       860        0       0       2       1258    0       0
2       2246       0       0       2       1870    0       0
2       1799       0       1       2       1709    0       0
2       1674       0       1       2       1568    0       1
2       1527       0       0       2       1324    0       1
2       957        0       1       2       932     0       0
2       847        0       1       2       848     0       1
2       1850       0       0       2       1843    0       0
2       1535       0       0       2       1447    0       0
2       1384       0       0       2       414     2       1
2       2204       2       0       2       1063    2       1
2       481        2       1       2       105     2       1
2       641        2       1       2       390     2       1
2       288        2       1       2       421     1       1
2       79         2       0       2       748     1       1
2       486        1       0       2       48      2       0
2       272        1       0       2       1074    2       1
2       381        1       0       2       10      2       1
2       53         2       0       2       80      2       0
2       35         2       0       2       248     1       1
2       704        2       0       2       211     1       1
2       219        1       1       2       606     1       1
3       2640       0       1       3       2430    0       1
3       2252       0       1       3       2140    0       1
3       2133       0       0       3       1238    0       1
3       1631       0       1       3       2024    0       0
3       1345       0       1       3       1136    0       1
3       845        0       0       3       422     1       0
3       162        2       1       3       84      1       0
3       100        1       1       3       2       2       1
3       47         1       1       3       242     1       1
3       456        1       1       3       268     1       0
3       318        2       0       3       32      1       1
3       467        1       0       3       47      1       1
3       390        1       1       3       183     2       0
3       105        2       1       3       115     1       0
3       164        2       0       3       93      1       0
3       120        1       0       3       80      2       1
3       677        2       1       3       64      1       0
3       168        2       0       3       74      2       0
3       16         2       0       3       157     1       0
3       625        1       0       3       48      1       0
3       273        1       1       3       63      2       1
3       76         1       1       3       113     1       0
3       363        2       1
;
run;

%CIF(data=bmt,time=Ftime, status=Status, group=Diagnosis, event=1, censored=0, strata=Gender, alpha=.05);

----------------------------------------------------------------------
References:
1. Marubini, E. and Valsecchi, M.G. (1995), Analysing survival data from clinical trials
   and observational studies, John Wiley.
2. Gray, R.J. (1988). &quot;A class of K-sample tests for comparing the cumulative incidence of
   a competing risk,&quot; Annals of statistics, 16(3), 1141--1154.
3. Klein, J.P. and Moeschberger, M.L., (2003), Survival analysis: techniques for censored
   and truncated data, Springer Verlag.</code></pre>
</div>
</div>
<div id="subdistribution-hazard-function" class="section level3" number="19.4.5">
<h3><span class="header-section-number">19.4.5</span> Subdistribution hazard function</h3>
<div id="introduction-18" class="section level4" number="19.4.5.1">
<h4><span class="header-section-number">19.4.5.1</span> Introduction</h4>
<p>Hazard function, <span class="math inline">\(h(t)]\)</span> The instantaneous strength of the probability that the observed individual surviving at this moment dies at <span class="math inline">\(t\)</span>, the formula is
<span class="math display">\[
h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t \leqslant T&lt;t+\Delta t \mid T \geqslant t)}{\Delta t}
\]</span>
If there is no competitive risk, the Cox proportional hazard model is
<span class="math display">\[
\log [\lambda(t)]=\log \left[\lambda_{0}(t)\right]+X \beta
\]</span>
Among them, <span class="math inline">\(\lambda(t)\)</span> is the net risk rate, and <span class="math inline">\(\lambda_{0}(t)\)</span> is the baseline risk function, that is, the risk function when the covariate vector is 0, which can be written as
<span class="math display">\[\lambda(t)=\lambda_{0}(t) \exp (\mathrm{X} \beta)\]</span></p>
<p>If there is a risk of competition, the <strong>condition of “censoring independence”</strong> is not met at this time, and there are two models:</p>
<ul>
<li>Subdistribution hazard function (CIF regression model, Fine-Gray model)
<ul>
<li>Represents the instantaneous probability intensity of the occurrence of the <span class="math inline">\(k\)</span> event of the observed individual without the <span class="math inline">\(k\)</span> event at the time <span class="math inline">\(t\)</span></li>
</ul></li>
<li>Cause-specific hazard
<ul>
<li>Represents the instantaneous probability intensity of the occurrence of the <span class="math inline">\(k\)</span> event of the observed individual without any event at the time <span class="math inline">\(t\)</span></li>
</ul></li>
</ul>
</div>
<div id="modeling-using-proc-phreg" class="section level4" number="19.4.5.2">
<h4><span class="header-section-number">19.4.5.2</span> Modeling using proc phreg</h4>
<p><span class="math display">\[\lambda_{K}^{S D}(t)=\lim _{\Delta t \rightarrow 0} \frac{P[t \leqslant T&lt;t+\Delta t, D=k \mid T&gt;t \cup(T&lt;t \cap K \neq k)]}{\Delta t}\]</span></p>
<pre><code>*** Mainly concerned about the outcome A corrected CIF, SD model;
proc phreg data＝cohort plots(overlay＝stratum)＝cif；
    model time*y(0)＝cov1~covn /eventcode ＝ 1 rl；
run；

*** Competitive risk event B corrected CIF, SD model;
proc phreg data＝cohort plots(overlay＝stratum)＝cif； 
    model time*y(0)＝cov1~covn /eventcode＝2 rl；
run；</code></pre>
</div>
<div id="finegray_sel" class="section level4" number="19.4.5.3">
<h4><span class="header-section-number">19.4.5.3</span> %FINEGRAY_SEL</h4>
<p>Conduct Backward Selection in Multivariable Competing Risk Analysis by Fine &amp; Gray Model</p>
<pre><code>%macro FINEGRAY_SEL(dsn=,  event=,  censor=,  event_code=1, var=,  cVar=, inc= 0, alpha=.2,
         type3=T, id=,  clnum=T, ORIENTATION = portrait, report =T, outpath=, filename=, debug=F) ;
     
   %local cnt cnt_ pos pos_ L1 L2 clist_ _cnt_ cvar_cnt i cnt_bef  cvar_ref cnt2 len2 cntw pos2 pos3 bef cnt_bef cvar_ nn;

   /* Capitalize */
    
    %let debug      = %UPCASE(&amp;debug);
    %let type3      = %UPCASE(&amp;type3);
    %let report     = %UPCASE(&amp;report);
    
   /* Macros for final variable lists */
   %global _finalvar _finalcvar;

  /* Save current options */
   PROC OPTSAVE out=_options;   RUN;

  /* Count number of variables in var */
    %let var_cnt = %sysfunc(countw(&amp;var,&#39; &#39;));



  /* It could be longer if there are interaction terms */
   %let length = 64; 


   /* Time Should not be missing value*/
   
   %if &amp;event = %STR()  %then %do;
      %put ERROR: EVENT should be specified.; 
      %goto exit;
   %end;



/*Check CVAR whether in the proper format, such as separate by * if reference level is specified*/
  /* Count number of class variables */

  %if %superq(cvar) = %str( ) %then %let cvar_cnt = 0;
  %if %superq(cvar) ~= %str( ) %then %do;
        
        %let cnt = %qsysfunc(countw(%superq(cvar),&#39;*&#39;));
        %let cnt_= %qsysfunc(countw(%superq(cvar),&#39; &#39;));

        %let pos=%qsysfunc(countc(%superq(cvar), &#39;(&#39; ));
        %let pos_ = %qsysfunc(countc(%superq(cvar), &#39;*&#39; ));

        %if %superq(pos) = 1 %then %do;
        %let L1=%qsysfunc(findc(%superq(cvar),  &#39;(&#39; ));
        %let L2=%qsysfunc(findc(%superq(cvar),  &#39;)&#39; ));
        %let clist_=%qsysfunc(SUBSTR(%superq(cvar), %superq(L1),%eval(%superq(L2) - %superq(L1) +1)));
        %let _cnt_ = %qsysfunc(countw(%superq(clist_),&#39; &#39;));
        %end;

        %if %superq(cnt) = 1 and  %superq(cnt_) = 1 %then %let cvar_cnt = 1;
        %else %if %superq(pos_) &gt; 0 %then %let cvar_cnt = %superq(cnt);
        %else %if %superq(pos_) = 0 and %superq(pos) = 0 %then %let cvar_cnt = %superq(cnt_);
        %else %if (%superq(pos) = 1 and %superq(pos_) = 0) and %superq(cnt_) = %superq(_cnt_) %then  %let cvar_cnt = 1;
        %else %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                   %goto exit; %end;

  %end;

/*Build up categorical variable list without reference level specified*/
  %let cvarlist =; 

  %if &amp;cvar_cnt = 1 and &amp;pos = 1 %then %let cvarlist = %sysfunc(SUBSTR(%superq(cvar), 1,%eval(&amp;L1-1)));
  %else %if &amp;cvar_cnt = 1 and &amp;pos = 0 %then %let cvarlist = %superq(cvar);
  %if &amp;cvar_cnt &gt; 1  and %superq(pos_) = 0 %then  %let cvarlist = %superq(cvar) ; 

  %if &amp;cvar_cnt &gt; 1  and %superq(pos_) &gt; 0 %then %do; 
            
      %do i = 1 %to &amp;cvar_cnt; 

                %let cvar_ref = %SCAN(&amp;cvar, &amp;i, &#39;*&#39;); 

                %let cnt2=%qsysfunc(countc(&amp;cvar_ref, &#39;(&#39; ));
                
                %let len2=%LENGTH(&amp;cvar_ref);
                %let cntw=%qsysfunc(countw(&amp;cvar_ref,&#39; &#39;));

                /*%put cvar_ref = &amp;cvar_ref cnt2= &amp;cnt2  len2=&amp;len2 cntw =&amp;cntw ;*/

                %if %superq(cnt2) = 1 %then %do;

                    %let pos2=%sysfunc(findc(&amp;cvar_ref, &#39;(&#39; ));
                    %let pos3=%sysfunc(findc(&amp;cvar_ref, &#39;)&#39; ));

                    %let bef = %sysfunc(SUBSTR(&amp;cvar_ref, 1,%eval(&amp;pos2-1)));
                    %let cnt_bef = %qsysfunc(countw(&amp;bef,&#39; &#39;));

                    %if %superq(cnt_bef) = 1 and  %superq(pos3) = %superq(len2) %then %let cvar_=&amp;bef;
                    %else %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                                %goto exit;%end;
                    %end;
                    
                %if %superq(cnt2) = 0 and %superq(cntw) = 1 %then %LET cvar_ = &amp;cvar_ref;

                %if %superq(cnt2) &gt; 1 or ( %superq(cntw) &gt; 1 and %superq(cnt2) = 0) %then %do; %put ERROR: The categorical variables in CVAR should be separated by * if you specify the reference level.; 
                %goto exit;  %end;   

            %let cvarlist = %superq(cvarlist) %superq(cvar_); 
 %end;
         
 %end;

 /* Make sure that CVAR are either in VAR or FORCEINVAR*/
 %put &amp;var   ;
 %put &amp;cvarlist;

   %do i = 1 %to &amp;cvar_cnt;
        %let _check_ = 1;
     %do j = 1 %to &amp;var_cnt;
         %if %upcase(%SCAN(&amp;var, &amp;j)) = %upcase(%SCAN(&amp;cvarlist, &amp;i)) %then %let _check_ = 0;;
     %end;
   %end;

   %if &amp;_check_ = 1 %then %do; 
   %put ERROR: The varaible appears in CVAR should also be in VAR.; 
   %goto exit;  %end;


  /* Check for variable names that are longer than the default and increase length as needed */
   %DO i = 1 %to &amp;cvar_cnt; 
      %IF %LENGTH(%SCAN(&amp;var, &amp;i,&#39; &#39;)) &gt; &amp;length %then %let length = %LENGTH(%SCAN(&amp;var, &amp;i,&#39; &#39;);
   %END;


   /*Fine&amp;Gray model with backwards elimination */ 

   %let remlist =;

  %do %while (&amp;var_cnt &gt; 0);

    %if &amp;cvar_cnt &gt; 0 %then %let  cvar_ref = %sysfunc(tranwrd(%superq(cvar),*,%str()));
    
   ods select none;
   ODS OUTPUT  NObs = numobs ClassLevelFreq =clfreq ParameterEstimates = MLEC ModelInfo=modelinf ModelANOVA = type3  ;
   proc phreg data=&amp;dsn simple namelen=&amp;length %if &amp;id ~= %STR() %then %do; COVS(AGGREGATE) %end;;
        %if &amp;cvar_cnt &gt; 0 %then %do; 
        class &amp;cvar_ref /order=internal param=glm;%end;
        model &amp;event*&amp;censor(0) = &amp;var / eventcode=&amp;event_code rl;
        %if &amp;id ~= %STR() %then %do;
            id &amp;id;
         %end;
    run;
    ods select all;

    /*Identifiy next candidate to be removed*/

     proc sql noprint; select count(*) into :nn from type3; quit;

     %if &amp;nn = &amp;inc %then %goto exit2;
     %else %do;

    * in Type3 data remove variables that should not be fixed in model;
        Data typ3_n; set type3; if _N_ &gt; &amp;inc;run;
    * for the rest variables, see which one has the largest p value and compare it to alpha; 

     proc sql noprint; 
        select Effect into: var_ separated by &#39; &#39; from typ3_n ;quit; * keep the original order;

     proc sort data=typ3_n; by desending ProbChiSq;run;
     proc sql noprint;
       select ProbChiSq into: rplist separated by &#39; &#39; from typ3_n ;
       select Effect into: rvlist separated by &#39; &#39; from typ3_n ;
     quit;


    %let premove_p = %scan(&amp;rplist,1, &#39; &#39;); 
    %let premove = %scan(&amp;rvlist,1, &#39; &#39;);

    %put &amp;premove_p &amp;premove;

    * if the current largest pvalue is less than alpha, then stop, else update &amp;var and &amp;cvar;
    %if &amp;premove_p &lt; &amp;alpha %then %goto exit2;

    %else %do;
         %let remlist = &amp;remlist &amp;premove;
         /* update &amp;var list and keep the same input order;*/
         %let var = %sysfunc(tranwrd(%upcase(&amp;var),%upcase(&amp;premove),%str())); 

         /* update &amp;cvar;*/
         %if &amp;cvar_cnt &gt;  0 %then %do;* update &amp;cvar;

            %let pos_=%qsysfunc(findc(%superq(cvar), &#39;*&#39; ));
            

            %let newcvar = ;
            %do i = 1 %to &amp;cvar_cnt;
/*              %put pos_ = &amp;pos_ cvar= &amp;cvar;*/
                %if &amp;pos_ &gt; 0 or &amp;cvar_cnt = 1 %then %let scanvar = %SCAN(&amp;cvar, &amp;i, &#39;*&#39;);
                %else %let scanvar = %SCAN(&amp;cvar, &amp;i, &#39; &#39;);

                %let pos = %qsysfunc(findc(%superq(scanvar), &#39;(&#39; ));

                %if &amp;pos &gt; 0 %then %let trimvar=%qsysfunc(SUBSTR(%superq(scanvar), 1,%eval(&amp;pos-1)));
                %else %let trimvar = &amp;scanvar;

/*              %put trimvar = &amp;trimvar scanvar=&amp;scanvar premove=&amp;premove;*/

                %if %upcase(&amp;trimvar) = %upcase(&amp;premove) %then %let newcvar = &amp;newcvar; 
                %else  %let newcvar = &amp;newcvar*&amp;scanvar; 

            %end;
            %let cvar = &amp;newcvar;
         %end;
    %end;

    %let var_cnt = %sysfunc(countw(&amp;var,&#39; &#39;)); * update number of variable in &amp;var; 
    %let cvar_cnt = %sysfunc(countw(&amp;cvar,&#39;*&#39;));  * update number of variable in &amp;cvar; 

%end;/*%do %if (&amp;var_cnt &gt; 0);*/

   /* Save in macro variables */
   %let _finalvar = &amp;var;
   %let _finalcvar = &amp;cvar;

%end; /*end of   %if &amp;nn = &amp;inc %then %goto exit2;  %else %do;*/

%exit2:

/* Produce report of final model */
   %if &amp;report = T %then %do;
      %let forceInVar = .;
      %if &amp;inc &gt;0 %then %do;

        Data typ3_n; set type3; if _N_ &lt;= &amp;inc;run;
        proc sql noprint;
        select Effect into :inforcevar separated by &#39; &#39;
        from Typ3_n;

        PROC CONTENTS DATA = &amp;dsn (keep=&amp;inforcevar) out=cont noprint; RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :inLab separated by &#39;, &#39;
             from cont;
         QUIT;
         %end;
         %else %let inLab = None;

         
      /* If any variables were removed from the model create a list */
      %if &amp;remlist ~= %STR() %then %do;
         /* Get variable labels for footnote */
         PROC CONTENTS DATA = &amp;dsn (keep=&amp;remlist) out=cont noprint;
         RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :remLab separated by &#39;, &#39;
             from cont;
         QUIT;

           %let foottext = The following variables were forced in the model: &amp;inLab . The following variables were removed from the model: &amp;remLab..;

      %end;
      %else %let foottext = The following variables were forced in the model: &amp;inLab . No variables were removed from the model.;

      %MULTIPLE_PHREG(        
          OUTPATH = &amp;outpath, 
          FNAME = &amp;filename,
          ORIENTATION = &amp;ORIENTATION,
          clnum=&amp;clnum,
          TYPE3 = &amp;type3,
          debug= &amp;debug,
          FOOTNOTE=&quot;** Backward selection with an alpha level of removal of &amp;alpha was used.  &amp;foottext&quot;
        );

  %end;


   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
           delete %if cvar ~= %STR() %then %do; freq  %end; mergedata mlec modelinf numobs type3 typ3_n keptlist Cont
                  result1 result2 result2_ result3 Ori_list Removed _options _cont ;
       quit;
    %end;
   
/* Final variables selected (get rid of double spaces */
   %put Categorical variables selected: &amp;_finalcvar;
   %put All variables selected: &amp;_finalvar;

%exit:
%mend finegray_sel;


proc format;
value DiseaseGroup 1=&#39;ALL&#39; 2=&#39;AML-Low Risk&#39; 3=&#39;AML-High Risk&#39;;
value sex 0= &#39;F&#39; 1=&#39;M&#39;;
run;
data bmt;
  input Group T Status WaitTime @@;
  logWaittime=log(WaitTime);
  label T = &#39; disease-free survival time (days)&#39; ;
datalines;
1 2081 0 98 1 1602 0 1720 1 1496 0 127  1 1462 0 168
1 1433 0 93 1 1377 0 2187 1 1330 0 1006 1 996  0 1319
1 226  0 208 1 1199 0 174  1 1111 0 236  1 530  0  151 
1 1182 0 203 1 1167 0 191 1 418 2 110 1 383 1 824
1 276  2 146 1 104 1 85   1 609 1 187  1 172 2 129
1 487 2 128  1 662 1 84   1 194 2 329 1 230 1 147 
1 526 2 943 1 122 2 2616  1 129 1 937 1 74 1 303
1 122 1 170 1 86 2 239    1 466 2 508 1 192 1 74
1 109 1 393 1 55 1 331    1   1 2 196 1 107 2 178
1 110 1 361 1 332 2 834   2 2569 0 270 2 2506 0 60
2 2409 0 120 2 2218 0 60 2 1857 0 90 2 1829 0 210
2 1562 0 90 2 1470 0 240 2 1363 0 90 2 1030 0 210
2 860 0 180 2 1258 0 180 2 2246 0 105 2 1870 0 225
2 1799 0 120 2 1709 0 90 2 1674 0 60 2 1568 0 90
2 1527 0 450 2 1324 0 75 2 957 0 90 2 932 0 60
2 847 0 75 2 848 0 180 2 1850 0 180 2 1843 0 270
2 1535 0 180 2 1447 0 150 2 1384 0 120 2 414 2 120
2 2204 2 60 2 1063 2 270 2 481 2 90 2 105 2 120
2 641 2 90 2 390 2 120 2 288 2 90 2 421 1 90
2 79 2 90 2 748 1 60 2 486 1 120 2 48 2 150
2 272 1 120 2 1074 2 150 2 381 1 120 2 10 2 240
2 53 2 180 2 80 2 150 2 35 2 150 2 248 1 30
2 704 2 105 2 211 1 90 2 219 1 120 2 606 1 210
3 2640 0 750 3 2430 0 24 3 2252 0 120 3 2140 0 210
3 2133 0 240 3 1238 0 240 3 1631 0 690 3 2024 0 105
3 1345 0 120 3 1136 0 900 3 845 0 210 3 422 1 210
3 162 2 300 3 84 1 105 3 100 1 210 3 2 2 75
3 47 1 90 3 242 1 180 3 456 1 630 3 268 1 180
3 318 2 300 3 32 1 90 3 467 1 120 3 47 1 135
3 390 1 210 3 183 2 120 3 105 2 150 3 115 1 270
3 164 2 285 3 93 1 240 3 120 1 510 3 80 2 780
3 677 2 150 3 64 1 180 3 168 2 150 3 74 2 750
3 16 2 180 3 157 1 180 3 625 1 150 3 48 1 210
3 273 1 240 3 63 2 360 3 76 1 330 3 113 1 240
3 363 2 180
;
run;


data bmt;
  set bmt;
  call streaminit(123);      
  u = rand(&quot;Uniform&quot;);      
  output;
run;

data bmt;
  set bmt;
   if u&gt;=0.7 then sex=1; else if u&lt;0.5 then sex=0;
   if u&gt;=0.4 then race=&#39;white&#39;; else race=&#39;AA&#39;;
   Dftime= t / 365.25;
   
   label sex = &#39;gender&#39;
         group = &#39;patient group&#39;
    ;
 format Group DiseaseGroup. SEX SEX.;
run;

*** %include &quot;C:\Users\gcpdmpc3\Desktop\ZBA\MULTIPLE_PHREG V21.sas&quot;;
*** %let dir = H:\Chao_paper_2019124\Informative_censoring\output;
%include &quot;/home/zehuibai24885190/CIF/MULTIPLE_PHREG V21.sas&quot;;
%let dir = /home/zehuibai24885190/CIF;

Title &quot;Table 3 Multivariate Survival Analysis for Fine and Gray�s Model&quot;;
%finegray_sel (dsn=bmt,  
       event=t,    
       censor=Status,  
       var= race Group  logWaitTime sex  , 
       cVar= Group(desc)*  race *sex,
       event_code=1,
       inc = 1,
       alpha=0.2,
       Type3=t,
       debug=F,
       outpath =  &amp;dir.\ ,
       filename = Multivariable Fine and Gray) ;
Title;</code></pre>
</div>
<div id="multiple_phreg" class="section level4" number="19.4.5.4">
<h4><span class="header-section-number">19.4.5.4</span> %MULTIPLE_PHREG</h4>
<pre><code>/**********************************************************************************************
***********************************************************************************************
Macro Name: MULTIPLE_PHREG
Created Date/Author: Feb. 2012/Yuan Liu
Last Update Date/Person: Oct, 2016/ Yaqi Jia
Current Version: V21
Working Environment: SAS 9.3 English version

Contact: Dr. Yuan Liu yliu31@emory.edu

Purpose:  To produce a summary table from a multivariable survival model, but the macro itself 
does not do statistical modeling automatically.  

Notes: The macro only helps to generate a nice summary table, and cannot be used for 
statistical modeling.  The modeling must be conducted using PROC PHREG before calling this 
macro.  Several tables must be created using ODS OUTPUT when running PROC PHREG (nNObs = numobs 
ParameterEstimates = MLEC ModelInfo=modelinf SliceDiffs = slices_diff(only for interaction model)
Type3 = type3). The option RL must also be used in the model statement and option PARAM= GLM in 
class statement. Variable names must not be more than 20 characters.  This macro can be set up to 
handle models including interaction terms, and in the model fitting step, use SLICE statement to specify 
how the stratified analysis to be conducted and use ods output SliceDiffs = slices_diff.   

Parameters: 

OUTPATH        Path for output table to be stored.
FNAME          File name for output table.
FOOTNOTE       Text of footnote to include in the table (optional).  It should be in quotes.  This 
               footnote will appear below the footnote containing the number of observations.  
               Leave this field blank if not including an additional footnote.
FOOTNOTE2      Text of second footnote to include in the table (optional).  It should be in quotes.  
               This footnote will appear below all other footnotes.  Leave this field blank if not
               including an additional footnote.   
TYPE3          Set to F to suppress type III p-values from being reported in the table (optional).
               The default value is T.
CLNUM          Set to T if you want to see the number of observations for each level of covariates. The default is T.
EFFECT         If not empty, then the model contains a two-way interaction. It is used to specify
               the treatment effect in the interaction.
SLICEBY        Use in combine with EFFECT to specify the stratified variable in the interaction.
SHORTREPORT    Use in combine with EFFECT and SLICEBY when there is an interaction in the model and set
               to T to only report the stratified treatment effect. 
ORIENTATION    orientation of the output Word table. Default is portrait, can be changed to landscape.
DEBUG          Set to T if running in debug mode (optional).  Work datasets will not be deleted in
               debug mode.  This is useful if you are editing the code or want to further 
               manipulate the resulting data sets.  The default value is F.

***********************************************************************************************
For more details, please see the related documentation
**********************************************************************************************/

%macro MULTIPLE_PHREG(OUTPATH=, FNAME =, FOOTNOTE=, FOOTNOTE2=, TYPE3=T, EFFECT=,SLICEBY=,CLNUM=T,STRATA=, shortreport=T,
ORIENTATION = portrait, DEBUG=F);

   %local FOOTNOTE FOOTNOTE2 NUMREAD NUMUSED OUTPATH DSN EVENT VAR CLASSEXIST N CONTRAST
     EVENTVV CLIST TYPE3 FNAME DEBUG;

   /* Upper case */
   %let type3 = %UPCASE(&amp;type3);
   %let debug = %UPCASE(&amp;debug);
   %let strata = %UPCASE(&amp;strata);

   /* Save current options */
   PROC OPTSAVE out=_options;
   RUN;

   /* Get data set name and outcome name */
   PROC SQL noprint;
      select cvalue into :dsn
      from modelinf
      where description = &#39;Data Set&#39;;
      select cvalue into :event
      from modelinf
      where description = &#39;Dependent Variable&#39;;
   QUIT;

   /* Get outcome label */
   data _NULL_; 
      set &amp;dsn (obs=1); 
      call symput(&#39;eventvv&#39;, VLABEL(&amp;event));
   run;

      /* Get variable labels */
   PROC CONTENTS DATA = &amp;dsn out=_cont (rename=(name=parameter)) noprint;
   RUN;


   /* Check to see if class variables were used - s/b classval0 variable */
   data _null_;
      dsid=open(&#39;mlec&#39;);
      check=varnum(dsid,&#39;classval0&#39;);
      /* 0 = does not exist, 1 = exists */
      exist = MIN(check, 1);
      CALL SYMPUT(&#39;classExist&#39;,PUT(exist,1.));
   run;

   /* If class variables were used */
   /* Don&#39;t include interaction terms in categorical list */
   %if &amp;classexist = 1 %then %do;
      /* Create list of class variables */
      PROC SQL noprint;
         select distinct Parameter into :clist separated by &#39; &#39; 
         from mlec
         where MISSING(classval0) = 0 and INDEX(parameter,&#39;*&#39;) = 0 ;
      QUIT;
   %end;
   %else %let clist =;
   
   %put &amp;clist;

   proc sql noprint;
      select NObsRead into :numread  from numobs; 
      select NObsUsed into :numused from numobs; 
   quit;

   %put &amp;numread &amp;numused;

   DATA mlec;
      set mlec;
      /* Save order */
      Num= _N_;
   RUN;

   %IF &amp;CLIST NE %THEN %DO; 
     
       /*Merge mlec and clfreq*/

        /*prepare to be sorted. there is missing value in class variable in clfreq, so need below data step*/
       data clfreq; 
       length parameter $256.;
       retain parameter;
       set clfreq;
       if class ~= &#39; &#39; then parameter=class;
       else class=parameter;
       keep parameter class value freq;
       run;

       proc sort data=clfreq; by parameter value;run;
       proc sort data=mlec;  by parameter classval0;run;

         %if &amp;strata ~= %str() %then %do; /*when the strata statement used in the model, the sample size is generated by strata, reduce it to total samples through strata*/
              ods select none;
              ods output Summary=sums_(rename=(freq_Sum=Freq));
              proc means data=clfreq sum;
              var Freq; by parameter Value;
              run; ods select all; 

              data clfreq; set sums_;run;
         %end;

       data mg;
         length parameter $256. level $256.;
         merge mlec(in=a rename=(classval0=level)) clfreq(in=b rename=(value=level));
         by parameter level;
         if a;
         drop label; /*avoid conflict with label variable in lab data set produced by proc contents below*/
       run;
        
        /*Merge mg with label data set produced by proc contents*/
        ods select none;
        ods output variables=lab;
        proc contents data= &amp;dsn ;run;
        ods select all;
        
        proc sort data=lab;by variable;run;
        proc sort data=mg;  by parameter;run;

        data mglab;
          merge mg (in=a) lab (in=b rename=(variable=parameter) keep=variable label);
          by parameter;
          if a;
        run;
       
       /*Merge type3 and mg*/
       data type3;
           length effect $100;
           set type3; 
           order=_n_; 
           rename ProbChiSq = p_type3 effect=parameter; 
           format ProbChiSq;
           keep effect ProbChiSq order;
      run;

       proc sort data=type3;by parameter;run;
       proc sort data=mglab;by parameter;run;

      data mergedata;
           length parameter $256. level $256. plabel $256. n $120.;
           merge mglab type3;
           by parameter;
           n=put(freq,8.);
           plabel=label;
           if label = &quot;&quot; and plabel = &quot;&quot; then plabel = parameter;
           format ProbChiSq;
           if n=. then n=&quot;&amp;numused&quot;;

           /* If coding was ref then reference parameters will not have been in the original */
         /* parameter estimates file and will have missing num - Make sure they are ordered */
           /* as the last category for a variable */
           if num = . then num = 1000;
      run;

       proc sort data=mergedata;
         by order num;
      run; 

   %END;

   %ELSE %DO;

      /* Check to see if label variable exists (it won&#39;t exist if none of the model vars have */
      /* labels */
      data _null_;
         dsid=open(&#39;mlec&#39;);
         check=varnum(dsid,&#39;label&#39;);
           /* 0 = does not exist, 1 = exists */
           exist = MIN(check, 1);
         CALL SYMPUT(&#39;labexist&#39;,PUT(exist,1.));
      run;

      data mergedata;
         length plabel $256;
         set mlec;
         Level = &quot;&quot;;
         p_type3 = ProbChiSq;

         /* If there are no labels use var names */
         %if &amp;labexist ~= 0 %then %do; 
            if label ~= &#39; &#39; then plabel = label; 
               else plabel = parameter;
         %end;
         %else %do;
            plabel = Parameter;
         %end;

         format p_type3 ProbChiSq;
      run;

   %END;

 

   /* If reporting contrasts as well */
  %if &amp;effect ~=%str() %then %do;

        /*Extract variable name,label and length*/
       %let cfivar=%sysfunc(countw(&amp;_finalvar,&#39; &#39;));
        %put finalvar=&amp;_finalvar;
        %put number of final var=&amp;cfivar; 
        data frequency;
          set &amp;dsn;
          %do i=4 %to &amp;cfivar;
          if missing(%scan(&amp;_finalvar,&amp;i,&#39; &#39;))=0;
          %end;

          %if &amp;event ~= %STR() %then %do;
            where &amp;event &gt;= 0 and missing(&amp;censor)=0;
          %end;

          %else %do;
            where &amp;stop &gt;= &amp;start and missing (&amp;start)=0 and missing(&amp;stop)=0 and missing(&amp;censor)=0;
          %end;
        run;
        
        ods output list=freq_;
        proc freq data=frequency;
           tables &amp;sliceby*&amp;effect/list;
        run;

        Data freq;
          length slice $256. effect $256.;
          set freq_;
          sliceby=vvalue(&amp;sliceby);
          effect=vvalue(&amp;effect);
          keep sliceby effect frequency;
        run;

      /*extract effect and slicby values from data to prepare for the merge with freq*/ 
        data slices_diff;
          length effect $256. _effect $256. slice $256.;
          set slices_diff;
          effect=vvalue(&amp;effect);
          _effect=vvalue(_&amp;effect);
          sliceby=vvalue(slice);
          rank=_n_;/*save original order*/
        run;
       
      /* get the number of observations used for &amp;effect */
        proc sort data=slices_diff; by effect sliceby ;run;
        proc sort data=freq; by effect sliceby;run;

        data merge_1;
           merge freq (in=a rename=(frequency=obsused1)) slices_diff(in=b);
           by effect;
           if b;
        run;

       /* get the number of observations used for _&amp;effect*/
       proc sort data=slices_diff nodupkey; by _effect sliceby;run;

       data merge_2;
          merge freq (in=a rename=(effect=_effect frequency=obsused2)) slices_diff (in=b);
          by _effect;
          if b;
          keep sliceby _effect obsused2;
       run;

       proc sort data=merge_1;by _effect sliceby;run;
       proc sort data=merge_2;by _effect sliceby;run;
       data merge_12;
         merge merge_1(in=a) merge_2 (in=b);
         by _effect sliceby;
         if a;
       run;

       
      DATA merge12;
        length plabel $256. level $256. n $120.; 
        set merge_12;
        plabel = tranwrd(sliceby,scan(sliceby,1), &quot;&quot;);
        level=cat(strip(effect),&quot; vs. &quot;,strip(_effect));
        n=cat(strip(obsused1),&quot; vs. &quot;,strip(obsused2));
        HazardRatio = ExpEstimate;
        HRLowerCL = LowerExp;
        HRUpperCL = UpperExp;
        ProbChiSq = Probz;
      Run;
    
       /* put data in original order*/
        proc sort data=merge12;by rank;run;

      /* extract type3 p-value as interaction p-value from type3 data set*/
      
      Data _null_; /* get the label of sliceby variable*/
         set &amp;dsn (obs=1);
         call symput (&#39;slicebylabel&#39;,vlabel(&amp;sliceby));
         call symput (&#39;effectlabel&#39;,vlabel(&amp;effect));
      run;

      Data _type3;
         length plabel $256 level $256.;
         set type3;
         plabel = &quot;Comparisons Stratified by &amp;Slicebylabel :&quot;;
         level=&quot;&amp;effectlabel :&quot;;
         where index(parameter,&#39;*&#39;) ~=0;
         keep parameter plabel level p_type3;
      run;
      
      /* Combine Type3 data set and Hazardratio data set*/
      DATA _contrast;
         set _type3 merge12;
         keep plabel level n HazardRatio HRLowerCL HRUpperCL probchisq p_type3;
      RUN;

      %if &amp;shortreport = T %then %do;

         %let upeffect=%upcase(&amp;effect); /* delete &amp;effect &amp;sliceby and &amp;effect*&amp;sliceby variables in above data set*/
         %let upsliceby=%upcase(&amp;sliceby);

          DATA conlab;
          set mergedata; 
          if upcase(parameter) not in (&quot;&amp;upeffect&quot;  &quot;&amp;upsliceby&quot; &quot;&amp;upeffect*&amp;upsliceby&quot; );
          RUN;

          %let conlab= None;
          proc sql noprint;
            select distinct(plabel) into: conlab separated by &#39;, &#39; from conlab;
          quit;
        
        Data mergedata;
          set _contrast;run; 
       %end;

       %else %do;
          %let upeffect=%upcase(&amp;effect); /* delete &amp;effect &amp;sliceby and &amp;effect*&amp;sliceby variables in above data set*/
          %let upsliceby=%upcase(&amp;sliceby);
          DATA mergedata;
          set mergedata _contrast; 
          if upcase(parameter) not in (&quot;&amp;upeffect&quot;  &quot;&amp;upsliceby&quot; &quot;&amp;upeffect*&amp;upsliceby&quot; );
          RUN;
       %end;

   %end;

   DATA mergedata;
      set mergedata;
      /* HR and 95% CI */
      if HazardRatio ~= . then HR = TRIM(LEFT(PUT(HazardRatio,8.2))) || &quot; (&quot; || 
         TRIM(LEFT(PUT(HRLowerCL,8.2))) || &quot;-&quot; || 
         TRIM(LEFT(PUT(HRUpperCL,8.2))) || &quot;)&quot;;
      else HR = &#39;-&#39;;
      /* Number of observations read and used - save in data set */
      numused = &amp;numused;
      numread = &amp;numread;
   RUN;

   *---- table template -----;  
   ODS PATH WORK.TEMPLAT(UPDATE) SASUSR.TEMPLAT(UPDATE) SASHELP.TMPLMST(READ);

   PROC TEMPLATE;
      DEFINE STYLE STYLES.TABLES;
      NOTES &quot;MY TABLE STYLE&quot;; 
      PARENT=STYLES.MINIMAL;

       STYLE SYSTEMTITLE /FONT_SIZE = 12pt   FONT_FACE = &quot;TIMES NEW ROMAN&quot;;

       STYLE HEADER /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
            CELLPADDING=8
            JUST=C
            VJUST=C
            FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD; 

     STYLE TABLE /
            FRAME=HSIDES            /* outside borders: void, box, above/below, vsides/hsides, lhs/rhs */
           RULES=GROUP              /* internal borders: none, all, cols, rows, groups */
           CELLPADDING=6            /* the space between table cell contents and the cell border */
            CELLSPACING=6           /* the space between table cells, allows background to show */
            JUST=C
            FONT_SIZE = 10pt
           BORDERWIDTH = 0.5pt;  /* the width of the borders and rules */

     STYLE DATAEMPHASIS /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
           FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD;

     STYLE DATA /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot; 
           FONT_SIZE = 10pt;

     STYLE SYSTEMFOOTER /FONT_SIZE = 9pt FONT_FACE = &quot;TIMES NEW ROMAN&quot; JUST=C;
END;

RUN; 



   **** PRINT THE TABLE ************;
   OPTIONS ORIENTATION=&amp;ORIENTATION MISSING = &quot;-&quot; NODATE;
   ODS rtf STYLE=TABLES file= &quot;&amp;OUTPATH.&amp;FNAME &amp;SYSDATE..DOC&quot;; 

   PROC REPORT DATA=mergedata HEADLINE HEADSKIP CENTER STYLE(REPORT)={JUST=CENTER} SPLIT=&#39;~&#39; 
     nowd SPANROWS lS=256; 
      COLUMN plabel  Level %if &amp;clnum=T %then %do;n %end;(&quot;&amp;eventvv&quot; &#39;------------------------------------------&#39;
          (HR  ProbChiSq  %if &amp;type3 = T %then %do; p_type3 %end;)); 
      DEFINE plabel/order order=data &quot;Covariate&quot;  STYLE(COLUMN) = {JUST = L CellWidth=25%}; 
      DEFINE Level/DISPLAY &quot;Level&quot; STYLE(COLUMN) = {JUST =L CellWidth=20%}; 
      %if &amp;clnum=T %then %do;
      DEFINE n/display &quot;N&quot; style(column)={just=C cellwidth=10%};
      %end;
      %if &amp;type3 = T %then %do; 
      DEFINE p_type3/order MISSING &quot;Type3 P-value&quot; STYLE(COLUMN) = {JUST=C CellWidth=8%} 
               FORMAT=PVALUE8.3; 
       %end;
      DEFINE HR/DISPLAY &quot;Hazard Ratio (95% CI)&quot; STYLE(COLUMN) = {JUST = C CellWidth=15%}; 
      DEFINE ProbChiSq/DISPLAY &quot;HR P-value&quot; STYLE(COLUMN) = {JUST = C CellWidth=8%} FORMAT=PVALUE8.3; 

      COMPUTE ProbChiSq; 
         IF . &lt; ProbChiSq &lt;0.05 THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         *if plabel = &quot;Stratified Comparisons by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[COLOR=WHITE]&quot;);
      ENDCOMP; 

       %if &amp;effect ~= %str() %then %do;
       COMPUTE plabel;
          if plabel = &quot;Comparisons Stratified by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;plabel&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;);  
       ENDCOMP;

       COMPUTE level;
          if level = &quot;&amp;effectlabel :&quot; THEN CALL DEFINE(&quot;level&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;);  
       ENDCOMP;
       %end;
       /*COMPUTE HR;
          if plabel = &quot;Stratified Comparisons by &amp;Slicebylabel :&quot; THEN CALL DEFINE(&quot;HR&quot;, &quot;STYLE&quot;, &quot;STYLE=[COLOR=WHITE]&quot;);
       ENDCOMP;*/

       %if &amp;type3 = T %then %do;
         COMPUTE p_type3; 
            IF . &lt; p_type3 &lt;0.05 THEN CALL DEFINE(&quot;p_type3&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         ENDCOMP;   
       %end;

       compute after plabel; line &#39;&#39;;   endcomp;  

       compute after _page_;
         length text1 - text2 $512.;
         text1 = &quot;*  Number of observations in the original data set = %TRIM(&amp;numread). Number of observations used = %TRIM(&amp;numused).&quot;;
         line @0 text1 $512.;

           %if &amp;footnote ~= %STR() %then %do;
              line @0 &amp;footnote;
           %end;
           %if &amp;footnote2 ~= %STR() %then %do;
              line @0 &amp;footnote2;
           %end;
           %if &amp;effect ~=%str() and &amp;shortreport = T %then %do;
            line @0 &quot;*** The estimated stratified treatement effect was controlled by: &amp;conlab&quot;;
           %end;
      ENDCOMP;
 
   RUN;

   ods rtf close;

   /* Reload original options that were in use before running the macro */
   PROC OPTLOAD data=_options;
   RUN;

   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
          delete mergedata _options _cont %if &amp;CLIST ~= %STR() %then %do; clfreq lab mglab freq mg type3 Sums_ %end;
          %if &amp;effect ~= %str() %then %do;freq freq_ frequency slices_diff _contrast _temp merge_1 merge_2 merge_12 merge12 _type3 %end;
          %if &amp;shortreport = T %then %do; conlab %end;;

      quit;    
   %end;

%mend;</code></pre>
</div>
</div>
<div id="cause-specific-hazard-function" class="section level3" number="19.4.6">
<h3><span class="header-section-number">19.4.6</span> Cause-specific hazard function</h3>
<div id="modeling-using-proc-phreg-1" class="section level4" number="19.4.6.1">
<h4><span class="header-section-number">19.4.6.1</span> Modeling using proc phreg</h4>
<p>CS represents the instantaneous probability intensity of the occurrence of the <span class="math inline">\(k\)</span> event of the observed individual without any event at the time <span class="math inline">\(t\)</span>.
In words, It is a conditional probability that a subject with covariates <span class="math inline">\(x\)</span> dies in the interval <span class="math inline">\([t, t+d t]\)</span> and the event of interest is jth cause, given that the subject was alive just before time t.</p>
<p><span class="math display">\[\lambda_{K}^{C s}(t)=\lim _{\Delta i \rightarrow 0} \frac{P(t \leqslant T&lt;t+\Delta t, D=k \mid T \geqslant t)}{\Delta t}\]</span></p>
<p>The principal estimable quantity in competing risks is the causespecific hazard function <span class="math inline">\(\lambda_{\mathrm{k}}(\mathrm{t})\)</span>, which can heuristically be thought of as a probability of failure specifically resulting from cause <span class="math inline">\(\mathrm{k}\)</span> in a small interval of time, given that no failure of any kind has occurred thus far. The overall hazard <span class="math inline">\(\lambda(\mathrm{t})\)</span> for any type of failure at time <span class="math inline">\(\mathrm{t}\)</span> is the sum of the cause-specific hazards <span class="math inline">\(\lambda_{\mathrm{k}}(\mathrm{t})\)</span>. The cumulative causespecific hazard function <span class="math inline">\(\Lambda{\mathrm{k}}(\mathrm{t})\)</span> or cumulative hazard function <span class="math inline">\(\Lambda(\mathrm{t})\)</span> equals the value of its corresponding hazard function summed up to time <span class="math inline">\(t\)</span>. Note that the cumulative hazard function is uniquely related to the familiar survival function (probability of survival past time <span class="math inline">\(t\)</span> ) via <span class="math inline">\(S(t)=\exp (-\Lambda(t)).\)</span> However, <span class="math inline">\(\exp \left(-\Lambda_{\mathrm{k}}(\mathrm{t})\right)\)</span> is in general not interpretable as the survival function for cause <span class="math inline">\(\mathrm{k}\)</span> alone unless additional assumptions are made that cannot be verified in competing risks data.</p>
<pre><code>*** competing events censored;
proc phreg data＝cohort zph；
    * class cov1(order=internal ref=&#39;3&#39;);
    model time*Status(0，2)＝cov1~covn /ties＝efron rl；
    assess ph/resample seed＝1234；
run；

*** Effect of competing events;
proc phreg data＝cohort zph； 
    model time*Status(0，1)＝cov1~covn /ties＝efron rl；
    assess ph/resample seed＝1234；
run；</code></pre>
</div>
<div id="cause_specific_sel" class="section level4" number="19.4.6.2">
<h4><span class="header-section-number">19.4.6.2</span> %Cause_Specific_SEL</h4>
<p>To conduct multivariate backward selection Cause-Specific Hazard model on competing risk survival data. For a particular cause of interest, we treat all the competing events as censored observations in the analysis. The risk set at each time includes only those subjects who have not failed from competing events or are truly censored.</p>
<pre><code>/***************************************************************************************************
****************************************************************************************************;
Macro Name: CauseSpecific_Sel
Created Date/Author/Contact: Jan 2019/  Chao Zhang,  Yuan Liu, and Yaqi Jia
Current Version: V1
Working Environment: SAS 9.4 English version  

Contact Information: chao.zhang2@emory.edu

Purpose:  :  To conduct multivariate backward selection Cause-Specific Hazard model on competing risk
survival data. For a particular cause of interest, we treat all the competing events as censored 
observations in the analysis.  The risk set at each time includes only those subjects who have not 
failed from competing events or are truly censored.    


References:
    1 SAS Institute Inc, 2017 SAS/STAT� 14.3 User�s Guide. Cary, NC: SAS Institute Inc. User�s Guide the Phreg Procedure.
    2 Changbin Guo and Ying So (2018), Cause-Specific Analysis of Competing Risks Using the Phreg Procedure. SAS2159-2018 SAS Institute Inc.
    3 PHREG_SEL V23 created by Dana Nickleach

Parameters: 

DSN            The name of the data set to be analyzed(required).   
 
EVENT          Name of time to event outcome variable (required).                                                             

CENSOR         Name of censoring indicator variable.  Values of 0 indicate censored observations(required).

CENSORED_VALUE The value in CENSOR that were specified the Values of Censored(required). For example, 0 = Censored, 1= Relapse, 2= Death,
               if relapse is the event of interest, type 0 and type 2 were specified censored in Cause-Specified Hazard Model 
               of competing-Risk survival data.

VAR            The list of variables on interest in the initial model that would be eliminated during the backward selection 
               procedure separated by spaces. The order of variables in this list will be preserved in the final report(required).

CVAR           The list of categorical variables that are in VAR(required). If need to change the reference group, you can 
               follow each variable name by (DESC) where needed and separate terms by *.  See code example. 

INC            Number of variables to include in the model. The first n variables in the var parameter will be included 
               in every model(optional).  The default value is 0. 

SLSTAY         The significance level for removing variables from the model (optional).  The default value is 0.2.

ID             Variable to be used in the ID statement in PHREG (optional).  Refer to SAS Help and Documentation for proper use of this 
               option. ID and COVSAGG will be used together in the model to compute the robust sandwich covariance matrix estimate for 
               cluster data. The ID statement identifies the variable that represents the clusters.  If observations have more than 
               one record in the data file, the number of observations reported in the table footer will be the number of records, 
               not unique observations. 

ORIENTATION    Orientation of the output Word table. Default is portrait, can be changed to landscape.

OUTPATH        Path for output table to be stored(required).

FNAME          File name for output table(required).

DEBUG          Set to T if running in debug mode (optional).  Work datasets will not be deleted in
               debug mode.  This is useful if you are editing the code or want to further 
               manipulate the resulting data sets.  The default value is F.

******************************************************************************************************/

Options macrogen symbolgen mlogic mprint mfile;
%macro CauseSpecific_sel(dsn=, event=, censor=, censored_value=, var=,cvar=,inc=0,slstay=.2,id=,covsagg=f, ORIENTATION = portrait,outpath=,filename=,debug=F);
    /* Save current options */
    PROC OPTSAVE out=_options;   RUN;

    /* Upper case T/F */
    %let debug   = %UPCASE(&amp;debug);
    %let var     = %UPCASE(&amp;var);
    %let cvar    = %UPCASE(&amp;cvar);
    %let covsagg = %UPCASE(&amp;covsagg);
    /* Initialize error variable */
    %LET __Macro_Err = 0;

   /* Time Should not be missing value*/
   
    %if &amp;censor = %STR()  %then %do;
       %put ERROR: censor should be specified.; 
       %let __Macro_Err=1;
    %end;
   
     %if %INDEX(&amp;cvar,*) &gt; 0 OR %INDEX(&amp;cvar,(DESC)) &gt; 0 %then %let cvar_cnt = %sysfunc(countw(&amp;cvar,*));
     %else %let cvar_cnt = %sysfunc(countw(&amp;cvar,&#39; &#39;)); 

     
      %if &amp;__Macro_Err. %then %do;
      data _null_;
         abort 3;
      run;
     %end;

     ODS SELECT NONE;
      ODS OUTPUT   ModelBuildingSummary(nowarn)=removed NObs = numobs
          ParameterEstimates = MLEC ModelInfo=modelinf %if &amp;cvar_cnt ~=0 %then %do; ModelANOVA = type3 ClassLevelFreq=clfreq %end;;

          proc phreg data=&amp;dsn   %if &amp;covsagg=T %then %do; COVS(AGGREGATE) %end;simple;
           
             class %if %sysevalf(%superq(CVAR)~=,boolean) %then %do; 
               %sysfunc(TRANSLATE(&amp;cvar,&#39; &#39;,&#39;*&#39;)) %end;/order=internal param=glm ;

               model &amp;event*&amp;censor(&amp;censored_value) = &amp;var/rl selection=backward include=&amp;inc /*stop=%EVAL(&amp;var_cnt-1)*/
               slstay=&amp;slstay hierarchy=single;
        

         %if &amp;id ~= %STR() %then %do;
            id &amp;id;
         %end;

      run;
      ODS SELECT ALL;

  
       /* Save order */
       DATA MLEC2;
          set MLEC;
          order = _n_;
       RUN;
       
       /* Check to see if data set containing a removed variable exists */
      /* If no variables were removed then the data set will not be created and the selection */
      /* process is done */
      %let continue = %sysfunc(exist(removed));

      %if &amp;continue = 1 %then %do;
         /* Get name of variable removed */
         /* Need SCAN because variable label is included after variable name in the same column */
         PROC SQL noprint;
            select UPCASE(SCAN(EffectRemoved,1,&#39; &#39;))
            into :remove
            from removed;
         quit;

         %let remlist =  &amp;remove;

       /* If any variables were removed from the model create a list */
      %if &amp;remlist ~= %STR() %then %do;
         /* Get variable labels for footnote */
         PROC CONTENTS DATA = &amp;dsn (keep=&amp;remlist) out=cont noprint;
         RUN;

         DATA cont;
            set cont end=last;
             if label = &#39; &#39; then label = name;
             if _N_ ~= 1 and last then label = &#39;and &#39; || label;
         RUN;

         PROC SQL noprint;
            select label into :remLab separated by &#39;, &#39;
             from cont;
         QUIT;

           %let foottext = The following variables were removed from the model: &amp;remLab..;

      %end;
      %else %let foottext = No variables were removed from the model.;
      %end;

      
/* Get dataset name and outcome name and use them in the output*/
   PROC SQL noprint;
      select cvalue into :event
      from modelinf
      where description = &#39;Dependent Variable&#39;;
   QUIT;

   /* Get outcome label */
   data _NULL_; 
      set &amp;dsn (obs=1); 
      call symput(&#39;eventvv&#39;, VLABEL(&amp;event));
   run;

      ** get number for continuous vars **;
      proc sql noprint;
        select NObsRead into :numread from numobs; 
        select NObsUsed into :numused from numobs; 
      quit;

    %if &amp;cvar_cnt ~=0 %then %do;
      **merge type3 and mlec datasets **;
      data type3;
         set type3;
        rename ProbChiSq = type3_p ;
        
      run;

       proc sql;
         create table MergeData AS 
         select A.* , B.effect, B.type3_p  
         from MLEC2 A, type3 B
         where MLEC2.Parameter = type3.effect;
       QUIT;
      

     **add frequency to mergedata **;
        %let continue2 = %sysfunc(exist(Clfreq));

        %if &amp;continue2 = 1 %then %do;

         data Clfreq(rename=(value=level));
            length parameter $100;
            set Clfreq;
            retain;
            if class ~=&quot;&quot; then parameter = upcase(class);
            else if class =&quot;&quot; then do;
            retain class;
            end;
            drop class control_var;
            format freq 8.0 ;
         run; 

       data mergedata;
          length parameter $100;
          set mergedata;
          parameter  = UPCASE(parameter);
          rename ClassVal0 = level;
       run;

       proc sql;
         create table mergedata_ as
            select A.*, B.FREQ
            from mergedata A LEFT JOIN Clfreq B
              on A.parameter = B.parameter AND A.level =B.level;
               
        QUIT;


    proc sort data=mergedata_; by effect order; run;
    data mergedata_ ;
      set mergedata_;
      if first.effect  then p_type3 = type3_p ;
      by effect order;
    run;
 
     data mergedata_ ;
        set  mergedata_ ;
        N = freq;
        if freq =. then N = &amp;numused;
      run;

    proc sort data=mergedata_; by order; run;

   %end;
 %end;
  %else %do;
        data mergedata_;
          set mlec2;
          rename Parameter = effect;
         run;
  %end;
 
DATA mergedata_;
      set MergeData_;
      /* HR and 95% CI */
      if HazardRatio ~= . then HR = TRIM(LEFT(PUT(HazardRatio,8.2))) || &quot; (&quot; || 
         TRIM(LEFT(PUT(HRLowerCL,8.2))) || &quot;-&quot; || 
         TRIM(LEFT(PUT(HRUpperCL,8.2))) || &quot;)&quot;;
      else HR = &#39;-&#39;;
      /* Number of observations read and used - save in data set */
      numused = &amp;numused;
      numread = &amp;numread;
      parameter = upcase(parameter);
RUN;

    **catch type of interest **;
    
   proc freq data=&amp;DSN;
     table status/out = freqCount;
   run;

   data freqCount;
     set freqCount;
     where &amp;censor ~ in (&amp;censored_value);
   run;

    Proc sql noprint;
         select &amp;censor  into:interest
         from freqCount;
    quit;
  %PUT interest: &amp;interest;

     /* part 3 create the word format table  */;

*---- table template -----;  
   ODS PATH WORK.TEMPLAT(UPDATE) SASUSR.TEMPLAT(UPDATE) SASHELP.TMPLMST(READ);

   PROC TEMPLATE;
      DEFINE STYLE STYLES.TABLES;
      NOTES &quot;MY TABLE STYLE&quot;; 
      PARENT=STYLES.MINIMAL;

       STYLE SYSTEMTITLE /FONT_SIZE = 12pt   FONT_FACE = &quot;TIMES NEW ROMAN&quot;;

       STYLE HEADER /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
            CELLPADDING=8
            JUST=C
            VJUST=C
            FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD; 

     STYLE TABLE /
            FRAME=HSIDES           
           RULES=GROUP              
           CELLPADDING=6            
            CELLSPACING=6           
            JUST=C
            FONT_SIZE = 10pt
           BORDERWIDTH = 0.5pt;  

     STYLE DATAEMPHASIS /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot;
           FONT_SIZE = 10pt
           FONT_WEIGHT = BOLD;

     STYLE DATA /
           FONT_FACE = &quot;TIMES NEW ROMAN&quot; 
           FONT_SIZE = 10pt;

     STYLE SYSTEMFOOTER /FONT_SIZE = 9pt FONT_FACE = &quot;TIMES NEW ROMAN&quot; JUST=C;
END;

RUN; 



   **** PRINT THE TABLE ************;
   OPTIONS ORIENTATION=&amp;ORIENTATION MISSING = &quot;-&quot; NODATE;
   ODS rtf STYLE=TABLES file= &quot;&amp;OUTPATH.&amp;FILENAME &amp;SYSDATE..DOC&quot;; 

   PROC REPORT DATA=mergedata_ HEADLINE HEADSKIP CENTER STYLE(REPORT)={JUST=CENTER} SPLIT=&#39;~&#39; 
     nowd SPANROWS lS=256; 
      COLUMN effect %if &amp;cvar_cnt ~=0 %then %do;  Level N %end;(&quot;&amp;eventvv&quot; &#39;------------------------------------------&#39;
          (HR  ProbChiSq  %if &amp;cvar_cnt ~=0 %then %do; p_type3 %end;)); 
      DEFINE effect/order order=data &quot;Covariate&quot;  STYLE(COLUMN) = {JUST = C CellWidth=25%}; 
      %if &amp;cvar_cnt ~=0 %then %do;
      DEFINE Level/DISPLAY &quot;Level&quot; STYLE(COLUMN) = {JUST =L CellWidth=20%}; 
      DEFINE N/DISPLAY &quot;N&quot; STYLE(COLUMN) = {JUST =C CellWidth=8%}FORMAT=8.0; 
      %end;
       %if &amp;cvar_cnt ~=0 %then %do;
         DEFINE p_type3/display   MISSING &quot;Global P-value&quot; STYLE(COLUMN) = {JUST=C CellWidth=8%} 
               FORMAT=PVALUE8.3; 
       %end;
      DEFINE HR/DISPLAY &quot;Hazard Ratio&quot; STYLE(COLUMN) = {JUST = C CellWidth=15%}; 
      DEFINE ProbChiSq/DISPLAY &quot;HR P-value&quot; STYLE(COLUMN) = {JUST = C CellWidth=8%} FORMAT=PVALUE8.3; 

      COMPUTE ProbChiSq; 
         IF . &lt; ProbChiSq &lt;=0.05 THEN CALL DEFINE(&quot;ProbChiSq&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
       
      ENDCOMP; 

       
       %if &amp;cvar_cnt ~=0 %then %do;
         COMPUTE p_type3; 
            IF . &lt; p_type3 &lt;0.05 THEN CALL DEFINE(&quot;p_type3&quot;, &quot;STYLE&quot;, &quot;STYLE=[FONT_WEIGHT=BOLD]&quot;); 
         ENDCOMP;   
       %end;

       compute after effect; line &#39;&#39;;   endcomp;  

       compute after _page_;
         length text1 - text3 $200.;
         text1 = &quot;*Number of observations in the original data set = %TRIM(&amp;numread). Number of observations used = %TRIM(&amp;numused).&quot;;
         line @0 text1 $200.;
          
         text2 = &quot;*Backward selection with an alpha level of removal of &amp;slstay was used.  &amp;foottext&quot; ;
         
          line @0 text2 $200.;

         text3 = &quot;*Cause-Specific Hazard Model:  Type of Censored= &amp;censored_value;  Type of Interest= %TRIM(&amp;interest).&quot; ;
         
         line @0 text3 $200.;
       ENDCOMP;
 
     RUN;
   ods rtf close;

   
   %if &amp;debug = F %then %do;
      *--- DELETE ALL TEMPORARY DATASETS that were created; 
      proc datasets lib=work memtype=data noprint;  
           delete %if cvar ~= %STR() %then %do; CLfreq  %end; mergedata mlec modelinf numobs type3 REMOVED Cont Freqcount Mergedata_ Mlec2  ;
       quit;
    %end;
   
%mend CauseSpecific_sel;


data bmt;
  input Group T Status WaitTime @@;
  logWaittime=log(WaitTime);
 datalines;
1 2081 0 98 1 1602 0 1720 1 1496 0 127  1 1462 0 168
1 1433 0 93 1 1377 0 2187 1 1330 0 1006 1 996  0 1319
1 226  0 208 1 1199 0 174  1 1111 0 236  1 530  0  151 
1 1182 0 203 1 1167 0 191 1 418 2 110 1 383 1 824
1 276  2 146 1 104 1 85   1 609 1 187  1 172 2 129
1 487 2 128  1 662 1 84   1 194 2 329 1 230 1 147 
1 526 2 943 1 122 2 2616  1 129 1 937 1 74 1 303
1 122 1 170 1 86 2 239    1 466 2 508 1 192 1 74
1 109 1 393 1 55 1 331    1   1 2 196 1 107 2 178
1 110 1 361 1 332 2 834   2 2569 0 270 2 2506 0 60
2 2409 0 120 2 2218 0 60 2 1857 0 90 2 1829 0 210
2 1562 0 90 2 1470 0 240 2 1363 0 90 2 1030 0 210
2 860 0 180 2 1258 0 180 2 2246 0 105 2 1870 0 225
2 1799 0 120 2 1709 0 90 2 1674 0 60 2 1568 0 90
2 1527 0 450 2 1324 0 75 2 957 0 90 2 932 0 60
2 847 0 75 2 848 0 180 2 1850 0 180 2 1843 0 270
2 1535 0 180 2 1447 0 150 2 1384 0 120 2 414 2 120
2 2204 2 60 2 1063 2 270 2 481 2 90 2 105 2 120
2 641 2 90 2 390 2 120 2 288 2 90 2 421 1 90
2 79 2 90 2 748 1 60 2 486 1 120 2 48 2 150
2 272 1 120 2 1074 2 150 2 381 1 120 2 10 2 240
2 53 2 180 2 80 2 150 2 35 2 150 2 248 1 30
2 704 2 105 2 211 1 90 2 219 1 120 2 606 1 210
3 2640 0 750 3 2430 0 24 3 2252 0 120 3 2140 0 210
3 2133 0 240 3 1238 0 240 3 1631 0 690 3 2024 0 105
3 1345 0 120 3 1136 0 900 3 845 0 210 3 422 1 210
3 162 2 300 3 84 1 105 3 100 1 210 3 2 2 75
3 47 1 90 3 242 1 180 3 456 1 630 3 268 1 180
3 318 2 300 3 32 1 90 3 467 1 120 3 47 1 135
3 390 1 210 3 183 2 120 3 105 2 150 3 115 1 270
3 164 2 285 3 93 1 240 3 120 1 510 3 80 2 780
3 677 2 150 3 64 1 180 3 168 2 150 3 74 2 750
3 16 2 180 3 157 1 180 3 625 1 150 3 48 1 210
3 273 1 240 3 63 2 360 3 76 1 330 3 113 1 240
3 363 2 180
;
run;

*** %let dir = H:\Chao_paper_2019124\Informative_censoring\output;
%let dir = /home/zehuibai24885190/CIF;

proc format;
value DiseaseGroup 1=&#39;ALL&#39; 2=&#39;AML-Low Risk&#39; 3=&#39;AML-High Risk&#39;;
value sex 0= &#39;F&#39; 1=&#39;M&#39;;
run;

data bmt;
  set bmt;
  call streaminit(123);      
  u = rand(&quot;Uniform&quot;);      
  output;
run;

data bmt;
  set bmt;
   if u&gt;=0.7 then sex=1; else if u&lt;0.5 then sex=0;
   if u&gt;=0.4 then race=&#39;white&#39;; else race=&#39;AA&#39;;
        
   label sex = &#39;gender&#39;
         group = &#39;patient group&#39;
         label T = &#39; disease-free survival time (days)&#39; ;
    ;
 format Group DiseaseGroup. SEX SEX.;
run;


title &#39;Table 1 Multivariate Cause-Specific Hazard Regression for Relapse&#39; ;
%CauseSpecific_sel(dsn=bmt, 
                 event=t, censor=status, 
                 censored_value=0 2, 
                 var=Group logWaitTime sex,
                 cvar=Group(desc)* sex,
                 inc=0,
                 slstay=.3,
                 ORIENTATION = portrait, 
                 outpath= &amp;dir.\,
                 filename=aaa,
                 debug=t);
title &#39;&#39;;

title &#39;Table 2 Multivariate Cause-Specific Hazard Regression for Death&#39; ;
%CauseSpecific_sel(dsn=bmt, 
                 event=t, censor=status, 
                 censored_value=0 1, 
                 var=Group logWaitTime sex,
                 cvar=Group  sex,
                 inc=0,
                 slstay=.3,
                 ORIENTATION = portrait, 
                 outpath= &amp;dir.\,
                 filename=bbb,
                 debug=t);
title &#39;&#39;;</code></pre>
</div>
</div>
</div>
<div id="clustered-events" class="section level2" number="19.5">
<h2><span class="header-section-number">19.5</span> Clustered Events</h2>
<div id="introduction-19" class="section level3" number="19.5.1">
<h3><span class="header-section-number">19.5.1</span> Introduction</h3>
<p><a href="https://support.sas.com/resources/papers/proceedings09/237-2009.pdf">Source</a></p>
<p>we are interested in the analysis of multivariate failure time data. Such data arise when each study subject can potentially experience several events (for instance, multiple infections after surgery) or when there exists some natural or artificial clustering of subjects (for instance, a litter of mice) that induces dependence among the failure times of the same cluster.</p>
<ul>
<li>Data in the former situation are referred to as multiple events data, which include recurrent events data as a special case;</li>
<li>Data in the latter situation are referred to as clustered data.</li>
</ul>
<p>Two methods to analyzing survival data with clustered events are presented.</p>
<ol style="list-style-type: decimal">
<li>The first method is a proportional hazards model which adopts a marginal approach with a working independence assumption. This model can be fitted by SAS PROC PHREG with the robust sandwich estimate option. In the marginal model, WLW (Wei, Lin, and Weissfeld, hereafter WLW) adopts a pseudolikelihood approach with a working independence assumption. They estimated the covariate effect assuming independence among correlated failure times, while adjusting for the correlation by sandwich estimate in estimating the covariance matrix.</li>
<li>The second method is a likelihood-based random effects (frailty) model. In the second model, the baseline hazard could be either a priori determined (e.g., Weibull) or approximated by piecewise constant counterpart. The estimation could be carried out by adaptive Gaussian quadrature method which is implemented in SAS PROC NLMIXED. Frailty model is a random effects proportional hazards model. The random effects could be used to capture the relation of the correlated observations in the clustered or recurrent events data.</li>
</ol>
</div>
<div id="proportional-hazards-model-which-adopts-a-marginal" class="section level3" number="19.5.2">
<h3><span class="header-section-number">19.5.2</span> Proportional hazards model which adopts a marginal</h3>
<p>Calculate robust sandwich covariance estimates in the PROC PHREG call. The PHREG process uses ODS graphics to create graphics as part of its output. For example, the ASSESS statement uses a graphics method that uses ODS Graphics to check the model suitability of the model. PROC PHREG (version 9.2) also provides many important enhancements. The most notable features are the CLASS statement used to specify categorical variables; the CONTRAST statement used to estimate and test linear contrast; the BAYES statement used to perform Bayesian analysis; and the HAZARDRATIO statement used to estimate custom hazard ratios.</p>
<p>The option COVS(AGGREGATE) is specified in the PROC statement to obtain the robust sandwich estimate of the covariance matrix, and the score residuals used in computing the middle part of the sandwich estimate are aggregated over identical ID values. Then, the model is defined including Treat covariate, JR covariate, and interaction term between Treat and JR. The TEST statements can be included in the PROC PHREG code to test various linear hypotheses of the regression parameters based on the robust sandwich covariance matrix estimate. This method is most appropriate when the main purpose is to estimate the marginal (population) covariate effects.</p>
<p>The marginal Cox model for the <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event and the <span class="math inline">\(\hat{t}^{\text {th }}\)</span> cluster is given by
<span class="math display">\[
\lambda_{j}\left(t ; Z_{i j}\right)=\lambda_{0 j} e^{\beta_{j}^{\prime} Z_{i j}(t)}, j=1, \ldots, J ; i=1, \ldots, n
\]</span>
and the <span class="math inline">\(j^{\text {th }}\)</span> event-specific partial likelihood is
<span class="math display">\[
\mathrm{L}_{\mathrm{j}}(\beta)=\prod_{\mathrm{i}=1}^{\mathrm{n}}\left[\frac{\exp \left\{\beta^{\prime} Z_{i j}\left(X_{i j}\right)\right\}}{\sum_{l \in R_{j}\left(X_{i j}\right)} \exp \left\{\beta^{\prime} Z_{i l}\left(X_{i j}\right)\right\}}\right]^{\Delta_{\mathrm{i}}}
\]</span></p>
<ul>
<li>Where <span class="math inline">\(\lambda_{0 j}(t)\)</span> is an arbitrary baseline hazard function for the <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event</li>
<li><span class="math inline">\(\beta_{j}\)</span> is the (event-specific) column vector of regression coefficients for <span class="math inline">\(\mathrm{j}^{\text {th }}\)</span> event.</li>
<li>WLW estimates <span class="math inline">\(\beta_{1}, \ldots, \beta_{J}\)</span> by the maximum partial likelihood estimates <span class="math inline">\(\hat{\beta} 1, \ldots, \hat{\beta} J\)</span>, respectively, and uses a robust sandwich covariance matrix estimate for <span class="math inline">\(\left(\hat{\beta} 1^{\prime}, \ldots, \hat{\beta} J^{\prime}\right)^{\prime}\)</span> to account for the dependence of the multiple failure times.</li>
</ul>
<pre><code>proc phreg data=diabetes covs(aggregate);
 model Time*Status(0)=Treat JR Interaction;
 Interaction= Treat * JR;
 id ID;
run;</code></pre>
</div>
<div id="frailty-model" class="section level3" number="19.5.3">
<h3><span class="header-section-number">19.5.3</span> Frailty model</h3>
<p><strong>Analysis of clustered data with known distribution using proc nlmixed</strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="count-data-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/23-Advanced-Survival-Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
