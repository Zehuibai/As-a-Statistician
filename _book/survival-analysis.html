<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Survival Analysis | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Survival Analysis | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Survival Analysis | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2021-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-logistic-regression.html"/>
<link rel="next" href="advanced-survival-analysis.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="input-and-format.html"><a href="input-and-format.html"><i class="fa fa-check"></i><b>2</b> Input and Format</a>
<ul>
<li class="chapter" data-level="2.1" data-path="input-and-format.html"><a href="input-and-format.html#input-data-into-sas"><i class="fa fa-check"></i><b>2.1</b> Input data into SAS</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="input-and-format.html"><a href="input-and-format.html#reading-free-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.1</b> Reading free formatted data instream</a></li>
<li class="chapter" data-level="2.1.2" data-path="input-and-format.html"><a href="input-and-format.html#reading-fixed-formatted-data-instream"><i class="fa fa-check"></i><b>2.1.2</b> Reading fixed formatted data instream</a></li>
<li class="chapter" data-level="2.1.3" data-path="input-and-format.html"><a href="input-and-format.html#infile-reading-fixed-formatted-data-from-an-external-file"><i class="fa fa-check"></i><b>2.1.3</b> INFILE: Reading fixed formatted data from an external file</a></li>
<li class="chapter" data-level="2.1.4" data-path="input-and-format.html"><a href="input-and-format.html#write-the-sas-file"><i class="fa fa-check"></i><b>2.1.4</b> Write the SAS File</a></li>
<li class="chapter" data-level="2.1.5" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data"><i class="fa fa-check"></i><b>2.1.5</b> Import csv data</a></li>
<li class="chapter" data-level="2.1.6" data-path="input-and-format.html"><a href="input-and-format.html#import"><i class="fa fa-check"></i><b>2.1.6</b> %Import</a></li>
<li class="chapter" data-level="2.1.7" data-path="input-and-format.html"><a href="input-and-format.html#infile-read-multiple-raw-data-files"><i class="fa fa-check"></i><b>2.1.7</b> Infile Read multiple raw data files</a></li>
<li class="chapter" data-level="2.1.8" data-path="input-and-format.html"><a href="input-and-format.html#generate-automatic-file-name"><i class="fa fa-check"></i><b>2.1.8</b> Generate automatic file name</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="input-and-format.html"><a href="input-and-format.html#input-and-import-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Input and import data in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="input-and-format.html"><a href="input-and-format.html#import-csv-data-1"><i class="fa fa-check"></i><b>2.2.1</b> Import csv data</a></li>
<li class="chapter" data-level="2.2.2" data-path="input-and-format.html"><a href="input-and-format.html#import-txt-data"><i class="fa fa-check"></i><b>2.2.2</b> Import txt data</a></li>
<li class="chapter" data-level="2.2.3" data-path="input-and-format.html"><a href="input-and-format.html#import-excel-data"><i class="fa fa-check"></i><b>2.2.3</b> Import excel data</a></li>
<li class="chapter" data-level="2.2.4" data-path="input-and-format.html"><a href="input-and-format.html#import-stata-data"><i class="fa fa-check"></i><b>2.2.4</b> Import stata data</a></li>
<li class="chapter" data-level="2.2.5" data-path="input-and-format.html"><a href="input-and-format.html#import-sas-data"><i class="fa fa-check"></i><b>2.2.5</b> Import SAS data</a></li>
<li class="chapter" data-level="2.2.6" data-path="input-and-format.html"><a href="input-and-format.html#copy-from-clipboard"><i class="fa fa-check"></i><b>2.2.6</b> Copy from clipboard</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="input-and-format.html"><a href="input-and-format.html#save-and-write-objective-in-r"><i class="fa fa-check"></i><b>2.3</b> Save and write objective in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="input-and-format.html"><a href="input-and-format.html#save-as-r-datei"><i class="fa fa-check"></i><b>2.3.1</b> Save as R-Datei</a></li>
<li class="chapter" data-level="2.3.2" data-path="input-and-format.html"><a href="input-and-format.html#write.table-and-write.csv"><i class="fa fa-check"></i><b>2.3.2</b> write.table and write.csv</a></li>
<li class="chapter" data-level="2.3.3" data-path="input-and-format.html"><a href="input-and-format.html#write.foreign"><i class="fa fa-check"></i><b>2.3.3</b> write.foreign</a></li>
<li class="chapter" data-level="2.3.4" data-path="input-and-format.html"><a href="input-and-format.html#write.xlsx"><i class="fa fa-check"></i><b>2.3.4</b> write.xlsx</a></li>
<li class="chapter" data-level="2.3.5" data-path="input-and-format.html"><a href="input-and-format.html#save-the-plot"><i class="fa fa-check"></i><b>2.3.5</b> Save the plot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="input-and-format.html"><a href="input-and-format.html#format-in-sas"><i class="fa fa-check"></i><b>2.4</b> Format in SAS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="input-and-format.html"><a href="input-and-format.html#proc-format"><i class="fa fa-check"></i><b>2.4.1</b> Proc format</a></li>
<li class="chapter" data-level="2.4.2" data-path="input-and-format.html"><a href="input-and-format.html#copy-and-combine-sas-format-libraries"><i class="fa fa-check"></i><b>2.4.2</b> Copy and combine SAS format libraries</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="input-and-format.html"><a href="input-and-format.html#package-readr"><i class="fa fa-check"></i><b>2.5</b> Package readr</a></li>
<li class="chapter" data-level="2.6" data-path="input-and-format.html"><a href="input-and-format.html#package-strings"><i class="fa fa-check"></i><b>2.6</b> Package Strings</a></li>
<li class="chapter" data-level="2.7" data-path="input-and-format.html"><a href="input-and-format.html#package-forcats"><i class="fa fa-check"></i><b>2.7</b> Package forcats</a></li>
<li class="chapter" data-level="2.8" data-path="input-and-format.html"><a href="input-and-format.html#package-lubridate"><i class="fa fa-check"></i><b>2.8</b> Package lubridate</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html"><i class="fa fa-check"></i><b>3</b> Data Management in SAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#array"><i class="fa fa-check"></i><b>3.1</b> Array</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#defining"><i class="fa fa-check"></i><b>3.1.1</b> Defining</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#format-multiple-variables"><i class="fa fa-check"></i><b>3.1.2</b> Format multiple variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#arrays"><i class="fa fa-check"></i><b>3.1.3</b> 2*2 arrays</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables"><i class="fa fa-check"></i><b>3.1.4</b> Dynamic Element List using Macro Variables</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#carry-over-values"><i class="fa fa-check"></i><b>3.1.5</b> Carry over values</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#retain"><i class="fa fa-check"></i><b>3.2</b> Retain</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#change-from-basilne"><i class="fa fa-check"></i><b>3.2.1</b> Change from Basilne</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#variable-names-and-types"><i class="fa fa-check"></i><b>3.3</b> Variable Names and Types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#convert-all-numeric-to-char"><i class="fa fa-check"></i><b>3.3.1</b> Convert all numeric to char*</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#get-all-the-numeric-variable-names"><i class="fa fa-check"></i><b>3.3.2</b> Get all the numeric variable names</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-variable-names-as-macro-variables"><i class="fa fa-check"></i><b>3.3.3</b> Write all variable names as macro variables</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#write-all-observations-as-macro-variable"><i class="fa fa-check"></i><b>3.3.4</b> Write all observations as macro variable</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-some-variables"><i class="fa fa-check"></i><b>3.3.5</b> Rename some variables</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-with-suffix"><i class="fa fa-check"></i><b>3.3.6</b> Rename with suffix</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#rename-array-variables"><i class="fa fa-check"></i><b>3.3.7</b> Rename array variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-exists-for-validation"><i class="fa fa-check"></i><b>3.4</b> Check exists for validation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-exists"><i class="fa fa-check"></i><b>3.4.1</b> Check datasets exists</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-and-variables"><i class="fa fa-check"></i><b>3.4.2</b> Check datasets and Variables</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#check-datasets-if-empty"><i class="fa fa-check"></i><b>3.4.3</b> Check datasets if empty</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#sysfunc-get-the-observations"><i class="fa fa-check"></i><b>3.4.4</b> %sysfunc get the observations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#proc-transpose"><i class="fa fa-check"></i><b>3.5</b> Proc Transpose</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#numeric"><i class="fa fa-check"></i><b>3.5.1</b> <em>numeric</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#in-processing"><i class="fa fa-check"></i><b>3.5.2</b> In processing</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#clean-up"><i class="fa fa-check"></i><b>3.6</b> Clean Up</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#basic-setting"><i class="fa fa-check"></i><b>3.6.1</b> Basic setting</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-datasets"><i class="fa fa-check"></i><b>3.6.2</b> Delete datasets</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#deleting-formats"><i class="fa fa-check"></i><b>3.6.3</b> Deleting Formats</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#remove-assigned-formats"><i class="fa fa-check"></i><b>3.6.4</b> Remove assigned formats</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro-variables"><i class="fa fa-check"></i><b>3.6.5</b> Delete macro variables</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-management-in-sas.html"><a href="data-management-in-sas.html#delete-macro"><i class="fa fa-check"></i><b>3.6.6</b> Delete Macro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management-in-r.html"><a href="data-management-in-r.html"><i class="fa fa-check"></i><b>4</b> Data Management in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-tidyr"><i class="fa fa-check"></i><b>4.1</b> Package tidyr</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#pivoting"><i class="fa fa-check"></i><b>4.1.1</b> Pivoting</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#gather-and-spread"><i class="fa fa-check"></i><b>4.1.2</b> gather and spread</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#separate-and-unite"><i class="fa fa-check"></i><b>4.1.3</b> separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#package-dplyr"><i class="fa fa-check"></i><b>4.2</b> Package dplyr</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-management-in-r.html"><a href="data-management-in-r.html#data-transformation-with-dplyr"><i class="fa fa-check"></i><b>4.2.1</b> Data Transformation with dplyr</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-management-in-r.html"><a href="data-management-in-r.html#across"><i class="fa fa-check"></i><b>4.2.2</b> across</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-management-in-r.html"><a href="data-management-in-r.html#arrange"><i class="fa fa-check"></i><b>4.2.3</b> arrange</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-management-in-r.html"><a href="data-management-in-r.html#coalesce"><i class="fa fa-check"></i><b>4.2.4</b> coalesce</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-management-in-r.html"><a href="data-management-in-r.html#filter"><i class="fa fa-check"></i><b>4.2.5</b> filter</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-management-in-r.html"><a href="data-management-in-r.html#if_else"><i class="fa fa-check"></i><b>4.2.6</b> if_else</a></li>
<li class="chapter" data-level="4.2.7" data-path="data-management-in-r.html"><a href="data-management-in-r.html#join"><i class="fa fa-check"></i><b>4.2.7</b> join</a></li>
<li class="chapter" data-level="4.2.8" data-path="data-management-in-r.html"><a href="data-management-in-r.html#mutate"><i class="fa fa-check"></i><b>4.2.8</b> mutate</a></li>
<li class="chapter" data-level="4.2.9" data-path="data-management-in-r.html"><a href="data-management-in-r.html#select"><i class="fa fa-check"></i><b>4.2.9</b> select</a></li>
<li class="chapter" data-level="4.2.10" data-path="data-management-in-r.html"><a href="data-management-in-r.html#summarise"><i class="fa fa-check"></i><b>4.2.10</b> summarise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>5</b> SQL</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sql.html"><a href="sql.html#mysql-management"><i class="fa fa-check"></i><b>5.1</b> MySQL: Management</a></li>
<li class="chapter" data-level="5.2" data-path="sql.html"><a href="sql.html#mysql-php-in-processing"><i class="fa fa-check"></i><b>5.2</b> MySQL PHP (In processing)</a></li>
<li class="chapter" data-level="5.3" data-path="sql.html"><a href="sql.html#proc-sql-in-sas"><i class="fa fa-check"></i><b>5.3</b> PROC SQL in SAS</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sql.html"><a href="sql.html#inreoduction"><i class="fa fa-check"></i><b>5.3.1</b> Inreoduction</a></li>
<li class="chapter" data-level="5.3.2" data-path="sql.html"><a href="sql.html#create-normal-table"><i class="fa fa-check"></i><b>5.3.2</b> Create Normal Table</a></li>
<li class="chapter" data-level="5.3.3" data-path="sql.html"><a href="sql.html#creating-tables-like-an-existing-table"><i class="fa fa-check"></i><b>5.3.3</b> Creating Tables like an Existing Table</a></li>
<li class="chapter" data-level="5.3.4" data-path="sql.html"><a href="sql.html#inserting-rows"><i class="fa fa-check"></i><b>5.3.4</b> Inserting Rows</a></li>
<li class="chapter" data-level="5.3.5" data-path="sql.html"><a href="sql.html#delete-rows-and-table"><i class="fa fa-check"></i><b>5.3.5</b> Delete Rows and Table</a></li>
<li class="chapter" data-level="5.3.6" data-path="sql.html"><a href="sql.html#new-columns-using-summary-function"><i class="fa fa-check"></i><b>5.3.6</b> New Columns using Summary Function</a></li>
<li class="chapter" data-level="5.3.7" data-path="sql.html"><a href="sql.html#aggregation-summary"><i class="fa fa-check"></i><b>5.3.7</b> Aggregation: Summary</a></li>
<li class="chapter" data-level="5.3.8" data-path="sql.html"><a href="sql.html#conditionality-if"><i class="fa fa-check"></i><b>5.3.8</b> Conditionality (If)</a></li>
<li class="chapter" data-level="5.3.9" data-path="sql.html"><a href="sql.html#filtering-aggregated-data-having"><i class="fa fa-check"></i><b>5.3.9</b> Filtering Aggregated Data (HAVING)</a></li>
<li class="chapter" data-level="5.3.10" data-path="sql.html"><a href="sql.html#select-operator-union"><i class="fa fa-check"></i><b>5.3.10</b> Select Operator (Union…)</a></li>
<li class="chapter" data-level="5.3.11" data-path="sql.html"><a href="sql.html#loap"><i class="fa fa-check"></i><b>5.3.11</b> Loap</a></li>
<li class="chapter" data-level="5.3.12" data-path="sql.html"><a href="sql.html#join-1"><i class="fa fa-check"></i><b>5.3.12</b> Join</a></li>
<li class="chapter" data-level="5.3.13" data-path="sql.html"><a href="sql.html#reordering-rows-proc-sort"><i class="fa fa-check"></i><b>5.3.13</b> Reordering Rows (Proc Sort)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sql.html"><a href="sql.html#package-dbi-in-processing"><i class="fa fa-check"></i><b>5.4</b> Package DBI (In processing)</a></li>
<li class="chapter" data-level="5.5" data-path="sql.html"><a href="sql.html#package-sparklyr-in-processing"><i class="fa fa-check"></i><b>5.5</b> Package sparklyr (In processing)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>6</b> ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ggplot2.html"><a href="ggplot2.html#parametric-rendering"><i class="fa fa-check"></i><b>6.1</b> Parametric Rendering</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ggplot2.html"><a href="ggplot2.html#grammar"><i class="fa fa-check"></i><b>6.1.1</b> Grammar</a></li>
<li class="chapter" data-level="6.1.2" data-path="ggplot2.html"><a href="ggplot2.html#coord"><i class="fa fa-check"></i><b>6.1.2</b> coord</a></li>
<li class="chapter" data-level="6.1.3" data-path="ggplot2.html"><a href="ggplot2.html#facet"><i class="fa fa-check"></i><b>6.1.3</b> facet</a></li>
<li class="chapter" data-level="6.1.4" data-path="ggplot2.html"><a href="ggplot2.html#geom"><i class="fa fa-check"></i><b>6.1.4</b> geom</a></li>
<li class="chapter" data-level="6.1.5" data-path="ggplot2.html"><a href="ggplot2.html#position"><i class="fa fa-check"></i><b>6.1.5</b> position</a></li>
<li class="chapter" data-level="6.1.6" data-path="ggplot2.html"><a href="ggplot2.html#scale"><i class="fa fa-check"></i><b>6.1.6</b> scale</a></li>
<li class="chapter" data-level="6.1.7" data-path="ggplot2.html"><a href="ggplot2.html#stat"><i class="fa fa-check"></i><b>6.1.7</b> stat</a></li>
<li class="chapter" data-level="6.1.8" data-path="ggplot2.html"><a href="ggplot2.html#color"><i class="fa fa-check"></i><b>6.1.8</b> Color</a></li>
<li class="chapter" data-level="6.1.9" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>6.1.9</b> Thema</a></li>
<li class="chapter" data-level="6.1.10" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>6.1.10</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ggplot2.html"><a href="ggplot2.html#scatter-plot"><i class="fa fa-check"></i><b>6.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ggplot2.html"><a href="ggplot2.html#grouping-aesthetic"><i class="fa fa-check"></i><b>6.2.1</b> Grouping Aesthetic</a></li>
<li class="chapter" data-level="6.2.2" data-path="ggplot2.html"><a href="ggplot2.html#facet-1"><i class="fa fa-check"></i><b>6.2.2</b> facet</a></li>
<li class="chapter" data-level="6.2.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_smooth"><i class="fa fa-check"></i><b>6.2.3</b> geom_smooth</a></li>
<li class="chapter" data-level="6.2.4" data-path="ggplot2.html"><a href="ggplot2.html#dot-plot"><i class="fa fa-check"></i><b>6.2.4</b> Dot Plot</a></li>
<li class="chapter" data-level="6.2.5" data-path="ggplot2.html"><a href="ggplot2.html#label-and-title"><i class="fa fa-check"></i><b>6.2.5</b> Label and Title</a></li>
<li class="chapter" data-level="6.2.6" data-path="ggplot2.html"><a href="ggplot2.html#residuals"><i class="fa fa-check"></i><b>6.2.6</b> Residuals</a></li>
<li class="chapter" data-level="6.2.7" data-path="ggplot2.html"><a href="ggplot2.html#encircling"><i class="fa fa-check"></i><b>6.2.7</b> Encircling</a></li>
<li class="chapter" data-level="6.2.8" data-path="ggplot2.html"><a href="ggplot2.html#dumbbell-plot"><i class="fa fa-check"></i><b>6.2.8</b> Dumbbell Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i><b>6.3</b> Histogram</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ggplot2.html"><a href="ggplot2.html#general-appearance"><i class="fa fa-check"></i><b>6.3.1</b> General appearance</a></li>
<li class="chapter" data-level="6.3.2" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>6.3.2</b> Themes</a></li>
<li class="chapter" data-level="6.3.3" data-path="ggplot2.html"><a href="ggplot2.html#geom_freqpoly"><i class="fa fa-check"></i><b>6.3.3</b> geom_freqpoly()</a></li>
<li class="chapter" data-level="6.3.4" data-path="ggplot2.html"><a href="ggplot2.html#marginal-histogram-boxplot"><i class="fa fa-check"></i><b>6.3.4</b> Marginal Histogram / Boxplot</a></li>
<li class="chapter" data-level="6.3.5" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>6.3.5</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ggplot2.html"><a href="ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>6.4</b> Bar plot</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic"><i class="fa fa-check"></i><b>6.4.1</b> Aesthetic</a></li>
<li class="chapter" data-level="6.4.2" data-path="ggplot2.html"><a href="ggplot2.html#proportion"><i class="fa fa-check"></i><b>6.4.2</b> Proportion</a></li>
<li class="chapter" data-level="6.4.3" data-path="ggplot2.html"><a href="ggplot2.html#coord-1"><i class="fa fa-check"></i><b>6.4.3</b> coord</a></li>
<li class="chapter" data-level="6.4.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity"><i class="fa fa-check"></i><b>6.4.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.4.5" data-path="ggplot2.html"><a href="ggplot2.html#ranking"><i class="fa fa-check"></i><b>6.4.5</b> Ranking</a></li>
<li class="chapter" data-level="6.4.6" data-path="ggplot2.html"><a href="ggplot2.html#means-and-error-bars"><i class="fa fa-check"></i><b>6.4.6</b> Means and error bars</a></li>
<li class="chapter" data-level="6.4.7" data-path="ggplot2.html"><a href="ggplot2.html#waffle-chart"><i class="fa fa-check"></i><b>6.4.7</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ggplot2.html"><a href="ggplot2.html#box-plot"><i class="fa fa-check"></i><b>6.5</b> Box plot</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="ggplot2.html"><a href="ggplot2.html#varwidth"><i class="fa fa-check"></i><b>6.5.1</b> varwidth</a></li>
<li class="chapter" data-level="6.5.2" data-path="ggplot2.html"><a href="ggplot2.html#reorder"><i class="fa fa-check"></i><b>6.5.2</b> Reorder</a></li>
<li class="chapter" data-level="6.5.3" data-path="ggplot2.html"><a href="ggplot2.html#fill"><i class="fa fa-check"></i><b>6.5.3</b> Fill</a></li>
<li class="chapter" data-level="6.5.4" data-path="ggplot2.html"><a href="ggplot2.html#statidentity-1"><i class="fa fa-check"></i><b>6.5.4</b> stat=“identity”</a></li>
<li class="chapter" data-level="6.5.5" data-path="ggplot2.html"><a href="ggplot2.html#dot-box-plot"><i class="fa fa-check"></i><b>6.5.5</b> Dot + Box Plot</a></li>
<li class="chapter" data-level="6.5.6" data-path="ggplot2.html"><a href="ggplot2.html#violin-plot"><i class="fa fa-check"></i><b>6.5.6</b> Violin Plot</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ggplot2.html"><a href="ggplot2.html#other-rendering"><i class="fa fa-check"></i><b>6.6</b> Other rendering</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i><b>6.6.1</b> Annotation</a></li>
<li class="chapter" data-level="6.6.2" data-path="ggplot2.html"><a href="ggplot2.html#text-ggtext"><i class="fa fa-check"></i><b>6.6.2</b> Text: ggtext</a></li>
<li class="chapter" data-level="6.6.3" data-path="ggplot2.html"><a href="ggplot2.html#text-ggrepel"><i class="fa fa-check"></i><b>6.6.3</b> Text: ggrepel</a></li>
<li class="chapter" data-level="6.6.4" data-path="ggplot2.html"><a href="ggplot2.html#arrage-gridextra"><i class="fa fa-check"></i><b>6.6.4</b> Arrage: gridExtra</a></li>
<li class="chapter" data-level="6.6.5" data-path="ggplot2.html"><a href="ggplot2.html#interactive-charts-plotly"><i class="fa fa-check"></i><b>6.6.5</b> Interactive charts: plotly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html"><i class="fa fa-check"></i><b>7</b> Proc Sqplot (In Processing)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#ods"><i class="fa fa-check"></i><b>7.1</b> ODS</a></li>
<li class="chapter" data-level="7.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#scatter-plot-1"><i class="fa fa-check"></i><b>7.3</b> Scatter Plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#vector-in-scatter-plot"><i class="fa fa-check"></i><b>7.3.1</b> Vector in scatter Plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#add-predict-curve"><i class="fa fa-check"></i><b>7.3.2</b> Add predict curve</a></li>
<li class="chapter" data-level="7.3.3" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#grouping"><i class="fa fa-check"></i><b>7.3.3</b> grouping</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#bar-chart"><i class="fa fa-check"></i><b>7.4</b> Bar chart</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#group-and-using-freq"><i class="fa fa-check"></i><b>7.4.1</b> Group and using freq</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="proc-sqplot-in-processing.html"><a href="proc-sqplot-in-processing.html#histogram-1"><i class="fa fa-check"></i><b>7.5</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html"><i class="fa fa-check"></i><b>8</b> Descriptive Statistics in SAS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-freq"><i class="fa fa-check"></i><b>8.1</b> PROC FREQ</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-table-names"><i class="fa fa-check"></i><b>8.1.1</b> ODS Table Names</a></li>
<li class="chapter" data-level="8.1.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-plots"><i class="fa fa-check"></i><b>8.1.2</b> ODS Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-univariate"><i class="fa fa-check"></i><b>8.2</b> PROC UNIVARIATE</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#histogram-statement"><i class="fa fa-check"></i><b>8.2.1</b> HISTOGRAM Statement</a></li>
<li class="chapter" data-level="8.2.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#cdfplot-statement"><i class="fa fa-check"></i><b>8.2.2</b> CDFPLOT Statement</a></li>
<li class="chapter" data-level="8.2.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ppplot-statement"><i class="fa fa-check"></i><b>8.2.3</b> PPPLOT Statement</a></li>
<li class="chapter" data-level="8.2.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#probplot-and-qqplot-statement"><i class="fa fa-check"></i><b>8.2.4</b> PROBPLOT and QQPLOT Statement</a></li>
<li class="chapter" data-level="8.2.5" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-tables"><i class="fa fa-check"></i><b>8.2.5</b> ODS Tables</a></li>
<li class="chapter" data-level="8.2.6" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#ods-graphics"><i class="fa fa-check"></i><b>8.2.6</b> ODS Graphics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-means"><i class="fa fa-check"></i><b>8.3</b> PROC MEANS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-summary-statistics"><i class="fa fa-check"></i><b>8.3.1</b> Basic summary statistics</a></li>
<li class="chapter" data-level="8.3.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#autoname-option"><i class="fa fa-check"></i><b>8.3.2</b> AUTONAME Option</a></li>
<li class="chapter" data-level="8.3.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#chartype-option"><i class="fa fa-check"></i><b>8.3.3</b> CHARTYPE Option</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#proc-tabulate"><i class="fa fa-check"></i><b>8.4</b> PROC TABULATE</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#basic-syntax-for-proc-tabulate"><i class="fa fa-check"></i><b>8.4.1</b> Basic Syntax for PROC TABULATE</a></li>
<li class="chapter" data-level="8.4.2" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#identification-of-desired-statistics"><i class="fa fa-check"></i><b>8.4.2</b> Identification of Desired Statistics</a></li>
<li class="chapter" data-level="8.4.3" data-path="descriptive-statistics-in-sas.html"><a href="descriptive-statistics-in-sas.html#in-processing-1"><i class="fa fa-check"></i><b>8.4.3</b> In processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>9</b> Descriptive Statistics in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-pape"><i class="fa fa-check"></i><b>9.1</b> Package pape</a></li>
<li class="chapter" data-level="9.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-summarytools"><i class="fa fa-check"></i><b>9.2</b> Package summarytools</a></li>
<li class="chapter" data-level="9.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-comparegroups"><i class="fa fa-check"></i><b>9.3</b> Package compareGroups</a></li>
<li class="chapter" data-level="9.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#package-kableextra"><i class="fa fa-check"></i><b>9.4</b> Package kableExtra</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#kable_styling"><i class="fa fa-check"></i><b>9.4.1</b> kable_styling</a></li>
<li class="chapter" data-level="9.4.2" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#columnrow-specification"><i class="fa fa-check"></i><b>9.4.2</b> Column/Row Specification</a></li>
<li class="chapter" data-level="9.4.3" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#grouping-columnsrows"><i class="fa fa-check"></i><b>9.4.3</b> Grouping columns/rows</a></li>
<li class="chapter" data-level="9.4.4" data-path="descriptive-statistics-in-r.html"><a href="descriptive-statistics-in-r.html#add-footnote"><i class="fa fa-check"></i><b>9.4.4</b> Add Footnote</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html"><i class="fa fa-check"></i><b>10</b> Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#distribution"><i class="fa fa-check"></i><b>10.1</b> Distribution</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#quantile-function-in-sas"><i class="fa fa-check"></i><b>10.1.1</b> Quantile Function in SAS</a></li>
<li class="chapter" data-level="10.1.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-distribution"><i class="fa fa-check"></i><b>10.1.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="10.1.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>10.1.3</b> Negative binomial distribution</a></li>
<li class="chapter" data-level="10.1.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multinomial-distribution"><i class="fa fa-check"></i><b>10.1.4</b> Multinomial distribution</a></li>
<li class="chapter" data-level="10.1.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#normal-distribution"><i class="fa fa-check"></i><b>10.1.5</b> Normal Distribution</a></li>
<li class="chapter" data-level="10.1.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>10.1.6</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="10.1.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#poisson-distribution"><i class="fa fa-check"></i><b>10.1.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="10.1.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#exponential-distribution"><i class="fa fa-check"></i><b>10.1.8</b> Exponential distribution</a></li>
<li class="chapter" data-level="10.1.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#gamma-distribution"><i class="fa fa-check"></i><b>10.1.9</b> Gamma distribution</a></li>
<li class="chapter" data-level="10.1.10" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#weibull-distribution"><i class="fa fa-check"></i><b>10.1.10</b> Weibull Distribution</a></li>
<li class="chapter" data-level="10.1.11" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#beta-distribution"><i class="fa fa-check"></i><b>10.1.11</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#point-estimates"><i class="fa fa-check"></i><b>10.2</b> Point Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-proportions"><i class="fa fa-check"></i><b>10.3</b> Test Proportion(s)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#binomial-ci-for-small-samples"><i class="fa fa-check"></i><b>10.3.1</b> Binomial CI for Small Samples</a></li>
<li class="chapter" data-level="10.3.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-binom"><i class="fa fa-check"></i><b>10.3.2</b> Package binom</a></li>
<li class="chapter" data-level="10.3.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#ci_single_proportion"><i class="fa fa-check"></i><b>10.3.3</b> %CI_Single_Proportion</a></li>
<li class="chapter" data-level="10.3.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#incidence-rate-ci"><i class="fa fa-check"></i><b>10.3.4</b> Incidence rate CI</a></li>
<li class="chapter" data-level="10.3.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#package-pwr"><i class="fa fa-check"></i><b>10.3.5</b> Package: pwr</a></li>
<li class="chapter" data-level="10.3.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-one-proportion-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.6</b> Test one Proportion based on Wald CI</a></li>
<li class="chapter" data-level="10.3.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-two-proportions-based-on-wald-ci"><i class="fa fa-check"></i><b>10.3.7</b> Test two Proportions based on Wald CI</a></li>
<li class="chapter" data-level="10.3.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test"><i class="fa fa-check"></i><b>10.3.8</b> Paired Proportions: McNemar’s Z-test</a></li>
<li class="chapter" data-level="10.3.9" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#chi-square-test"><i class="fa fa-check"></i><b>10.3.9</b> Chi-square test</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-means"><i class="fa fa-check"></i><b>10.4</b> Test Mean(s)</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-one-sample-mean"><i class="fa fa-check"></i><b>10.4.1</b> Test one sample mean</a></li>
<li class="chapter" data-level="10.4.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-two-sample-means"><i class="fa fa-check"></i><b>10.4.2</b> Test two sample means</a></li>
<li class="chapter" data-level="10.4.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test"><i class="fa fa-check"></i><b>10.4.3</b> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li class="chapter" data-level="10.4.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#test-k-means"><i class="fa fa-check"></i><b>10.4.4</b> Test k Means</a></li>
<li class="chapter" data-level="10.4.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#anova-using-pwr.anova.test"><i class="fa fa-check"></i><b>10.4.5</b> Anova using <code>pwr.anova.test</code></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#other-methods"><i class="fa fa-check"></i><b>10.5</b> Other Methods</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#odds-ratio"><i class="fa fa-check"></i><b>10.5.1</b> Odds Ratio</a></li>
<li class="chapter" data-level="10.5.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlation"><i class="fa fa-check"></i><b>10.5.2</b> Correlation</a></li>
<li class="chapter" data-level="10.5.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies"><i class="fa fa-check"></i><b>10.5.3</b> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#multiple-test"><i class="fa fa-check"></i><b>10.6</b> Multiple test</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#definitions-of-power"><i class="fa fa-check"></i><b>10.6.1</b> Definitions of Power</a></li>
<li class="chapter" data-level="10.6.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#bonferroni-tests-individual-power"><i class="fa fa-check"></i><b>10.6.2</b> Bonferroni Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#tukeys-method-individual-power"><i class="fa fa-check"></i><b>10.6.3</b> Tukey’s method (Individual Power)</a></li>
<li class="chapter" data-level="10.6.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power"><i class="fa fa-check"></i><b>10.6.4</b> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li class="chapter" data-level="10.6.5" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower"><i class="fa fa-check"></i><b>10.6.5</b> Combined Power %SimPower and %PlotSimPower</a></li>
<li class="chapter" data-level="10.6.6" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r"><i class="fa fa-check"></i><b>10.6.6</b> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#time-to-event-data"><i class="fa fa-check"></i><b>10.7</b> Time-To-Event Data</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#cox-ph-2-sided-equality"><i class="fa fa-check"></i><b>10.7.1</b> Cox PH, 2-Sided Equality</a></li>
<li class="chapter" data-level="10.7.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks"><i class="fa fa-check"></i><b>10.7.2</b> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#estimation-in-diagnostic-test"><i class="fa fa-check"></i><b>10.8</b> Estimation in diagnostic test</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#adequate-sensitivityspecificity"><i class="fa fa-check"></i><b>10.8.1</b> Adequate sensitivity/specificity</a></li>
<li class="chapter" data-level="10.8.2" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#testing-sensitivity-or-specificity"><i class="fa fa-check"></i><b>10.8.2</b> Testing sensitivity (or specificity)</a></li>
<li class="chapter" data-level="10.8.3" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#likelihood-ratio-estimation"><i class="fa fa-check"></i><b>10.8.3</b> Likelihood ratio estimation</a></li>
<li class="chapter" data-level="10.8.4" data-path="sample-size-calculation.html"><a href="sample-size-calculation.html#roc-index-of-accuracy"><i class="fa fa-check"></i><b>10.8.4</b> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="parametric-test.html"><a href="parametric-test.html"><i class="fa fa-check"></i><b>11</b> Parametric Test</a>
<ul>
<li class="chapter" data-level="11.1" data-path="parametric-test.html"><a href="parametric-test.html#binomial-test"><i class="fa fa-check"></i><b>11.1</b> Binomial test</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="parametric-test.html"><a href="parametric-test.html#mathematical-formula"><i class="fa fa-check"></i><b>11.1.1</b> Mathematical Formula</a></li>
<li class="chapter" data-level="11.1.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation"><i class="fa fa-check"></i><b>11.1.2</b> R implementation</a></li>
<li class="chapter" data-level="11.1.3" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation"><i class="fa fa-check"></i><b>11.1.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="parametric-test.html"><a href="parametric-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>11.2</b> Fisher’s Exact Test</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-2"><i class="fa fa-check"></i><b>11.2.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-1"><i class="fa fa-check"></i><b>11.2.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.2.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-1"><i class="fa fa-check"></i><b>11.2.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="parametric-test.html"><a href="parametric-test.html#mcnemars-test"><i class="fa fa-check"></i><b>11.3</b> McNemar’s test</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="parametric-test.html"><a href="parametric-test.html#introduction-3"><i class="fa fa-check"></i><b>11.3.1</b> introduction</a></li>
<li class="chapter" data-level="11.3.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-2"><i class="fa fa-check"></i><b>11.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="11.3.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-2"><i class="fa fa-check"></i><b>11.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="parametric-test.html"><a href="parametric-test.html#cochranmantelhaenszel-test"><i class="fa fa-check"></i><b>11.4</b> Cochran–Mantel–Haenszel Test</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-3"><i class="fa fa-check"></i><b>11.4.1</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="parametric-test.html"><a href="parametric-test.html#correlation-test"><i class="fa fa-check"></i><b>11.5</b> Correlation Test</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="parametric-test.html"><a href="parametric-test.html#pearson-correlation"><i class="fa fa-check"></i><b>11.5.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="11.5.2" data-path="parametric-test.html"><a href="parametric-test.html#spearman-correlation"><i class="fa fa-check"></i><b>11.5.2</b> Spearman correlation</a></li>
<li class="chapter" data-level="11.5.3" data-path="parametric-test.html"><a href="parametric-test.html#kendall-correlation"><i class="fa fa-check"></i><b>11.5.3</b> Kendall correlation</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="parametric-test.html"><a href="parametric-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>11.6</b> Two Sample T-Test</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="parametric-test.html"><a href="parametric-test.html#inreoduction-1"><i class="fa fa-check"></i><b>11.6.1</b> Inreoduction</a></li>
<li class="chapter" data-level="11.6.2" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-3"><i class="fa fa-check"></i><b>11.6.2</b> SAS implementation</a></li>
<li class="chapter" data-level="11.6.3" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-4"><i class="fa fa-check"></i><b>11.6.3</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="parametric-test.html"><a href="parametric-test.html#normality-test"><i class="fa fa-check"></i><b>11.7</b> Normality test</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="parametric-test.html"><a href="parametric-test.html#sas-implementation-4"><i class="fa fa-check"></i><b>11.7.1</b> SAS implementation</a></li>
<li class="chapter" data-level="11.7.2" data-path="parametric-test.html"><a href="parametric-test.html#r-implementation-5"><i class="fa fa-check"></i><b>11.7.2</b> R implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>12</b> ANOVA</a>
<ul>
<li class="chapter" data-level="12.1" data-path="anova.html"><a href="anova.html#unstructured-models"><i class="fa fa-check"></i><b>12.1</b> Unstructured Models</a></li>
<li class="chapter" data-level="12.2" data-path="anova.html"><a href="anova.html#balanced-one-way-analysis-of-variance-anova"><i class="fa fa-check"></i><b>12.2</b> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="anova.html"><a href="anova.html#modeling-assumptions-and-basic-analysis"><i class="fa fa-check"></i><b>12.2.1</b> Modeling Assumptions and Basic Analysis</a></li>
<li class="chapter" data-level="12.2.2" data-path="anova.html"><a href="anova.html#parameter-estimates"><i class="fa fa-check"></i><b>12.2.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="12.2.3" data-path="anova.html"><a href="anova.html#r-implementation-6"><i class="fa fa-check"></i><b>12.2.3</b> R Implementation</a></li>
<li class="chapter" data-level="12.2.4" data-path="anova.html"><a href="anova.html#sas-implementation-5"><i class="fa fa-check"></i><b>12.2.4</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.2.5" data-path="anova.html"><a href="anova.html#model-diagnosis"><i class="fa fa-check"></i><b>12.2.5</b> Model Diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="anova.html"><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>12.3</b> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="12.4" data-path="anova.html"><a href="anova.html#two-ways-anova-test"><i class="fa fa-check"></i><b>12.4</b> Two-Ways ANOVA Test</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="anova.html"><a href="anova.html#introduction-4"><i class="fa fa-check"></i><b>12.4.1</b> Introduction</a></li>
<li class="chapter" data-level="12.4.2" data-path="anova.html"><a href="anova.html#r-implementation-7"><i class="fa fa-check"></i><b>12.4.2</b> R implementation</a></li>
<li class="chapter" data-level="12.4.3" data-path="anova.html"><a href="anova.html#sas-implementation-6"><i class="fa fa-check"></i><b>12.4.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="12.4.4" data-path="anova.html"><a href="anova.html#unbalanced-design"><i class="fa fa-check"></i><b>12.4.4</b> Unbalanced design</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="anova.html"><a href="anova.html#heteroscedastic-responses"><i class="fa fa-check"></i><b>12.5</b> Heteroscedastic Responses</a></li>
<li class="chapter" data-level="12.6" data-path="anova.html"><a href="anova.html#repeated-measures-anova-data"><i class="fa fa-check"></i><b>12.6</b> Repeated Measures ANOVA Data</a></li>
<li class="chapter" data-level="12.7" data-path="anova.html"><a href="anova.html#multivariate-responses-with-normally-distributed-data"><i class="fa fa-check"></i><b>12.7</b> Multivariate Responses with Normally Distributed Data</a></li>
<li class="chapter" data-level="12.8" data-path="anova.html"><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.8</b> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li class="chapter" data-level="12.9" data-path="anova.html"><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions"><i class="fa fa-check"></i><b>12.9</b> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-comparison.html"><a href="multiple-comparison.html"><i class="fa fa-check"></i><b>13</b> Multiple-Comparison</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-5"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiplicity-problem"><i class="fa fa-check"></i><b>13.1.1</b> Multiplicity Problem</a></li>
<li class="chapter" data-level="13.1.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#error-rates"><i class="fa fa-check"></i><b>13.1.2</b> Error Rates</a></li>
<li class="chapter" data-level="13.1.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-adjusted-p"><i class="fa fa-check"></i><b>13.1.3</b> The adjusted P</a></li>
<li class="chapter" data-level="13.1.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#basic-statistical-concepts"><i class="fa fa-check"></i><b>13.1.4</b> Basic Statistical Concepts</a></li>
<li class="chapter" data-level="13.1.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#functions-in-glht-package-in-r"><i class="fa fa-check"></i><b>13.1.5</b> Functions in glht package in R</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-and-šidák-methods"><i class="fa fa-check"></i><b>13.2</b> Bonferroni and Šidák Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#lsd-least-significance-difference"><i class="fa fa-check"></i><b>13.2.1</b> LSD (least significance difference)</a></li>
<li class="chapter" data-level="13.2.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák"><i class="fa fa-check"></i><b>13.2.2</b> Šidák</a></li>
<li class="chapter" data-level="13.2.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni"><i class="fa fa-check"></i><b>13.2.3</b> Bonferroni</a></li>
<li class="chapter" data-level="13.2.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot"><i class="fa fa-check"></i><b>13.2.4</b> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova"><i class="fa fa-check"></i><b>13.3</b> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#ls-means"><i class="fa fa-check"></i><b>13.3.1</b> LS-Means</a></li>
<li class="chapter" data-level="13.3.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-multivariate-t-distribution"><i class="fa fa-check"></i><b>13.3.2</b> The Multivariate t Distribution</a></li>
<li class="chapter" data-level="13.3.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha"><i class="fa fa-check"></i><b>13.3.3</b> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li class="chapter" data-level="13.3.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution"><i class="fa fa-check"></i><b>13.3.4</b> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li class="chapter" data-level="13.3.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons"><i class="fa fa-check"></i><b>13.3.5</b> Tukey’s Method for All Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically"><i class="fa fa-check"></i><b>13.3.6</b> Displaying Pairwise Comparisons Graphically</a></li>
<li class="chapter" data-level="13.3.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><i class="fa fa-check"></i><b>13.3.7</b> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li class="chapter" data-level="13.3.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control"><i class="fa fa-check"></i><b>13.3.8</b> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li class="chapter" data-level="13.3.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><i class="fa fa-check"></i><b>13.3.9</b> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><i class="fa fa-check"></i><b>13.4</b> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#the-model-and-estimates"><i class="fa fa-check"></i><b>13.4.1</b> The Model and Estimates</a></li>
<li class="chapter" data-level="13.4.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#tukey-kramer-method"><i class="fa fa-check"></i><b>13.4.2</b> Tukey-Kramer Method</a></li>
<li class="chapter" data-level="13.4.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#alternative-simulation-based-method"><i class="fa fa-check"></i><b>13.4.3</b> Alternative Simulation-Based Method</a></li>
<li class="chapter" data-level="13.4.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#pairwise-comparisons-with-control"><i class="fa fa-check"></i><b>13.4.4</b> Pairwise Comparisons with Control</a></li>
<li class="chapter" data-level="13.4.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom"><i class="fa fa-check"></i><b>13.4.5</b> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>13.5</b> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation"><i class="fa fa-check"></i><b>13.5.1</b> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li class="chapter" data-level="13.5.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method"><i class="fa fa-check"></i><b>13.5.2</b> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li class="chapter" data-level="13.5.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction"><i class="fa fa-check"></i><b>13.5.3</b> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters"><i class="fa fa-check"></i><b>13.6</b> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#scheffés-method"><i class="fa fa-check"></i><b>13.6.1</b> Scheffés Method</a></li>
<li class="chapter" data-level="13.6.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#finding-the-maximal-contrast"><i class="fa fa-check"></i><b>13.6.2</b> Finding the Maximal Contrast</a></li>
<li class="chapter" data-level="13.6.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#working-hotelling-method"><i class="fa fa-check"></i><b>13.6.3</b> Working-Hotelling method</a></li>
<li class="chapter" data-level="13.6.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#discrete-approximation-method"><i class="fa fa-check"></i><b>13.6.4</b> Discrete approximation method</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7</b> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-of-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.1</b> Introduction of heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#satterthwaite-approximation"><i class="fa fa-check"></i><b>13.7.2</b> Satterthwaite Approximation</a></li>
<li class="chapter" data-level="13.7.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.3</b> MaxT Method under Heteroscedasticity</a></li>
<li class="chapter" data-level="13.7.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#minp-method-under-heteroscedasticity"><i class="fa fa-check"></i><b>13.7.4</b> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-and-stepwise-testing-methods"><i class="fa fa-check"></i><b>13.8</b> Closed and Stepwise Testing Methods</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-family-of-hypotheses"><i class="fa fa-check"></i><b>13.8.1</b> Closed Family of Hypotheses</a></li>
<li class="chapter" data-level="13.8.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#bonferroni-holm-method"><i class="fa fa-check"></i><b>13.8.2</b> Bonferroni-Holm Method</a></li>
<li class="chapter" data-level="13.8.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#šidák-holm-method"><i class="fa fa-check"></i><b>13.8.3</b> Šidák-Holm Method</a></li>
<li class="chapter" data-level="13.8.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-fisher-combination-method"><i class="fa fa-check"></i><b>13.8.4</b> Closed Fisher Combination Method</a></li>
<li class="chapter" data-level="13.8.5" data-path="multiple-comparison.html"><a href="multiple-comparison.html#simes-hommel-method"><i class="fa fa-check"></i><b>13.8.5</b> Simes-Hommel Method</a></li>
<li class="chapter" data-level="13.8.6" data-path="multiple-comparison.html"><a href="multiple-comparison.html#hochbergs-ok-step-up"><i class="fa fa-check"></i><b>13.8.6</b> Hochberg’s O(k) Step-Up</a></li>
<li class="chapter" data-level="13.8.7" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences"><i class="fa fa-check"></i><b>13.8.7</b> Sequential Testing with Fixed Sequences</a></li>
<li class="chapter" data-level="13.8.8" data-path="multiple-comparison.html"><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods"><i class="fa fa-check"></i><b>13.8.8</b> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="multiple-comparison.html"><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts"><i class="fa fa-check"></i><b>13.9</b> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#incorporating-logical-constraints"><i class="fa fa-check"></i><b>13.9.1</b> Incorporating Logical Constraints</a></li>
<li class="chapter" data-level="13.9.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#shaffers-method"><i class="fa fa-check"></i><b>13.9.2</b> Shaffer’s Method</a></li>
<li class="chapter" data-level="13.9.3" data-path="multiple-comparison.html"><a href="multiple-comparison.html#extended-shaffer-royen-method"><i class="fa fa-check"></i><b>13.9.3</b> Extended Shaffer-Royen Method</a></li>
<li class="chapter" data-level="13.9.4" data-path="multiple-comparison.html"><a href="multiple-comparison.html#step-down-dunnett-test"><i class="fa fa-check"></i><b>13.9.4</b> Step-down Dunnett test</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multiple-comparisons-with-binary-data"><i class="fa fa-check"></i><b>13.10</b> Multiple Comparisons with Binary Data</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="multiple-comparison.html"><a href="multiple-comparison.html#introduction-6"><i class="fa fa-check"></i><b>13.10.1</b> Introduction</a></li>
<li class="chapter" data-level="13.10.2" data-path="multiple-comparison.html"><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes"><i class="fa fa-check"></i><b>13.10.2</b> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="non-parametric-test.html"><a href="non-parametric-test.html"><i class="fa fa-check"></i><b>14</b> Non-Parametric Test</a>
<ul>
<li class="chapter" data-level="14.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#two-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.1</b> Two Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples"><i class="fa fa-check"></i><b>14.1.1</b> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li class="chapter" data-level="14.1.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched"><i class="fa fa-check"></i><b>14.1.2</b> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li class="chapter" data-level="14.1.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.3</b> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><i class="fa fa-check"></i><b>14.1.4</b> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li class="chapter" data-level="14.1.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions"><i class="fa fa-check"></i><b>14.1.5</b> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#several-samples-hypotheses-testing"><i class="fa fa-check"></i><b>14.2</b> Several Samples Hypotheses Testing</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples"><i class="fa fa-check"></i><b>14.2.1</b> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter"><i class="fa fa-check"></i><b>14.2.2</b> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#tests-for-categorical-data"><i class="fa fa-check"></i><b>14.3</b> Tests for Categorical Data</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test"><i class="fa fa-check"></i><b>14.3.1</b> Spearman Rank Correlation Coefficient Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#fisher-exact-test"><i class="fa fa-check"></i><b>14.3.2</b> Fisher Exact Test</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-test"><i class="fa fa-check"></i><b>14.4</b> Permutation test</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="non-parametric-test.html"><a href="non-parametric-test.html#introduction-7"><i class="fa fa-check"></i><b>14.4.1</b> Introduction</a></li>
<li class="chapter" data-level="14.4.2" data-path="non-parametric-test.html"><a href="non-parametric-test.html#package-coin"><i class="fa fa-check"></i><b>14.4.2</b> Package: coin</a></li>
<li class="chapter" data-level="14.4.3" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.3</b> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.4" data-path="non-parametric-test.html"><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data"><i class="fa fa-check"></i><b>14.4.4</b> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li class="chapter" data-level="14.4.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles"><i class="fa fa-check"></i><b>14.4.5</b> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="non-parametric-test.html"><a href="non-parametric-test.html#nonparametric-regression"><i class="fa fa-check"></i><b>14.5</b> Nonparametric Regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>15</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation-1"><i class="fa fa-check"></i><b>15.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.1</b> Pearson correlation coefficient</a></li>
<li class="chapter" data-level="15.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.2</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient"><i class="fa fa-check"></i><b>15.1.3</b> Kendall rank correlation coefficient</a></li>
<li class="chapter" data-level="15.1.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#intraclass-correlation"><i class="fa fa-check"></i><b>15.1.4</b> Intraclass correlation</a></li>
<li class="chapter" data-level="15.1.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualize-the-correlation-in-r"><i class="fa fa-check"></i><b>15.1.5</b> Visualize the correlation in R</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>15.2</b> Ordinary least squares (OLS)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#assumpions"><i class="fa fa-check"></i><b>15.2.1</b> Assumpions</a></li>
<li class="chapter" data-level="15.2.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#interpretation"><i class="fa fa-check"></i><b>15.2.2</b> Interpretation</a></li>
<li class="chapter" data-level="15.2.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#matrix-solution"><i class="fa fa-check"></i><b>15.2.3</b> Matrix Solution</a></li>
<li class="chapter" data-level="15.2.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>15.2.4</b> Gauss-Markov Theorem</a></li>
<li class="chapter" data-level="15.2.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#limitation"><i class="fa fa-check"></i><b>15.2.5</b> limitation</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-statistics"><i class="fa fa-check"></i><b>15.3</b> Model Statistics</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#residuals-standard-error"><i class="fa fa-check"></i><b>15.3.1</b> Residuals Standard Error</a></li>
<li class="chapter" data-level="15.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared"><i class="fa fa-check"></i><b>15.3.2</b> R-Squared and Adjusted R-Squared</a></li>
<li class="chapter" data-level="15.3.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#t-statistic"><i class="fa fa-check"></i><b>15.3.3</b> T Statistic</a></li>
<li class="chapter" data-level="15.3.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#f-statistic"><i class="fa fa-check"></i><b>15.3.4</b> F Statistic</a></li>
<li class="chapter" data-level="15.3.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>15.3.5</b> Confidence Intervals</a></li>
<li class="chapter" data-level="15.3.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>15.3.6</b> Likelihood-ratio test</a></li>
<li class="chapter" data-level="15.3.7" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#accuracy"><i class="fa fa-check"></i><b>15.3.7</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>15.4</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-error-assumptions"><i class="fa fa-check"></i><b>15.4.1</b> Checking Error Assumptions</a></li>
<li class="chapter" data-level="15.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#finding-unusual-observations"><i class="fa fa-check"></i><b>15.4.2</b> Finding Unusual Observations</a></li>
<li class="chapter" data-level="15.4.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#checking-the-structure-of-the-model"><i class="fa fa-check"></i><b>15.4.3</b> Checking the Structure of the Model</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#sas-implementation-proc-reg"><i class="fa fa-check"></i><b>15.5</b> SAS implementation Proc Reg</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#options"><i class="fa fa-check"></i><b>15.5.1</b> Options</a></li>
<li class="chapter" data-level="15.5.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#diagnose"><i class="fa fa-check"></i><b>15.5.2</b> Diagnose</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#r-implementation-8"><i class="fa fa-check"></i><b>15.6</b> R implementation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html"><i class="fa fa-check"></i><b>16</b> Advanced Linear Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#model-selection"><i class="fa fa-check"></i><b>16.1</b> Model Selection</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-methods"><i class="fa fa-check"></i><b>16.1.1</b> Selection Methods</a></li>
<li class="chapter" data-level="16.1.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#selection-criteria"><i class="fa fa-check"></i><b>16.1.2</b> Selection Criteria</a></li>
<li class="chapter" data-level="16.1.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#k--fold-cross-validation"><i class="fa fa-check"></i><b>16.1.3</b> k- Fold Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#practical-difficulties-using-ols"><i class="fa fa-check"></i><b>16.2</b> Practical Difficulties using OLS</a></li>
<li class="chapter" data-level="16.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#skewness"><i class="fa fa-check"></i><b>16.3</b> Skewness</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#introduction-8"><i class="fa fa-check"></i><b>16.3.1</b> Introduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#baisc-transformation"><i class="fa fa-check"></i><b>16.3.2</b> Baisc Transformation</a></li>
<li class="chapter" data-level="16.3.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#box-cox-power-transformation"><i class="fa fa-check"></i><b>16.3.3</b> Box-Cox Power Transformation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#scale-1"><i class="fa fa-check"></i><b>16.4</b> Scale</a></li>
<li class="chapter" data-level="16.5" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#interaction"><i class="fa fa-check"></i><b>16.5</b> Interaction</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>16.5.1</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="16.5.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#plotting-interactions"><i class="fa fa-check"></i><b>16.5.2</b> Plotting Interactions</a></li>
<li class="chapter" data-level="16.5.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#check-linearity-assumption"><i class="fa fa-check"></i><b>16.5.3</b> Check linearity assumption</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#collinearity"><i class="fa fa-check"></i><b>16.6</b> Collinearity</a></li>
<li class="chapter" data-level="16.7" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#problems-with-the-error"><i class="fa fa-check"></i><b>16.7</b> Problems with the Error</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#generalized-least-squares"><i class="fa fa-check"></i><b>16.7.1</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="16.7.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>16.7.2</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="16.7.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#robust-regression"><i class="fa fa-check"></i><b>16.7.3</b> Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#shrinkage-methods"><i class="fa fa-check"></i><b>16.8</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#principal-components-analzsis"><i class="fa fa-check"></i><b>16.8.1</b> Principal Components Analzsis</a></li>
<li class="chapter" data-level="16.8.2" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#partial-least-squares"><i class="fa fa-check"></i><b>16.8.2</b> Partial Least Squares</a></li>
<li class="chapter" data-level="16.8.3" data-path="advanced-linear-regression.html"><a href="advanced-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>16.8.3</b> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>17</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-9"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols"><i class="fa fa-check"></i><b>17.1.1</b> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li class="chapter" data-level="17.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#more-fundamental-problem-outside-01"><i class="fa fa-check"></i><b>17.1.2</b> More fundamental problem outside [0,1]</a></li>
<li class="chapter" data-level="17.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-model"><i class="fa fa-check"></i><b>17.1.3</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="17.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-of-the-logistic-model"><i class="fa fa-check"></i><b>17.1.4</b> Estimation of the Logistic Model</a></li>
<li class="chapter" data-level="17.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#convergence-problems"><i class="fa fa-check"></i><b>17.1.5</b> Convergence Problems</a></li>
<li class="chapter" data-level="17.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#use-exact-methods."><i class="fa fa-check"></i><b>17.1.6</b> Use exact methods.</a></li>
<li class="chapter" data-level="17.1.7" data-path="logistic-regression.html"><a href="logistic-regression.html#use-penalized-likelihood"><i class="fa fa-check"></i><b>17.1.7</b> Use penalized likelihood</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-modell"><i class="fa fa-check"></i><b>17.2</b> Logit Modell</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-10"><i class="fa fa-check"></i><b>17.2.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-9"><i class="fa fa-check"></i><b>17.2.2</b> R Implementation</a></li>
<li class="chapter" data-level="17.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-7"><i class="fa fa-check"></i><b>17.2.3</b> SAS Implementation</a></li>
<li class="chapter" data-level="17.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#multicollinearity"><i class="fa fa-check"></i><b>17.2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="17.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance"><i class="fa fa-check"></i><b>17.2.5</b> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li class="chapter" data-level="17.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.2.6</b> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="17.2.7" data-path="logistic-regression.html"><a href="logistic-regression.html#statistics-measuring-predictive-power-r2"><i class="fa fa-check"></i><b>17.2.7</b> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="17.2.8" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>17.2.8</b> ROC Curves</a></li>
<li class="chapter" data-level="17.2.9" data-path="logistic-regression.html"><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics"><i class="fa fa-check"></i><b>17.2.9</b> Predicted Values, Residuals, and Influence Statistics</a></li>
<li class="chapter" data-level="17.2.10" data-path="logistic-regression.html"><a href="logistic-regression.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>17.2.10</b> Unobserved Heterogeneity</a></li>
<li class="chapter" data-level="17.2.11" data-path="logistic-regression.html"><a href="logistic-regression.html#plotting-effects-of-predictor-variables"><i class="fa fa-check"></i><b>17.2.11</b> Plotting Effects of Predictor Variables</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="logistic-regression.html"><a href="logistic-regression.html#probit-modell"><i class="fa fa-check"></i><b>17.3</b> Probit Modell</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-11"><i class="fa fa-check"></i><b>17.3.1</b> Introduction</a></li>
<li class="chapter" data-level="17.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation"><i class="fa fa-check"></i><b>17.3.2</b> R Implemetation</a></li>
<li class="chapter" data-level="17.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-8"><i class="fa fa-check"></i><b>17.3.3</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="logistic-regression.html"><a href="logistic-regression.html#complementary-log-log-modell"><i class="fa fa-check"></i><b>17.4</b> Complementary log-log-Modell</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implemetation-1"><i class="fa fa-check"></i><b>17.4.1</b> R Implemetation</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multi-category-logit-model"><i class="fa fa-check"></i><b>17.5</b> Multi-category logit model</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#multinomialverteilung"><i class="fa fa-check"></i><b>17.5.1</b> Multinomialverteilung</a></li>
<li class="chapter" data-level="17.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#mehrkategoriales-logit-modell"><i class="fa fa-check"></i><b>17.5.2</b> Mehrkategoriales Logit-Modell</a></li>
<li class="chapter" data-level="17.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-10"><i class="fa fa-check"></i><b>17.5.3</b> R Implementation</a></li>
<li class="chapter" data-level="17.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-9"><i class="fa fa-check"></i><b>17.5.4</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="logistic-regression.html"><a href="logistic-regression.html#ordinal-cumulative-logit-model"><i class="fa fa-check"></i><b>17.6</b> Ordinal Cumulative Logit Model</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#r-implementation-11"><i class="fa fa-check"></i><b>17.6.1</b> R Implementation</a></li>
<li class="chapter" data-level="17.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#sas-implementation-10"><i class="fa fa-check"></i><b>17.6.2</b> SAS Implementation</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="logistic-regression.html"><a href="logistic-regression.html#adjacent-categories-model"><i class="fa fa-check"></i><b>17.7</b> Adjacent Categories Model</a></li>
<li class="chapter" data-level="17.8" data-path="logistic-regression.html"><a href="logistic-regression.html#continuation-ratio-model"><i class="fa fa-check"></i><b>17.8</b> Continuation Ratio Model</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html"><i class="fa fa-check"></i><b>18</b> Advanced Logistic Regression</a>
<ul>
<li class="chapter" data-level="18.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.1</b> Logit Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table"><i class="fa fa-check"></i><b>18.1.1</b> Two-Way Table</a></li>
<li class="chapter" data-level="18.1.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#three-way-table"><i class="fa fa-check"></i><b>18.1.2</b> Three-Way Table</a></li>
<li class="chapter" data-level="18.1.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#four-way-table"><i class="fa fa-check"></i><b>18.1.3</b> Four-Way Table</a></li>
<li class="chapter" data-level="18.1.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#overdispersion"><i class="fa fa-check"></i><b>18.1.4</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables"><i class="fa fa-check"></i><b>18.2</b> Loglinear Analysis of Contingency Tables</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#two-way-table-1"><i class="fa fa-check"></i><b>18.2.1</b> Two-way Table</a></li>
<li class="chapter" data-level="18.2.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#problem-of-zeros"><i class="fa fa-check"></i><b>18.2.2</b> Problem of Zeros</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#discrete-choice-analysis"><i class="fa fa-check"></i><b>18.3</b> Discrete Choice Analysis</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#logistic-strata"><i class="fa fa-check"></i><b>18.3.1</b> Logistic Strata</a></li>
<li class="chapter" data-level="18.3.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#conditional-logit-model"><i class="fa fa-check"></i><b>18.3.2</b> Conditional logit model</a></li>
<li class="chapter" data-level="18.3.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#ranked-data"><i class="fa fa-check"></i><b>18.3.3</b> Ranked Data</a></li>
<li class="chapter" data-level="18.3.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model"><i class="fa fa-check"></i><b>18.3.4</b> Heteroscedastic extreme value (HEV) Model</a></li>
<li class="chapter" data-level="18.3.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#nested-logit-model"><i class="fa fa-check"></i><b>18.3.5</b> Nested logit model</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data"><i class="fa fa-check"></i><b>18.4</b> Longitudinal and Other Clustered Data</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#introduction-12"><i class="fa fa-check"></i><b>18.4.1</b> Introduction</a></li>
<li class="chapter" data-level="18.4.2" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#robust-standard-errors"><i class="fa fa-check"></i><b>18.4.2</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="18.4.3" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod"><i class="fa fa-check"></i><b>18.4.3</b> GEE Estimation with PROC GENMOD</a></li>
<li class="chapter" data-level="18.4.4" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix"><i class="fa fa-check"></i><b>18.4.4</b> Mixed Models with PROC GLIMMIX</a></li>
<li class="chapter" data-level="18.4.5" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression"><i class="fa fa-check"></i><b>18.4.5</b> Fixed-Effects with Conditional Logistic Regression</a></li>
<li class="chapter" data-level="18.4.6" data-path="advanced-logistic-regression.html"><a href="advanced-logistic-regression.html#hybrid-method"><i class="fa fa-check"></i><b>18.4.6</b> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>19</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="survival-analysis.html"><a href="survival-analysis.html#preliminary"><i class="fa fa-check"></i><b>19.1</b> Preliminary</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="survival-analysis.html"><a href="survival-analysis.html#probability-density-function"><i class="fa fa-check"></i><b>19.1.1</b> Probability density function</a></li>
<li class="chapter" data-level="19.1.2" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-function"><i class="fa fa-check"></i><b>19.1.2</b> Survival function</a></li>
<li class="chapter" data-level="19.1.3" data-path="survival-analysis.html"><a href="survival-analysis.html#hazard-function"><i class="fa fa-check"></i><b>19.1.3</b> Hazard function</a></li>
<li class="chapter" data-level="19.1.4" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-hazard-function"><i class="fa fa-check"></i><b>19.1.4</b> Cumulative hazard function</a></li>
<li class="chapter" data-level="19.1.5" data-path="survival-analysis.html"><a href="survival-analysis.html#mean-residual-life"><i class="fa fa-check"></i><b>19.1.5</b> Mean Residual Life</a></li>
<li class="chapter" data-level="19.1.6" data-path="survival-analysis.html"><a href="survival-analysis.html#relation-between-functions"><i class="fa fa-check"></i><b>19.1.6</b> Relation between functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>19.2</b> Kaplan-Meier estimator</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="survival-analysis.html"><a href="survival-analysis.html#km-introduction"><i class="fa fa-check"></i><b>19.2.1</b> KM Introduction</a></li>
<li class="chapter" data-level="19.2.2" data-path="survival-analysis.html"><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function"><i class="fa fa-check"></i><b>19.2.2</b> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li class="chapter" data-level="19.2.3" data-path="survival-analysis.html"><a href="survival-analysis.html#survival-curve-in-sas"><i class="fa fa-check"></i><b>19.2.3</b> Survival curve in SAS</a></li>
<li class="chapter" data-level="19.2.4" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-sas"><i class="fa fa-check"></i><b>19.2.4</b> KM Survival Plots in SAS</a></li>
<li class="chapter" data-level="19.2.5" data-path="survival-analysis.html"><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r"><i class="fa fa-check"></i><b>19.2.5</b> Convert Personal-level to Personal-period in R</a></li>
<li class="chapter" data-level="19.2.6" data-path="survival-analysis.html"><a href="survival-analysis.html#package-survfit-in-r"><i class="fa fa-check"></i><b>19.2.6</b> Package survfit in R</a></li>
<li class="chapter" data-level="19.2.7" data-path="survival-analysis.html"><a href="survival-analysis.html#km-survival-plots-in-r"><i class="fa fa-check"></i><b>19.2.7</b> KM Survival Plots in R</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="survival-analysis.html"><a href="survival-analysis.html#compare-the-survival-function"><i class="fa fa-check"></i><b>19.3</b> Compare the survival function</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="survival-analysis.html"><a href="survival-analysis.html#tests-of-equality-of-the-survival-function"><i class="fa fa-check"></i><b>19.3.1</b> Tests of equality of the survival function</a></li>
<li class="chapter" data-level="19.3.2" data-path="survival-analysis.html"><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement"><i class="fa fa-check"></i><b>19.3.2</b> Other nonparametric tests for STRATA statement</a></li>
<li class="chapter" data-level="19.3.3" data-path="survival-analysis.html"><a href="survival-analysis.html#multiple-comparisons"><i class="fa fa-check"></i><b>19.3.3</b> Multiple comparisons</a></li>
<li class="chapter" data-level="19.3.4" data-path="survival-analysis.html"><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr"><i class="fa fa-check"></i><b>19.3.4</b> Comparing survival functions using Log-Rank HR</a></li>
<li class="chapter" data-level="19.3.5" data-path="survival-analysis.html"><a href="survival-analysis.html#mantel-haenszel-hr"><i class="fa fa-check"></i><b>19.3.5</b> Mantel-Haenszel HR</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>19.4</b> Cox Proportional Hazards Model</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-13"><i class="fa fa-check"></i><b>19.4.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="advanced-survival-analysis.html"><a href="advanced-survival-analysis.html"><i class="fa fa-check"></i><b>20</b> Advanced Survival Analysis</a></li>
<li class="chapter" data-level="21" data-path="count-data-regression.html"><a href="count-data-regression.html"><i class="fa fa-check"></i><b>21</b> Count Data Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="count-data-regression.html"><a href="count-data-regression.html#introduction-of-count-data-regression"><i class="fa fa-check"></i><b>21.1</b> Introduction of Count Data Regression</a></li>
<li class="chapter" data-level="21.2" data-path="count-data-regression.html"><a href="count-data-regression.html#poisson-regression"><i class="fa fa-check"></i><b>21.2</b> Poisson regression</a></li>
<li class="chapter" data-level="21.3" data-path="count-data-regression.html"><a href="count-data-regression.html#negative-binomial-regression"><i class="fa fa-check"></i><b>21.3</b> Negative Binomial Regression</a></li>
<li class="chapter" data-level="21.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-truncated-poisson-regression-model"><i class="fa fa-check"></i><b>21.4</b> Zero-truncated Poisson Regression Model</a></li>
<li class="chapter" data-level="21.5" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-insflated-model"><i class="fa fa-check"></i><b>21.5</b> Zero-Insflated Model</a></li>
<li class="chapter" data-level="21.6" data-path="count-data-regression.html"><a href="count-data-regression.html#hurdle-models"><i class="fa fa-check"></i><b>21.6</b> Hurdle models</a></li>
<li class="chapter" data-level="21.7" data-path="count-data-regression.html"><a href="count-data-regression.html#proportion-response-regression"><i class="fa fa-check"></i><b>21.7</b> Proportion-Response-Regression</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="count-data-regression.html"><a href="count-data-regression.html#beta-regression"><i class="fa fa-check"></i><b>21.7.1</b> Beta Regression</a></li>
<li class="chapter" data-level="21.7.2" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.2</b> Zero-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.7.3" data-path="count-data-regression.html"><a href="count-data-regression.html#one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.3</b> One-inflated Beta Regression</a></li>
<li class="chapter" data-level="21.7.4" data-path="count-data-regression.html"><a href="count-data-regression.html#zero-one-inflated-beta-regression"><i class="fa fa-check"></i><b>21.7.4</b> Zero-one-inflated Beta Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mixed-model.html"><a href="mixed-model.html"><i class="fa fa-check"></i><b>22</b> Mixed Model</a>
<ul>
<li class="chapter" data-level="22.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-14"><i class="fa fa-check"></i><b>22.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="mixed-model.html"><a href="mixed-model.html#correlated-response-data"><i class="fa fa-check"></i><b>22.1.1</b> Correlated response data</a></li>
<li class="chapter" data-level="22.1.2" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-and-marginal-model"><i class="fa fa-check"></i><b>22.1.2</b> Hierarchical and Marginal model</a></li>
<li class="chapter" data-level="22.1.3" data-path="mixed-model.html"><a href="mixed-model.html#mle-in-marginal-model"><i class="fa fa-check"></i><b>22.1.3</b> MLE in Marginal model</a></li>
<li class="chapter" data-level="22.1.4" data-path="mixed-model.html"><a href="mixed-model.html#reml-in-marginal-model"><i class="fa fa-check"></i><b>22.1.4</b> REML in Marginal model</a></li>
<li class="chapter" data-level="22.1.5" data-path="mixed-model.html"><a href="mixed-model.html#variance-correction"><i class="fa fa-check"></i><b>22.1.5</b> Variance correction</a></li>
<li class="chapter" data-level="22.1.6" data-path="mixed-model.html"><a href="mixed-model.html#hypothesis-tests"><i class="fa fa-check"></i><b>22.1.6</b> Hypothesis tests</a></li>
<li class="chapter" data-level="22.1.7" data-path="mixed-model.html"><a href="mixed-model.html#residual-structure"><i class="fa fa-check"></i><b>22.1.7</b> Residual Structure</a></li>
<li class="chapter" data-level="22.1.8" data-path="mixed-model.html"><a href="mixed-model.html#converge-problems"><i class="fa fa-check"></i><b>22.1.8</b> Converge problems</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model"><i class="fa fa-check"></i><b>22.2</b> Random Slope and Intercept Model</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction"><i class="fa fa-check"></i><b>22.2.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.2.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-11"><i class="fa fa-check"></i><b>22.2.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.2.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-12"><i class="fa fa-check"></i><b>22.2.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="mixed-model.html"><a href="mixed-model.html#random-slope-and-intercept-model-with-covariance-structure"><i class="fa fa-check"></i><b>22.3</b> Random Slope and Intercept Model with Covariance Structure</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="mixed-model.html"><a href="mixed-model.html#model-introduction-1"><i class="fa fa-check"></i><b>22.3.1</b> Model Introduction</a></li>
<li class="chapter" data-level="22.3.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-12"><i class="fa fa-check"></i><b>22.3.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.3.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-13"><i class="fa fa-check"></i><b>22.3.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="mixed-model.html"><a href="mixed-model.html#generalized-estimating-equation"><i class="fa fa-check"></i><b>22.4</b> Generalized Estimating Equation</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-of-gee"><i class="fa fa-check"></i><b>22.4.1</b> Introduction of GEE</a></li>
<li class="chapter" data-level="22.4.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-13"><i class="fa fa-check"></i><b>22.4.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.4.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-14"><i class="fa fa-check"></i><b>22.4.3</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="mixed-model.html"><a href="mixed-model.html#hierarchical-regression-model-for-normal-response"><i class="fa fa-check"></i><b>22.5</b> Hierarchical Regression Model for Normal Response</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="mixed-model.html"><a href="mixed-model.html#introduction-15"><i class="fa fa-check"></i><b>22.5.1</b> Introduction</a></li>
<li class="chapter" data-level="22.5.2" data-path="mixed-model.html"><a href="mixed-model.html#sas-implementation-14"><i class="fa fa-check"></i><b>22.5.2</b> SAS Implementation</a></li>
<li class="chapter" data-level="22.5.3" data-path="mixed-model.html"><a href="mixed-model.html#r-implementation-15"><i class="fa fa-check"></i><b>22.5.3</b> R Implementation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="generalized-linear-mixed-model.html"><a href="generalized-linear-mixed-model.html"><i class="fa fa-check"></i><b>23</b> Generalized Linear (Mixed) Model</a></li>
<li class="chapter" data-level="24" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html"><i class="fa fa-check"></i><b>24</b> Group (Adaptive) Sequential Design</a>
<ul>
<li class="chapter" data-level="24.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#section"><i class="fa fa-check"></i><b>24.1</b> </a></li>
<li class="chapter" data-level="24.2" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#adaptive-designs"><i class="fa fa-check"></i><b>24.2</b> Adaptive designs</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="group-adaptive-sequential-design.html"><a href="group-adaptive-sequential-design.html#introduction-16"><i class="fa fa-check"></i><b>24.2.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="space.html"><a href="space.html"><i class="fa fa-check"></i><b>25</b> ^_^ Space</a></li>
<li class="chapter" data-level="26" data-path="propensity-score.html"><a href="propensity-score.html"><i class="fa fa-check"></i><b>26</b> Propensity Score</a></li>
<li class="chapter" data-level="27" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>27</b> Missing Data</a>
<ul>
<li class="chapter" data-level="27.1" data-path="missing-data.html"><a href="missing-data.html#missing-mechanisms"><i class="fa fa-check"></i><b>27.1</b> Missing mechanisms</a></li>
<li class="chapter" data-level="27.2" data-path="missing-data.html"><a href="missing-data.html#compatibility-and-congeniality"><i class="fa fa-check"></i><b>27.2</b> Compatibility and Congeniality</a></li>
<li class="chapter" data-level="27.3" data-path="missing-data.html"><a href="missing-data.html#single-imputation"><i class="fa fa-check"></i><b>27.3</b> Single imputation</a></li>
<li class="chapter" data-level="27.4" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>27.4</b> Multiple imputation</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="missing-data.html"><a href="missing-data.html#joint-modeling-jm"><i class="fa fa-check"></i><b>27.4.1</b> Joint Modeling (JM)</a></li>
<li class="chapter" data-level="27.4.2" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice"><i class="fa fa-check"></i><b>27.4.2</b> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="missing-data.html"><a href="missing-data.html#bayesian-linear-regression"><i class="fa fa-check"></i><b>27.5</b> Bayesian linear regression</a></li>
<li class="chapter" data-level="27.6" data-path="missing-data.html"><a href="missing-data.html#predictive-mean-matching"><i class="fa fa-check"></i><b>27.6</b> Predictive Mean Matching</a></li>
<li class="chapter" data-level="27.7" data-path="missing-data.html"><a href="missing-data.html#mice-using-random-forest"><i class="fa fa-check"></i><b>27.7</b> MICE using random forest</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="survival-analysis" class="section level1" number="19">
<h1><span class="header-section-number">Chapter 19</span> Survival Analysis</h1>
<div id="htmlwidget-f44fe196b685de1aa2c7" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-f44fe196b685de1aa2c7">{"x":{"data":"# \n## Survival Analysis \n### Preliminary\n#### Probability density function\n#### Cumulative distribution function\n#### Survival function\n#### Hazard function\n#### Cumulative hazard function\n#### Mean Residual Life\n#### Relation between functions\n### Kaplan-Meier estimator\n#### KM Introduction\n#### Nelson-Aalen estimator of the cumulative hazard function\n#### Survival curve in SAS\n#### KM Survival Plots in SAS\n#### Convert Personal-level to Personal-period in R\n#### Package survfit in R\n#### KM Survival Plots in R\n### Compare the survival function\n#### Tests of equality of the survival function\n#### Other nonparametric tests for STRATA statement \n#### Multiple comparisons\n#### Comparing survival functions using Log-Rank HR\n#### Mantel-Haenszel HR\n### Cox Proportional Hazards Model\n#### Introduction","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="preliminary" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Preliminary</h2>
<p>Survival analysis mainly focuses on processing a special kind of time data, and the time data may be partially censored. The shortcomings of the ordinary least squares regression method are that the event occurrence time is usually not normally distributed, and the model cannot handle Censor. The non-parametric method can simply and quickly check the survival experience, while the Cox proportional hazard regression model is still the main Analytical method.</p>
<div id="probability-density-function" class="section level3" number="19.1.1">
<h3><span class="header-section-number">19.1.1</span> Probability density function</h3>
<p>The function that describes likelihood of observing Time at time t relative to all other survival times is known as the probability density function
the probability of observing a survival time within the interval <span class="math inline">\([a, b]\)</span> is
<span class="math display">\[
\operatorname{Pr}(a \leq \text { Time } \leq b)=\int_{a}^{b} f(t) d t=\int_{a}^{b} \lambda e^{-\lambda t} d t
\]</span>
### Cumulative distribution function</p>
<p>Describes the probability of observing Time less than or equal to some timet <span class="math inline">\(t\)</span> <span class="math inline">\(\operatorname{Pr}(\)</span> Time <span class="math inline">\(\leq t)\)</span>
<span class="math display">\[
\begin{array}{c}
F(t)=\int_{0}^{t} f(t) d t \\
f(t)=\frac{d F(t)}{d t}
\end{array}
\]</span>
In SAS, we can graph an estimate of the cdf using proc univariate.</p>
<pre><code>proc univariate data = whas500(where=(fstat=1));
    var lenfol;
    cdfplot lenfol;
run;</code></pre>
</div>
<div id="survival-function" class="section level3" number="19.1.2">
<h3><span class="header-section-number">19.1.2</span> Survival function</h3>
<p><span class="math display">\[
S(t)=P(T&gt;t)=1-F(t)
\]</span>
The survival function gives the probability that a person survives longer than some specified time <span class="math inline">\(t\)</span> : that
is, <span class="math inline">\(S(t)\)</span> gives the probability that the random variable <span class="math inline">\(T\)</span> exceeds the specified time <span class="math inline">\(t .\)</span> And here, some
important characteristics:</p>
<ul>
<li>It is nonincreasing; that is, it heads downward as <span class="math inline">\(t\)</span> increases.</li>
<li>At time <span class="math inline">\(t=0, S(t)=S(0)=1\)</span>; that is, at the start of the study, since no one has gotten the event
yet, the probability of surviving past time zero is one.</li>
<li>At time <span class="math inline">\(t=\inf , S(t)=S(\mathrm{inf})=0 ;\)</span> that is, theoretically, if the study period increased without limit.
eventually nobody would survive, so the survival curve must eventually fall to zero.</li>
</ul>
<p>Here we can use proc lifetest to graph <span class="math inline">\(S_(t)\)</span>.</p>
<pre><code>proc lifetest data=whas500(where=(fstat=1)) plots=survival(atrisk);
time lenfol*fstat(0);
run; </code></pre>
</div>
<div id="hazard-function" class="section level3" number="19.1.3">
<h3><span class="header-section-number">19.1.3</span> Hazard function</h3>
<p>The hazard function <span class="math inline">\(h(t)\)</span>, is given by the formula:
<span class="math display">\[
h(t)=\lim _{\Delta_{t} \rightarrow 0} \frac{P(t \leq T&lt;t+\Delta t \mid T \geq t)}{\Delta t}
\]</span>
We could say that the hazard function
is the probability that if you survive to time <span class="math inline">\(t\)</span>, you will experience the event in the next instant, or in other
words, the hazard function gives the instantaneous potential per unit time for the event to occur, given
that the individual has survived up to time <span class="math inline">\(t\)</span>. Because of the given sign here, the hazard function is
sometimes called a conditional failure rate.</p>
<p>We can estimate the hazard function is SAS as well using proc lifetest</p>
<pre><code>proc lifetest data=whas500(where=(fstat=1)) plots=hazard(bw=200);
    time lenfol*fstat(0);
run;</code></pre>
</div>
<div id="cumulative-hazard-function" class="section level3" number="19.1.4">
<h3><span class="header-section-number">19.1.4</span> Cumulative hazard function</h3>
<p>Calculated by integrating the hazard function over an interval of time:
<span class="math display">\[H(t) = \int_0^th(u)du\]</span></p>
<p>The cumulative hazard function H(t) and the survival function S(t) have a simple monotonic relationship. Therefore, when the survival function reaches the maximum at the beginning of the analysis time, the cumulative hazard function is the smallest. As time goes by, the survival function advances toward its minimum, and the cumulative hazard function advances toward its maximum. You can use proc lifetest to estimate the cumulative hazard function, and then send the results to proc sgplot for plotting.</p>
<pre><code>ods output ProductLimitEstimates = ple;
proc lifetest data=whas500(where=(fstat=1))  nelson outs=outwhas500;
    time lenfol*fstat(0);
run;
proc sgplot data = ple;
    series x = lenfol y = CumHaz;
run;</code></pre>
</div>
<div id="mean-residual-life" class="section level3" number="19.1.5">
<h3><span class="header-section-number">19.1.5</span> Mean Residual Life</h3>
<p><span class="math display">\[r(t)=E(T-t \mid T \geq t)=\frac{\int_{t}^{\infty} S(u) d u}{S(t)},\]</span></p>
<p>Intuitively, this is as simple as when I know that I have lived to the time point t and how many years I have to live.</p>
</div>
<div id="relation-between-functions" class="section level3" number="19.1.6">
<h3><span class="header-section-number">19.1.6</span> Relation between functions</h3>
<p>The survival function can be ascertained from the probability density function by integrating
over the probability density function from time <span class="math inline">\(t\)</span> to infinity, or by calculating the difference between one and the cumulative distribution function <span class="math inline">\(F(t)\)</span>. The hazard can then be found by dividing the negative derivative of the survival function by the survival function. Note that the functions <span class="math inline">\(f(t), F(t), h(t)\)</span>, and
<span class="math inline">\(H(t)\)</span> are all related.</p>
<p><strong>Assume that <span class="math inline">\(T\)</span> is non-negative and continuos:</strong></p>
<ul>
<li>Probability density function:
<span class="math display">\[
f(t)=F^{\prime}(t)=\frac{d F(t)}{d t}
\]</span></li>
<li>Cumulative distribution function:
<span class="math display">\[
F(t)=P(T \leq t)=\int_{0}^{t} f(u) d u
\]</span></li>
<li>Survival function
<span class="math display">\[
\begin{array}{l}
S(t)=1-F(t)\\
S(t)=P(T&gt;t)=\int_{t}^{+\infty} f(u) d u \\
S(t)=\exp \left(-\int_{0}^{t} h(u) d u\right) \\
S(t)=\exp (-H(t))
\end{array}
\]</span></li>
<li>Hazard function
<span class="math display">\[h(t) = \frac{ f(t)}{S(t)}= \frac{ -d[S(t)]/dt}{S(t)}\]</span></li>
<li>Cumulative hazard function
o Cumulative hazard function
<span class="math display">\[
H(t)=\int_{0}^{t} h(u) d u
\]</span></li>
</ul>
<p><strong>Assume that <span class="math inline">\(T\)</span> is non-negative and discrete,</strong></p>
<ul>
<li>Probability mass function:
<span class="math display">\[
\begin{aligned}
p\left(t_{i}\right) &amp;=P\left(T=t_{i}\right) \\
p\left(t_{i}\right) &amp;=S\left(t_{i-1}\right)-S\left(t_{i}\right) \\
p\left(t_{i}\right) &amp;=F\left(t_{i}\right)-F\left(t_{i-1}\right)
\end{aligned}
\]</span></li>
<li>Cumulative distribution function:
<span class="math display">\[
F(t)=P(T \leq t)=\sum_{t_{i} \leq t} p\left(t_{i}\right)
\]</span></li>
<li>Survival function
<span class="math display">\[
S(t)=\prod_{t_{i} \leq t}\left(1-h\left(t_{i}\right)\right)
\]</span></li>
<li>Hazard function
<span class="math display">\[
\begin{aligned}
h(t) &amp;=\frac{p\left(t_{i}\right)}{S\left(t_{i-1}\right)}=\frac{-d[S(t)] / d t}{S(t)} \\
h(t) &amp;=1-\frac{S\left(t_{i}\right)}{S\left(t_{i-1}\right)}
\end{aligned}
\]</span></li>
<li>Cumulative hazard function
<span class="math display">\[
H(t)=\sum_{t_{i} \leq t} h\left(t_{i}\right)
\]</span></li>
</ul>
</div>
</div>
<div id="kaplan-meier-estimator" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> Kaplan-Meier estimator</h2>
<div id="km-introduction" class="section level3" number="19.2.1">
<h3><span class="header-section-number">19.2.1</span> KM Introduction</h3>
<p><span class="math display">\[\hat S(t)=\prod_{t_i\leq t}\frac{n_i – d_i}{n_i},\]</span></p>
<ul>
<li><span class="math inline">\(n_{i}\)</span> is the number of subjects at risk</li>
<li><span class="math inline">\(d_{i}\)</span> is the number of subjects who fail, both at time <span class="math inline">\(t_{i}\)</span>, the number who failed out
of <span class="math inline">\(n_{i}\)</span></li>
</ul>
</div>
<div id="nelson-aalen-estimator-of-the-cumulative-hazard-function" class="section level3" number="19.2.2">
<h3><span class="header-section-number">19.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</h3>
<p>Since it and the survival function <span class="math inline">\(S(t)=e^{-H(t)}\)</span> Nelson-Aalen estimator is a non-parametric estimator of the cumulative hazard function</p>
<p><span class="math display">\[
\hat{H}(t)=\sum_{t_{i} l e q t} \frac{d_{i}}{n_{i}}
\]</span></p>
<ul>
<li>The Nelson-Aalen estimator is requested in SAS through the nelson option on
the proc lifetest statement. SAS will output both Kaplan Meier estimates of
the survival function and Nelson-Aalen estimates of the cumulative hazard
function in one table.</li>
<li>Quartile Estimates: Calculating median, mean, and other survival times</li>
</ul>
<pre><code>proc lifetest data=whas500 atrisk nelson;
    time lenfol*fstat(0);
run;</code></pre>
</div>
<div id="survival-curve-in-sas" class="section level3" number="19.2.3">
<h3><span class="header-section-number">19.2.3</span> Survival curve in SAS</h3>
<pre><code>proc lifetest data=whas500 atrisk plots=survival(cb) outs=outwhas500;
  time lenfol*fstat(0);
run;</code></pre>
<p><strong>Graphing the Kaplan-Meier estimate</strong></p>
<ul>
<li>By default, proc lifetest graphs the Kaplan Meier estimate, even without the
plot= option on the proc lifetest statement, so we could have used the
same code from above that produced the table of Kaplan-Meier estimates to
generate the graph.</li>
<li>However, we would like to add confidence bands and the number at risk to the
graph, so we add plots=survival(atrisk cb)</li>
</ul>
<blockquote>
<p>生存曲线周围的蓝色阴影区域代表95%置信带，此处为Hall-Wellner置信带。为整 个生存函数计算该置信带，在任何给定的时间间隔内，其宽度必须大于点状置信区
间 (单个间隔附近的置信度间隔)， 以确保所有点状置信区间的95%都包含在该带 中。survivor 函数的许多转换可用于通过conftype选项计算置信区间的替代方法</p>
</blockquote>
<p><strong>Life Table method</strong></p>
<p>生命表方法如果观察的次数很多，并且如果精确地测量了事件时间，那么将有很多唯一的事件时间。然后，KM方法会生成较长的表，这些表可能难以呈现和解释。</p>
<ol style="list-style-type: decimal">
<li>解决此问题的一种方法是使用TIMELIST选项（在PROC LIFEREG语句中），该选项仅在指定的时间点报告KM估计。</li>
<li>另一种解决方案是切换到生命周期表方法 life-table method ，在该方法中，事件时间被分组为可以随意设置的时间间隔。此外，寿命表方法（也称为精算方法 actuarial method）可以生成危害函数的估计值和曲线图。寿命表方法的缺点是间隔的选择通常有些随意，从而导致结果的
随意性以及如何选择间隔的不确定性。不可避免地也会丢失一些信息。但是注意，PROC LIFETEST根据未分组的数据（如果可用）计算对数秩和Wilcoxon统计信息（以及其他可选的测试统计信息），
因此它们不受寿命表方法的间隔选择的影响。</li>
</ol>
<pre><code>ODS GRAPHICS ON;
PROC LIFETEST DATA=recid METHOD=LIFE PLOTS=(S,H);
 TIME week*arrest(0);
RUN;
ODS GRAPHICS OFF;

    Interval    Number   Number    Sample   Probability   Standard
 [Lower, Upper) Failed   Censored  Size     of Failure    Error
  0      10     14       0         432.0    0.0324        0.00852
 10      20     21       0         418.0    0.0502        0.0107
 20      30     23       0         397.0    0.0579        0.0117
 30      40     23       0         374.0    0.0615        0.0124
 40      50     26       0         351.0    0.0741        0.0140
 50      60      7       318       166.0    0.0422        0.0156</code></pre>
</div>
<div id="km-survival-plots-in-sas" class="section level3" number="19.2.4">
<h3><span class="header-section-number">19.2.4</span> KM Survival Plots in SAS</h3>
<ul>
<li>在任何被检查的观察结果中，图形都包含加号 (看起来像刻度线)。 当数据集很大且包含大量经过审 查的观察结果时, 这些标记可能会使人分心。可以使用NOCENSOR选项抑制它们.</li>
<li>另一个有用的选项是ATRISK，可以将仍然处于危险中 (尚未死亡或受到审查) 的人数添加到图表中。</li>
<li>要获得具有幸存者功能95%置信度限制的图形, 请使用CL选项。置信度极限是逐点极限 pointwise limits, 这意味着对于每个指定的生存时间，我们有95%的置信度到那个时间生存的概率在那些极限之 内。置信度限制仅扩展到最大事件时间.</li>
<li>假设我们需要置信带 confidence bands that can be interpreted by saying that we are <span class="math inline">\(95 \%\)</span> confident that the entire survivor function falls within the upper curve and the lower curve. More complex
methods are needed to produce such bands, and PROC LIFETEST offers two: the HallWellner method
and the equal precision (EP) method. 有95%的信心说整个幸存者功能都落在上曲线和下曲线之间。 产生这样的频带需要更复杂的方法, 而 PROC LIFETEST提供两种方法：HallWellner方法和等精度 (EP) 方法。
<ul>
<li>EP方法 倾向于产生在尾部更稳定的置信带。要实现此方法, 该选项将变为PLOTS <span class="math inline">\(=\mathrm{S}(\mathrm{CB}=\)</span> EP) 。 要同时获得逐点频带和EP频带, 请使用选项PLOTS <span class="math inline">\(=\mathrm{S}(\mathrm{CL} \mathrm{CB}=\mathrm{EP})\)</span> 置信带始终比点状 置信极限宽。</li>
<li>Other transformations are available, the most attractive being the logit <span class="math inline">\(\log [\hat{S}(t) /(1-\hat{S}(t))]\)</span> To switch to this transform, include the CONFTYPE=LOGIT option in the PROC statement.</li>
</ul></li>
</ul>
<pre><code>proc lifetest data=whas500 atrisk  PLOTS=S(NOCENSOR ATRISK CL) OUTSURV=outwhas500;
  time lenfol*fstat(0);
run;</code></pre>
<p><strong>Test in plot</strong></p>
<pre><code>ODS GRAPHICS ON;
PROC LIFETEST DATA=myel PLOTS=S(TEST);
 TIME dur*status(0);
 STRATA treat;
RUN;
ODS GRAPHICS OFF;</code></pre>
<p><strong>log-log survival plots</strong></p>
<p>LS produces a plot of <span class="math inline">\(-\log \hat{S}(t)\)</span> versus <span class="math inline">\(t\)</span>.
<span class="math display">\[
-\log S(t)=\int_{0}^{t} h(u) d u
\]</span></p>
<p>The LLS keyword produces a plot of <span class="math inline">\(\log [-\log \hat{S}(t)]\)</span> versus <span class="math inline">\(\log t\)</span>. If survival times follow a Weibull distribution, which has a hazard given by <span class="math inline">\(\log h(t)=\alpha+\beta \log t\)</span>, then the log-log survival plot (log
cumulative hazard plot) should be a straight line with a slope of <span class="math inline">\(\beta\)</span>.
If the hazards are proportional, the log-log survivor functions should be strictly parallel.</p>
<pre><code>PROC LIFETEST DATA=COMBINE PLOTS=LLS;
 TIME years*event(0);
 STRATA type;
RUN; </code></pre>
<p><strong>Hazard plots</strong></p>
<p>Examine smoothed hazard plots using the kernel smoothing option</p>
<pre><code>ODS GRAPHICS ON;
PROC LIFETEST DATA=combine PLOTS=H(BW=10);
 TIME years*event(0);
 STRATA type;
RUN;
ODS GRAPHICS OFF;

## confidence limits around the hazard function;
PROC LIFETEST DATA=recid PLOTS=H(CL);</code></pre>
</div>
<div id="convert-personal-level-to-personal-period-in-r" class="section level3" number="19.2.5">
<h3><span class="header-section-number">19.2.5</span> Convert Personal-level to Personal-period in R</h3>
<p>In studies of survival or modeling discrete-time events, one compact way to store data is in what may be called, “person-level” or generally “observation-level.” For example, you could have three variables, one indicating the observation, one indicating the time period the event occurred or the last follow-up period and one indicating whether the observation was censored.</p>
<p>The PLPP function takes five arguments. The first, data is the data set to be converted. The second, id is the name of the variable containing the identifier for each observation. The third, period is the name of the variable that indicates how many periods the person or observation was in. The fourth, event is the name of the variable that indicates whether the event occurred or not or whether the observation was censored (depending on which direction you are converting). The fifth, direction indicates whether the function should go from person-level to person-period or from person-period to person-level. There are two options, “period” to go to person-period or “level” to go to person-level. Now let’s try it out. For the examples that follow to work, you need to source the function into R.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="survival-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Person-Level Person-Period Converter Function</span></span>
<span id="cb12-2"><a href="survival-analysis.html#cb12-2" aria-hidden="true" tabindex="-1"></a>PLPP <span class="ot">&lt;-</span> <span class="cf">function</span>(data, id, period, event, <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">&quot;period&quot;</span>, <span class="st">&quot;level&quot;</span>)){</span>
<span id="cb12-3"><a href="survival-analysis.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Data Checking and Verification Steps</span></span>
<span id="cb12-4"><a href="survival-analysis.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(data) <span class="sc">||</span> <span class="fu">is.data.frame</span>(data))</span>
<span id="cb12-5"><a href="survival-analysis.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">c</span>(id, period, event) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">colnames</span>(data), <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)))</span>
<span id="cb12-6"><a href="survival-analysis.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="survival-analysis.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(data[, <span class="fu">c</span>(id, period, event)]))) {</span>
<span id="cb12-8"><a href="survival-analysis.html#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;PLPP cannot currently handle missing data in the id, period, or event variables&quot;</span>)</span>
<span id="cb12-9"><a href="survival-analysis.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-10"><a href="survival-analysis.html#cb12-10" aria-hidden="true" tabindex="-1"></a>   <span class="do">## Do the conversion</span></span>
<span id="cb12-11"><a href="survival-analysis.html#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span>(<span class="fu">match.arg</span>(direction),</span>
<span id="cb12-12"><a href="survival-analysis.html#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">period =</span> {</span>
<span id="cb12-13"><a href="survival-analysis.html#cb12-13" aria-hidden="true" tabindex="-1"></a>      index <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), data[, period])</span>
<span id="cb12-14"><a href="survival-analysis.html#cb12-14" aria-hidden="true" tabindex="-1"></a>      idmax <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(data[, period])</span>
<span id="cb12-15"><a href="survival-analysis.html#cb12-15" aria-hidden="true" tabindex="-1"></a>      reve <span class="ot">&lt;-</span> <span class="sc">!</span>data[, event]</span>
<span id="cb12-16"><a href="survival-analysis.html#cb12-16" aria-hidden="true" tabindex="-1"></a>      dat <span class="ot">&lt;-</span> data[index, ]</span>
<span id="cb12-17"><a href="survival-analysis.html#cb12-17" aria-hidden="true" tabindex="-1"></a>      dat[, period] <span class="ot">&lt;-</span> <span class="fu">ave</span>(dat[, period], dat[, id], <span class="at">FUN =</span> seq_along)</span>
<span id="cb12-18"><a href="survival-analysis.html#cb12-18" aria-hidden="true" tabindex="-1"></a>      dat[, event] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-19"><a href="survival-analysis.html#cb12-19" aria-hidden="true" tabindex="-1"></a>      dat[idmax, event] <span class="ot">&lt;-</span> reve},</span>
<span id="cb12-20"><a href="survival-analysis.html#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> {</span>
<span id="cb12-21"><a href="survival-analysis.html#cb12-21" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data[, <span class="fu">c</span>(period, id)], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data))</span>
<span id="cb12-22"><a href="survival-analysis.html#cb12-22" aria-hidden="true" tabindex="-1"></a>      index <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">by</span>(tmp, tmp[, id],</span>
<span id="cb12-23"><a href="survival-analysis.html#cb12-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">FUN =</span> <span class="cf">function</span>(x) x[<span class="fu">which.max</span>(x[, period]), <span class="st">&quot;i&quot;</span>]))</span>
<span id="cb12-24"><a href="survival-analysis.html#cb12-24" aria-hidden="true" tabindex="-1"></a>      dat <span class="ot">&lt;-</span> data[index, ]</span>
<span id="cb12-25"><a href="survival-analysis.html#cb12-25" aria-hidden="true" tabindex="-1"></a>      dat[, event] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">!</span>dat[, event])</span>
<span id="cb12-26"><a href="survival-analysis.html#cb12-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb12-27"><a href="survival-analysis.html#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="survival-analysis.html#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(dat) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-29"><a href="survival-analysis.html#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb12-30"><a href="survival-analysis.html#cb12-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-31"><a href="survival-analysis.html#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="survival-analysis.html#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in the person-level dataset</span></span>
<span id="cb12-33"><a href="survival-analysis.html#cb12-33" aria-hidden="true" tabindex="-1"></a>teachers <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://stats.idre.ucla.edu/stat/examples/alda/teachers.csv&quot;</span>)</span>
<span id="cb12-34"><a href="survival-analysis.html#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at a subset of the cases</span></span>
<span id="cb12-35"><a href="survival-analysis.html#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(teachers, id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">126</span>, <span class="dv">129</span>))</span></code></pre></div>
<pre><code>##      id  t censor
## 19   20  3      0
## 125 126 12      0
## 128 129 12      1</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="survival-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Uses PLPP to convert to person-period and store in object, &#39;tpp&#39;</span></span>
<span id="cb14-2"><a href="survival-analysis.html#cb14-2" aria-hidden="true" tabindex="-1"></a>tpp <span class="ot">&lt;-</span> <span class="fu">PLPP</span>(<span class="at">data =</span> teachers, <span class="at">id =</span> <span class="st">&quot;id&quot;</span>, <span class="at">period =</span> <span class="st">&quot;t&quot;</span>, <span class="at">event =</span> <span class="st">&quot;censor&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;period&quot;</span>)</span>
<span id="cb14-3"><a href="survival-analysis.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at a subset of the cases</span></span>
<span id="cb14-4"><a href="survival-analysis.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(tpp, id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">126</span>, <span class="dv">129</span>))</span></code></pre></div>
<pre><code>##      id  t censor
## 95   20  1      0
## 96   20  2      0
## 97   20  3      1
## 740 126  1      0
## 741 126  2      0
## 742 126  3      0
## 743 126  4      0
## 744 126  5      0
## 745 126  6      0
## 746 126  7      0
## 747 126  8      0
## 748 126  9      0
## 749 126 10      0
## 750 126 11      0
## 751 126 12      1
## 760 129  1      0
## 761 129  2      0
## 762 129  3      0
## 763 129  4      0
## 764 129  5      0
## 765 129  6      0
## 766 129  7      0
## 767 129  8      0
## 768 129  9      0
## 769 129 10      0
## 770 129 11      0
## 771 129 12      0</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="survival-analysis.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Convert person-period to person-level</span></span>
<span id="cb16-2"><a href="survival-analysis.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in person-period dataset</span></span>
<span id="cb16-3"><a href="survival-analysis.html#cb16-3" aria-hidden="true" tabindex="-1"></a>teachers.pp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://stats.idre.ucla.edu/stat/examples/alda/teachers_pp.csv&quot;</span>)</span>
<span id="cb16-4"><a href="survival-analysis.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at a subset of the cases</span></span>
<span id="cb16-5"><a href="survival-analysis.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(teachers.pp, id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">126</span>, <span class="dv">129</span>))</span></code></pre></div>
<pre><code>##      id period event
## 95   20      1     0
## 96   20      2     0
## 97   20      3     1
## 740 126      1     0
## 741 126      2     0
## 742 126      3     0
## 743 126      4     0
## 744 126      5     0
## 745 126      6     0
## 746 126      7     0
## 747 126      8     0
## 748 126      9     0
## 749 126     10     0
## 750 126     11     0
## 751 126     12     1
## 760 129      1     0
## 761 129      2     0
## 762 129      3     0
## 763 129      4     0
## 764 129      5     0
## 765 129      6     0
## 766 129      7     0
## 767 129      8     0
## 768 129      9     0
## 769 129     10     0
## 770 129     11     0
## 771 129     12     0</code></pre>
</div>
<div id="package-survfit-in-r" class="section level3" number="19.2.6">
<h3><span class="header-section-number">19.2.6</span> Package survfit in R</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="survival-analysis.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute survival curves</span></span>
<span id="cb18-2"><a href="survival-analysis.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;survival&quot;</span>)</span>
<span id="cb18-3"><a href="survival-analysis.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;survminer&quot;</span>)</span>
<span id="cb18-4"><a href="survival-analysis.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="survival-analysis.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;lung&quot;</span>)</span>
<span id="cb18-6"><a href="survival-analysis.html#cb18-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> lung)</span>
<span id="cb18-7"><a href="survival-analysis.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Stratification</span></span>
<span id="cb18-8"><a href="survival-analysis.html#cb18-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung)</span>
<span id="cb18-9"><a href="survival-analysis.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, status) ~ sex, data = lung)
## 
##                 sex=1 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##    11    138       3   0.9783  0.0124       0.9542        1.000
##    12    135       1   0.9710  0.0143       0.9434        0.999
##    13    134       2   0.9565  0.0174       0.9231        0.991
##    15    132       1   0.9493  0.0187       0.9134        0.987
##    26    131       1   0.9420  0.0199       0.9038        0.982
##    30    130       1   0.9348  0.0210       0.8945        0.977
##    31    129       1   0.9275  0.0221       0.8853        0.972
##    53    128       2   0.9130  0.0240       0.8672        0.961
##    54    126       1   0.9058  0.0249       0.8583        0.956
##    59    125       1   0.8986  0.0257       0.8496        0.950
##    60    124       1   0.8913  0.0265       0.8409        0.945
##    65    123       2   0.8768  0.0280       0.8237        0.933
##    71    121       1   0.8696  0.0287       0.8152        0.928
##    81    120       1   0.8623  0.0293       0.8067        0.922
##    88    119       2   0.8478  0.0306       0.7900        0.910
##    92    117       1   0.8406  0.0312       0.7817        0.904
##    93    116       1   0.8333  0.0317       0.7734        0.898
##    95    115       1   0.8261  0.0323       0.7652        0.892
##   105    114       1   0.8188  0.0328       0.7570        0.886
##   107    113       1   0.8116  0.0333       0.7489        0.880
##   110    112       1   0.8043  0.0338       0.7408        0.873
##   116    111       1   0.7971  0.0342       0.7328        0.867
##   118    110       1   0.7899  0.0347       0.7247        0.861
##   131    109       1   0.7826  0.0351       0.7167        0.855
##   132    108       2   0.7681  0.0359       0.7008        0.842
##   135    106       1   0.7609  0.0363       0.6929        0.835
##   142    105       1   0.7536  0.0367       0.6851        0.829
##   144    104       1   0.7464  0.0370       0.6772        0.823
##   147    103       1   0.7391  0.0374       0.6694        0.816
##   156    102       2   0.7246  0.0380       0.6538        0.803
##   163    100       3   0.7029  0.0389       0.6306        0.783
##   166     97       1   0.6957  0.0392       0.6230        0.777
##   170     96       1   0.6884  0.0394       0.6153        0.770
##   175     94       1   0.6811  0.0397       0.6076        0.763
##   176     93       1   0.6738  0.0399       0.5999        0.757
##   177     92       1   0.6664  0.0402       0.5922        0.750
##   179     91       2   0.6518  0.0406       0.5769        0.736
##   180     89       1   0.6445  0.0408       0.5693        0.730
##   181     88       2   0.6298  0.0412       0.5541        0.716
##   183     86       1   0.6225  0.0413       0.5466        0.709
##   189     83       1   0.6150  0.0415       0.5388        0.702
##   197     80       1   0.6073  0.0417       0.5309        0.695
##   202     78       1   0.5995  0.0419       0.5228        0.687
##   207     77       1   0.5917  0.0420       0.5148        0.680
##   210     76       1   0.5839  0.0422       0.5068        0.673
##   212     75       1   0.5762  0.0424       0.4988        0.665
##   218     74       1   0.5684  0.0425       0.4909        0.658
##   222     72       1   0.5605  0.0426       0.4829        0.651
##   223     70       1   0.5525  0.0428       0.4747        0.643
##   229     67       1   0.5442  0.0429       0.4663        0.635
##   230     66       1   0.5360  0.0431       0.4579        0.627
##   239     64       1   0.5276  0.0432       0.4494        0.619
##   246     63       1   0.5192  0.0433       0.4409        0.611
##   267     61       1   0.5107  0.0434       0.4323        0.603
##   269     60       1   0.5022  0.0435       0.4238        0.595
##   270     59       1   0.4937  0.0436       0.4152        0.587
##   283     57       1   0.4850  0.0437       0.4065        0.579
##   284     56       1   0.4764  0.0438       0.3979        0.570
##   285     54       1   0.4676  0.0438       0.3891        0.562
##   286     53       1   0.4587  0.0439       0.3803        0.553
##   288     52       1   0.4499  0.0439       0.3716        0.545
##   291     51       1   0.4411  0.0439       0.3629        0.536
##   301     48       1   0.4319  0.0440       0.3538        0.527
##   303     46       1   0.4225  0.0440       0.3445        0.518
##   306     44       1   0.4129  0.0440       0.3350        0.509
##   310     43       1   0.4033  0.0441       0.3256        0.500
##   320     42       1   0.3937  0.0440       0.3162        0.490
##   329     41       1   0.3841  0.0440       0.3069        0.481
##   337     40       1   0.3745  0.0439       0.2976        0.471
##   353     39       2   0.3553  0.0437       0.2791        0.452
##   363     37       1   0.3457  0.0436       0.2700        0.443
##   364     36       1   0.3361  0.0434       0.2609        0.433
##   371     35       1   0.3265  0.0432       0.2519        0.423
##   387     34       1   0.3169  0.0430       0.2429        0.413
##   390     33       1   0.3073  0.0428       0.2339        0.404
##   394     32       1   0.2977  0.0425       0.2250        0.394
##   428     29       1   0.2874  0.0423       0.2155        0.383
##   429     28       1   0.2771  0.0420       0.2060        0.373
##   442     27       1   0.2669  0.0417       0.1965        0.362
##   455     25       1   0.2562  0.0413       0.1868        0.351
##   457     24       1   0.2455  0.0410       0.1770        0.341
##   460     22       1   0.2344  0.0406       0.1669        0.329
##   477     21       1   0.2232  0.0402       0.1569        0.318
##   519     20       1   0.2121  0.0397       0.1469        0.306
##   524     19       1   0.2009  0.0391       0.1371        0.294
##   533     18       1   0.1897  0.0385       0.1275        0.282
##   558     17       1   0.1786  0.0378       0.1179        0.270
##   567     16       1   0.1674  0.0371       0.1085        0.258
##   574     15       1   0.1562  0.0362       0.0992        0.246
##   583     14       1   0.1451  0.0353       0.0900        0.234
##   613     13       1   0.1339  0.0343       0.0810        0.221
##   624     12       1   0.1228  0.0332       0.0722        0.209
##   643     11       1   0.1116  0.0320       0.0636        0.196
##   655     10       1   0.1004  0.0307       0.0552        0.183
##   689      9       1   0.0893  0.0293       0.0470        0.170
##   707      8       1   0.0781  0.0276       0.0390        0.156
##   791      7       1   0.0670  0.0259       0.0314        0.143
##   814      5       1   0.0536  0.0239       0.0223        0.128
##   883      3       1   0.0357  0.0216       0.0109        0.117
## 
##                 sex=2 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     5     90       1   0.9889  0.0110       0.9675        1.000
##    60     89       1   0.9778  0.0155       0.9478        1.000
##    61     88       1   0.9667  0.0189       0.9303        1.000
##    62     87       1   0.9556  0.0217       0.9139        0.999
##    79     86       1   0.9444  0.0241       0.8983        0.993
##    81     85       1   0.9333  0.0263       0.8832        0.986
##    95     83       1   0.9221  0.0283       0.8683        0.979
##   107     81       1   0.9107  0.0301       0.8535        0.972
##   122     80       1   0.8993  0.0318       0.8390        0.964
##   145     79       2   0.8766  0.0349       0.8108        0.948
##   153     77       1   0.8652  0.0362       0.7970        0.939
##   166     76       1   0.8538  0.0375       0.7834        0.931
##   167     75       1   0.8424  0.0387       0.7699        0.922
##   182     71       1   0.8305  0.0399       0.7559        0.913
##   186     70       1   0.8187  0.0411       0.7420        0.903
##   194     68       1   0.8066  0.0422       0.7280        0.894
##   199     67       1   0.7946  0.0432       0.7142        0.884
##   201     66       2   0.7705  0.0452       0.6869        0.864
##   208     62       1   0.7581  0.0461       0.6729        0.854
##   226     59       1   0.7452  0.0471       0.6584        0.843
##   239     57       1   0.7322  0.0480       0.6438        0.833
##   245     54       1   0.7186  0.0490       0.6287        0.821
##   268     51       1   0.7045  0.0501       0.6129        0.810
##   285     47       1   0.6895  0.0512       0.5962        0.798
##   293     45       1   0.6742  0.0523       0.5791        0.785
##   305     43       1   0.6585  0.0534       0.5618        0.772
##   310     42       1   0.6428  0.0544       0.5447        0.759
##   340     39       1   0.6264  0.0554       0.5267        0.745
##   345     38       1   0.6099  0.0563       0.5089        0.731
##   348     37       1   0.5934  0.0572       0.4913        0.717
##   350     36       1   0.5769  0.0579       0.4739        0.702
##   351     35       1   0.5604  0.0586       0.4566        0.688
##   361     33       1   0.5434  0.0592       0.4390        0.673
##   363     32       1   0.5265  0.0597       0.4215        0.658
##   371     30       1   0.5089  0.0603       0.4035        0.642
##   426     26       1   0.4893  0.0610       0.3832        0.625
##   433     25       1   0.4698  0.0617       0.3632        0.608
##   444     24       1   0.4502  0.0621       0.3435        0.590
##   450     23       1   0.4306  0.0624       0.3241        0.572
##   473     22       1   0.4110  0.0626       0.3050        0.554
##   520     19       1   0.3894  0.0629       0.2837        0.534
##   524     18       1   0.3678  0.0630       0.2628        0.515
##   550     15       1   0.3433  0.0634       0.2390        0.493
##   641     11       1   0.3121  0.0649       0.2076        0.469
##   654     10       1   0.2808  0.0655       0.1778        0.443
##   687      9       1   0.2496  0.0652       0.1496        0.417
##   705      8       1   0.2184  0.0641       0.1229        0.388
##   728      7       1   0.1872  0.0621       0.0978        0.359
##   731      6       1   0.1560  0.0590       0.0743        0.328
##   735      5       1   0.1248  0.0549       0.0527        0.295
##   765      3       1   0.0832  0.0499       0.0257        0.270</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="survival-analysis.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Access to the sort summary table</span></span>
<span id="cb20-2"><a href="survival-analysis.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)<span class="sc">$</span>table</span></code></pre></div>
<pre><code>##       records n.max n.start events   *rmean *se(rmean) median 0.95LCL 0.95UCL
## sex=1     138   138     138    112 326.0841   22.91156    270     212     310
## sex=2      90    90      90     53 460.6473   34.68985    426     348     550</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="survival-analysis.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  function survfit() returns a list of variables,components can be accessed as follow:</span></span>
<span id="cb22-2"><a href="survival-analysis.html#cb22-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> fit<span class="sc">$</span>time,</span>
<span id="cb22-3"><a href="survival-analysis.html#cb22-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.risk =</span> fit<span class="sc">$</span>n.risk,</span>
<span id="cb22-4"><a href="survival-analysis.html#cb22-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.event =</span> fit<span class="sc">$</span>n.event,</span>
<span id="cb22-5"><a href="survival-analysis.html#cb22-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.censor =</span> fit<span class="sc">$</span>n.censor,</span>
<span id="cb22-6"><a href="survival-analysis.html#cb22-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">surv =</span> fit<span class="sc">$</span>surv,</span>
<span id="cb22-7"><a href="survival-analysis.html#cb22-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upper =</span> fit<span class="sc">$</span>upper,</span>
<span id="cb22-8"><a href="survival-analysis.html#cb22-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower =</span> fit<span class="sc">$</span>lower</span>
<span id="cb22-9"><a href="survival-analysis.html#cb22-9" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb22-10"><a href="survival-analysis.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   time n.risk n.event n.censor      surv     upper     lower
## 1   11    138       3        0 0.9782609 1.0000000 0.9542301
## 2   12    135       1        0 0.9710145 0.9994124 0.9434235
## 3   13    134       2        0 0.9565217 0.9911586 0.9230952
## 4   15    132       1        0 0.9492754 0.9866017 0.9133612
## 5   26    131       1        0 0.9420290 0.9818365 0.9038355
## 6   30    130       1        0 0.9347826 0.9768989 0.8944820</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="survival-analysis.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Kaplan-Meier life table: summary of survival curves summary(fit)</span></span>
<span id="cb24-2"><a href="survival-analysis.html#cb24-2" aria-hidden="true" tabindex="-1"></a>res.sum <span class="ot">&lt;-</span> <span class="fu">surv_summary</span>(fit)</span>
<span id="cb24-3"><a href="survival-analysis.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res.sum)</span></code></pre></div>
<pre><code>##   time n.risk n.event n.censor      surv    std.err     upper     lower strata
## 1   11    138       3        0 0.9782609 0.01268978 1.0000000 0.9542301  sex=1
## 2   12    135       1        0 0.9710145 0.01470747 0.9994124 0.9434235  sex=1
## 3   13    134       2        0 0.9565217 0.01814885 0.9911586 0.9230952  sex=1
## 4   15    132       1        0 0.9492754 0.01967768 0.9866017 0.9133612  sex=1
## 5   26    131       1        0 0.9420290 0.02111708 0.9818365 0.9038355  sex=1
## 6   30    130       1        0 0.9347826 0.02248469 0.9768989 0.8944820  sex=1
##   sex
## 1   1
## 2   1
## 3   1
## 4   1
## 5   1
## 6   1</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="survival-analysis.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## surv_summary对象还有一个名为“表格”的属性，其中包含有关生存曲线的信息，包括具有置信区间的生存中位数以及每条曲线中受试者的总数和事件数</span></span>
<span id="cb26-2"><a href="survival-analysis.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res.sum, <span class="st">&quot;table&quot;</span>)</span></code></pre></div>
<pre><code>##       records n.max n.start events   *rmean *se(rmean) median 0.95LCL 0.95UCL
## sex=1     138   138     138    112 326.0841   22.91156    270     212     310
## sex=2      90    90      90     53 460.6473   34.68985    426     348     550</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="survival-analysis.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence Interval type</span></span>
<span id="cb28-2"><a href="survival-analysis.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## One of &quot;none&quot;, &quot;plain&quot;, &quot;log&quot; (the default), &quot;log-log&quot;, &quot;logit&quot; or &quot;arcsin&quot;.</span></span>
<span id="cb28-3"><a href="survival-analysis.html#cb28-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># The none option 将导致不生成置信区间</span></span>
<span id="cb28-4"><a href="survival-analysis.html#cb28-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># The plain option 导致标准间隔曲线 +-k *se(curve), 其中k由conf.int确定. </span></span>
<span id="cb28-5"><a href="survival-analysis.html#cb28-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># The log option calculates intervals based on the cumulative hazard or log(survival). </span></span>
<span id="cb28-6"><a href="survival-analysis.html#cb28-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># The log-log option bases the intervals on the log hazard or log(-log(survival)), 将间隔设置为以log危险或log（-log（survival））为基础</span></span>
<span id="cb28-7"><a href="survival-analysis.html#cb28-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># The logit option on log(survival/(1- survival)) and arcsin on arcsin(survival).</span></span>
<span id="cb28-8"><a href="survival-analysis.html#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="survival-analysis.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1) Normalverteilungsannahme</span></span>
<span id="cb28-10"><a href="survival-analysis.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## S(t) +- SE(S(t)) * u_(1-alpha/2)</span></span>
<span id="cb28-11"><a href="survival-analysis.html#cb28-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung, <span class="at">conf.type=</span><span class="st">&quot;plain&quot;</span>)</span>
<span id="cb28-12"><a href="survival-analysis.html#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="survival-analysis.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2) log-Methode,nicht in Vorlesung</span></span>
<span id="cb28-14"><a href="survival-analysis.html#cb28-14" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung, <span class="at">conf.type=</span><span class="st">&quot;log&quot;</span>)</span>
<span id="cb28-15"><a href="survival-analysis.html#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="survival-analysis.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 3) log-log-Methode </span></span>
<span id="cb28-17"><a href="survival-analysis.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="do">## S(t)^(exp(+-SE(log(-logS(t)))*u_(1-alpha/2))), dabei muss SE(log(-logS(t))) mit Formel (2.16) berechnet werden </span></span>
<span id="cb28-18"><a href="survival-analysis.html#cb28-18" aria-hidden="true" tabindex="-1"></a> <span class="co"># ( nicht: S(t)^(exp(+-SE *(log(-logS(t)))*u_(1-alpha/2))) )</span></span>
<span id="cb28-19"><a href="survival-analysis.html#cb28-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung, <span class="at">conf.type=</span><span class="st">&quot;log-log&quot;</span>)</span>
<span id="cb28-20"><a href="survival-analysis.html#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="survival-analysis.html#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算指定生存概率下相应的随访时间</span></span>
<span id="cb28-22"><a href="survival-analysis.html#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(a ,<span class="at">probs =</span><span class="dv">1</span><span class="sc">-</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>))</span></code></pre></div>
<pre><code>## $quantile
##        25  50  75
## sex=1 144 270 457
## sex=2 226 426 687
## 
## $lower
##        25  50  75
## sex=1 107 212 371
## sex=2 186 345 524
## 
## $upper
##        25  50  75
## sex=1 177 306 567
## sex=2 310 524 735</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="survival-analysis.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival curves comparing</span></span>
<span id="cb30-2"><a href="survival-analysis.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## When rho=0, log-rank test or Mantel-Haenszel test is performed.</span></span>
<span id="cb30-3"><a href="survival-analysis.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## When rho=1, the Peto correction test of Gehan-Wilcoxon is performed, which gives a greater weight to the early outcome events. But this is not the Wilcoxon test </span></span>
<span id="cb30-4"><a href="survival-analysis.html#cb30-4" aria-hidden="true" tabindex="-1"></a>surv_diff <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung)</span>
<span id="cb30-5"><a href="survival-analysis.html#cb30-5" aria-hidden="true" tabindex="-1"></a>surv_diff</span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time, status) ~ sex, data = lung)
## 
##         N Observed Expected (O-E)^2/E (O-E)^2/V
## sex=1 138      112     91.6      4.55      10.3
## sex=2  90       53     73.4      5.68      10.3
## 
##  Chisq= 10.3  on 1 degrees of freedom, p= 0.001</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="survival-analysis.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Extracting information from a survdiff object</span></span>
<span id="cb32-2"><a href="survival-analysis.html#cb32-2" aria-hidden="true" tabindex="-1"></a>surv_diff <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung)</span>
<span id="cb32-3"><a href="survival-analysis.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(surv_diff<span class="sc">$</span>chisq, <span class="fu">length</span>(surv_diff<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.001311165</code></pre>
</div>
<div id="km-survival-plots-in-r" class="section level3" number="19.2.7">
<h3><span class="header-section-number">19.2.7</span> KM Survival Plots in R</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="survival-analysis.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change color, linetype by strata, risk.table color by strata</span></span>
<span id="cb34-2"><a href="survival-analysis.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit,</span>
<span id="cb34-3"><a href="survival-analysis.html#cb34-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">pval =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-4"><a href="survival-analysis.html#cb34-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk.table =</span> <span class="cn">TRUE</span>,               <span class="co"># Add risk table</span></span>
<span id="cb34-5"><a href="survival-analysis.html#cb34-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk.table.col =</span> <span class="st">&quot;strata&quot;</span>,       <span class="co"># Change risk table color by groups</span></span>
<span id="cb34-6"><a href="survival-analysis.html#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">&quot;strata&quot;</span>,             <span class="co"># Change line type by groups</span></span>
<span id="cb34-7"><a href="survival-analysis.html#cb34-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">surv.median.line =</span> <span class="st">&quot;hv&quot;</span>,         <span class="co"># Specify median survival</span></span>
<span id="cb34-8"><a href="survival-analysis.html#cb34-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),            <span class="co"># Change ggplot2 theme</span></span>
<span id="cb34-9"><a href="survival-analysis.html#cb34-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="survival-analysis.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The plot can be further customized</span></span>
<span id="cb35-2"><a href="survival-analysis.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb35-3"><a href="survival-analysis.html#cb35-3" aria-hidden="true" tabindex="-1"></a>   fit,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span id="cb35-4"><a href="survival-analysis.html#cb35-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">pval =</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span id="cb35-5"><a href="survival-analysis.html#cb35-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">conf.int =</span> <span class="cn">TRUE</span>,         <span class="co"># show confidence intervals for </span></span>
<span id="cb35-6"><a href="survival-analysis.html#cb35-6" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># point estimaes of survival curves.</span></span>
<span id="cb35-7"><a href="survival-analysis.html#cb35-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">conf.int.style =</span> <span class="st">&quot;step&quot;</span>,  <span class="co"># customize style of confidence intervals</span></span>
<span id="cb35-8"><a href="survival-analysis.html#cb35-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">xlab =</span> <span class="st">&quot;Time in days&quot;</span>,   <span class="co"># customize X axis label.</span></span>
<span id="cb35-9"><a href="survival-analysis.html#cb35-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">break.time.by =</span> <span class="dv">200</span>,     <span class="co"># break X axis in time intervals by 200.</span></span>
<span id="cb35-10"><a href="survival-analysis.html#cb35-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">ggtheme =</span> <span class="fu">theme_light</span>(), <span class="co"># customize plot and risk table with a theme.</span></span>
<span id="cb35-11"><a href="survival-analysis.html#cb35-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">risk.table =</span> <span class="st">&quot;abs_pct&quot;</span>,  <span class="co"># absolute number and percentage at risk.</span></span>
<span id="cb35-12"><a href="survival-analysis.html#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text.col =</span> T,<span class="co"># colour risk table text annotations.</span></span>
<span id="cb35-13"><a href="survival-analysis.html#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.y.text =</span> <span class="cn">FALSE</span>,<span class="co"># show bars instead of names in text annotations</span></span>
<span id="cb35-14"><a href="survival-analysis.html#cb35-14" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># in legend of risk table.</span></span>
<span id="cb35-15"><a href="survival-analysis.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncensor.plot =</span> <span class="cn">TRUE</span>,      <span class="co"># plot the number of censored subjects at time t</span></span>
<span id="cb35-16"><a href="survival-analysis.html#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.median.line =</span> <span class="st">&quot;hv&quot;</span>,  <span class="co"># add the median survival pointer.</span></span>
<span id="cb35-17"><a href="survival-analysis.html#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb35-18"><a href="survival-analysis.html#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),    <span class="co"># change legend labels.</span></span>
<span id="cb35-19"><a href="survival-analysis.html#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb35-20"><a href="survival-analysis.html#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>) <span class="co"># custom color palettes.</span></span>
<span id="cb35-21"><a href="survival-analysis.html#cb35-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-2.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="survival-analysis.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot cumulative events</span></span>
<span id="cb36-2"><a href="survival-analysis.html#cb36-2" aria-hidden="true" tabindex="-1"></a> <span class="do">## fun = &quot;event&quot; cumulative events </span></span>
<span id="cb36-3"><a href="survival-analysis.html#cb36-3" aria-hidden="true" tabindex="-1"></a> <span class="do">## fun = &quot;log&quot;: log transformation </span></span>
<span id="cb36-4"><a href="survival-analysis.html#cb36-4" aria-hidden="true" tabindex="-1"></a> <span class="do">## fun = &quot;cumhaz&quot;: cumulative hazard</span></span>
<span id="cb36-5"><a href="survival-analysis.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="survival-analysis.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="do">## plot cumulative events</span></span>
<span id="cb36-7"><a href="survival-analysis.html#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit,</span>
<span id="cb36-8"><a href="survival-analysis.html#cb36-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-9"><a href="survival-analysis.html#cb36-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk.table.col =</span> <span class="st">&quot;strata&quot;</span>,          <span class="co"># Change risk table color by groups</span></span>
<span id="cb36-10"><a href="survival-analysis.html#cb36-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),               <span class="co"># Change ggplot2 theme</span></span>
<span id="cb36-11"><a href="survival-analysis.html#cb36-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>),</span>
<span id="cb36-12"><a href="survival-analysis.html#cb36-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-3.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="survival-analysis.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot log survival curve</span></span>
<span id="cb37-2"><a href="survival-analysis.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit,</span>
<span id="cb37-3"><a href="survival-analysis.html#cb37-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-4"><a href="survival-analysis.html#cb37-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">risk.table.col =</span> <span class="st">&quot;strata&quot;</span>, <span class="co"># Change risk table color by groups</span></span>
<span id="cb37-5"><a href="survival-analysis.html#cb37-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(), <span class="co"># Change ggplot2 theme</span></span>
<span id="cb37-6"><a href="survival-analysis.html#cb37-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>),</span>
<span id="cb37-7"><a href="survival-analysis.html#cb37-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">fun =</span> <span class="st">&quot;log&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-4.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="survival-analysis.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot cummulative hazard</span></span>
<span id="cb38-2"><a href="survival-analysis.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## The cummulative hazard is commonly used to estimate the hazard probability</span></span>
<span id="cb38-3"><a href="survival-analysis.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit,</span>
<span id="cb38-4"><a href="survival-analysis.html#cb38-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-5"><a href="survival-analysis.html#cb38-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk.table.col =</span> <span class="st">&quot;strata&quot;</span>, <span class="co"># Change risk table color by groups</span></span>
<span id="cb38-6"><a href="survival-analysis.html#cb38-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(), <span class="co"># Change ggplot2 theme</span></span>
<span id="cb38-7"><a href="survival-analysis.html#cb38-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>),</span>
<span id="cb38-8"><a href="survival-analysis.html#cb38-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">fun =</span> <span class="st">&quot;cumhaz&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-5.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="survival-analysis.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Complex survival curves in grouping</span></span>
<span id="cb39-2"><a href="survival-analysis.html#cb39-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>( <span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex <span class="sc">+</span> rx <span class="sc">+</span> adhere,</span>
<span id="cb39-3"><a href="survival-analysis.html#cb39-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> colon )</span>
<span id="cb39-4"><a href="survival-analysis.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot survival curves by sex and facet by rx and adhere</span></span>
<span id="cb39-5"><a href="survival-analysis.html#cb39-5" aria-hidden="true" tabindex="-1"></a>ggsurv <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(fit2, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-6"><a href="survival-analysis.html#cb39-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb39-7"><a href="survival-analysis.html#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="survival-analysis.html#cb39-8" aria-hidden="true" tabindex="-1"></a>ggsurv<span class="sc">$</span>plot <span class="sc">+</span><span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb39-9"><a href="survival-analysis.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-10"><a href="survival-analysis.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(rx <span class="sc">~</span> adhere)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualize%20survival%20curves-6.png" width="672" /></p>
</div>
</div>
<div id="compare-the-survival-function" class="section level2" number="19.3">
<h2><span class="header-section-number">19.3</span> Compare the survival function</h2>
<div id="tests-of-equality-of-the-survival-function" class="section level3" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Tests of equality of the survival function</h3>
<p>The log-rank test, is a hypothesis test to compare the survival distributions of two samples. It is a nonparametric test and appropriate to use when the data are right-skewed and censored (technically, the censoring must be non-informative).</p>
<p>The logrank test is based on the same assumptions as the Kaplan-Meier survival curve—namely, that censoring is unrelated to prognosis, the survival probabilities are the same for subjects recruited early and late in the study, and the events happened at the times specified. Deviations from these assumptions matter most if they are satisfied differently in the groups being compared, for example if censoring is more likely in one group than another</p>
<p>The calculation of the statistic for the nonparametric “Log-Rank” and “Wilcoxon” tests is given by :</p>
<p><span class="math display">\[Q = \frac{\bigg[\sum\limits_{i=1}^m w_j(d_{ij}-\hat e_{ij})\bigg]^2}{\sum\limits_{i=1}^m w_j^2\hat v_{ij}},\]</span></p>
<ul>
<li><span class="math inline">\(d_{i j}\)</span> is the observed number of failures in stratum <span class="math inline">\(i\)</span> at time <span class="math inline">\(t_{i j}\)</span></li>
<li><span class="math inline">\(\hat{e}_{i j}\)</span> is the expected number of failures in stratum <span class="math inline">\(i\)</span> at time <span class="math inline">\(t_{i j}\)</span></li>
<li><span class="math inline">\(\hat{v}_{i j}\)</span> is the estimator of the variance of <span class="math inline">\(d_{i j}\)</span></li>
<li><span class="math inline">\(w_{j}\)</span> is the weight of the difference at time <span class="math inline">\(t_{j}\)</span></li>
<li>The log-rank or Mantel-Haenzel test uses <span class="math inline">\(w_{j}=1\)</span></li>
<li>The Wilcoxon test uses <span class="math inline">\(w_{j}=n_{j}\)</span>, so that differences are weighted by the number at risk at time <span class="math inline">\(t_{j}\)</span></li>
</ul>
<p><strong>Specified, for group 1, the log-rank statistic can be written as</strong></p>
<p><span class="math display">\[
\sum_{j=1}^{r}\left(d_{1 j}-e_{1 j}\right)
\]</span>
where the summation is over all unique event times (in both groups), and there are a total of <span class="math inline">\(r\)</span> such
times. <span class="math inline">\(d_{1 j}\)</span> is the number of deaths that occur in group 1 at time <span class="math inline">\(j\)</span>, and <span class="math inline">\(e_{1 j}\)</span> is the expected number of events in group 1 at time <span class="math inline">\(j\)</span>. The expected number is given by <span class="math inline">\(n_{1 j} d_{j} / n_{j}\)</span>, where <span class="math inline">\(n_{j}\)</span> is the total number of cases that are at risk just prior to time <span class="math inline">\(j, n_{1 j}\)</span> is the number at risk just prior to time <span class="math inline">\(j\)</span> in group 1, and <span class="math inline">\(d_{j}\)</span> is the total number of deaths at time <span class="math inline">\(j\)</span> in both groups.</p>
<p><strong>The Wilcoxon statistic, given by</strong></p>
<p><span class="math display">\[\sum_{j=1}^{r} n_{j}\left(d_{1 j}-e_{1 j}\right)\]</span></p>
<p><strong>strata statement in proc lifetest in SAS</strong></p>
<pre><code>proc lifetest data=whas500 atrisk plots=survival(atrisk cb) outs=outwhas500;
strata gender;
time lenfol*fstat(0);
run;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:Strata"></span>
<img src="02_Plots/Proc_lifetest_strata.png" alt="Figure: Strata statement in proc lifetest" width="100%" />
<p class="caption">
Figure 19.1: Figure: Strata statement in proc lifetest
</p>
</div>
<table>
<thead>
<tr class="header">
<th>Test of Equality over Strata</th>
<th>Title</th>
<th>Title</th>
<th>Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Test</td>
<td>Chi-Square</td>
<td>DF</td>
<td>Pr &gt; Chi-Square</td>
</tr>
<tr class="even">
<td>Log-Rank</td>
<td>7.7911</td>
<td>1</td>
<td>0.0053</td>
</tr>
<tr class="odd">
<td>Wilcoxon</td>
<td>5.5370</td>
<td>1</td>
<td>0.0186</td>
</tr>
<tr class="even">
<td>-2Log(LR)</td>
<td>10.5120</td>
<td>1</td>
<td>0.0012</td>
</tr>
</tbody>
</table>
<p><strong>log-rank test v.s. Wilcoxon test</strong></p>
<ul>
<li>If the log-rank test is meaningful but the Wilcoxon test is meaningless, it indicates that the long-term difference may be large, but not necessarily in the early stage, and the difference may not be large.</li>
<li>If the log-rank test is meaningless and the Wilcoxon test is meaningful, it indicates that there is a large difference in early survival and little difference in long-term survival. Because the Wilcoxon test is more important for early weights than for late weights (nj does not increase with time), it is not as sensitive as log-rank test to differences between groups that occur at later time points. In other words, although the two statistics test the same null hypothesis, they have different sensitivities to various deviations from the hypothesis.</li>
</ul>
<blockquote>
<p>如果对数秩检验有意义，而Wilcoxon检验毫无意义，则表明长期差异可能很大，但不一定在早期，差异可能不会很大。
如果对数秩检验无意义，而Wilcoxon检验有意义，则表明早期生存率差异很大，长期生存率差异很小。 因为Wilcoxon检验对于较早的重量比对较重的重量更重要（nj不会随时间增加）</p>
</blockquote>
<p>In particular, the log-rank test is more powerful for detecting differences of the form
<span class="math display">\[S_{1}(t)=\left[S_{2}(t)\right]^{\gamma}, \gamma &gt; 1\]</span></p>
<p>This equation defines a proportional hazards model, the log-rank test is closely related to tests for differences between two groups that are performed within the framework of Cox’s proportional hazards model</p>
<p>In contrast, the Wilcoxon test is more powerful than the log-rank test in situations where event times have log-normal distributions (discussed in the next chapter) with a common variance but with different means in the two groups.</p>
</div>
<div id="other-nonparametric-tests-for-strata-statement" class="section level3" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Other nonparametric tests for STRATA statement</h3>
<p>In addition to the log-rank and Wilcoxon tests, which are produced by default, the STRATA statement also has options for four other nonparametric tests:</p>
<ul>
<li>Tarone-Ware,</li>
<li>Peto-Peto,</li>
<li>modified Peto-Peto,</li>
<li>Fleming-Harrington.</li>
</ul>
<p>Like the Wilcoxon and log-rank tests, all of these can be represented as a weighted sum of observed and expected numbers of events:</p>
<pre><code>STRATA treat / TESTS=ALL;</code></pre>
<p>For the Tarone-Ware test, <span class="math inline">\(w j\)</span> is the square root of <span class="math inline">\(n i\)</span>, so this test behaves much like the Wilcoxon test
in being more sensitive to differences at earlier rather than later times.
<span class="math display">\[
\sum_{j=1}^{r} w_{j}\left(d_{1 j}-e_{1 j}\right)
\]</span>
That’s also true of the two Peto tests, for which <span class="math inline">\(w_{j}\)</span> is a function of the survivor function itself.
<span class="math display">\[
\sum_{j=1}^{r} \hat{S}\left(t_{j}\right)\left(d_{1 j}-e_{1 j}\right)
\]</span>
Fleming-Harrington is actually a family of tests in which the weights depend on two parameters, <span class="math inline">\(p\)</span> and
<span class="math inline">\(q\)</span> which can be chosen by the user:
<span class="math display">\[w_{j}=\hat{S}\left(t_{j}\right)^{p}\left[1-\hat{S}\left(t_{j}\right)\right]^{q}\]</span></p>
<ul>
<li>When both <span class="math inline">\(\mathrm{p}\)</span> and <span class="math inline">\(\mathrm{q}\)</span> are 0 , you get the log-rank test.</li>
<li>When <span class="math inline">\(\mathrm{p}\)</span> is 1 and <span class="math inline">\(\mathrm{q}\)</span> is 0 , you get something very close to the Peto-Peto test.</li>
<li>When <span class="math inline">\(\mathrm{q}\)</span> is 1 and <span class="math inline">\(\mathrm{p}\)</span> is 0 , wi increases with time, unlike any of the other tests.</li>
</ul>
</div>
<div id="multiple-comparisons" class="section level3" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Multiple comparisons</h3>
<p>When more than one strata, the ADJUST option tells PROC LIFETEST to produce p-values for all six pairwise comparisons of the four strata and then to report p-values that have been adjusted for multiple comparisons using Tukey’s method (other methods are also available):</p>
<pre><code>PROC LIFETEST DAta=my.recid;
 TIME week*arrest(0);
 STRATA wexp paro / ADJUST=TUKEY;
RUN;</code></pre>
<p>For numeric variables, you can use the STRATA statement to define groups by intervals rather than by unique values.</p>
<pre><code>PROC LIFETEST DAta=my.recid;
 TIME week*arrest(0);
 STRATA age(21 24 28) / ADJUST=BON;
RUN;

     age &lt; 21
21 ≤ age &lt; 24
24 ≤ age &lt; 28
28 ≤ age </code></pre>
</div>
<div id="comparing-survival-functions-using-log-rank-hr" class="section level3" number="19.3.4">
<h3><span class="header-section-number">19.3.4</span> Comparing survival functions using Log-Rank HR</h3>
<p>One way to compare two survival curves is to calculate the hazard ratio (HR)</p>
<pre><code>proc lifetest data=whas500 atrisk plots=hazard(bw=200) outs=outwhas500;
    strata bmi(15,18.5,25,30,40);
    time lenfol*fstat(0);
run;</code></pre>
<p>作为Kaplan-Meier计算的一部分，计算每个组中观察到的事件 (通常为死亡) 的数量, 以及假设生存时间 没有差异的零假设的预期事件的数量。危险比为:
- Treatment A and Treatment B. the observed and expected deaths are summed, to give
- <span class="math inline">\(O_{A}=\Sigma O_{A t}, O_{B}=\Sigma O_{B t}, E_{A}=\Sigma E_{A t}\)</span>, and <span class="math inline">\(E_{B}=\Sigma E_{B t}\)</span>
- Finally the Logrank statistic is calculated as
<span class="math display">\[
\chi_{\text {Logrank }}^{2}=\frac{\left(O_{A}-E_{A}\right)^{2}}{E_{A}}+\frac{\left(O_{B}-E_{B}\right)^{2}}{E_{B}}
\]</span>
- It can be written as
<span class="math display">\[
\chi_{\text {Logrank }}^{2}=\left(O_{A}-E_{A}\right)^{2}\left(\frac{1}{E_{A}}+\frac{1}{E_{B}}\right)
\]</span>
- since <span class="math inline">\(\left(O_{A}-E_{A}\right)^{2}=\left(O_{B}-E_{B}\right)^{2}\)</span>.
- We can obtain the ratio <span class="math inline">\(O_{A} / E_{A}\)</span> and <span class="math inline">\(\left.O_{B} / E_{B}\right)\)</span>, we can calculate the hazard ratio HR, defined as
the ratio of these two relative death rates; that is,
<span class="math display">\[H R=\frac{O_{A} / E_{A}}{O_{B} / E_{B}}\]</span></p>
<p><strong>Confidence Interval of HR</strong></p>
<p>In calculating <span class="math inline">\(C I s\)</span>, it is convenient if the statistic under consideration can be assumed to follow an
approximately Normal distribution. However, the estimate of the <span class="math inline">\(H R\)</span> is not normally distributed. In
particular it has a possible range of values from 0 to <span class="math inline">\(\infty\)</span>, with the null hypothesis value of unity not
located at the centre of this interval. To make the scale symmetric and to enable us to calculate <span class="math inline">\(C I s\)</span>,
we transform the estimate to make it approximately normally distributed. We do this by using log <span class="math inline">\(H R\)</span>,
rather than <span class="math inline">\(H R\)</span> itself, as the basis for our calculation. It is possible to show that a general
<span class="math inline">\(100(1-\alpha) \% C I\)</span> for the <span class="math inline">\(\log H R\)</span> is
Convert the estimated value to an approximately normal distribution. For this, we use logarithmic HR
<span class="math display">\[
\log H R-\left[z_{1-\alpha / 2} \times S E(\log H R)\right] \text { to } \log H R+\left[z_{1-\alpha / 2} \times S E(\log H R)\right]
\]</span>
HR itself is then
<span class="math display">\[
\exp \left[\operatorname { l o g } H R - [ z _ { 1 - \alpha / 2 } \times S E ( \operatorname { l o g } H R ) ] \text { to } \operatorname { e x p } \left[\log H R+\left[z_{1-\alpha / 2} \times S E(\log H R)\right]\right.\right.
\]</span>
In both these expressions
<span class="math display">\[S E(\log H R)=\sqrt{\left(\frac{1}{E_{A}}+\frac{1}{E_{B}}\right)}\]</span></p>
</div>
<div id="mantel-haenszel-hr" class="section level3" number="19.3.5">
<h3><span class="header-section-number">19.3.5</span> Mantel-Haenszel HR</h3>
<p>在研究中的事件总数很小的情况下, <span class="math inline">\(S E(\log H R)\)</span> 的估计并不总是可靠的。但对 <span class="math inline">\(S E\)</span> 的首选估计值需要 在每个死亡时间计算方差，称为超几何方差 hypergeometric variance 。始终总结这些差异会导致Logrank
测试的Mantel-Haenszel版本。时间 <span class="math inline">\(t\)</span> 的超几何方差由下式给出:
<span class="math display">\[
V_{t}=\frac{m_{t} n_{t} r_{t} s_{t}}{N_{t}^{2}\left(N_{t}-1\right)}
\]</span>
If all deaths occur at different times, that is, there is no fixed observation value, then
<span class="math display">\[r{t}=1, s{t}=N_{t}-1\]</span>
<span class="math display">\[V_{t}=m_{t} n_{t} / N_{t}^{2} .\]</span>
As for both <span class="math inline">\(E_{A t}\)</span> and <span class="math inline">\(E_{B t}\)</span>, we finally sum the individual <span class="math inline">\(V_{t}\)</span> calculated at each distinct event time to
obtain <span class="math inline">\(V=\Sigma V_{t}\)</span>. The Mantel-Haenszel test statistic is then defined as
<span class="math display">\[
\chi_{M H}^{2}=\frac{\left(O_{A}-E_{A}\right)^{2}}{V}
\]</span>
This has an approximate <span class="math inline">\(\chi^{2}\)</span> distribution with <span class="math inline">\(d f=1\)</span> in the same way as the Logrank test. It should be noted that <span class="math inline">\(\chi_{M H}^{2}\)</span> only differs from <span class="math inline">\(\chi_{\text {Logrank }}^{2}\)</span> by the expression for <span class="math inline">\(V\)</span>.
The use of the Mantel-Haenszel statistic to test for the difference between two groups also gives an alternative estimate of the HR:
<span class="math display">\[
H R_{M H}=\exp \left(\frac{O_{A}-E_{A}}{V}\right)
\]</span>
The corresponding <span class="math inline">\(S E\)</span> of the Mantel-Haenszel <span class="math inline">\(\log H R_{M H}\)</span> is
<span class="math display">\[S E\left(\log H R_{M H}\right)=1 / V^{1 / 2}\]</span>
This <span class="math inline">\(S E\left(\log H R_{M H}\right)\)</span> can be used to give <span class="math inline">\(C I\)</span> s derived from the Mantel-Haenszel estimate of the <span class="math inline">\(H R\)</span> as
<span class="math display">\[
\exp \left[\log H R_{M H}-\left(z_{1-\alpha / 2} / V^{1 / 2}\right)\right] \text { to } \exp \left[\log H R_{M H}+\left(z_{1-\alpha / 2} / V^{1 / 2}\right)\right]
\]</span></p>
<p>See more under <strong>Survival Analysis-Survival Analysis Using SAS - A Practical Guide (2nd Edition)</strong></p>
</div>
</div>
<div id="cox-proportional-hazards-model" class="section level2" number="19.4">
<h2><span class="header-section-number">19.4</span> Cox Proportional Hazards Model</h2>
<div id="introduction-13" class="section level3" number="19.4.1">
<h3><span class="header-section-number">19.4.1</span> Introduction</h3>
<p>The hazard rate can also be interpreted as the rate at which failures occur at that point in time, or the rate at which risk is accumulated
<span class="math display">\[h(t|x)=exp(\beta_0 + \beta_1x)\]</span>
<span class="math display">\[h(t)=h_0(t)exp(x\beta_x)\]</span>
<span class="math display">\[HR = \frac{h(t|x_2)}{h(t|x_1)} = \frac{h_0(t)exp(x_2\beta_x)}{h_0(t)exp(x_1\beta_x)} = exp(\beta_x(x_2-x_1))\]</span></p>
<p><strong>Partial Likelihood</strong></p>
<p>尚若不考虑删失, <span class="math inline">\(\quad j\)</span> 个观测 <span class="math inline">\(T_{1} \sim \lambda_{1}(t), T_{2} \sim \lambda_{2}(t), \ldots T_{j} \sim \lambda_{j}(t)\)</span> 在Cox Regression的假设下满
足
<span class="math display">\[
P\left(T_{1}&lt;T_{2}&lt;\ldots&lt;T_{J}\right)=\prod_{i=1}^{J} \frac{\lambda_{j}(t)}{\sum_{k=j}^{J} \lambda_{k}(t)}=\prod_{i=1}^{J} \frac{\exp \left(x_{j}^{T} \beta\right)}{\sum_{k=j}^{J} \exp \left(x_{k}^{T} \beta\right)}
\]</span>
进一步，我们考虑删失, 为了更好的保留原数据中的信息, 我们将每个死亡事件发生的时间点记为 <span class="math inline">\(t_{j}\)</span>, 则在
该时间点发生死亡的概率为:
<span class="math display">\[
\frac{\exp \left(x_{j}^{T} \beta\right)}{\sum_{k \in R\left(t_{j}\right)} \exp \left(x_{k} \beta\right)}
\]</span>
给定受试者的协变量值 <span class="math inline">\(\beta ，\)</span> 我们可以类似地计算观察到每个受试者失败时间的联合概率或失败时间的可能
性, given the subject’s covariates values <span class="math inline">\(x_{j}\)</span> 似然可以被表达为
<span class="math display">\[
L(\beta)=\prod_{j} \frac{\exp \left(x_{j}^{T} \beta\right)}{\sum_{k \in R\left(t_{j}\right)} \exp \left(x_{k} \beta\right)}
\]</span>
<span class="math inline">\(k \in R\left(t_{j}\right)\)</span> 代表在时间点 <span class="math inline">\(t_{j}-\)</span> 处个体 <span class="math inline">\(k\)</span> 仍然存活。这里我们暂时假设在时间点 <span class="math inline">\(t_{j}\)</span> 上只有一个死亡观 测。
从严格意义上来说，这并不是一个似然函数。因为似然函数本应代表在给定数据的情况下分布函数的连 乘, 然而上式显然不是。甚至来说，连乘本应是关于个体的连乘, 而上式是关于时间点的。Cox在1975年 将这种形式的似然称为偏似然 (Partial Likelihood)，并证明了它的所有性质与似然别无二致。</p>
<p><strong>NR iteration for parameter estimate</strong></p>
<p>参数迭代形式为
<span class="math display">\[
\hat{\beta}^{(r+1)}=\hat{\beta}^{(r)}+\left(X^{T} W X\right)^{-1} X^{T}(d-P d)
\]</span>
- <span class="math inline">\(w_{i}=\exp \left(x_{i}^{T} \beta\right)\)</span>
- <span class="math inline">\(Y_{i}\left(t_{j}\right)\)</span> 如果个体在 <span class="math inline">\(t_{j}\)</span> 时刻仍芙存活则为1, <span class="math inline">\(Y_{i}\left(t_{j}\right)\)</span> 是一个个体往某时间 <span class="math inline">\(t_{j}\)</span> 生存的index
- <span class="math inline">\(\pi_{i j}=Y_{i}\left(t_{j}\right) \frac{w_{i}}{\sum_{k \in R\left(t_{j}\right)} w_{k}}=Y_{i}\left(t_{j}\right) \frac{w_{i}}{\sum_{k=1}^{n} Y_{k}\left(t_{j}\right) w_{k}}\)</span>
- <span class="math inline">\(P=\left\{\pi_{i j}\right\}_{i, j}\)</span>,代表荣个个体 <span class="math inline">\(i\)</span> 在时间 <span class="math inline">\(t_{j}\)</span> 时的相对死亡风险。因此我们只考虑还活着的个体
- <span class="math inline">\(W_{k k}=-\sum_{i} \delta_{i} \pi_{k i}\left(1-\pi_{k i}\right), W_{k k}\)</span> 代表个体的加权情况。每当一个其余个体 <span class="math inline">\(i\)</span> 死亡, 如果 <span class="math inline">\(k\)</span> 仍然 存活，则其权重增加 <span class="math inline">\(\pi(1-\pi)\)</span>
- <span class="math inline">\(W_{k j}=\sum_{i} \delta_{i} \pi_{k i} \pi_{j i}, k j\)</span> 代表个体 <span class="math inline">\(k\)</span> 的交互情况。每当一个其余个体死亡，如果 <span class="math inline">\(k, j\)</span> 仍然存活 <span class="math inline">\((\)</span> Y决
定), 其交互权重增加 <span class="math inline">\(\pi_{k} \pi_{j}\)</span></p>
<p><strong>Wald</strong></p>
<p><span class="math display">\[\quad \hat{\beta} \sim N\left(\beta,\left(X^{T} W X\right)^{-1}\right)\]</span>
<strong>Likelihood Ratio</strong></p>
<p>Likelihood Ratio Test(LRT) 却是容易使用的。LRT常常被用来判断两个模型 (不同的参数维度) 是否具有显著差异。具体而言</p>
<p><span class="math display">\[-2\left(l\left(\hat{\beta}_{1}\right)-l\left(\hat{\beta}_{2}\right)\right) \sim \chi_{p}^{2}, \quad\]</span></p>
<p><strong>Score Test</strong></p>
<p>用Score Method获得置信区间是非常界难的。但我们可以使用它来做检验。具体而言
<span class="math display">\[u(\beta)=\sum_{i=1}^{n} \delta_{i} x_{i}-\sum_{i=1}^{n} \sum_{k=1}^{n} Y_{k}\left(t_{i}\right) \frac{w_{k}}{\sum_{j=1}^{n} Y_{j}\left(t_{i}\right) w_{j}} x_{i} \delta_{i}=X^{T}(d-P d)\]</span>
<span class="math display">\[I(\beta)=\sum_{i=1}^{n} \sum_{k=1}^{n} \delta_{i} x_{i}\left[\frac{Y_{k}\left(t_{i}\right) w_{k}}{\sum_{j=1}^{n} Y_{j}\left(t_{i}\right) w_{j}} \frac{x_{k}^{T}\left(\sum_{j=1}^{n} Y_{j}\left(t_{i}\right) w_{j}\right)+\sum_{j=1}^{n} Y_{j}\left(t_{i}\right) w_{j} x_{j}^{T}}{\sum_{j=1}^{n} Y_{j}\left(t_{i}\right) w_{j}}\right]\]</span></p>
<p>统计量为<span class="math inline">\(u\left(\beta_{0}\right) / \sqrt{I\left(\beta_{0}\right)}\)</span>, 不需要计算<span class="math inline">\(\hat{\beta}\)</span>从而在模型加入新的变量时不需安再重新拟合参数。</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-logistic-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-survival-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/22-Survival-Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
