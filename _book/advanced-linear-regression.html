<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Advanced Linear Regression | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Advanced Linear Regression | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Advanced Linear Regression | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="correlation-and-regression.html"/>
<link rel="next" href="logistic-regression.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#coord" id="toc-coord"><span class="toc-section-number">4.4.3</span> coord</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.5</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.6</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.7</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#reorder" id="toc-reorder"><span class="toc-section-number">4.5.2</span> Reorder</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.3</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.4</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.5</span> Dot + Box Plot</a></li>
<li><a href="ggplot2.html#violin-plot" id="toc-violin-plot"><span class="toc-section-number">4.5.6</span> Violin Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#nominal-response" id="toc-nominal-response"><span class="toc-section-number">13.6.2</span> Nominal Response</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.3</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-linear-regression" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Advanced Linear Regression</h1>
<div id="htmlwidget-de51870eca4c212778cb" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-de51870eca4c212778cb">{"x":{"data":"# \n## Advanced Linear Regression\n### Model Selection\n#### Selection Methods\n#### Selection Criteria\n#### k- Fold Cross validation\n### Practical Difficulties using OLS\n### Skewness\n#### Introduction\n#### Baisc Transformation  \n#### Box-Cox Power Transformation\n### Scale\n### Interaction\n#### Simple slopes analysis\n#### Plotting Interactions \n#### Check linearity assumption\n### Collinearity\n### Problems with the Error\n#### Generalized Least Squares\n#### Weighted Least Squares\n#### Robust Regression\n### Shrinkage Methods\n#### Principal Components Analzsis\n#### Partial Least Squares\n#### Ridge Regression","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="model-selection" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Model Selection</h2>
<div id="selection-methods" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Selection Methods</h3>
<p><strong>1. Forward stepwise selection</strong></p>
<p>Forward stepwise selection: Start with a zero-feature model, and then add one feature at a time until all features are added. In this process, the model created by the selected features that are added has the smallest RSS. So in theory, the first selected feature should best explain the response variable, and so on. <strong>Adding a feature will definitely reduce the RSS</strong> and <strong>increase the R-square</strong>, but it will not necessarily improve the fit and interpretability of the model</p>
<blockquote>
<p>前向逐步选择: 从一个零特征模型开始，然后每次添加一个特征，直到所有特征添加完毕。在 这个过程中，被添加的选定特征建立的模型具有最小的RSS。所以理论上，第一个选定的特征应 该能最好地解释响应变量，依此类推。添加一个特征一定会使RSS减少，使R方增加，但不一定能提高模型的拟合度和 可解释性</p>
</blockquote>
<pre><code>title2 ’Forward stepwise selection’;
proc reg;
model birthwt = headcirc length gestage momage toxemia
/ selection=f;
run;</code></pre>
<p><strong>2. Backward stepwise regression</strong></p>
<p>Backward stepwise regression starts with a model that includes all features, and deletes one feature that plays the smallest role each time</p>
<blockquote>
<p>后向逐步回归从一个包含所有特征的模型开始，每次删除一个起最小作用的特征。现在也有 一种混合方法，这种算法先通过前向逐步回归添加特征，然后检查是否有特征不再对提高模型拟 合度起作用，如果有则删除。每次建模之后，分析者都可以检查模型输出， 并使用各种统计量选择能提供最佳拟合的特征.
某些逐步回归的支持者更喜欢向后方法，因为每个解释变量都有机会被包含在最终选择的模型中。</p>
</blockquote>
<blockquote>
<p>逐步回归技术会遇到非常严重的问题。 对于一个数据集，先用前向逐步回归，然后再用后向逐步回归，可能会得到两个完全矛盾的模型。 最重要的一点是，逐步回归会使回归系数发生偏离，换句话说，会使回归系数的值过大，置信区间过窄(Tibrishani，1996)</p>
</blockquote>
<pre><code>proc reg;
model birthwt = headcirc length gestage momage toxemia
/ selection=b;
run;</code></pre>
<p><strong>3. Best subset regression</strong></p>
<blockquote>
<p>最优子集回归是逐步回归的一个可接受的替代方案。在最优子集回归中，算法使用所有可能的特征组合来拟合模型，所以，如果有3个特征，将生成7个模型。然后和逐步回 归一样，分析者需要应用自己的判断和统计分析来选择最优模型，模型选择就是后面工作的关键。 如果数据集有多个特征，工作量就会非常大。当特征数多于观测数时(p大 于n)，这个方法的效果就不会好。</p>
</blockquote>
<pre><code>title2 ’Selecting the best of all possible regression models’;
proc reg;
model birthwt = headcirc length gestage momage toxemia
/ selection=cp adjrsq r best=5;
run;</code></pre>
<blockquote>
<p>/ selection = cp adjrsq r选项指示SAS使用Cp准则排序最佳模型，并列出调整后和未经调整的R2统计信息。
best =选项指定SAS在检查所有可能的解释变量选择后将列出的最大数量的不同模型。</p>
</blockquote>
<pre><code>library(leaps) 
library(alr3)
data(water)
socal.water &lt;- water[ ,-1]


## Full Model
fit &lt;- lm(BSAAM ~ ., data = socal.water)
summary(fit)

sub.fit &lt;- regsubsets(BSAAM ~ ., data = socal.water)
best.summary &lt;- summary(sub.fit)
best.summary


## A model with a minimum and maximum value of a certain output.
which.min()
which.max()

names(best.summary)
which.min(best.summary$rss)
which.min(best.summary$bic)
which.max(best.summary$adjr2)


## Plot model evaluation
par(mfrow = c(1,2))
plot(best.summary$cp, xlab = &quot;number of features&quot;, ylab = &quot;cp&quot;)
plot(sub.fit, scale = &quot;Cp&quot;)</code></pre>
</div>
<div id="selection-criteria" class="section level3" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Selection Criteria</h3>
<p><strong>1. Akaike information criterion (AIC)</strong></p>
<p><span class="math display">\[
A I C=2 k-2 \ln (\hat{L})
\]</span></p>
<ul>
<li><span class="math inline">\(k\)</span> = number of estimated parameters in the model</li>
<li><span class="math inline">\(\hat{L}\)</span> = maximum value of the likelihood function for the model</li>
</ul>
<p><strong>2. Bayesian information criterion (BIC)</strong></p>
<p>or Schwarz information criterion (also SIC, SBC, SBIC)</p>
<p><span class="math display">\[{\displaystyle \mathrm {BIC} =k\ln(n)-2\ln({\widehat {L}}).\ }\]</span></p>
<ul>
<li><span class="math inline">\(n\)</span> = the number of data points in <span class="math inline">\({\displaystyle x}\)</span>, the number of observations, or equivalently, the sample size;</li>
</ul>
<p><strong>3. Adjusted <span class="math inline">\(R^2\)</span></strong></p>
<p>Adjusted <span class="math inline">\(R^2\)</span> statistic takes the number of explanatory variables p into account. The definition is
<span class="math display">\[\text { Adjusted }\left(R^{2}\right)=1-\frac{(N-1)\left(1-R^{2}\right)}{N-p}\]</span></p>
<p>p is the number of parameters in the model, and N is the sample size. <strong>If the sample size N is much larger than the number of explanatory variables</strong>,
the adjusted <span class="math inline">\(R^2\)</span> will not be very different from the usual R2.</p>
<p><strong>4. Mallows’s Cp</strong></p>
<p><span class="math display">\[C_{p}=\frac{\text { Error SS(p parameters) }}{s^{2}(\text { for the full model })}-N+2 p,\]</span></p>
<p>This statistic is used to compare the “full” model with all explanatory variables to a smaller model with p-parameters. It is best to use smaller Cp values, because they mean that the root mean square error of the model is smaller, and that there are fewer terms in the model</p>
<p><strong>Other common metrics</strong></p>
<ul>
<li>MAPE (Mean absolute percentage error) <span class="math inline">\(\rightarrow\)</span> Lower the better</li>
<li>MSE (Mean squared error) <span class="math inline">\(\rightarrow\)</span> Lower the better</li>
</ul>
</div>
<div id="k--fold-cross-validation" class="section level3" number="12.1.3">
<h3><span class="header-section-number">12.1.3</span> k- Fold Cross validation</h3>
<blockquote>
<p>美国莱特州立大学的塔皮教授对此有精彩的论述: 我们经常使用回归模型预测未来观测值。我们用数据去拟合模型是完全可以的，
但如果用来预测模型响应的数据和用来估计模型的数据属于同一批，那么说预测效果有多么好就有欺骗的嫌疑了。
在评价模型对未来观测值的预测效果方面，这样做往往会得 到过于乐观的结果。如果我们留下一个观测值，用其余观测值拟合模型，
然后再预测这个留下的观测值，那么评价模型预测效果时，得到的结论会具有更少偏差。</p>
</blockquote>
<p>Suppose, the model predicts satisfactorily on the 20% split (test data), is that enough to believe that your model will perform equally well all the time? It is important to rigorously test the model’s performance as much as possible. One way is to ensure that the model equation you have will perform well, when it is ‘built’ on a different subset of training data and predicted on the remaining data.</p>
<p>Split your data into ‘k’ mutually exclusive random sample portions. Keeping each portion as test data, we build the model on the remaining (k-1 portion) data and calculate the mean squared error of the predictions. This is done for each of the ‘k’ random sample portions. Then finally, the average of these mean squared errors (for ‘k’ portions) is computed. We can use this metric to compare different linear models.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="advanced-linear-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CVlm {DAAG}</span></span>
<span id="cb5-2"><a href="advanced-linear-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Cross-Validation for Linear Regression </span></span>
<span id="cb5-3"><a href="advanced-linear-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="advanced-linear-regression.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb5-5"><a href="advanced-linear-regression.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb5-6"><a href="advanced-linear-regression.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># performs the CV</span></span>
<span id="cb5-7"><a href="advanced-linear-regression.html#cb5-7" aria-hidden="true" tabindex="-1"></a>cvResults <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">CVlm</span>(<span class="at">data =</span>cars, </span>
<span id="cb5-8"><a href="advanced-linear-regression.html#cb5-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">form.lm=</span>dist <span class="sc">~</span> speed, </span>
<span id="cb5-9"><a href="advanced-linear-regression.html#cb5-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">m=</span><span class="dv">5</span>, </span>
<span id="cb5-10"><a href="advanced-linear-regression.html#cb5-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">dots=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-11"><a href="advanced-linear-regression.html#cb5-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">seed=</span><span class="dv">29</span>, </span>
<span id="cb5-12"><a href="advanced-linear-regression.html#cb5-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend.pos=</span><span class="st">&quot;topleft&quot;</span>,  </span>
<span id="cb5-13"><a href="advanced-linear-regression.html#cb5-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">printit=</span><span class="cn">FALSE</span>, </span>
<span id="cb5-14"><a href="advanced-linear-regression.html#cb5-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">main=</span><span class="st">&quot;Small symbols are predicted values while bigger ones are actuals.&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Cross-Validation%20for%20Linear%20Regression%20-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="advanced-linear-regression.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mean squared error</span></span>
<span id="cb6-2"><a href="advanced-linear-regression.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(cvResults, <span class="st">&#39;ms&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 254.2661</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="advanced-linear-regression.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check plot, Are the dashed lines parallel? Are the small and big symbols are not over dispersed for one particular color?</span></span></code></pre></div>
<p><strong>predicted residual error sum of squares (PRESS)</strong></p>
<p>The predicted residual error sum of squares (PRESS) statistic is a form of cross-validation used in regression analysis to provide a summary measure of the fit of a model to a sample of observations that were not themselves used to estimate the model. It is calculated as the sums of squares of the prediction residuals for those observations.</p>
<p>A fitted model having been produced, each observation in turn is removed and the model is refitted using the remaining observations. The out-of-sample predicted value is calculated for the omitted observation in each case, and the PRESS statistic is calculated as the sum of the squares of all the resulting prediction errors</p>
<p><span class="math display">\[\operatorname {PRESS}=\sum _{{i=1}}^{n}(y_{i}-{\hat  {y}}_{{i,-i}})^{2}\]</span></p>
<blockquote>
<p>预测的残差平方和（PRESS）统计量是一种交叉验证的一种形式，用于回归分析，以提供模型对自身不用于估计模型的观测值样本拟合的汇总度量。 它被计算为这些观测值的预测残差的平方和。已生成拟合模型，依次删除每个观察值，并使用其余观察值重新拟合模型。 在每种情况下，都会为省略的观察计算出样本外预测值，并且将PRESS统计量计算为所有产生的预测误差的平方和</p>
</blockquote>
<pre><code>library(MPV)
PRESS(lm(dist ~ speed,data =cars))</code></pre>
</div>
</div>
<div id="practical-difficulties-using-ols" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Practical Difficulties using OLS</h2>
<p><strong>1. Nonrandom Samples</strong></p>
<p>数据的收集方式直接影响我们可以得出的结论。假设检验的一般理论提出了一个从中抽取样本的总体。样本就是我们的数据，我们想使用从样本数据中获得的估计值来说明未知的总体值！此外，我们要求生成数据d使用总体的简单随机样本。该样本的大小是有限的，而总体的大小是无限的，或者至少如此之大，以至于样本量在整体中所占的比例可以忽略不计。当数据根本不是随机样本时，统计推断背后的逻辑还取决于样本是随机的。这并不是说这样的研究是毫无价值的，而是应用描述性的统计技术之外的其他任何东西都是不合理的。对此类数据得出的结论的置信度肯定值得怀疑</p>
<p><strong>2. Choice and Range of Predictors</strong></p>
<p>如果未观察到重要的预测因素，则预测可能会很差，或者我们可能会误解预测因素与响应之间的关系。数据收集的范围和条件可能会限制有效的预测。 推断太多是不安全的。</p>
<p><strong>3. Model Misspecification</strong></p>
<p>我们对模型的结构部分和随机部分进行假设。 <span class="math inline">\(\varepsilon \sim \mathrm{N}\left(0, \sigma^{2} I\right)\)</span> 但这可能不正确. 线性模型 <span class="math inline">\(E y=X \beta\)</span> 的结构部分也可能不正确。</p>
<p><strong>4. Practical and Statistical Significance</strong></p>
<p>统计意义不等于实际意义。样本越大，您的p值将越小，因此请不要将p值与重要的预测器效果混淆。对于大型数据集，将很容易获得具有统计意义的结果，但实际效果可能并不重要。</p>
<p>参数估计值上的CIS是评估效果大小的更好方法。即使在不拒绝零假设的情况下，它们也很有用，因为它们告诉我们，我们对真实效果或价值接近零的信心有多强。同样重要的是要记住，模型通常只是基础现实的近似，这至少使参数的确切含义值得商榷. 此外，我们知道，拥有的数据越多，测试的功能就越强大。即使是零样本，即使有很大的差异，也会被大量样本检测到。现在，如果我们不能拒绝原假设，我们可能会简单地得出结论，即我们没有足够的数据来获得重要的结果。根据这种观点，假设检验只是对样本量的检验。因此，我们更喜欢CIs</p>
</div>
<div id="skewness" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Skewness</h2>
<div id="introduction" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Introduction</h3>
<p>Skewness is a measure of symmetry for a distribution. The value can be positive, negative or undefined. In a skewed distribution, the central tendency measures (mean, median, mode) will not be equal.</p>
<ul>
<li>Positively skewed distribution (or right skewed): The most frequent values are low; tail is toward the high values (on the right-hand side). Generally, Mode &lt; Median &lt; Mean.</li>
<li>Negatively skewed distribution (or left skewed), the most frequent values are high; tail is toward low values (on the left-hand side). Generally, Mode &gt; Median &gt; Mean.</li>
</ul>
<p><strong>skewness value</strong></p>
<p>The direction of skewness is given by the sign of the skewness coefficient: The larger the value of skewness, the larger the distribution differs from a normal distribution</p>
<ul>
<li>A zero means no skewness at all (normal distribution).</li>
<li>A negative value means the distribution is negatively skewed.</li>
<li>A positive value means the distribution is positively skewed.</li>
</ul>
<pre><code>library(moments)
skewness(iris$Sepal.Length, na.rm = TRUE)</code></pre>
<p><strong>Visualization</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="advanced-linear-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggpubr for creating easily publication ready plots</span></span>
<span id="cb11-2"><a href="advanced-linear-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## moments for computing skewness</span></span>
<span id="cb11-3"><a href="advanced-linear-regression.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb11-4"><a href="advanced-linear-regression.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb11-5"><a href="advanced-linear-regression.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;USJudgeRatings&quot;</span>)</span>
<span id="cb11-6"><a href="advanced-linear-regression.html#cb11-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> USJudgeRatings</span>
<span id="cb11-7"><a href="advanced-linear-regression.html#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="advanced-linear-regression.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Consider two variables:</span></span>
<span id="cb11-9"><a href="advanced-linear-regression.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">## CONT: Number of contacts of lawyer with judge. Positively skewed. </span></span>
<span id="cb11-10"><a href="advanced-linear-regression.html#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 律师与法官的联系次数。正偏</span></span>
<span id="cb11-11"><a href="advanced-linear-regression.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="do">## PHYS: Physical ability. Negatively skewed 身体能力。负偏斜</span></span>
<span id="cb11-12"><a href="advanced-linear-regression.html#cb11-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-13"><a href="advanced-linear-regression.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualization</span></span>
<span id="cb11-14"><a href="advanced-linear-regression.html#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="do">## The “CONT” variable shows positive skewness. “PHYS” variable is negatively skewed</span></span>
<span id="cb11-15"><a href="advanced-linear-regression.html#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of CONT variable</span></span>
<span id="cb11-16"><a href="advanced-linear-regression.html#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdensity</span>(df, <span class="at">x =</span> <span class="st">&quot;CONT&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="at">title =</span> <span class="st">&quot;CONT&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="advanced-linear-regression.html#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb11-18"><a href="advanced-linear-regression.html#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_overlay_normal_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Visualization%20of%20skewness-1.png" width="672" /></p>
</div>
<div id="baisc-transformation" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Baisc Transformation</h3>
<ul>
<li>square-root for moderate skew:
<ul>
<li>sqrt(x) for positively skewed data,</li>
<li>sqrt(max(x+1) - x) for negatively skewed data</li>
</ul></li>
<li>log for greater skew: The logarithm transformation of any variable will pull in large values and spread apart the low values 任何变量的对数转换将拉大值并分散低值
<ul>
<li>log10(x) for positively skewed data,</li>
<li>log10(max(x+1) - x) for negatively skewed data</li>
</ul></li>
<li>inverse for severe skew:
<ul>
<li>1/x for positively skewed data</li>
<li>1/(max(x+1) - x) for negatively skewed data</li>
</ul></li>
</ul>
<p><strong>Attention</strong></p>
<p>在不满足正态性假设的情况下，您可以考虑对已转换和未转换的数据运行统计检验（t检验或ANOVA），以查看是否存在任何有意义的差异。
如果两个测试都得出相同的结论，则您可能不选择转换结果变量并继续对原始数据进行测试输出。</p>
<p>注意，转换会使分析变得更加困难。例如，如果在转换数据后运行t检验以比较两组的平均值，则不能简单地说两组的均值存在差异。
现在，您具有附加的步骤来解释差异是基于对数转换的事实。因此，通常除非要使分析有效就必须避免进行转换。</p>
<p>假设响应变量y是连续的，仅假定为正值，并且其直方图似乎不是大致对称且呈钟形（即normal），而是具有较长的右尾 but rather has a long right tail （向右偏斜）。 我们讨论了对这种响应进行建模的两种可能的方法：Box-Cox变换和伽马回归。</p>
</div>
<div id="box-cox-power-transformation" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Box-Cox Power Transformation</h3>
<p>If the density of the response variable y is shifted to the right, you can transform y to make its density look more normal.</p>
<p><span class="math display">\[\tilde{y}=\left\{\begin{array}{ll}
\frac{y^{\lambda}-1}{\lambda}, &amp; \text { if } \lambda \neq 0 \\
\ln y, &amp; \text { if } \lambda=0
\end{array}\right.\]</span></p>
<p><span class="math inline">\(\lambda\)</span>的最佳值借助于最大似然估计来找到。对于一组离散的<span class="math inline">\(\lambda\)</span>值, 拟合一个线性模型,
其中变换后的响应<span class="math inline">\(y\)</span>回归到预测变量 <span class="math inline">\(x_{1}, \ldots, x_{k}\)</span> 选择与似然函数的最大值相对应的
<span class="math inline">\(\lambda\)</span>的值作为最佳值。但是, 所描述的优化是在y 正态分布的情况下进行的，而y并非正好成立,
因此，在实践中，研究人员将<span class="math inline">\(\lambda\)</span>的值“四舍五入”以产 生若干有意义的变换。下表总结了这些建议的转换</p>
<p><span class="math display">\[
\begin{array}{l|c|c|l}
\hline \begin{array}{l}
\text { Range for } \\
\text { optimal } \lambda
\end{array} &amp; \begin{array}{c}
\text { Recommended } \\
\text { value of } \lambda
\end{array} &amp; \begin{array}{c}
\text { Transformed } \\
\tilde{y}
\end{array} &amp; \begin{array}{l}
\text { Transformation } \\
\text { name }
\end{array} \\
\hline[-2.5,-1.5) &amp; -2 &amp; \frac{1}{2}\left(1-\frac{1}{y^{2}}\right) &amp; \text { inverse square } \\
{[-1.5,-0.75)} &amp; -1 &amp; 1-\frac{1}{y} &amp; \text { inverse (or reciprocal) } \\
{[-0.75,-0.25)} &amp; -0.5 &amp; 2\left(1-\frac{1}{\sqrt{y}}\right) &amp; \text { inverse square root } \\
{[-0.25,0.25)} &amp; 0 &amp; \ln y &amp; \text { natural logarithm } \\
{[0.25,0.75)} &amp; 0.5 &amp; 2(\sqrt{y}-1) &amp; \text { square root } \\
{[0.75,1.5)} &amp; 1 &amp; y-1 &amp; \text { linear } \\
{[1.5,2.5]} &amp; 2 &amp; \frac{1}{2}\left(y^{2}-1\right) &amp; \text { square } \\
\hline
\end{array}
\]</span></p>
<p><strong>Fitted Model</strong></p>
<p><span class="math display">\[widehat{\mathbb{E}}(\tilde{y})=\widehat{\mathbb{E}}\left(\frac{y^{\lambda}-1}{\lambda}\right)=\widehat{\beta}_{0}+\widehat{\beta}_{1} x_{1}+\cdots+\widehat{\beta}_{k} x_{k}\]</span></p>
<p>Interpretation of Estimated Regression Coefficients: For a continuous predictor <span class="math inline">\(x_{1}\)</span>, the estimated regression coefficient <span class="math inline">\(\widehat{\beta}_{1}\)</span> represents the change in estimated mean of the transformed response <span class="math inline">\(\widehat{\mathbb{E}}(\tilde{y})\)</span> when <span class="math inline">\(x_{1}\)</span> is increased by one unit, given that the other predictors stay fixed. If <span class="math inline">\(x_{1}\)</span> is an indicator variable, then <span class="math inline">\(\widehat{\beta}_{1}\)</span> is interpreted as the difference between the estimated mean of the transformed response <span class="math inline">\(\widehat{E}(\tilde{y})\)</span> for <span class="math inline">\(x_{1}=1\)</span> and that for <span class="math inline">\(x_{1}=0\)</span>,
when the other predictors are kept unchanged.</p>
<p>SAS Implementation</p>
<pre><code>proc transreg;
model BoxCox(response name) = identity(&lt;list of predictors&gt;);
run;


data real_estate;
input price beds baths sqft heating$ AC$ lot;
price10K=price/10000;
sqftK=sqft/1000;
central=(heating=&#39;central&#39;);
electric=(heating=&#39;electric&#39;);
ACyes=(AC=&#39;yes&#39;);
lotK=lot/1000;
cards;
669000 3 2 1733 central no 5641
715000 4 3.5 1812 none yes 4995
634900 5 3 2217 none no 8019
640000 3 2 1336 none no 7283
966000 5 3 4000 central no 7424
889000 3 2 2005 central no 7130
745000 4 3.5 2276 none no 7936
685000 2 1.5 1018 central yes 6141
549500 2 1 920 central no 5545
868999 5 2.5 1670 electric yes 5750
624900 3 2 1519 electric no 8267
549900 2 1 956 none no 4978
589900 3 2 1601 central no 5005
829000 5 3 2652 central yes 5601
599900 4 2 1802 none yes 5262
875000 6 2.5 3414 electric yes 6534
635000 3 2 1565 central no 5619
599999 2 1 832 none no 5601
734997 3 2.5 1780 central yes 5400
699999 3 2 1969 electric no 5488
759000 4 2 1530 central yes 6446
684900 3 2 1519 central no 8267
888000 5 2.75 2039 central yes 5976
599999 4 2 1513 electric no 5937
565000 2 2 1616 central no 5227
825000 3 2.5 1421 central yes 5871
659900 3 2 1547 electric yes 4791
746000 3 2 1130 central no 5301
1089000 5 2.5 3314 central yes 7129
1195499 5 3.5 3760 central yes 6000
;

## Goodness-of-Fit Tests for Normal Distribution
proc univariate;
var price10K;
histogram /normal;
run;

## The histogram exhibits a long right tail, suggesting that the distribution is
   right-skewed.
proc transreg data=real_estate;
model BoxCox(price10K) = identity(beds baths sqftK central
electric ACyes lotK);
run;

Lambda Log Like
-3.00 -63.2544
-2.75 -62.7175
-2.50 -62.2403
-2.25 -61.8273
-2.00 -61.4832
-1.75 -61.2132
-1.50 -61.0229
-1.25 -60.9186
-1.00 -60.9068
-0.75 -60.9944
-0.50 -61.1884
-0.25 -61.4959
 0.00 -61.9238
 0.25 -62.4784
 0.50 -63.1654
 
## the optimal value of λ that corresponds to the largest
   value of the log-likelihood function is -1

data real_estate;
set real_estate;
tr_price10K=1-(1/price10K);
run;
proc univariate;
var tr_price10K;
histogram /normal;
run;


## fit the general linear model to the transformed response
proc genmod;
class heating(ref=&#39;none&#39;) AC(ref=&#39;no&#39;);
model tr_price10K=beds baths sqftK heating
AC lotK/dist=normal link=identity;
run;</code></pre>
<p>R Implementation</p>
<pre><code>library(MASS)
BoxCox.fit.name &lt;- boxcox(response.name ∼ x1.name + ...
+ xk.name, data=data.name, lambda=seq(-3,3,1/4), interp=FALSE)
BoxCox.data.name &lt;- data.frame(BoxCox.fit.name$x, BoxCox.fit.name$y)</code></pre>
</div>
</div>
<div id="scale" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Scale</h2>
<p>单位的更改可能有助于解释, 但是不会影响参数估计。
当所有预测变量的比例都相似时，估计的数值稳定性会增强。
一种相当彻底的缩放方法是使用scale（）命令将所有变量转换为标准单位（均值0和方差1）。 这样的缩放比例具有将所有预测变量和响应置于可比较的比例尺上的优势，这使比较更加容易。
它还避免了当变量的比例非常不同时可能出现的一些数字问题。 这种缩放的不利之处在于，回归系数现在表示预测变量中标准单位增加对标准单位响应的影响-
这可能并不总是很容易解释。</p>
<pre><code>data(savings)
g &lt; - 1m (sr ˜ popl5+pop75+dpi+ddpi, savings)
summary (g)

Coefficients:
 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 28.566087 7.354516 3.88 0.00033
      pop15  0.461193 0.144642 !3.19 0.00260
      pop75  1.691498 1.083599 !1.56 0.12553
        dpi  0.000337 0.000931 !0.36 0.71917
        ddpi 0.409695 0.196197 2.09 0.04247
        
Residual standard error: 3.8 on 45 degrees of freedom
Multiple R-Squared: 0.338, Adjusted R-squared: 0.28
F-statistic: 5.76 on 4 and 45 DF, p-value: 0.00079


 g &lt; 1m (sr ˜ pop15+pop75+I(dpi/1000)+ddpi, savings)
 summary (g)
 
Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 28.566 7.355 3.88 0.00033
pop15 !0.461 0.145 !3.19 0.00260
pop75 !1.691 1.084 !1.56 0.12553
I(dpi/1000) !0.337 0.931 !0.36 0.71917
ddpi 0.410 0.196 2.09 0.04247

Residual standard error: 3.8 on 45 degrees of freedom
Multiple R-Squared: 0.338, Adjusted R-squared: 0.28
F-statistic: 5.76 on 4 and 45 DF, p-value: 0.00079
 
 
scsav &lt; - data.frame(scale(savings))
g &lt; - lm (sr , scsav) 
summary (g) Coefficients:

 Estimate Std Error t value Pr(&gt;|t|)
(Intercept) 4.0e–16 0.1200 3.3e–15 1.0000
pop15 !0.9420 0.2954 !3.19 0.0026
pop75 !0.4873 0.3122 !1.56 0.1255
dpi !0.0745 0.2059 !0.36 0.7192
ddpi 0.2624 0.1257 2.09 0.0425

Residual standard error: 0.849 on 45 degrees of freedom
Multiple R-Squared: 0.338, Adjusted R-squared: 0.28
F-statistic: 5.76 on 4 and 45 DF, p-value: 0.00079</code></pre>
</div>
<div id="interaction" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Interaction</h2>
<div id="simple-slopes-analysis" class="section level3" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Simple slopes analysis</h3>
<blockquote>
<p>如果交互项显著，就需要进一步做简单斜率检验。
简单斜率是在具有交互作用的情况下进行的。当包含交互作用项时，我们获得的回归输出告诉我们，当moderator保持为零时，斜率是多少，这通常不是实际/理论上有意义的值。为了更好地理解相互作用的性质，简单的斜率分析是在两个自变量的交互作用对因变量的效应显著情况下，这个时候我们需要知道在一个自变量的不同水平下，另一个自变量对因变量的影响如何！理论上来说需要在a的不同取值水平下分别做回归分析以检验所谓的“x在a不同水平下的简单斜率”是否显著。但是，由于a是一个连续变量，不可能在所有取值下都做， 所以，研究者一般默认取a的三个特殊值来代表其不同水平：</p>
</blockquote>
<p><span class="math display">\[M_{a}-S D_{a}, M_{a}, M_{a}+S D_{a}\]</span></p>
<p>For example, <span class="math inline">\(y=b_{0}+b_{1} x+b_{2} a+b_{3}\left(x-M_{x}\right)\left(a-M_{a}\right)\)</span>,
虽然我们可以直接算出来简单斜率的值，但是单凭这一点无法获得它们的各项统计指标！
所以在具体操作时，研究者想出了一个办法：可以对原始的a减去一个数<span class="math inline">\(\Delta\)</span>,
然后生成三列新的交互项<span class="math inline">\(i n t^{\prime}=\left(x-M_{x}\right) a^{\prime}=\left(x-M_{x}\right)(a-\Delta),\)</span>
最后用x,a,和新交互项进行三次回归分析, 得到的x的回归系数就等于我们想要的简单斜率。</p>
<ol style="list-style-type: decimal">
<li>当 <span class="math inline">\(\Delta=M_{a}\)</span> 时, 回归方程和最原始的方程一模一样, <span class="math inline">\(B_{1}=b_{1}\)</span>;</li>
<li>当 <span class="math inline">\(\Delta=M_{a}-S D_{a}\)</span> 时, <span class="math inline">\(\quad B_{1}=b_{1}-b_{3} S D_{a}=b_{1}^{\prime}\)</span></li>
<li>当 <span class="math inline">\(\Delta=M_{a}+S D_{a}\)</span> 时, <span class="math inline">\(\quad B_{1}=b_{1}+b_{3} S D_{a}=b_{1}^{\prime \prime}\)</span> 。</li>
</ol>
<p>因此, 这三个新的回归方程里 <span class="math inline">\(B_{1}\)</span> 的各项统计指标 (显著性、置信区间、标准化系数等),
交互作用的sim_slopes函数接受回归模型（带有交互作用项）作为输入，并自动执行简单的倾斜过程。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="advanced-linear-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co"># for summ()</span></span>
<span id="cb15-2"><a href="advanced-linear-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb15-3"><a href="advanced-linear-regression.html#cb15-3" aria-hidden="true" tabindex="-1"></a>fiti <span class="ot">&lt;-</span> <span class="fu">lm</span>(Income <span class="sc">~</span> Illiteracy <span class="sc">*</span> Murder <span class="sc">+</span> <span class="st">`</span><span class="at">HS Grad</span><span class="st">`</span>, <span class="at">data =</span> states)</span>
<span id="cb15-4"><a href="advanced-linear-regression.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(fiti)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
Income
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(4,45)
</td>
<td style="text-align:right;">
10.65
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
1414.46
</td>
<td style="text-align:right;">
737.84
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Illiteracy
</td>
<td style="text-align:right;">
753.07
</td>
<td style="text-align:right;">
385.90
</td>
<td style="text-align:right;">
1.95
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Murder
</td>
<td style="text-align:right;">
130.60
</td>
<td style="text-align:right;">
44.67
</td>
<td style="text-align:right;">
2.92
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
<code>HS Grad</code>
</td>
<td style="text-align:right;">
40.76
</td>
<td style="text-align:right;">
10.92
</td>
<td style="text-align:right;">
3.73
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Illiteracy:Murder
</td>
<td style="text-align:right;">
-97.04
</td>
<td style="text-align:right;">
35.86
</td>
<td style="text-align:right;">
-2.71
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="advanced-linear-regression.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb16-2"><a href="advanced-linear-regression.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## SIMPLE SLOPES ANALYSIS 
## 
## Slope of Illiteracy when Murder =  3.69 (- 1 SD): 
## 
##     Est.     S.E.   t val.      p
## -------- -------- -------- ------
##   395.34   274.84     1.44   0.16
## 
## Slope of Illiteracy when Murder =  7.38 (Mean): 
## 
##    Est.     S.E.   t val.      p
## ------- -------- -------- ------
##   37.12   192.56     0.19   0.85
## 
## Slope of Illiteracy when Murder = 11.07 (+ 1 SD): 
## 
##      Est.     S.E.   t val.      p
## --------- -------- -------- ------
##   -321.10   183.49    -1.75   0.09</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="advanced-linear-regression.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 现在我们知道文盲的影响只有在谋杀案很高的时候才存在。</span></span>
<span id="cb18-2"><a href="advanced-linear-regression.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 可以使用modx.values =参数自己选择moderator的值。</span></span>
<span id="cb18-3"><a href="advanced-linear-regression.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="advanced-linear-regression.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb18-5"><a href="advanced-linear-regression.html#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">johnson_neyman =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## SIMPLE SLOPES ANALYSIS 
## 
## Slope of Illiteracy when Murder = 0.00: 
## 
##     Est.     S.E.   t val.      p
## -------- -------- -------- ------
##   753.07   385.90     1.95   0.06
## 
## Slope of Illiteracy when Murder = 5.00: 
## 
##     Est.     S.E.   t val.      p
## -------- -------- -------- ------
##   267.88   240.49     1.11   0.27
## 
## Slope of Illiteracy when Murder = 10.00: 
## 
##      Est.     S.E.   t val.      p
## --------- -------- -------- ------
##   -217.32   176.21    -1.23   0.22</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="advanced-linear-regression.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualize the coefficients</span></span>
<span id="cb20-2"><a href="advanced-linear-regression.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="advanced-linear-regression.html#cb20-3" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sim_slopes</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, </span>
<span id="cb20-4"><a href="advanced-linear-regression.html#cb20-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb20-5"><a href="advanced-linear-regression.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ss)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Simple%20slopes%20analysis-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="advanced-linear-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tabular output</span></span>
<span id="cb21-2"><a href="advanced-linear-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="advanced-linear-regression.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="advanced-linear-regression.html#cb21-4" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sim_slopes</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder,</span>
<span id="cb21-5"><a href="advanced-linear-regression.html#cb21-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb21-6"><a href="advanced-linear-regression.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(huxtable)</span>
<span id="cb21-7"><a href="advanced-linear-regression.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">as_huxtable</span>(ss)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:Simple slopes analysis">
<caption style="caption-side: top; text-align: center;">(#tab:Simple slopes analysis) </caption><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Value of Murder</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Slope of Illiteracy</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Value of Murder</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">slope</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">753.07 (385.90)#</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.00</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">267.88 (240.49)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10.00</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-217.32 (176.21)</td></tr>
</table>

<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="advanced-linear-regression.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Johnson-Neyman intervals</span></span>
<span id="cb22-2"><a href="advanced-linear-regression.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="advanced-linear-regression.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, <span class="at">johnson_neyman =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## JOHNSON-NEYMAN INTERVAL 
## 
## When Murder is OUTSIDE the interval [-0.75, 11.74], the slope of Illiteracy
## is p &lt; .05.
## 
## Note: The range of observed values of Murder is [1.40, 15.10]
## 
## SIMPLE SLOPES ANALYSIS 
## 
## Slope of Illiteracy when Murder =  3.69 (- 1 SD): 
## 
##     Est.     S.E.   t val.      p
## -------- -------- -------- ------
##   395.34   274.84     1.44   0.16
## 
## Slope of Illiteracy when Murder =  7.38 (Mean): 
## 
##    Est.     S.E.   t val.      p
## ------- -------- -------- ------
##   37.12   192.56     0.19   0.85
## 
## Slope of Illiteracy when Murder = 11.07 (+ 1 SD): 
## 
##      Est.     S.E.   t val.      p
## --------- -------- -------- ------
##   -321.10   183.49    -1.75   0.09</code></pre>
</div>
<div id="plotting-interactions" class="section level3" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Plotting Interactions</h3>
<p><a href="https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html#plotting_interactions">Exploring interactions with continuous predictors in regression models</a></p>
<p><strong>Interactions of continuous variables</strong></p>
<p>交互提供了一个intern_plot作为一种相对轻松的方法，可以在后端使用ggplot2获得交互的漂亮图。</p>
<p>interact_plot的默认行为是将不参与交互的所有连续变量平均居中，以便更容易地解释预测值。 您可以通过添加居中=“ none”来禁用它。
可以通过在中心变量的向量中提供特定变量的名称来选择特定变量。默认情况下，使用连续moderator，将获得三行-均值上下的1个标准差以及均值本身。 如果指定modx.values =“ plus-minus”，则不会绘制moderator的平均值，而仅绘制两条+/- SD线。 也可以选择“条件”将数据分成三个相等大小的组，分别代表主持人分布的上，中，下三分之二，并获得代表这些主持人中每个组的主持人中位数的线 。
如果moderator是一个因素，则将绘制每个级别，并且您应保留默认值modx.values = NULL。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="advanced-linear-regression.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools) <span class="co"># for summ()</span></span>
<span id="cb24-2"><a href="advanced-linear-regression.html#cb24-2" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb24-3"><a href="advanced-linear-regression.html#cb24-3" aria-hidden="true" tabindex="-1"></a>fiti <span class="ot">&lt;-</span> <span class="fu">lm</span>(Income <span class="sc">~</span> Illiteracy <span class="sc">*</span> Murder <span class="sc">+</span> <span class="st">`</span><span class="at">HS Grad</span><span class="st">`</span>, <span class="at">data =</span> states)</span>
<span id="cb24-4"><a href="advanced-linear-regression.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(fiti)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
Income
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(4,45)
</td>
<td style="text-align:right;">
10.65
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
1414.46
</td>
<td style="text-align:right;">
737.84
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Illiteracy
</td>
<td style="text-align:right;">
753.07
</td>
<td style="text-align:right;">
385.90
</td>
<td style="text-align:right;">
1.95
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Murder
</td>
<td style="text-align:right;">
130.60
</td>
<td style="text-align:right;">
44.67
</td>
<td style="text-align:right;">
2.92
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
<code>HS Grad</code>
</td>
<td style="text-align:right;">
40.76
</td>
<td style="text-align:right;">
10.92
</td>
<td style="text-align:right;">
3.73
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Illiteracy:Murder
</td>
<td style="text-align:right;">
-97.04
</td>
<td style="text-align:right;">
35.86
</td>
<td style="text-align:right;">
-2.71
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="advanced-linear-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="advanced-linear-regression.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Other options</span></span>
<span id="cb26-2"><a href="advanced-linear-regression.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder,</span>
<span id="cb26-3"><a href="advanced-linear-regression.html#cb26-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">x.label =</span> <span class="st">&quot;Custom X Label&quot;</span>, <span class="at">y.label =</span> <span class="st">&quot;Custom Y Label&quot;</span>,</span>
<span id="cb26-4"><a href="advanced-linear-regression.html#cb26-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title =</span> <span class="st">&quot;Sample Plot&quot;</span>,  <span class="at">legend.main =</span> <span class="st">&quot;Custom Legend Title&quot;</span>,</span>
<span id="cb26-5"><a href="advanced-linear-regression.html#cb26-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">colors =</span> <span class="st">&quot;seagreen&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-2.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="advanced-linear-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 因素，则将绘制每个级别</span></span>
<span id="cb27-2"><a href="advanced-linear-regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a>fitiris <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width <span class="sc">*</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb27-3"><a href="advanced-linear-regression.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fitiris, <span class="at">pred =</span> Petal.Width, <span class="at">modx =</span> Species)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-3.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="advanced-linear-regression.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify a subset of a factor’s levels </span></span>
<span id="cb28-2"><a href="advanced-linear-regression.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fitiris, <span class="at">pred =</span> Petal.Width, <span class="at">modx =</span> Species,</span>
<span id="cb28-3"><a href="advanced-linear-regression.html#cb28-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">modx.values =</span> <span class="fu">c</span>(<span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;virginica&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-4.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="advanced-linear-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting observed data</span></span>
<span id="cb29-2"><a href="advanced-linear-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## plot.points = TRUE argument.</span></span>
<span id="cb29-3"><a href="advanced-linear-regression.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="advanced-linear-regression.html#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="advanced-linear-regression.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## continuous </span></span>
<span id="cb29-6"><a href="advanced-linear-regression.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-5.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="advanced-linear-regression.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## categorical </span></span>
<span id="cb30-2"><a href="advanced-linear-regression.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fitiris, <span class="at">pred =</span> Petal.Width, <span class="at">modx =</span> Species,</span>
<span id="cb30-3"><a href="advanced-linear-regression.html#cb30-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-6.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="advanced-linear-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## random “jitter” </span></span>
<span id="cb31-2"><a href="advanced-linear-regression.html#cb31-2" aria-hidden="true" tabindex="-1"></a>   <span class="do">## 许多点稍微重叠的地方，应用随机的“抖动”将其稍微移动以停止重叠可能会很有用。 使用抖动参数执行此操作。</span></span>
<span id="cb31-3"><a href="advanced-linear-regression.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">## point.shape</span></span>
<span id="cb31-4"><a href="advanced-linear-regression.html#cb31-4" aria-hidden="true" tabindex="-1"></a>   <span class="do">## point.shape = TRUE为每个点赋予不同的形状</span></span>
<span id="cb31-5"><a href="advanced-linear-regression.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fitiris, <span class="at">pred =</span> Petal.Width, <span class="at">modx =</span> Species,</span>
<span id="cb31-6"><a href="advanced-linear-regression.html#cb31-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.points =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> <span class="fl">0.1</span>, <span class="at">point.shape =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-7.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="advanced-linear-regression.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence bands</span></span>
<span id="cb32-2"><a href="advanced-linear-regression.html#cb32-2" aria-hidden="true" tabindex="-1"></a>   <span class="do">## robust argument to plot confidence intervals based on robust standard error calculations.</span></span>
<span id="cb32-3"><a href="advanced-linear-regression.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(fiti, <span class="at">pred =</span> Illiteracy, <span class="at">modx =</span> Murder, <span class="at">interval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-4"><a href="advanced-linear-regression.html#cb32-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">int.width =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Plotting%20interactions%20of%20continuous%20variables-8.png" width="672" /></p>
</div>
<div id="check-linearity-assumption" class="section level3" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Check linearity assumption</h3>
<p>The basic assumption of linear regression is that the relationship between the predictor variable and the response variable is linear. When you have an interaction, you can add the assumption that the relationship between the predictor and the response is linear, regardless of the level of the moderator.
If the relationship is non-linear, it will bend.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="advanced-linear-regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb33-2"><a href="advanced-linear-regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb33-3"><a href="advanced-linear-regression.html#cb33-3" aria-hidden="true" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb33-4"><a href="advanced-linear-regression.html#cb33-4" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb33-5"><a href="advanced-linear-regression.html#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="advanced-linear-regression.html#cb33-6" aria-hidden="true" tabindex="-1"></a>y_1 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>x <span class="sc">-</span> <span class="dv">9</span><span class="sc">*</span>w <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>w<span class="sc">*</span>x <span class="sc">+</span> err</span>
<span id="cb33-7"><a href="advanced-linear-regression.html#cb33-7" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_1 <span class="sc">~</span> x <span class="sc">*</span> w)</span>
<span id="cb33-8"><a href="advanced-linear-regression.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(model_1)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
y_1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(3,196)
</td>
<td style="text-align:right;">
25.93
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
2.47
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
x
</td>
<td style="text-align:right;">
-3.59
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
-8.61
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
w
</td>
<td style="text-align:right;">
-7.77
</td>
<td style="text-align:right;">
1.90
</td>
<td style="text-align:right;">
-4.10
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
x:w
</td>
<td style="text-align:right;">
2.86
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
4.62
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="advanced-linear-regression.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  the assumption is satisfied.</span></span>
<span id="cb34-2"><a href="advanced-linear-regression.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model_1, <span class="at">pred =</span> x, <span class="at">modx =</span> w, <span class="at">linearity.check =</span> <span class="cn">TRUE</span>, </span>
<span id="cb34-3"><a href="advanced-linear-regression.html#cb34-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Check%20linearity%20assumption-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="advanced-linear-regression.html#cb35-1" aria-hidden="true" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">max =</span> <span class="dv">3</span>)</span>
<span id="cb35-2"><a href="advanced-linear-regression.html#cb35-2" aria-hidden="true" tabindex="-1"></a>y_2 <span class="ot">&lt;-</span> <span class="fl">2.5</span> <span class="sc">-</span> x_2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">5</span><span class="sc">*</span>w <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>w<span class="sc">*</span>(x_2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> err</span>
<span id="cb35-3"><a href="advanced-linear-regression.html#cb35-3" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(x_2, y_2, w))</span>
<span id="cb35-4"><a href="advanced-linear-regression.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="advanced-linear-regression.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  the linearity assumption will be violated</span></span>
<span id="cb35-6"><a href="advanced-linear-regression.html#cb35-6" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_2 <span class="sc">~</span> x_2 <span class="sc">*</span> w, <span class="at">data =</span> data_2)</span>
<span id="cb35-7"><a href="advanced-linear-regression.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(model_2)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
y_2
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(3,196)
</td>
<td style="text-align:right;">
3.28
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
-0.75
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
-1.51
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
x_2
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
1.77
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
w
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
2.28
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
x_2:w
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
-0.61
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="advanced-linear-regression.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model_2, <span class="at">pred =</span> x_2, <span class="at">modx =</span> w, <span class="at">linearity.check =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-2"><a href="advanced-linear-regression.html#cb36-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Check%20linearity%20assumption-2.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="advanced-linear-regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 使用以下polynomial多项式来拟合此真实模型</span></span>
<span id="cb37-2"><a href="advanced-linear-regression.html#cb37-2" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_2 <span class="sc">~</span> <span class="fu">poly</span>(x_2, <span class="dv">2</span>) <span class="sc">*</span> w, <span class="at">data =</span> data_2)</span>
<span id="cb37-3"><a href="advanced-linear-regression.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(model_3)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
y_2
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(5,194)
</td>
<td style="text-align:right;">
18.32
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
-1.01
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
-2.41
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poly(x_2, 2)1
</td>
<td style="text-align:right;">
9.90
</td>
<td style="text-align:right;">
6.14
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poly(x_2, 2)2
</td>
<td style="text-align:right;">
-34.14
</td>
<td style="text-align:right;">
6.15
</td>
<td style="text-align:right;">
-5.55
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
w
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
2.65
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poly(x_2, 2)1:w
</td>
<td style="text-align:right;">
-6.33
</td>
<td style="text-align:right;">
8.60
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
poly(x_2, 2)2:w
</td>
<td style="text-align:right;">
75.58
</td>
<td style="text-align:right;">
8.62
</td>
<td style="text-align:right;">
8.77
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="advanced-linear-regression.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model_3, <span class="at">pred =</span> x_2, <span class="at">modx =</span> w, <span class="at">data =</span> data_2)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Check%20linearity%20assumption-3.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="advanced-linear-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  non-linearity check:</span></span>
<span id="cb39-2"><a href="advanced-linear-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model_3, <span class="at">pred =</span> x_2, <span class="at">modx =</span> w, <span class="at">data =</span> data_2,</span>
<span id="cb39-3"><a href="advanced-linear-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">linearity.check =</span> <span class="cn">TRUE</span>, <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Check%20linearity%20assumption-4.png" width="672" /></p>
</div>
</div>
<div id="collinearity" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Collinearity</h2>
<p>When some predictors are linear combinations of others, then <span class="math inline">\(X^{T} X\)</span> is singular, and we have (exact) collinearity. There is no unique least squares estimate of <span class="math inline">\(\beta\)</span> If <span class="math inline">\(X^{T} X\)</span> is close to singular, we have collinearity (some call it multicollinearity). This causes serious problems with the estimation of <span class="math inline">\(\beta\)</span> and associated quantities, as well as the interpretation.</p>
<p>共线性可以通过以下几种方式检测：</p>
<ol style="list-style-type: decimal">
<li>检查预测变量的相关矩阵可能会显示较大的成对共线性。</li>
<li>将 <span class="math inline">\(x_{i}\)</span> 对所有其他预测变量进行回归得到 <span class="math inline">\(R_{i}^{2}\)</span> 。 对所有预测变量重复上述步骤。 <span class="math inline">\(R_{i}^{2}\)</span> 接近1表示有问 题。 令人讨厌的线性组合可以通过检查这些回归系数来发现。</li>
<li>检查 <span class="math inline">\(X^{T} X\)</span>, 的特征值，其中 <span class="math inline">\(\lambda_{1}\)</span> 是最大特征值，其他特征值递减。特征值较小表示存在问题。</li>
</ol>
<pre><code>data (seatpos)
g &lt; - lm (hipcenter ˜ . , seatpos)
summary (g)
round(cor(seatpos), 3)

## check the eigendecomposition:
x &lt; - model.matrix(g)[,-1] 
e &lt; - eigen (t(x) %*% x)
e$val

sqrt(e$val[1]/e$val)
1.000 13.042 20.100 110.551 156.912 212.156 261.667 707.549


## check the variance inflation factors (VIFs). 
   For the first variable this is:
summary (lm (x [, 1] ~ x[,-1]))$r.squared
[1] 0.49948
1/(1!0.49948)
[1] 1.9979


## It is generally believed that a VIF value of more than 5 (some people think it is 10) 
## indicates that there is serious collinearity
vif (x)
Age Weight HtShoes Ht Seated Arm Thigh  Leg
1.9979 3.6470 307.4294 333.1378 8.9511 4.4964 2.7629 6.6943</code></pre>
</div>
<div id="problems-with-the-error" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Problems with the Error</h2>
<p>关于误差项 <span class="math inline">\(\varepsilon\)</span> 的标准假设是，它根据情况是独立且均匀分布的
（independent and identically distributed iid) 。即 <span class="math inline">\(\varepsilon=\sigma^{2} I\)</span> 。
此外，我们还假定误差是正态分布的，以便执行 通常的统计推断。我们已经看到,
这些假设经常会被违反，因此我们必须考虑其他选择。</p>
<ul>
<li>当误差不是i.i.d.时，我们考虑使用广义最小二乘（GLS）。</li>
<li>当误差是独立的，但分布不相同时，我们可以使用加权最小二乘（WLS），这是GLS的特例。</li>
<li>当误差不是正态分布时，我们可以使用鲁棒回归</li>
</ul>
<div id="generalized-least-squares" class="section level3" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> Generalized Least Squares</h3>
<p>到现在为止，我们假设var <span class="math inline">\(\varepsilon=\sigma^{2} I,\)</span>, 但有时错误具有非恒定方差或相关。假设var <span class="math inline">\(\varepsilon=\sigma^{2} \Sigma\)</span>, 其中
<span class="math inline">\(\sigma^{2}\)</span> 是未知的，而 <span class="math inline">\(\Sigma\)</span> 是已知的-换句话说，我们知道误差之间的相关性和相对方差，但我们不知道绝对比
例。
我们可以写 <span class="math inline">\(\Sigma=S S^{T},\)</span>, 其中 <span class="math inline">\(S\)</span> 是使用Choleski分解的三角矩阵（triangular matrix) 。现在我们可以按
如下方式转换回归模型：
<span class="math display">\[
\begin{array}{c}
y=X \beta+\varepsilon \\
S^{-1} y=S^{-1} X \beta+S^{-1} \varepsilon \\
y^{\prime}=X^{\prime} \beta+\varepsilon^{\prime} \\
\operatorname{var} \varepsilon^{\prime}=\operatorname{var}\left(S^{-1} \varepsilon\right)=S^{-1}(\operatorname{var} \varepsilon) S^{-T}=S^{-1} \sigma^{2} S S^{T} S^{-T}=\sigma^{2} I
\end{array}
\]</span>
因此，我们可以将GLS 简化为OLS, 通过 <span class="math inline">\(y^{\prime}=S^{-1} y\)</span> on <span class="math inline">\(S^{-1} X\)</span>,误差为 <span class="math inline">\(\varepsilon^{\prime}\)</span> 即iid. 我们只是将问题简化为 我们已经解决的问题。在此转换后的模型中，平方和为：
<span class="math display">\[
\left(S^{-1} y-S^{-1} X \beta\right)^{T}\left(S^{-1} y-S^{-1} X \beta\right)=(y-X \beta)^{T} S^{-T} S^{-1}(y-X \beta)=(y-X \beta)^{T} \Sigma^{-1}(y-X \beta)
\]</span>
which is minimized by:
<span class="math display">\[
\hat{\boldsymbol{\beta}}=\left(X^{T} \Sigma^{-1} X\right)^{-1} X^{T} \Sigma^{-1} y
\]</span>
We find that:
<span class="math display">\[
\operatorname{var} \hat{\boldsymbol{\beta}}=\left(X^{T} \Sigma^{-1} X\right)^{-1} \sigma^{2}
\]</span>
Since <span class="math inline">\(\varepsilon^{\prime}=S^{-1} \varepsilon\)</span>, diagnostics should be applied to the residuals, <span class="math inline">\(S^{-1} \hat{\varepsilon} .\)</span> If we have the right <span class="math inline">\(\Sigma\)</span>, then
these should be approximately i.i.d.
在Pinheiro和Bates（2000）的nlme软件包中找到更方便的方法，该软件包包含GLS拟合函数。我们可以 使用它来拟合此模型：</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="advanced-linear-regression.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (nlme)</span>
<span id="cb41-2"><a href="advanced-linear-regression.html#cb41-2" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(follicles <span class="sc">~</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>Time) <span class="sc">+</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>Time), Ovary,</span>
<span id="cb41-3"><a href="advanced-linear-regression.html#cb41-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">correlation =</span> <span class="fu">corAR1</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Mare))</span>
<span id="cb41-4"><a href="advanced-linear-regression.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fm1)</span></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: follicles ~ sin(2 * pi * Time) + cos(2 * pi * Time) 
##   Data: Ovary 
##        AIC      BIC    logLik
##   1571.455 1590.056 -780.7273
## 
## Correlation Structure: AR(1)
##  Formula: ~1 | Mare 
##  Parameter estimate(s):
##       Phi 
## 0.7532079 
## 
## Coefficients:
##                        Value Std.Error   t-value p-value
## (Intercept)        12.216398 0.6646437 18.380373  0.0000
## sin(2 * pi * Time) -2.774712 0.6450478 -4.301561  0.0000
## cos(2 * pi * Time) -0.899605 0.6975383 -1.289685  0.1981
## 
##  Correlation: 
##                    (Intr) s(*p*T
## sin(2 * pi * Time)  0.000       
## cos(2 * pi * Time) -0.294  0.000
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -2.41180365 -0.75405234 -0.02923628  0.63156880  3.16247697 
## 
## Residual standard error: 4.616172 
## Degrees of freedom: 308 total; 305 residual</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="advanced-linear-regression.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## check the confidence intervals</span></span>
<span id="cb43-2"><a href="advanced-linear-regression.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">intervals</span> (fm1) </span></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Coefficients:
##                        lower       est.      upper
## (Intercept)        10.908531 12.2163982 13.5242656
## sin(2 * pi * Time) -4.044019 -2.7747122 -1.5054050
## cos(2 * pi * Time) -2.272201 -0.8996047  0.4729919
## attr(,&quot;label&quot;)
## [1] &quot;Coefficients:&quot;
## 
##  Correlation structure:
##         lower      est.     upper
## Phi 0.6684283 0.7532079 0.8186662
## attr(,&quot;label&quot;)
## [1] &quot;Correlation structure:&quot;
## 
##  Residual standard error:
##    lower     est.    upper 
## 3.974706 4.616172 5.361161</code></pre>
</div>
<div id="weighted-least-squares" class="section level3" number="12.7.2">
<h3><span class="header-section-number">12.7.2</span> Weighted Least Squares</h3>
<p>有时误差是不相关的，但方差不相等。当 <span class="math inline">\(\Sigma\)</span> 是对角矩阵时，误差是不相关的，但不一定具有相等的方
差。在这种情况下可以使用WLS。
<span class="math display">\[
\Sigma=\operatorname{diag}(1 / \mathrm{w} 1, \ldots, 1 / \mathrm{w} n)
\]</span>
其中 <span class="math inline">\(w_{i}\)</span> 是权重, <span class="math inline">\(S=\operatorname{diag}(\sqrt{1 / w 1}, \ldots, \sqrt{1 / w n})\)</span> 因此我们可以将 <span class="math inline">\(\sqrt{w_{i}} y_{i}\)</span> 上的 <span class="math inline">\(\sqrt{w_{i}} x_{i}\)</span> 回归（尽
管需要替换 <span class="math inline">\(X\)</span> -matrix中的一列 与 )。变异性低的案例应获得较高的权重，变异性高的案例应获
得较低的权重。
Das Modell
<span class="math display">\[
\boldsymbol{y}=\boldsymbol{X} \boldsymbol{\beta}+\boldsymbol{\varepsilon}
\]</span></p>
<p>is called a general linear regression model if the following assumptions apply:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathrm{E}(\varepsilon)=\mathbf{0}\)</span></li>
<li><span class="math inline">\(\operatorname{Cov}(\varepsilon)=\mathrm{E}\left(\varepsilon \varepsilon^{\prime}\right)=\sigma^{2} \boldsymbol{W}\)</span>, wobei <span class="math inline">\(\boldsymbol{W}\)</span> eine bekannte positiv definite Matrix sei.</li>
<li>Die Designmatrix <span class="math inline">\(\boldsymbol{X}\)</span> besitzt vollen Spaltenrang, d.h. <span class="math inline">\(\operatorname{rg}(\boldsymbol{X})=p\)</span>.</li>
<li><span class="math inline">\(\varepsilon \sim \mathrm{N}\left(\mathbf{0}, \sigma^{2} \boldsymbol{W}\right)\)</span>
<span class="math inline">\(\mathrm{lm}_{\mathrm{A} \mathrm{A} 2}^{\sim} \mathrm{A}+\mathrm{B}+\mathrm{C}+\mathrm{D}+\mathrm{E}+\mathrm{F}+\mathrm{G}+\mathrm{H}+\mathrm{J}+\mathrm{K}+\mathrm{N} ! \mathrm{l}\)</span>, fpe, weights <span class="math inline">\(\left.=\mathrm{l} / \mathrm{EI}\right)\)</span></li>
</ol>
<p><strong>weights options</strong></p>
<p>an optional vector of weights to be used in the fitting process. Should be NULL or a numeric vector. If non-NULL, weighted least squares is used with weights weights (that is, minimizing sum(w*e^2)); otherwise ordinary least squares is used.</p>
</div>
<div id="robust-regression" class="section level3" number="12.7.3">
<h3><span class="header-section-number">12.7.3</span> Robust Regression</h3>
<p>When the error is normal, the least squares regression is obviously the best, but when the error is non-normal, other methods can be considered. Of particular interest are long-tailed error distributions. Robust regression provides an alternative. Robust regression is related to WLS.</p>
<ol style="list-style-type: decimal">
<li>健壮的估计器可防止长尾误差，但无法克服模型选择及其方差结构方面的问题。</li>
<li>健壮的估算仅能为您提供 <span class="math inline">\(\hat{\beta}\)</span> 以及可能的标准错误，而没有相关的推论方法。</li>
<li>除最小二乘法外，还可以使用鲁棒的方法作为确认方法。如果这两个估计值相距甚远，则有理由担 心。差异的来源应进行调查。</li>
</ol>
</div>
</div>
<div id="shrinkage-methods" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Shrinkage Methods</h2>
<div id="principal-components-analzsis" class="section level3" number="12.8.1">
<h3><span class="header-section-number">12.8.1</span> Principal Components Analzsis</h3>
</div>
<div id="partial-least-squares" class="section level3" number="12.8.2">
<h3><span class="header-section-number">12.8.2</span> Partial Least Squares</h3>
<p>Partial Least Squares (PLS) is a method used to associate a set of input variables X1,…Xm with outputs Y1,…,Y1. PLS regression is comparable to PCR because both use a certain number of linear combinations of predictors to predict the response. The difference is that although PCR ignores Y when determining linear combinations, PLS regression explicitly selects them to predict Y as much as possible. We will only consider univariate PLS</p>
<p><span class="math display">\[\hat{y}=\beta_{1} T_{1}+\cdots+\beta_{p} T_{p}\]</span></p>
<!-- 偏最小二乘（PLS）是一种用于关联一组输入变量X1，... Xm和输出Y1，...，Y1的方法。PLS回归可与PCR媲美，因为两者均使用一定数量的预测变量线性组合来预测响应。 区别在于，尽管PCR在确定线性组合时忽略了Y，但PLS回归显式选择了它们来尽可能地预测Y。 我们将仅考虑单变量PLS -->
<div class="figure" style="text-align: center">
<img src="02_Plots/Partial%20Least%20Squares.png" alt="Figure: Partial Least Squares" width="100%" />
<p class="caption">
(#fig:Partial Least Squares)Figure: Partial Least Squares
</p>
</div>
</div>
<div id="ridge-regression" class="section level3" number="12.8.3">
<h3><span class="header-section-number">12.8.3</span> Ridge Regression</h3>
<p><span class="math display">\[
\hat{\boldsymbol{\beta}}=\left(X^{T} X+\lambda I\right)^{-1} X^{T} y
\]</span>
We demonstrate the method on the meat spectroscopy data; <span class="math inline">\(\lambda=0\)</span> corresponds to least
squares while we find that as <span class="math inline">\(\lambda \rightarrow \infty: \hat{\beta} \rightarrow 0\)</span></p>
<p>The Ridge regression estimates of coefficients are biased. Deviation is undesirable, but it is not the only consideration. The mean square error (MSE) can be decomposed in the following ways:</p>
<p><span class="math display">\[E(\hat{\beta}-\beta)^{2}=(E(\hat{\beta}-\beta))^{2}+E(\hat{\beta}-E \hat{\beta})^{2}\]</span></p>
<p>因此，估计的MSE可以表示为偏差的平方加方差。 有时，可以以增加偏差为代价获得方差的大幅减少。 如果结果导致MSE降低，那么我们可能愿意接受一些偏见。 这就是岭回归所要做出的权衡—以偏差增加为代价减少方差。 这是一个常见的难题。 Frank and Friedman（1993）比较了PCR，PLS和岭回归，发现岭回归的最佳结果。 当然，对于任何给定的数据集，任何一种方法都可能被证明是最好的，因此很难选择一个获胜者</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="correlation-and-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-Advanced-Linear-Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
