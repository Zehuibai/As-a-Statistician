<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 ggplot2 | As a Statistician</title>
  <meta name="description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 ggplot2 | As a Statistician" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 ggplot2 | As a Statistician" />
  
  <meta name="twitter:description" content="This book involves different statistical principles and methods, including the application of SAS and R, and aims to accumulate personal statistical knowledge." />
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2022-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-management-in-r.html"/>
<link rel="next" href="descriptive-statistics-in-r.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.17/d3.min.js"></script>
<link href="libs/markmap-0.3.3/view.mindmap.css" rel="stylesheet" />
<script src="libs/markmap-0.3.3/view.mindmap.js"></script>
<script src="libs/markmap-0.3.3/plugins/parsemd.min.js"></script>
<script src="libs/markmap-binding-1.2.3/markmap.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.6.1/DiagrammeR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">As a Statistician</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="data-management-in-sas.html#data-management-in-sas" id="toc-data-management-in-sas"><span class="toc-section-number">2</span> Data Management in SAS</a>
<ul>
<li><a href="data-management-in-sas.html#input-data-into-sas" id="toc-input-data-into-sas"><span class="toc-section-number">2.1</span> Input data into SAS</a>
<ul>
<li><a href="data-management-in-sas.html#native-datasets-input" id="toc-native-datasets-input"><span class="toc-section-number">2.1.1</span> Native datasets input</a></li>
<li><a href="data-management-in-sas.html#reading-free-formatted-data-instream" id="toc-reading-free-formatted-data-instream"><span class="toc-section-number">2.1.2</span> Reading free formatted data instream</a></li>
<li><a href="data-management-in-sas.html#reading-fixed-formatted-data-instream" id="toc-reading-fixed-formatted-data-instream"><span class="toc-section-number">2.1.3</span> Reading fixed formatted data instream</a></li>
<li><a href="data-management-in-sas.html#infile-reading-fixed-formatted-data-from-an-external-file" id="toc-infile-reading-fixed-formatted-data-from-an-external-file"><span class="toc-section-number">2.1.4</span> INFILE: Reading fixed formatted data from an external file</a></li>
<li><a href="data-management-in-sas.html#write-the-sas-file" id="toc-write-the-sas-file"><span class="toc-section-number">2.1.5</span> Write the SAS File</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">2.1.6</span> Import csv data</a></li>
<li><a href="data-management-in-sas.html#import" id="toc-import"><span class="toc-section-number">2.1.7</span> %Import</a></li>
<li><a href="data-management-in-sas.html#url" id="toc-url"><span class="toc-section-number">2.1.8</span> URL</a></li>
<li><a href="data-management-in-sas.html#infile-read-multiple-raw-data-files" id="toc-infile-read-multiple-raw-data-files"><span class="toc-section-number">2.1.9</span> Infile Read multiple raw data files</a></li>
<li><a href="data-management-in-sas.html#generate-automatic-file-name" id="toc-generate-automatic-file-name"><span class="toc-section-number">2.1.10</span> Generate automatic file name</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#format-the-variables" id="toc-format-the-variables"><span class="toc-section-number">2.2</span> Format the variables</a>
<ul>
<li><a href="data-management-in-sas.html#proc-format" id="toc-proc-format"><span class="toc-section-number">2.2.1</span> Proc format</a></li>
<li><a href="data-management-in-sas.html#copy-and-combine-sas-format-libraries" id="toc-copy-and-combine-sas-format-libraries"><span class="toc-section-number">2.2.2</span> Copy and combine SAS format libraries</a></li>
<li><a href="data-management-in-sas.html#build-a-format-from-a-dataset" id="toc-build-a-format-from-a-dataset"><span class="toc-section-number">2.2.3</span> Build a format from a dataset</a></li>
<li><a href="data-management-in-sas.html#output-format-as-datasets" id="toc-output-format-as-datasets"><span class="toc-section-number">2.2.4</span> Output format as datasets</a></li>
<li><a href="data-management-in-sas.html#delete-the-format" id="toc-delete-the-format"><span class="toc-section-number">2.2.5</span> Delete the format</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#array" id="toc-array"><span class="toc-section-number">2.3</span> Array</a>
<ul>
<li><a href="data-management-in-sas.html#defining" id="toc-defining"><span class="toc-section-number">2.3.1</span> Defining</a></li>
<li><a href="data-management-in-sas.html#format-multiple-variables" id="toc-format-multiple-variables"><span class="toc-section-number">2.3.2</span> Format multiple variables</a></li>
<li><a href="data-management-in-sas.html#arrays" id="toc-arrays"><span class="toc-section-number">2.3.3</span> 2*2 arrays</a></li>
<li><a href="data-management-in-sas.html#dynamic-element-list-using-macro-variables" id="toc-dynamic-element-list-using-macro-variables"><span class="toc-section-number">2.3.4</span> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#retain" id="toc-retain"><span class="toc-section-number">2.4</span> Retain</a>
<ul>
<li><a href="data-management-in-sas.html#generate-serial-number" id="toc-generate-serial-number"><span class="toc-section-number">2.4.1</span> Generate Serial Number</a></li>
<li><a href="data-management-in-sas.html#change-from-basilne" id="toc-change-from-basilne"><span class="toc-section-number">2.4.2</span> Change from Basilne</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#data-utilities" id="toc-data-utilities"><span class="toc-section-number">2.5</span> Data utilities</a>
<ul>
<li><a href="data-management-in-sas.html#scan" id="toc-scan"><span class="toc-section-number">2.5.1</span> %Scan</a></li>
<li><a href="data-management-in-sas.html#eval-and-syseval" id="toc-eval-and-syseval"><span class="toc-section-number">2.5.2</span> %eval and %syseval</a></li>
<li><a href="data-management-in-sas.html#macro-variable-status" id="toc-macro-variable-status"><span class="toc-section-number">2.5.3</span> Macro variable status</a></li>
<li><a href="data-management-in-sas.html#sysfunc" id="toc-sysfunc"><span class="toc-section-number">2.5.4</span> %SYSFUNC</a></li>
<li><a href="data-management-in-sas.html#quoting-function" id="toc-quoting-function"><span class="toc-section-number">2.5.5</span> Quoting Function</a></li>
<li><a href="data-management-in-sas.html#call-symput" id="toc-call-symput"><span class="toc-section-number">2.5.6</span> Call Symput</a></li>
<li><a href="data-management-in-sas.html#call-execute" id="toc-call-execute"><span class="toc-section-number">2.5.7</span> Call Execute</a></li>
<li><a href="data-management-in-sas.html#sysfunc-get-the-observations" id="toc-sysfunc-get-the-observations"><span class="toc-section-number">2.5.8</span> %sysfunc get the observations</a></li>
</ul></li>
<li><a href="data-management-in-sas.html#clean-up" id="toc-clean-up"><span class="toc-section-number">2.6</span> Clean Up</a>
<ul>
<li><a href="data-management-in-sas.html#basic-setting" id="toc-basic-setting"><span class="toc-section-number">2.6.1</span> Basic setting</a></li>
<li><a href="data-management-in-sas.html#delete-datasets" id="toc-delete-datasets"><span class="toc-section-number">2.6.2</span> Delete datasets</a></li>
<li><a href="data-management-in-sas.html#deleting-formats" id="toc-deleting-formats"><span class="toc-section-number">2.6.3</span> Deleting Formats</a></li>
<li><a href="data-management-in-sas.html#remove-assigned-formats" id="toc-remove-assigned-formats"><span class="toc-section-number">2.6.4</span> Remove assigned formats</a></li>
<li><a href="data-management-in-sas.html#delete-macro-variables" id="toc-delete-macro-variables"><span class="toc-section-number">2.6.5</span> Delete macro variables</a></li>
<li><a href="data-management-in-sas.html#delete-macro" id="toc-delete-macro"><span class="toc-section-number">2.6.6</span> Delete Macro</a></li>
</ul></li>
</ul></li>
<li><a href="data-management-in-r.html#data-management-in-r" id="toc-data-management-in-r"><span class="toc-section-number">3</span> Data Management in R</a>
<ul>
<li><a href="data-management-in-r.html#basic-data-management" id="toc-basic-data-management"><span class="toc-section-number">3.1</span> Basic data management</a>
<ul>
<li><a href="data-management-in-r.html#apply-family" id="toc-apply-family"><span class="toc-section-number">3.1.1</span> apply family</a></li>
</ul></li>
<li><a href="data-management-in-r.html#importimput" id="toc-importimput"><span class="toc-section-number">3.2</span> import/imput</a>
<ul>
<li><a href="data-management-in-r.html#package-readr" id="toc-package-readr"><span class="toc-section-number">3.2.1</span> Package readr</a></li>
<li><a href="data-management-in-sas.html#import-csv-data" id="toc-import-csv-data"><span class="toc-section-number">3.2.2</span> Import csv data</a></li>
<li><a href="data-management-in-r.html#import-txt-data" id="toc-import-txt-data"><span class="toc-section-number">3.2.3</span> Import txt data</a></li>
<li><a href="data-management-in-r.html#import-excel-data" id="toc-import-excel-data"><span class="toc-section-number">3.2.4</span> Import excel data</a></li>
<li><a href="data-management-in-r.html#import-stata-data" id="toc-import-stata-data"><span class="toc-section-number">3.2.5</span> Import stata data</a></li>
<li><a href="data-management-in-r.html#import-sas-data" id="toc-import-sas-data"><span class="toc-section-number">3.2.6</span> Import SAS data</a></li>
<li><a href="data-management-in-r.html#copy-from-clipboard" id="toc-copy-from-clipboard"><span class="toc-section-number">3.2.7</span> Copy from clipboard</a></li>
<li><a href="data-management-in-r.html#save-and-write-objective-in-r" id="toc-save-and-write-objective-in-r"><span class="toc-section-number">3.2.8</span> Save and write objective in R</a></li>
<li><a href="data-management-in-r.html#save-the-plot" id="toc-save-the-plot"><span class="toc-section-number">3.2.9</span> Save the plot</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-tidyr" id="toc-package-tidyr"><span class="toc-section-number">3.3</span> Package tidyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet" id="toc-cheat-sheet"><span class="toc-section-number">3.3.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#pivoting" id="toc-pivoting"><span class="toc-section-number">3.3.2</span> Pivoting</a></li>
<li><a href="data-management-in-r.html#gather-and-spread" id="toc-gather-and-spread"><span class="toc-section-number">3.3.3</span> gather and spread</a></li>
<li><a href="data-management-in-r.html#separate-and-unite" id="toc-separate-and-unite"><span class="toc-section-number">3.3.4</span> separate and unite</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-dplyr" id="toc-package-dplyr"><span class="toc-section-number">3.4</span> Package dplyr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-1" id="toc-cheat-sheet-1"><span class="toc-section-number">3.4.1</span> CHEAT SHEET</a></li>
<li><a href="data-management-in-r.html#across" id="toc-across"><span class="toc-section-number">3.4.2</span> across</a></li>
<li><a href="data-management-in-r.html#arrange" id="toc-arrange"><span class="toc-section-number">3.4.3</span> arrange</a></li>
<li><a href="data-management-in-r.html#coalesce" id="toc-coalesce"><span class="toc-section-number">3.4.4</span> coalesce</a></li>
<li><a href="data-management-in-r.html#filter" id="toc-filter"><span class="toc-section-number">3.4.5</span> filter</a></li>
<li><a href="data-management-in-r.html#if_else" id="toc-if_else"><span class="toc-section-number">3.4.6</span> if_else</a></li>
<li><a href="data-management-in-r.html#join" id="toc-join"><span class="toc-section-number">3.4.7</span> join</a></li>
<li><a href="data-management-in-r.html#mutate" id="toc-mutate"><span class="toc-section-number">3.4.8</span> mutate</a></li>
<li><a href="data-management-in-r.html#select" id="toc-select"><span class="toc-section-number">3.4.9</span> select</a></li>
<li><a href="data-management-in-r.html#summarise" id="toc-summarise"><span class="toc-section-number">3.4.10</span> summarise</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-stringr" id="toc-package-stringr"><span class="toc-section-number">3.5</span> Package stringr</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-2" id="toc-cheat-sheet-2"><span class="toc-section-number">3.5.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-forcats" id="toc-package-forcats"><span class="toc-section-number">3.6</span> Package forcats</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-3" id="toc-cheat-sheet-3"><span class="toc-section-number">3.6.1</span> CHEAT SHEET</a></li>
</ul></li>
<li><a href="data-management-in-r.html#package-lubridate" id="toc-package-lubridate"><span class="toc-section-number">3.7</span> Package lubridate</a>
<ul>
<li><a href="data-management-in-r.html#cheat-sheet-4" id="toc-cheat-sheet-4"><span class="toc-section-number">3.7.1</span> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li><a href="ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4</span> ggplot2</a>
<ul>
<li><a href="ggplot2.html#parametric-rendering" id="toc-parametric-rendering"><span class="toc-section-number">4.1</span> Parametric Rendering</a>
<ul>
<li><a href="ggplot2.html#grammar" id="toc-grammar"><span class="toc-section-number">4.1.1</span> Grammar</a></li>
<li><a href="ggplot2.html#coordinate-system" id="toc-coordinate-system"><span class="toc-section-number">4.1.2</span> Coordinate system</a></li>
<li><a href="ggplot2.html#legend" id="toc-legend"><span class="toc-section-number">4.1.3</span> Legend</a></li>
<li><a href="ggplot2.html#geom" id="toc-geom"><span class="toc-section-number">4.1.4</span> geom</a></li>
<li><a href="ggplot2.html#position" id="toc-position"><span class="toc-section-number">4.1.5</span> position</a></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">4.1.6</span> scale</a></li>
<li><a href="ggplot2.html#stat" id="toc-stat"><span class="toc-section-number">4.1.7</span> stat</a></li>
<li><a href="ggplot2.html#color" id="toc-color"><span class="toc-section-number">4.1.8</span> Color</a></li>
<li><a href="ggplot2.html#thema" id="toc-thema"><span class="toc-section-number">4.1.9</span> Thema</a></li>
<li><a href="ggplot2.html#saving-plots" id="toc-saving-plots"><span class="toc-section-number">4.1.10</span> Saving plots</a></li>
</ul></li>
<li><a href="ggplot2.html#scatter-plot" id="toc-scatter-plot"><span class="toc-section-number">4.2</span> Scatter plot</a>
<ul>
<li><a href="ggplot2.html#grouping-aesthetic" id="toc-grouping-aesthetic"><span class="toc-section-number">4.2.1</span> Grouping Aesthetic</a></li>
<li><a href="ggplot2.html#facet" id="toc-facet"><span class="toc-section-number">4.2.2</span> facet</a></li>
<li><a href="ggplot2.html#geom_smooth" id="toc-geom_smooth"><span class="toc-section-number">4.2.3</span> geom_smooth</a></li>
<li><a href="ggplot2.html#dot-plot" id="toc-dot-plot"><span class="toc-section-number">4.2.4</span> Dot Plot</a></li>
<li><a href="ggplot2.html#label-and-title" id="toc-label-and-title"><span class="toc-section-number">4.2.5</span> Label and Title</a></li>
<li><a href="ggplot2.html#residuals" id="toc-residuals"><span class="toc-section-number">4.2.6</span> Residuals</a></li>
<li><a href="ggplot2.html#encircling" id="toc-encircling"><span class="toc-section-number">4.2.7</span> Encircling</a></li>
<li><a href="ggplot2.html#dumbbell-plot" id="toc-dumbbell-plot"><span class="toc-section-number">4.2.8</span> Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#histogram" id="toc-histogram"><span class="toc-section-number">4.3</span> Histogram</a>
<ul>
<li><a href="ggplot2.html#general-appearance" id="toc-general-appearance"><span class="toc-section-number">4.3.1</span> General appearance</a></li>
<li><a href="ggplot2.html#themes" id="toc-themes"><span class="toc-section-number">4.3.2</span> Themes</a></li>
<li><a href="ggplot2.html#geom_freqpoly" id="toc-geom_freqpoly"><span class="toc-section-number">4.3.3</span> geom_freqpoly()</a></li>
<li><a href="ggplot2.html#marginal-histogram-boxplot" id="toc-marginal-histogram-boxplot"><span class="toc-section-number">4.3.4</span> Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2.html#scales" id="toc-scales"><span class="toc-section-number">4.3.5</span> Scales</a></li>
</ul></li>
<li><a href="ggplot2.html#bar-plot" id="toc-bar-plot"><span class="toc-section-number">4.4</span> Bar plot</a>
<ul>
<li><a href="ggplot2.html#aesthetic" id="toc-aesthetic"><span class="toc-section-number">4.4.1</span> Aesthetic</a></li>
<li><a href="ggplot2.html#proportion" id="toc-proportion"><span class="toc-section-number">4.4.2</span> Proportion</a></li>
<li><a href="ggplot2.html#statidentity" id="toc-statidentity"><span class="toc-section-number">4.4.3</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#ranking" id="toc-ranking"><span class="toc-section-number">4.4.4</span> Ranking</a></li>
<li><a href="ggplot2.html#means-and-error-bars" id="toc-means-and-error-bars"><span class="toc-section-number">4.4.5</span> Means and error bars</a></li>
<li><a href="ggplot2.html#waffle-chart" id="toc-waffle-chart"><span class="toc-section-number">4.4.6</span> Waffle Chart</a></li>
</ul></li>
<li><a href="ggplot2.html#box-plot" id="toc-box-plot"><span class="toc-section-number">4.5</span> Box plot</a>
<ul>
<li><a href="ggplot2.html#varwidth" id="toc-varwidth"><span class="toc-section-number">4.5.1</span> varwidth</a></li>
<li><a href="ggplot2.html#fill" id="toc-fill"><span class="toc-section-number">4.5.2</span> Fill</a></li>
<li><a href="ggplot2.html#statidentity-1" id="toc-statidentity-1"><span class="toc-section-number">4.5.3</span> stat=“identity”</a></li>
<li><a href="ggplot2.html#dot-box-plot" id="toc-dot-box-plot"><span class="toc-section-number">4.5.4</span> Dot + Box Plot</a></li>
</ul></li>
<li><a href="ggplot2.html#other-rendering" id="toc-other-rendering"><span class="toc-section-number">4.6</span> Other rendering</a>
<ul>
<li><a href="ggplot2.html#annotation" id="toc-annotation"><span class="toc-section-number">4.6.1</span> Annotation</a></li>
<li><a href="ggplot2.html#text-ggtext" id="toc-text-ggtext"><span class="toc-section-number">4.6.2</span> Text: ggtext</a></li>
<li><a href="ggplot2.html#text-ggrepel" id="toc-text-ggrepel"><span class="toc-section-number">4.6.3</span> Text: ggrepel</a></li>
<li><a href="ggplot2.html#arrage-gridextra" id="toc-arrage-gridextra"><span class="toc-section-number">4.6.4</span> Arrage: gridExtra</a></li>
<li><a href="ggplot2.html#interactive-charts-plotly" id="toc-interactive-charts-plotly"><span class="toc-section-number">4.6.5</span> Interactive charts: plotly</a></li>
</ul></li>
<li><a href="ggplot2.html#diagrammer" id="toc-diagrammer"><span class="toc-section-number">4.7</span> DiagrammeR</a>
<ul>
<li><a href="ggplot2.html#basic-flowchart-using-grviz" id="toc-basic-flowchart-using-grviz"><span class="toc-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></a></li>
<li><a href="ggplot2.html#graphviz-attributes" id="toc-graphviz-attributes"><span class="toc-section-number">4.7.2</span> Graphviz Attributes</a></li>
<li><a href="ggplot2.html#gantt-chart" id="toc-gantt-chart"><span class="toc-section-number">4.7.3</span> Gantt chart</a></li>
</ul></li>
<li><a href="ggplot2.html#ggstatsplot" id="toc-ggstatsplot"><span class="toc-section-number">4.8</span> ggstatsplot</a>
<ul>
<li><a href="ggplot2.html#ggbetweenstats" id="toc-ggbetweenstats"><span class="toc-section-number">4.8.1</span> ggbetweenstats</a></li>
</ul></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#descriptive-statistics-in-r" id="toc-descriptive-statistics-in-r"><span class="toc-section-number">5</span> Descriptive Statistics in R</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#package-pape" id="toc-package-pape"><span class="toc-section-number">5.1</span> Package pape</a></li>
<li><a href="descriptive-statistics-in-r.html#package-summarytools" id="toc-package-summarytools"><span class="toc-section-number">5.2</span> Package summarytools</a></li>
<li><a href="descriptive-statistics-in-r.html#package-comparegroups" id="toc-package-comparegroups"><span class="toc-section-number">5.3</span> Package compareGroups</a></li>
<li><a href="descriptive-statistics-in-r.html#package-sjplot-for-models-summary" id="toc-package-sjplot-for-models-summary"><span class="toc-section-number">5.4</span> Package sjPlot for Models Summary</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#tab_model-and-options" id="toc-tab_model-and-options"><span class="toc-section-number">5.4.1</span> tab_model and options</a></li>
<li><a href="descriptive-statistics-in-r.html#mixed-models" id="toc-mixed-models"><span class="toc-section-number">5.4.2</span> Mixed Models</a></li>
<li><a href="descriptive-statistics-in-r.html#plot_model" id="toc-plot_model"><span class="toc-section-number">5.4.3</span> plot_model</a></li>
</ul></li>
<li><a href="descriptive-statistics-in-r.html#package-kableextra" id="toc-package-kableextra"><span class="toc-section-number">5.5</span> Package kableExtra</a>
<ul>
<li><a href="descriptive-statistics-in-r.html#kable_styling" id="toc-kable_styling"><span class="toc-section-number">5.5.1</span> kable_styling</a></li>
<li><a href="descriptive-statistics-in-r.html#columnrow-specification" id="toc-columnrow-specification"><span class="toc-section-number">5.5.2</span> Column/Row Specification</a></li>
<li><a href="descriptive-statistics-in-r.html#grouping-columnsrows" id="toc-grouping-columnsrows"><span class="toc-section-number">5.5.3</span> Grouping columns/rows</a></li>
<li><a href="descriptive-statistics-in-r.html#add-footnote" id="toc-add-footnote"><span class="toc-section-number">5.5.4</span> Add Footnote</a></li>
</ul></li>
</ul></li>
<li><a href="parametric-test.html#parametric-test" id="toc-parametric-test"><span class="toc-section-number">6</span> Parametric Test</a>
<ul>
<li><a href="parametric-test.html#binomial-test" id="toc-binomial-test"><span class="toc-section-number">6.1</span> Binomial test</a>
<ul>
<li><a href="parametric-test.html#mathematical-formula" id="toc-mathematical-formula"><span class="toc-section-number">6.1.1</span> Mathematical Formula</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">6.1.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">6.1.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">6.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">6.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">6.2.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">6.2.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">6.3</span> Sensitivity and specificity</a></li>
<li><a href="parametric-test.html#mcnemars-test" id="toc-mcnemars-test"><span class="toc-section-number">6.4</span> McNemar’s test</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">6.4.1</span> introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">6.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">6.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#cochranmantelhaenszel-test" id="toc-cochranmantelhaenszel-test"><span class="toc-section-number">6.5</span> Cochran–Mantel–Haenszel Test</a>
<ul>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">6.5.1</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#correlation-test" id="toc-correlation-test"><span class="toc-section-number">6.6</span> Correlation Test</a>
<ul>
<li><a href="parametric-test.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">6.6.1</span> Pearson correlation</a></li>
<li><a href="parametric-test.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">6.6.2</span> Spearman correlation</a></li>
<li><a href="parametric-test.html#kendall-correlation" id="toc-kendall-correlation"><span class="toc-section-number">6.6.3</span> Kendall correlation</a></li>
</ul></li>
<li><a href="parametric-test.html#two-sample-t-test" id="toc-two-sample-t-test"><span class="toc-section-number">6.7</span> Two Sample T-Test</a>
<ul>
<li><a href="parametric-test.html#inreoduction" id="toc-inreoduction"><span class="toc-section-number">6.7.1</span> Inreoduction</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">6.7.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">6.7.3</span> R implementation</a></li>
</ul></li>
<li><a href="parametric-test.html#normality-test" id="toc-normality-test"><span class="toc-section-number">6.8</span> Normality test</a>
<ul>
<li><a href="parametric-test.html#sas-implementation-4" id="toc-sas-implementation-4"><span class="toc-section-number">6.8.1</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-5" id="toc-r-implementation-5"><span class="toc-section-number">6.8.2</span> R implementation</a></li>
</ul></li>
</ul></li>
<li><a href="non-parametric-test.html#non-parametric-test" id="toc-non-parametric-test"><span class="toc-section-number">7</span> Non-Parametric Test</a>
<ul>
<li><a href="non-parametric-test.html#two-samples-hypotheses-testing" id="toc-two-samples-hypotheses-testing"><span class="toc-section-number">7.1</span> Two Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#sign-test-for-location-parameter-for-matched-paired-samples" id="toc-sign-test-for-location-parameter-for-matched-paired-samples"><span class="toc-section-number">7.1.1</span> Sign Test for Location Parameter for Matched Paired Samples</a></li>
<li><a href="non-parametric-test.html#wilcoxon-signed-rank-test-for-location-parameter-for-matched" id="toc-wilcoxon-signed-rank-test-for-location-parameter-for-matched"><span class="toc-section-number">7.1.2</span> Wilcoxon Signed-Rank Test for Location Parameter for Matched</a></li>
<li><a href="non-parametric-test.html#wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples" id="toc-wilcoxon-rank-sum-test-for-location-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.3</span> Wilcoxon Rank-Sum Test for Location Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#ansari-bradley-test-for-scale-parameter-for-two-independent-samples" id="toc-ansari-bradley-test-for-scale-parameter-for-two-independent-samples"><span class="toc-section-number">7.1.4</span> Ansari-Bradley Test for Scale Parameter for Two Independent Samples</a></li>
<li><a href="non-parametric-test.html#kolmogorov-smirnov-test-for-equality-of-distributions" id="toc-kolmogorov-smirnov-test-for-equality-of-distributions"><span class="toc-section-number">7.1.5</span> Kolmogorov-Smirnov Test for Equality of Distributions</a></li>
</ul></li>
<li><a href="non-parametric-test.html#several-samples-hypotheses-testing" id="toc-several-samples-hypotheses-testing"><span class="toc-section-number">7.2</span> Several Samples Hypotheses Testing</a>
<ul>
<li><a href="non-parametric-test.html#friedman-rank-test-for-location-parameter-for-several-dependent-samples" id="toc-friedman-rank-test-for-location-parameter-for-several-dependent-samples"><span class="toc-section-number">7.2.1</span> Friedman Rank Test for Location Parameter for Several Dependent Samples</a></li>
<li><a href="non-parametric-test.html#kruskal-wallis-h-test-for-location-parameter" id="toc-kruskal-wallis-h-test-for-location-parameter"><span class="toc-section-number">7.2.2</span> Kruskal-Wallis H-Test for Location Parameter</a></li>
</ul></li>
<li><a href="non-parametric-test.html#tests-for-categorical-data" id="toc-tests-for-categorical-data"><span class="toc-section-number">7.3</span> Tests for Categorical Data</a>
<ul>
<li><a href="non-parametric-test.html#spearman-rank-correlation-coefficient-test" id="toc-spearman-rank-correlation-coefficient-test"><span class="toc-section-number">7.3.1</span> Spearman Rank Correlation Coefficient Test</a></li>
<li><a href="non-parametric-test.html#fisher-exact-test" id="toc-fisher-exact-test"><span class="toc-section-number">7.3.2</span> Fisher Exact Test</a></li>
</ul></li>
<li><a href="non-parametric-test.html#permutation-test" id="toc-permutation-test"><span class="toc-section-number">7.4</span> Permutation test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">7.4.1</span> Introduction</a></li>
<li><a href="non-parametric-test.html#package-coin" id="toc-package-coin"><span class="toc-section-number">7.4.2</span> Package: coin</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-independence-for-ordinal-data" id="toc-one-way-permutation-test-of-independence-for-ordinal-data"><span class="toc-section-number">7.4.3</span> One-way Permutation Test of Independence for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#one-way-permutation-test-of-symmetry-for-ordinal-data" id="toc-one-way-permutation-test-of-symmetry-for-ordinal-data"><span class="toc-section-number">7.4.4</span> One-way Permutation Test of Symmetry for Ordinal Data</a></li>
<li><a href="non-parametric-test.html#permutation-tests-for-medians-and-percentiles" id="toc-permutation-tests-for-medians-and-percentiles"><span class="toc-section-number">7.4.5</span> Permutation Tests for Medians and Percentiles</a></li>
</ul></li>
</ul></li>
<li><a href="sample-size-calculation.html#sample-size-calculation" id="toc-sample-size-calculation"><span class="toc-section-number">8</span> Sample Size Calculation</a>
<ul>
<li><a href="sample-size-calculation.html#distribution" id="toc-distribution"><span class="toc-section-number">8.1</span> Distribution</a>
<ul>
<li><a href="sample-size-calculation.html#quantile-function-in-sas" id="toc-quantile-function-in-sas"><span class="toc-section-number">8.1.1</span> Quantile Function in SAS</a></li>
<li><a href="sample-size-calculation.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">8.1.2</span> Binomial distribution</a></li>
<li><a href="sample-size-calculation.html#negative-binomial-distribution" id="toc-negative-binomial-distribution"><span class="toc-section-number">8.1.3</span> Negative binomial distribution</a></li>
<li><a href="sample-size-calculation.html#multinomial-distribution" id="toc-multinomial-distribution"><span class="toc-section-number">8.1.4</span> Multinomial distribution</a></li>
<li><a href="sample-size-calculation.html#normal-distribution" id="toc-normal-distribution"><span class="toc-section-number">8.1.5</span> Normal Distribution</a></li>
<li><a href="sample-size-calculation.html#multivariate-normal-distribution" id="toc-multivariate-normal-distribution"><span class="toc-section-number">8.1.6</span> Multivariate normal distribution</a></li>
<li><a href="sample-size-calculation.html#poisson-distribution" id="toc-poisson-distribution"><span class="toc-section-number">8.1.7</span> Poisson distribution</a></li>
<li><a href="sample-size-calculation.html#exponential-distribution" id="toc-exponential-distribution"><span class="toc-section-number">8.1.8</span> Exponential distribution</a></li>
<li><a href="sample-size-calculation.html#gamma-distribution" id="toc-gamma-distribution"><span class="toc-section-number">8.1.9</span> Gamma distribution</a></li>
<li><a href="sample-size-calculation.html#weibull-distribution" id="toc-weibull-distribution"><span class="toc-section-number">8.1.10</span> Weibull Distribution</a></li>
<li><a href="sample-size-calculation.html#chi-squared-distribution" id="toc-chi-squared-distribution"><span class="toc-section-number">8.1.11</span> Chi-Squared Distribution</a></li>
<li><a href="sample-size-calculation.html#beta-distribution" id="toc-beta-distribution"><span class="toc-section-number">8.1.12</span> Beta Distribution</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#binomial-ci" id="toc-binomial-ci"><span class="toc-section-number">8.2</span> Binomial CI</a>
<ul>
<li><a href="sample-size-calculation.html#point-estimates" id="toc-point-estimates"><span class="toc-section-number">8.2.1</span> Point Estimates</a></li>
<li><a href="sample-size-calculation.html#binomial-ci-for-small-samples" id="toc-binomial-ci-for-small-samples"><span class="toc-section-number">8.2.2</span> Binomial CI for Small Samples</a></li>
<li><a href="sample-size-calculation.html#r-packages" id="toc-r-packages"><span class="toc-section-number">8.2.3</span> R Packages</a></li>
<li><a href="sample-size-calculation.html#incidence-rate-ci" id="toc-incidence-rate-ci"><span class="toc-section-number">8.2.4</span> Incidence rate CI</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-1-sample-proportion" id="toc-test-1-sample-proportion"><span class="toc-section-number">8.3</span> Test 1-Sample Proportion</a></li>
<li><a href="sample-size-calculation.html#test-2-sample-proportions" id="toc-test-2-sample-proportions"><span class="toc-section-number">8.4</span> Test 2-Sample Proportions</a>
<ul>
<li><a href="sample-size-calculation.html#technical-details" id="toc-technical-details"><span class="toc-section-number">8.4.1</span> Technical details</a></li>
<li><a href="parametric-test.html#fishers-exact-test" id="toc-fishers-exact-test"><span class="toc-section-number">8.4.2</span> Fisher’s Exact Test</a></li>
<li><a href="sample-size-calculation.html#z-test-or-chi-square-test-pooled-and-unpooled" id="toc-z-test-or-chi-square-test-pooled-and-unpooled"><span class="toc-section-number">8.4.3</span> Z Test (or Chi-Square Test) (Pooled and Unpooled)</a></li>
<li><a href="sample-size-calculation.html#conditional-mantel-haenszel-test" id="toc-conditional-mantel-haenszel-test"><span class="toc-section-number">8.4.4</span> Conditional Mantel-Haenszel Test</a></li>
<li><a href="sample-size-calculation.html#paired-proportions-mcnemars-z-test" id="toc-paired-proportions-mcnemars-z-test"><span class="toc-section-number">8.4.5</span> Paired Proportions: McNemar’s Z-test</a></li>
<li><a href="sample-size-calculation.html#chi-square-test" id="toc-chi-square-test"><span class="toc-section-number">8.4.6</span> Chi-square test</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#test-means" id="toc-test-means"><span class="toc-section-number">8.5</span> Test Mean(s)</a>
<ul>
<li><a href="sample-size-calculation.html#one-sample-mean-2-sided-equality" id="toc-one-sample-mean-2-sided-equality"><span class="toc-section-number">8.5.1</span> One Sample Mean 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-mean-non-inferiority-or-superiority" id="toc-sample-mean-non-inferiority-or-superiority"><span class="toc-section-number">8.5.2</span> 1-Sample Mean Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-mean-equivalence" id="toc-sample-mean-equivalence"><span class="toc-section-number">8.5.3</span> 1-Sample Mean Equivalence</a></li>
<li><a href="sample-size-calculation.html#sample-means-2-sided-equality" id="toc-sample-means-2-sided-equality"><span class="toc-section-number">8.5.4</span> 2-Sample Means, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#sample-means-1-sided" id="toc-sample-means-1-sided"><span class="toc-section-number">8.5.5</span> 2-Sample Means, 1-Sided</a></li>
<li><a href="sample-size-calculation.html#sample-means-non-inferiority-or-superiority" id="toc-sample-means-non-inferiority-or-superiority"><span class="toc-section-number">8.5.6</span> 2-Sample Means Non-Inferiority or Superiority</a></li>
<li><a href="sample-size-calculation.html#sample-means-equivalence" id="toc-sample-means-equivalence"><span class="toc-section-number">8.5.7</span> 2-Sample Means Equivalence</a></li>
<li><a href="sample-size-calculation.html#t-test-using-pwr.t.test-or-pwr.t2n.test" id="toc-t-test-using-pwr.t.test-or-pwr.t2n.test"><span class="toc-section-number">8.5.8</span> T-Test using <code>pwr.t.test</code> or <code>pwr.t2n.test</code></a></li>
<li><a href="sample-size-calculation.html#test-k-means" id="toc-test-k-means"><span class="toc-section-number">8.5.9</span> Test k Means</a></li>
<li><a href="sample-size-calculation.html#anova-using-pwr.anova.test" id="toc-anova-using-pwr.anova.test"><span class="toc-section-number">8.5.10</span> Anova using <code>pwr.anova.test</code></a></li>
<li><a href="sample-size-calculation.html#average-bioequivalence" id="toc-average-bioequivalence"><span class="toc-section-number">8.5.11</span> Average Bioequivalence</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#other-methods" id="toc-other-methods"><span class="toc-section-number">8.6</span> Other Methods</a>
<ul>
<li><a href="sample-size-calculation.html#odds-ratio" id="toc-odds-ratio"><span class="toc-section-number">8.6.1</span> Odds Ratio</a></li>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">8.6.2</span> Correlation</a></li>
<li><a href="sample-size-calculation.html#correlated-binary-data-ophthalmologic-studies" id="toc-correlated-binary-data-ophthalmologic-studies"><span class="toc-section-number">8.6.3</span> Correlated Binary Data: Ophthalmologic Studies</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#multiple-test" id="toc-multiple-test"><span class="toc-section-number">8.7</span> Multiple test</a>
<ul>
<li><a href="sample-size-calculation.html#definitions-of-power" id="toc-definitions-of-power"><span class="toc-section-number">8.7.1</span> Definitions of Power</a></li>
<li><a href="sample-size-calculation.html#bonferroni-tests-individual-power" id="toc-bonferroni-tests-individual-power"><span class="toc-section-number">8.7.2</span> Bonferroni Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#tukeys-method-individual-power" id="toc-tukeys-method-individual-power"><span class="toc-section-number">8.7.3</span> Tukey’s method (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#dunnetts-two-sided-tests-individual-power" id="toc-dunnetts-two-sided-tests-individual-power"><span class="toc-section-number">8.7.4</span> Dunnett’s Two-Sided Tests (Individual Power)</a></li>
<li><a href="sample-size-calculation.html#combined-power-simpower-and-plotsimpower" id="toc-combined-power-simpower-and-plotsimpower"><span class="toc-section-number">8.7.5</span> Combined Power %SimPower and %PlotSimPower</a></li>
<li><a href="sample-size-calculation.html#dunnett-set-up-close-tests-in-r" id="toc-dunnett-set-up-close-tests-in-r"><span class="toc-section-number">8.7.6</span> Dunnett Set up Close Tests in R</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#time-to-event-data" id="toc-time-to-event-data"><span class="toc-section-number">8.8</span> Time-To-Event Data</a>
<ul>
<li><a href="sample-size-calculation.html#cox-ph-2-sided-equality" id="toc-cox-ph-2-sided-equality"><span class="toc-section-number">8.8.1</span> Cox PH, 2-Sided Equality</a></li>
<li><a href="sample-size-calculation.html#log-rank-tests-for-competing-risks" id="toc-log-rank-tests-for-competing-risks"><span class="toc-section-number">8.8.2</span> Log-Rank Tests for Competing Risks</a></li>
</ul></li>
<li><a href="sample-size-calculation.html#estimation-in-diagnostic-test" id="toc-estimation-in-diagnostic-test"><span class="toc-section-number">8.9</span> Estimation in diagnostic test</a>
<ul>
<li><a href="sample-size-calculation.html#adequate-sensitivityspecificity" id="toc-adequate-sensitivityspecificity"><span class="toc-section-number">8.9.1</span> Adequate sensitivity/specificity</a></li>
<li><a href="sample-size-calculation.html#testing-sensitivity-or-specificity" id="toc-testing-sensitivity-or-specificity"><span class="toc-section-number">8.9.2</span> Testing sensitivity (or specificity)</a></li>
<li><a href="sample-size-calculation.html#likelihood-ratio-estimation" id="toc-likelihood-ratio-estimation"><span class="toc-section-number">8.9.3</span> Likelihood ratio estimation</a></li>
<li><a href="sample-size-calculation.html#roc-index-of-accuracy" id="toc-roc-index-of-accuracy"><span class="toc-section-number">8.9.4</span> ROC index of accuracy</a></li>
</ul></li>
</ul></li>
<li><a href="anova.html#anova" id="toc-anova"><span class="toc-section-number">9</span> ANOVA</a>
<ul>
<li><a href="anova.html#unstructured-models" id="toc-unstructured-models"><span class="toc-section-number">9.1</span> Unstructured Models</a></li>
<li><a href="anova.html#balanced-one-way-analysis-of-variance-anova" id="toc-balanced-one-way-analysis-of-variance-anova"><span class="toc-section-number">9.2</span> Balanced One-Way Analysis-of-Variance (ANOVA)</a>
<ul>
<li><a href="anova.html#modeling-assumptions-and-basic-analysis" id="toc-modeling-assumptions-and-basic-analysis"><span class="toc-section-number">9.2.1</span> Modeling Assumptions and Basic Analysis</a></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">9.2.2</span> Parameter Estimates</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">9.2.3</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">9.2.4</span> SAS Implementation</a></li>
<li><a href="anova.html#model-diagnosis" id="toc-model-diagnosis"><span class="toc-section-number">9.2.5</span> Model Diagnosis</a></li>
</ul></li>
<li><a href="anova.html#unbalanced-one-way-anova-and-analysis-of-covariance-ancova" id="toc-unbalanced-one-way-anova-and-analysis-of-covariance-ancova"><span class="toc-section-number">9.3</span> Unbalanced One-Way ANOVA and Analysis-of-Covariance (ANCOVA)</a></li>
<li><a href="anova.html#two-ways-anova-test" id="toc-two-ways-anova-test"><span class="toc-section-number">9.4</span> Two-Ways ANOVA Test</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">9.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">9.4.2</span> R implementation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">9.4.3</span> SAS Implementation</a></li>
<li><a href="anova.html#unbalanced-design" id="toc-unbalanced-design"><span class="toc-section-number">9.4.4</span> Unbalanced design</a></li>
</ul></li>
<li><a href="anova.html#heteroscedastic-responses" id="toc-heteroscedastic-responses"><span class="toc-section-number">9.5</span> Heteroscedastic Responses</a></li>
<li><a href="anova.html#repeated-measures-anova-data" id="toc-repeated-measures-anova-data"><span class="toc-section-number">9.6</span> Repeated Measures ANOVA Data</a></li>
<li><a href="anova.html#multivariate-responses-with-normally-distributed-data" id="toc-multivariate-responses-with-normally-distributed-data"><span class="toc-section-number">9.7</span> Multivariate Responses with Normally Distributed Data</a></li>
<li><a href="anova.html#independent-observations-from-parametric-nonnormal-distributions" id="toc-independent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.8</span> Independent Observations from Parametric Nonnormal Distributions</a></li>
<li><a href="anova.html#dependent-observations-from-parametric-nonnormal-distributions" id="toc-dependent-observations-from-parametric-nonnormal-distributions"><span class="toc-section-number">9.9</span> Dependent Observations from Parametric Nonnormal Distributions</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparison" id="toc-multiple-comparison"><span class="toc-section-number">10</span> Multiple-Comparison</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">10.1</span> Introduction</a>
<ul>
<li><a href="multiple-comparison.html#multiplicity-problem" id="toc-multiplicity-problem"><span class="toc-section-number">10.1.1</span> Multiplicity Problem</a></li>
<li><a href="multiple-comparison.html#error-rates" id="toc-error-rates"><span class="toc-section-number">10.1.2</span> Error Rates</a></li>
<li><a href="multiple-comparison.html#the-adjusted-p" id="toc-the-adjusted-p"><span class="toc-section-number">10.1.3</span> The adjusted P</a></li>
<li><a href="multiple-comparison.html#basic-statistical-concepts" id="toc-basic-statistical-concepts"><span class="toc-section-number">10.1.4</span> Basic Statistical Concepts</a></li>
<li><a href="multiple-comparison.html#functions-in-glht-package-in-r" id="toc-functions-in-glht-package-in-r"><span class="toc-section-number">10.1.5</span> Functions in glht package in R</a></li>
</ul></li>
<li><a href="multiple-comparison.html#bonferroni-and-šidák-methods" id="toc-bonferroni-and-šidák-methods"><span class="toc-section-number">10.2</span> Bonferroni and Šidák Methods</a>
<ul>
<li><a href="multiple-comparison.html#lsd-least-significance-difference" id="toc-lsd-least-significance-difference"><span class="toc-section-number">10.2.1</span> LSD (least significance difference)</a></li>
<li><a href="multiple-comparison.html#šidák" id="toc-šidák"><span class="toc-section-number">10.2.2</span> Šidák</a></li>
<li><a href="multiple-comparison.html#bonferroni" id="toc-bonferroni"><span class="toc-section-number">10.2.3</span> Bonferroni</a></li>
<li><a href="multiple-comparison.html#schweder-spjøtvoll-p-value-plot" id="toc-schweder-spjøtvoll-p-value-plot"><span class="toc-section-number">10.2.4</span> Schweder-Spjøtvoll p-Value Plot</a></li>
</ul></li>
<li><a href="multiple-comparison.html#mcp-among-treatment-means-in-the-one-way-balanced-anova" id="toc-mcp-among-treatment-means-in-the-one-way-balanced-anova"><span class="toc-section-number">10.3</span> MCP among Treatment Means in the One-Way Balanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#ls-means" id="toc-ls-means"><span class="toc-section-number">10.3.1</span> LS-Means</a></li>
<li><a href="multiple-comparison.html#the-multivariate-t-distribution" id="toc-the-multivariate-t-distribution"><span class="toc-section-number">10.3.2</span> The Multivariate t Distribution</a></li>
<li><a href="multiple-comparison.html#calculating-the-critical-value-c_alpha" id="toc-calculating-the-critical-value-c_alpha"><span class="toc-section-number">10.3.3</span> Calculating the Critical Value <span class="math inline">\(c_{\alpha}\)</span></a></li>
<li><a href="multiple-comparison.html#all-pairwise-comparisons-and-studentized-range-distribution" id="toc-all-pairwise-comparisons-and-studentized-range-distribution"><span class="toc-section-number">10.3.4</span> All Pairwise Comparisons and Studentized Range Distribution</a></li>
<li><a href="multiple-comparison.html#tukeys-method-for-all-pairwise-comparisons" id="toc-tukeys-method-for-all-pairwise-comparisons"><span class="toc-section-number">10.3.5</span> Tukey’s Method for All Pairwise Comparisons</a></li>
<li><a href="multiple-comparison.html#displaying-pairwise-comparisons-graphically" id="toc-displaying-pairwise-comparisons-graphically"><span class="toc-section-number">10.3.6</span> Displaying Pairwise Comparisons Graphically</a></li>
<li><a href="multiple-comparison.html#dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution" id="toc-dunnetts-two-sided-comparisons-with-a-control-and-dunnetts-two-sided-range-distribution"><span class="toc-section-number">10.3.7</span> Dunnett’s Two-Sided Comparisons with a Control and Dunnett’s Two-Sided Range Distribution</a></li>
<li><a href="multiple-comparison.html#dunnetts-one-sided-comparisons-with-a-control" id="toc-dunnetts-one-sided-comparisons-with-a-control"><span class="toc-section-number">10.3.8</span> Dunnett’s One-Sided Comparisons with a Control</a></li>
<li><a href="multiple-comparison.html#maximum-modulus-distribution-multiple-inferences-for-independent-estimates" id="toc-maximum-modulus-distribution-multiple-inferences-for-independent-estimates"><span class="toc-section-number">10.3.9</span> Maximum Modulus Distribution, Multiple Inferences for Independent Estimates</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova" id="toc-multiple-comparisons-among-treatment-means-in-the-one-way-unbalanced-anova"><span class="toc-section-number">10.4</span> Multiple Comparisons among Treatment Means in the One-Way Unbalanced ANOVA</a>
<ul>
<li><a href="multiple-comparison.html#the-model-and-estimates" id="toc-the-model-and-estimates"><span class="toc-section-number">10.4.1</span> The Model and Estimates</a></li>
<li><a href="multiple-comparison.html#tukey-kramer-method" id="toc-tukey-kramer-method"><span class="toc-section-number">10.4.2</span> Tukey-Kramer Method</a></li>
<li><a href="multiple-comparison.html#alternative-simulation-based-method" id="toc-alternative-simulation-based-method"><span class="toc-section-number">10.4.3</span> Alternative Simulation-Based Method</a></li>
<li><a href="multiple-comparison.html#pairwise-comparisons-with-control" id="toc-pairwise-comparisons-with-control"><span class="toc-section-number">10.4.4</span> Pairwise Comparisons with Control</a></li>
<li><a href="multiple-comparison.html#comparisons-with-the-average-meananalysis-of-means-anom" id="toc-comparisons-with-the-average-meananalysis-of-means-anom"><span class="toc-section-number">10.4.5</span> Comparisons with the Average Mean–Analysis of Means (ANOM)</a></li>
</ul></li>
<li><a href="multiple-comparison.html#generalizations-for-the-analysis-of-covariance-ancova-model" id="toc-generalizations-for-the-analysis-of-covariance-ancova-model"><span class="toc-section-number">10.5</span> Generalizations for the Analysis of Covariance (ANCOVA) model</a>
<ul>
<li><a href="multiple-comparison.html#dunnett-hsu-factor-analytic-approximation" id="toc-dunnett-hsu-factor-analytic-approximation"><span class="toc-section-number">10.5.1</span> Dunnett-Hsu Factor Analytic Approximation</a></li>
<li><a href="multiple-comparison.html#hsu-nelson-simulation-based-approximation-cvadjust-method" id="toc-hsu-nelson-simulation-based-approximation-cvadjust-method"><span class="toc-section-number">10.5.2</span> Hsu-Nelson Simulation-Based Approximation: CVADJUST Method</a></li>
<li><a href="multiple-comparison.html#comparisons-in-ancova-models-with-interaction" id="toc-comparisons-in-ancova-models-with-interaction"><span class="toc-section-number">10.5.3</span> Comparisons in ANCOVA Models with Interaction</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-inferences-for-infinite-sets-of-parameters" id="toc-multiple-inferences-for-infinite-sets-of-parameters"><span class="toc-section-number">10.6</span> Multiple Inferences for Infinite Sets of Parameters</a>
<ul>
<li><a href="multiple-comparison.html#scheffés-method" id="toc-scheffés-method"><span class="toc-section-number">10.6.1</span> Scheffés Method</a></li>
<li><a href="multiple-comparison.html#finding-the-maximal-contrast" id="toc-finding-the-maximal-contrast"><span class="toc-section-number">10.6.2</span> Finding the Maximal Contrast</a></li>
<li><a href="multiple-comparison.html#working-hotelling-method" id="toc-working-hotelling-method"><span class="toc-section-number">10.6.3</span> Working-Hotelling method</a></li>
<li><a href="multiple-comparison.html#discrete-approximation-method" id="toc-discrete-approximation-method"><span class="toc-section-number">10.6.4</span> Discrete approximation method</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-under-heteroscedasticity" id="toc-multiple-comparisons-under-heteroscedasticity"><span class="toc-section-number">10.7</span> Multiple Comparisons under Heteroscedasticity</a>
<ul>
<li><a href="multiple-comparison.html#introduction-of-heteroscedasticity" id="toc-introduction-of-heteroscedasticity"><span class="toc-section-number">10.7.1</span> Introduction of heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#satterthwaite-approximation" id="toc-satterthwaite-approximation"><span class="toc-section-number">10.7.2</span> Satterthwaite Approximation</a></li>
<li><a href="multiple-comparison.html#maxt-method-under-heteroscedasticity" id="toc-maxt-method-under-heteroscedasticity"><span class="toc-section-number">10.7.3</span> MaxT Method under Heteroscedasticity</a></li>
<li><a href="multiple-comparison.html#minp-method-under-heteroscedasticity" id="toc-minp-method-under-heteroscedasticity"><span class="toc-section-number">10.7.4</span> MinP Method under Heteroscedasticity</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-and-stepwise-testing-methods" id="toc-closed-and-stepwise-testing-methods"><span class="toc-section-number">10.8</span> Closed and Stepwise Testing Methods</a>
<ul>
<li><a href="multiple-comparison.html#closed-family-of-hypotheses" id="toc-closed-family-of-hypotheses"><span class="toc-section-number">10.8.1</span> Closed Family of Hypotheses</a></li>
<li><a href="multiple-comparison.html#bonferroni-holm-method" id="toc-bonferroni-holm-method"><span class="toc-section-number">10.8.2</span> Bonferroni-Holm Method</a></li>
<li><a href="multiple-comparison.html#šidák-holm-method" id="toc-šidák-holm-method"><span class="toc-section-number">10.8.3</span> Šidák-Holm Method</a></li>
<li><a href="multiple-comparison.html#closed-fisher-combination-method" id="toc-closed-fisher-combination-method"><span class="toc-section-number">10.8.4</span> Closed Fisher Combination Method</a></li>
<li><a href="multiple-comparison.html#simes-hommel-method" id="toc-simes-hommel-method"><span class="toc-section-number">10.8.5</span> Simes-Hommel Method</a></li>
<li><a href="multiple-comparison.html#hochbergs-ok-step-up" id="toc-hochbergs-ok-step-up"><span class="toc-section-number">10.8.6</span> Hochberg’s O(k) Step-Up</a></li>
<li><a href="multiple-comparison.html#sequential-testing-with-fixed-sequences" id="toc-sequential-testing-with-fixed-sequences"><span class="toc-section-number">10.8.7</span> Sequential Testing with Fixed Sequences</a></li>
<li><a href="multiple-comparison.html#sequential-testing-using-gatekeeping-methods" id="toc-sequential-testing-using-gatekeeping-methods"><span class="toc-section-number">10.8.8</span> Sequential Testing Using Gatekeeping Methods</a></li>
</ul></li>
<li><a href="multiple-comparison.html#closed-testing-of-pairwise-comparisons-and-general-contrasts" id="toc-closed-testing-of-pairwise-comparisons-and-general-contrasts"><span class="toc-section-number">10.9</span> Closed Testing of Pairwise Comparisons and General Contrasts</a>
<ul>
<li><a href="multiple-comparison.html#incorporating-logical-constraints" id="toc-incorporating-logical-constraints"><span class="toc-section-number">10.9.1</span> Incorporating Logical Constraints</a></li>
<li><a href="multiple-comparison.html#shaffers-method" id="toc-shaffers-method"><span class="toc-section-number">10.9.2</span> Shaffer’s Method</a></li>
<li><a href="multiple-comparison.html#extended-shaffer-royen-method" id="toc-extended-shaffer-royen-method"><span class="toc-section-number">10.9.3</span> Extended Shaffer-Royen Method</a></li>
<li><a href="multiple-comparison.html#step-down-dunnett-test" id="toc-step-down-dunnett-test"><span class="toc-section-number">10.9.4</span> Step-down Dunnett test</a></li>
</ul></li>
<li><a href="multiple-comparison.html#multiple-comparisons-with-binary-data" id="toc-multiple-comparisons-with-binary-data"><span class="toc-section-number">10.10</span> Multiple Comparisons with Binary Data</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">10.10.1</span> Introduction</a></li>
<li><a href="multiple-comparison.html#multivariate-two-sample-binary-outcomes" id="toc-multivariate-two-sample-binary-outcomes"><span class="toc-section-number">10.10.2</span> Multivariate Two-Sample Binary Outcomes</a></li>
</ul></li>
</ul></li>
<li><a href="correlation-and-regression.html#correlation-and-regression" id="toc-correlation-and-regression"><span class="toc-section-number">11</span> Correlation and Regression</a>
<ul>
<li><a href="sample-size-calculation.html#correlation" id="toc-correlation"><span class="toc-section-number">11.1</span> Correlation</a>
<ul>
<li><a href="correlation-and-regression.html#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient"><span class="toc-section-number">11.1.1</span> Pearson correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient"><span class="toc-section-number">11.1.2</span> Spearman’s rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#kendall-rank-correlation-coefficient" id="toc-kendall-rank-correlation-coefficient"><span class="toc-section-number">11.1.3</span> Kendall rank correlation coefficient</a></li>
<li><a href="correlation-and-regression.html#intraclass-correlation" id="toc-intraclass-correlation"><span class="toc-section-number">11.1.4</span> Intraclass correlation</a></li>
<li><a href="correlation-and-regression.html#visualize-the-correlation-in-r" id="toc-visualize-the-correlation-in-r"><span class="toc-section-number">11.1.5</span> Visualize the correlation in R</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols"><span class="toc-section-number">11.2</span> Ordinary least squares (OLS)</a>
<ul>
<li><a href="correlation-and-regression.html#assumpions" id="toc-assumpions"><span class="toc-section-number">11.2.1</span> Assumpions</a></li>
<li><a href="correlation-and-regression.html#interpretation" id="toc-interpretation"><span class="toc-section-number">11.2.2</span> Interpretation</a></li>
<li><a href="correlation-and-regression.html#matrix-solution" id="toc-matrix-solution"><span class="toc-section-number">11.2.3</span> Matrix Solution</a></li>
<li><a href="correlation-and-regression.html#gauss-markov-theorem" id="toc-gauss-markov-theorem"><span class="toc-section-number">11.2.4</span> Gauss-Markov Theorem</a></li>
<li><a href="correlation-and-regression.html#limitation" id="toc-limitation"><span class="toc-section-number">11.2.5</span> limitation</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-statistics" id="toc-model-statistics"><span class="toc-section-number">11.3</span> Model Statistics</a>
<ul>
<li><a href="correlation-and-regression.html#residuals-standard-error" id="toc-residuals-standard-error"><span class="toc-section-number">11.3.1</span> Residuals Standard Error</a></li>
<li><a href="correlation-and-regression.html#r-squared-and-adjusted-r-squared" id="toc-r-squared-and-adjusted-r-squared"><span class="toc-section-number">11.3.2</span> R-Squared and Adjusted R-Squared</a></li>
<li><a href="correlation-and-regression.html#t-statistic" id="toc-t-statistic"><span class="toc-section-number">11.3.3</span> T Statistic</a></li>
<li><a href="correlation-and-regression.html#f-statistic" id="toc-f-statistic"><span class="toc-section-number">11.3.4</span> F Statistic</a></li>
<li><a href="correlation-and-regression.html#confidence-intervals" id="toc-confidence-intervals"><span class="toc-section-number">11.3.5</span> Confidence Intervals</a></li>
<li><a href="correlation-and-regression.html#likelihood-ratio-test" id="toc-likelihood-ratio-test"><span class="toc-section-number">11.3.6</span> Likelihood-ratio test</a></li>
<li><a href="correlation-and-regression.html#accuracy" id="toc-accuracy"><span class="toc-section-number">11.3.7</span> Accuracy</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">11.4</span> Model Diagnostics</a>
<ul>
<li><a href="correlation-and-regression.html#checking-error-assumptions" id="toc-checking-error-assumptions"><span class="toc-section-number">11.4.1</span> Checking Error Assumptions</a></li>
<li><a href="correlation-and-regression.html#finding-unusual-observations" id="toc-finding-unusual-observations"><span class="toc-section-number">11.4.2</span> Finding Unusual Observations</a></li>
<li><a href="correlation-and-regression.html#checking-the-structure-of-the-model" id="toc-checking-the-structure-of-the-model"><span class="toc-section-number">11.4.3</span> Checking the Structure of the Model</a></li>
</ul></li>
<li><a href="correlation-and-regression.html#sas-implementation-proc-reg" id="toc-sas-implementation-proc-reg"><span class="toc-section-number">11.5</span> SAS implementation Proc Reg</a>
<ul>
<li><a href="correlation-and-regression.html#options" id="toc-options"><span class="toc-section-number">11.5.1</span> Options</a></li>
<li><a href="correlation-and-regression.html#diagnose" id="toc-diagnose"><span class="toc-section-number">11.5.2</span> Diagnose</a></li>
</ul></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">11.6</span> R implementation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#advanced-linear-regression" id="toc-advanced-linear-regression"><span class="toc-section-number">12</span> Advanced Linear Regression</a>
<ul>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.1</span> Model Selection</a>
<ul>
<li><a href="advanced-linear-regression.html#selection-methods" id="toc-selection-methods"><span class="toc-section-number">12.1.1</span> Selection Methods</a></li>
<li><a href="advanced-linear-regression.html#selection-criteria" id="toc-selection-criteria"><span class="toc-section-number">12.1.2</span> Selection Criteria</a></li>
<li><a href="advanced-linear-regression.html#k--fold-cross-validation" id="toc-k--fold-cross-validation"><span class="toc-section-number">12.1.3</span> k- Fold Cross validation</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#practical-difficulties-using-ols" id="toc-practical-difficulties-using-ols"><span class="toc-section-number">12.2</span> Practical Difficulties using OLS</a></li>
<li><a href="advanced-linear-regression.html#skewness" id="toc-skewness"><span class="toc-section-number">12.3</span> Skewness</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">12.3.1</span> Introduction</a></li>
<li><a href="advanced-linear-regression.html#baisc-transformation" id="toc-baisc-transformation"><span class="toc-section-number">12.3.2</span> Baisc Transformation</a></li>
<li><a href="advanced-linear-regression.html#box-cox-power-transformation" id="toc-box-cox-power-transformation"><span class="toc-section-number">12.3.3</span> Box-Cox Power Transformation</a></li>
</ul></li>
<li><a href="ggplot2.html#scale" id="toc-scale"><span class="toc-section-number">12.4</span> Scale</a></li>
<li><a href="advanced-linear-regression.html#interaction" id="toc-interaction"><span class="toc-section-number">12.5</span> Interaction</a>
<ul>
<li><a href="advanced-linear-regression.html#simple-slopes-analysis" id="toc-simple-slopes-analysis"><span class="toc-section-number">12.5.1</span> Simple slopes analysis</a></li>
<li><a href="advanced-linear-regression.html#plotting-interactions" id="toc-plotting-interactions"><span class="toc-section-number">12.5.2</span> Plotting Interactions</a></li>
<li><a href="advanced-linear-regression.html#check-linearity-assumption" id="toc-check-linearity-assumption"><span class="toc-section-number">12.5.3</span> Check linearity assumption</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#collinearity" id="toc-collinearity"><span class="toc-section-number">12.6</span> Collinearity</a></li>
<li><a href="advanced-linear-regression.html#problems-with-the-error" id="toc-problems-with-the-error"><span class="toc-section-number">12.7</span> Problems with the Error</a>
<ul>
<li><a href="advanced-linear-regression.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">12.7.1</span> Generalized Least Squares</a></li>
<li><a href="advanced-linear-regression.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">12.7.2</span> Weighted Least Squares</a></li>
<li><a href="advanced-linear-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">12.7.3</span> Robust Regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#shrinkage-methods" id="toc-shrinkage-methods"><span class="toc-section-number">12.8</span> Shrinkage Methods</a>
<ul>
<li><a href="advanced-linear-regression.html#principal-components-analzsis" id="toc-principal-components-analzsis"><span class="toc-section-number">12.8.1</span> Principal Components Analzsis</a></li>
<li><a href="advanced-linear-regression.html#partial-least-squares" id="toc-partial-least-squares"><span class="toc-section-number">12.8.2</span> Partial Least Squares</a></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">12.8.3</span> Ridge Regression</a></li>
</ul></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">13</span> Logistic Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">13.1</span> Introduction</a>
<ul>
<li><a href="logistic-regression.html#violation-of-assumptions-of-ordinary-least-squares-ols" id="toc-violation-of-assumptions-of-ordinary-least-squares-ols"><span class="toc-section-number">13.1.1</span> Violation of assumptions of Ordinary least squares (OLS)</a></li>
<li><a href="logistic-regression.html#more-fundamental-problem-outside-01" id="toc-more-fundamental-problem-outside-01"><span class="toc-section-number">13.1.2</span> More fundamental problem outside [0,1]</a></li>
<li><a href="logistic-regression.html#logistic-regression-model" id="toc-logistic-regression-model"><span class="toc-section-number">13.1.3</span> Logistic Regression Model</a></li>
<li><a href="logistic-regression.html#estimation-of-the-logistic-model" id="toc-estimation-of-the-logistic-model"><span class="toc-section-number">13.1.4</span> Estimation of the Logistic Model</a></li>
<li><a href="logistic-regression.html#convergence-problems" id="toc-convergence-problems"><span class="toc-section-number">13.1.5</span> Convergence Problems</a></li>
<li><a href="logistic-regression.html#use-exact-methods." id="toc-use-exact-methods."><span class="toc-section-number">13.1.6</span> Use exact methods.</a></li>
<li><a href="logistic-regression.html#use-penalized-likelihood" id="toc-use-penalized-likelihood"><span class="toc-section-number">13.1.7</span> Use penalized likelihood</a></li>
</ul></li>
<li><a href="logistic-regression.html#logit-modell" id="toc-logit-modell"><span class="toc-section-number">13.2</span> Logit Modell</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">13.2.1</span> Introduction</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">13.2.2</span> R Implementation</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">13.2.3</span> SAS Implementation</a></li>
<li><a href="logistic-regression.html#multicollinearity" id="toc-multicollinearity"><span class="toc-section-number">13.2.4</span> Multicollinearity</a></li>
<li><a href="logistic-regression.html#goodness-of-fit-statistics-pearson-deviance" id="toc-goodness-of-fit-statistics-pearson-deviance"><span class="toc-section-number">13.2.5</span> Goodness-of-Fit Statistics Pearson deviance</a></li>
<li><a href="logistic-regression.html#hosmer-and-lemeshow-goodness-of-fit-test" id="toc-hosmer-and-lemeshow-goodness-of-fit-test"><span class="toc-section-number">13.2.6</span> Hosmer and Lemeshow Goodness-of-Fit Test</a></li>
<li><a href="logistic-regression.html#statistics-measuring-predictive-power-r2" id="toc-statistics-measuring-predictive-power-r2"><span class="toc-section-number">13.2.7</span> Statistics Measuring Predictive Power <span class="math inline">\(R^2\)</span></a></li>
<li><a href="logistic-regression.html#roc-curves" id="toc-roc-curves"><span class="toc-section-number">13.2.8</span> ROC Curves</a></li>
<li><a href="logistic-regression.html#predicted-values-residuals-and-influence-statistics" id="toc-predicted-values-residuals-and-influence-statistics"><span class="toc-section-number">13.2.9</span> Predicted Values, Residuals, and Influence Statistics</a></li>
<li><a href="logistic-regression.html#unobserved-heterogeneity" id="toc-unobserved-heterogeneity"><span class="toc-section-number">13.2.10</span> Unobserved Heterogeneity</a></li>
</ul></li>
<li><a href="logistic-regression.html#illustration-in-sas" id="toc-illustration-in-sas"><span class="toc-section-number">13.3</span> Illustration in SAS</a>
<ul>
<li><a href="logistic-regression.html#effects-of-predictor-variables" id="toc-effects-of-predictor-variables"><span class="toc-section-number">13.3.1</span> Effects of Predictor Variables</a></li>
<li><a href="logistic-regression.html#odds-ratio-plot" id="toc-odds-ratio-plot"><span class="toc-section-number">13.3.2</span> Odds ratio plot</a></li>
</ul></li>
<li><a href="logistic-regression.html#probit-modell" id="toc-probit-modell"><span class="toc-section-number">13.4</span> Probit Modell</a>
<ul>
<li><a href="logistic-regression.html#introduction-2" id="toc-introduction-2"><span class="toc-section-number">13.4.1</span> Introduction</a></li>
<li><a href="logistic-regression.html#r-implemetation" id="toc-r-implemetation"><span class="toc-section-number">13.4.2</span> R Implemetation</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">13.4.3</span> SAS Implementation</a></li>
</ul></li>
<li><a href="logistic-regression.html#complementary-log-log-modell" id="toc-complementary-log-log-modell"><span class="toc-section-number">13.5</span> Complementary log-log-Modell</a>
<ul>
<li><a href="logistic-regression.html#r-implemetation-1" id="toc-r-implemetation-1"><span class="toc-section-number">13.5.1</span> R Implemetation</a></li>
</ul></li>
<li><a href="logistic-regression.html#multicategory-logit-models" id="toc-multicategory-logit-models"><span class="toc-section-number">13.6</span> Multicategory Logit Models</a>
<ul>
<li><a href="logistic-regression.html#multinomialverteilung" id="toc-multinomialverteilung"><span class="toc-section-number">13.6.1</span> Multinomialverteilung</a></li>
<li><a href="logistic-regression.html#nominal-response" id="toc-nominal-response"><span class="toc-section-number">13.6.2</span> Nominal Response</a></li>
<li><a href="logistic-regression.html#ordinal-response-cumulative-logit-model" id="toc-ordinal-response-cumulative-logit-model"><span class="toc-section-number">13.6.3</span> Ordinal Response: Cumulative Logit Model</a></li>
</ul></li>
<li><a href="logistic-regression.html#adjacent-categories-model" id="toc-adjacent-categories-model"><span class="toc-section-number">13.7</span> Adjacent Categories Model</a></li>
<li><a href="logistic-regression.html#continuation-ratio-model" id="toc-continuation-ratio-model"><span class="toc-section-number">13.8</span> Continuation Ratio Model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#advanced-logistic-regression" id="toc-advanced-logistic-regression"><span class="toc-section-number">14</span> Advanced Logistic Regression</a>
<ul>
<li><a href="advanced-logistic-regression.html#logit-analysis-of-contingency-tables" id="toc-logit-analysis-of-contingency-tables"><span class="toc-section-number">14.1</span> Logit Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table" id="toc-two-way-table"><span class="toc-section-number">14.1.1</span> Two-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#three-way-table" id="toc-three-way-table"><span class="toc-section-number">14.1.2</span> Three-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#four-way-table" id="toc-four-way-table"><span class="toc-section-number">14.1.3</span> Four-Way Table</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">14.1.4</span> Overdispersion</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#loglinear-analysis-of-contingency-tables" id="toc-loglinear-analysis-of-contingency-tables"><span class="toc-section-number">14.2</span> Loglinear Analysis of Contingency Tables</a>
<ul>
<li><a href="advanced-logistic-regression.html#two-way-table-1" id="toc-two-way-table-1"><span class="toc-section-number">14.2.1</span> Two-way Table</a></li>
<li><a href="advanced-logistic-regression.html#problem-of-zeros" id="toc-problem-of-zeros"><span class="toc-section-number">14.2.2</span> Problem of Zeros</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#discrete-choice-analysis" id="toc-discrete-choice-analysis"><span class="toc-section-number">14.3</span> Discrete Choice Analysis</a>
<ul>
<li><a href="advanced-logistic-regression.html#logistic-strata" id="toc-logistic-strata"><span class="toc-section-number">14.3.1</span> Logistic Strata</a></li>
<li><a href="advanced-logistic-regression.html#conditional-logit-model" id="toc-conditional-logit-model"><span class="toc-section-number">14.3.2</span> Conditional logit model</a></li>
<li><a href="advanced-logistic-regression.html#ranked-data" id="toc-ranked-data"><span class="toc-section-number">14.3.3</span> Ranked Data</a></li>
<li><a href="advanced-logistic-regression.html#heteroscedastic-extreme-value-hev-model" id="toc-heteroscedastic-extreme-value-hev-model"><span class="toc-section-number">14.3.4</span> Heteroscedastic extreme value (HEV) Model</a></li>
<li><a href="advanced-logistic-regression.html#nested-logit-model" id="toc-nested-logit-model"><span class="toc-section-number">14.3.5</span> Nested logit model</a></li>
</ul></li>
<li><a href="advanced-logistic-regression.html#longitudinal-and-other-clustered-data" id="toc-longitudinal-and-other-clustered-data"><span class="toc-section-number">14.4</span> Longitudinal and Other Clustered Data</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">14.4.1</span> Introduction</a></li>
<li><a href="advanced-logistic-regression.html#robust-standard-errors" id="toc-robust-standard-errors"><span class="toc-section-number">14.4.2</span> Robust Standard Errors</a></li>
<li><a href="advanced-logistic-regression.html#gee-estimation-with-proc-genmod" id="toc-gee-estimation-with-proc-genmod"><span class="toc-section-number">14.4.3</span> GEE Estimation with PROC GENMOD</a></li>
<li><a href="advanced-logistic-regression.html#mixed-models-with-proc-glimmix" id="toc-mixed-models-with-proc-glimmix"><span class="toc-section-number">14.4.4</span> Mixed Models with PROC GLIMMIX</a></li>
<li><a href="advanced-logistic-regression.html#fixed-effects-with-conditional-logistic-regression" id="toc-fixed-effects-with-conditional-logistic-regression"><span class="toc-section-number">14.4.5</span> Fixed-Effects with Conditional Logistic Regression</a></li>
<li><a href="advanced-logistic-regression.html#hybrid-method" id="toc-hybrid-method"><span class="toc-section-number">14.4.6</span> Hybrid Method</a></li>
</ul></li>
</ul></li>
<li><a href="count-data-regression.html#count-data-regression" id="toc-count-data-regression"><span class="toc-section-number">15</span> Count Data Regression</a>
<ul>
<li><a href="count-data-regression.html#introduction-of-count-data-regression" id="toc-introduction-of-count-data-regression"><span class="toc-section-number">15.1</span> Introduction of Count Data Regression</a></li>
<li><a href="count-data-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">15.2</span> Poisson regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">15.2.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients" id="toc-interpretation-of-estimated-coefficients"><span class="toc-section-number">15.2.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="advanced-logistic-regression.html#overdispersion" id="toc-overdispersion"><span class="toc-section-number">15.2.3</span> Overdispersion</a></li>
<li><a href="count-data-regression.html#adjustment-for-varying-time-spans" id="toc-adjustment-for-varying-time-spans"><span class="toc-section-number">15.2.4</span> Adjustment for Varying Time Spans</a></li>
<li><a href="count-data-regression.html#sas-implementation-using-proc-genmod" id="toc-sas-implementation-using-proc-genmod"><span class="toc-section-number">15.2.5</span> SAS implementation using PROC GENMOD</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">15.2.6</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">15.3</span> Negative Binomial Regression</a>
<ul>
<li><a href="count-data-regression.html#model-1" id="toc-model-1"><span class="toc-section-number">15.3.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">15.3.2</span> SAS implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">15.3.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-truncated-poisson-regression-model" id="toc-zero-truncated-poisson-regression-model"><span class="toc-section-number">15.4</span> Zero-truncated Poisson Regression Model</a>
<ul>
<li><a href="count-data-regression.html#model-2" id="toc-model-2"><span class="toc-section-number">15.4.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">15.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">15.4.3</span> R implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#zero-insflated-model" id="toc-zero-insflated-model"><span class="toc-section-number">15.5</span> Zero-Insflated Model</a>
<ul>
<li><a href="count-data-regression.html#model-3" id="toc-model-3"><span class="toc-section-number">15.5.1</span> Model</a></li>
<li><a href="count-data-regression.html#interpretation-of-estimated-coefficients-1" id="toc-interpretation-of-estimated-coefficients-1"><span class="toc-section-number">15.5.2</span> Interpretation of Estimated Coefficients</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">15.5.3</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">15.5.4</span> R Implementation</a></li>
</ul></li>
<li><a href="count-data-regression.html#hurdle-models" id="toc-hurdle-models"><span class="toc-section-number">15.6</span> Hurdle models</a>
<ul>
<li><a href="count-data-regression.html#model-4" id="toc-model-4"><span class="toc-section-number">15.6.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">15.6.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-4" id="toc-r-implementation-4"><span class="toc-section-number">15.6.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="proportion-response-regression.html#proportion-response-regression" id="toc-proportion-response-regression"><span class="toc-section-number">16</span> Proportion Response Regression</a>
<ul>
<li><a href="proportion-response-regression.html#beta-regression" id="toc-beta-regression"><span class="toc-section-number">16.1</span> Beta Regression</a>
<ul>
<li><a href="count-data-regression.html#model" id="toc-model"><span class="toc-section-number">16.1.1</span> Model</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">16.1.2</span> SAS Implementation</a></li>
<li><a href="proportion-response-regression.html#r-implementation-betareg" id="toc-r-implementation-betareg"><span class="toc-section-number">16.1.3</span> R Implementation “betareg”</a></li>
</ul></li>
<li><a href="proportion-response-regression.html#zero-inflated-beta-regression" id="toc-zero-inflated-beta-regression"><span class="toc-section-number">16.2</span> Zero-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#one-inflated-beta-regression" id="toc-one-inflated-beta-regression"><span class="toc-section-number">16.3</span> One-inflated Beta Regression</a></li>
<li><a href="proportion-response-regression.html#zero-one-inflated-beta-regression" id="toc-zero-one-inflated-beta-regression"><span class="toc-section-number">16.4</span> Zero-one-inflated Beta Regression</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis" id="toc-survival-analysis"><span class="toc-section-number">17</span> Survival Analysis</a>
<ul>
<li><a href="survival-analysis.html#preliminary" id="toc-preliminary"><span class="toc-section-number">17.1</span> Preliminary</a>
<ul>
<li><a href="survival-analysis.html#probability-density-function" id="toc-probability-density-function"><span class="toc-section-number">17.1.1</span> Probability density function</a></li>
<li><a href="survival-analysis.html#cumulative-distribution-function" id="toc-cumulative-distribution-function"><span class="toc-section-number">17.1.2</span> Cumulative distribution function</a></li>
<li><a href="survival-analysis.html#survival-function" id="toc-survival-function"><span class="toc-section-number">17.1.3</span> Survival function</a></li>
<li><a href="survival-analysis.html#hazard-function" id="toc-hazard-function"><span class="toc-section-number">17.1.4</span> Hazard function</a></li>
<li><a href="survival-analysis.html#cumulative-hazard-function" id="toc-cumulative-hazard-function"><span class="toc-section-number">17.1.5</span> Cumulative hazard function</a></li>
<li><a href="survival-analysis.html#mean-residual-life" id="toc-mean-residual-life"><span class="toc-section-number">17.1.6</span> Mean Residual Life</a></li>
<li><a href="survival-analysis.html#relation-between-functions" id="toc-relation-between-functions"><span class="toc-section-number">17.1.7</span> Relation between functions</a></li>
</ul></li>
<li><a href="survival-analysis.html#kaplan-meier-estimator" id="toc-kaplan-meier-estimator"><span class="toc-section-number">17.2</span> Kaplan-Meier estimator</a>
<ul>
<li><a href="survival-analysis.html#km-introduction" id="toc-km-introduction"><span class="toc-section-number">17.2.1</span> KM Introduction</a></li>
<li><a href="survival-analysis.html#nelson-aalen-estimator-of-the-cumulative-hazard-function" id="toc-nelson-aalen-estimator-of-the-cumulative-hazard-function"><span class="toc-section-number">17.2.2</span> Nelson-Aalen estimator of the cumulative hazard function</a></li>
<li><a href="survival-analysis.html#survival-curve-in-sas" id="toc-survival-curve-in-sas"><span class="toc-section-number">17.2.3</span> Survival curve in SAS</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-sas" id="toc-km-survival-plots-in-sas"><span class="toc-section-number">17.2.4</span> KM Survival Plots in SAS</a></li>
<li><a href="survival-analysis.html#convert-personal-level-to-personal-period-in-r" id="toc-convert-personal-level-to-personal-period-in-r"><span class="toc-section-number">17.2.5</span> Convert Personal-level to Personal-period in R</a></li>
<li><a href="survival-analysis.html#package-survfit-in-r" id="toc-package-survfit-in-r"><span class="toc-section-number">17.2.6</span> Package survfit in R</a></li>
<li><a href="survival-analysis.html#km-survival-plots-in-r" id="toc-km-survival-plots-in-r"><span class="toc-section-number">17.2.7</span> KM Survival Plots in R</a></li>
</ul></li>
<li><a href="survival-analysis.html#compare-the-survival-function" id="toc-compare-the-survival-function"><span class="toc-section-number">17.3</span> Compare the survival function</a>
<ul>
<li><a href="survival-analysis.html#tests-of-equality-of-the-survival-function" id="toc-tests-of-equality-of-the-survival-function"><span class="toc-section-number">17.3.1</span> Tests of equality of the survival function</a></li>
<li><a href="survival-analysis.html#other-nonparametric-tests-for-strata-statement" id="toc-other-nonparametric-tests-for-strata-statement"><span class="toc-section-number">17.3.2</span> Other nonparametric tests for STRATA statement</a></li>
<li><a href="survival-analysis.html#multiple-comparisons" id="toc-multiple-comparisons"><span class="toc-section-number">17.3.3</span> Multiple comparisons</a></li>
<li><a href="survival-analysis.html#comparing-survival-functions-using-log-rank-hr" id="toc-comparing-survival-functions-using-log-rank-hr"><span class="toc-section-number">17.3.4</span> Comparing survival functions using Log-Rank HR</a></li>
<li><a href="survival-analysis.html#mantel-haenszel-hr" id="toc-mantel-haenszel-hr"><span class="toc-section-number">17.3.5</span> Mantel-Haenszel HR</a></li>
<li><a href="survival-analysis.html#analysis-of-covariance-adjustment" id="toc-analysis-of-covariance-adjustment"><span class="toc-section-number">17.3.6</span> Analysis-of-covariance (Adjustment)</a></li>
</ul></li>
<li><a href="survival-analysis.html#accelerated-failure-time-aft-model" id="toc-accelerated-failure-time-aft-model"><span class="toc-section-number">17.4</span> Accelerated failure time (AFT) model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">17.4.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#proc-lifereg" id="toc-proc-lifereg"><span class="toc-section-number">17.4.2</span> PROC LIFEREG</a></li>
<li><a href="survival-analysis.html#residuum-distribution" id="toc-residuum-distribution"><span class="toc-section-number">17.4.3</span> Residuum distribution</a></li>
<li><a href="survival-analysis.html#exponential-model" id="toc-exponential-model"><span class="toc-section-number">17.4.4</span> Exponential Model</a></li>
<li><a href="survival-analysis.html#weibull-model" id="toc-weibull-model"><span class="toc-section-number">17.4.5</span> Weibull Model</a></li>
<li><a href="survival-analysis.html#log-normal-model" id="toc-log-normal-model"><span class="toc-section-number">17.4.6</span> Log-Normal Model</a></li>
<li><a href="survival-analysis.html#log-logistic-model" id="toc-log-logistic-model"><span class="toc-section-number">17.4.7</span> Log-Logistic Model</a></li>
<li><a href="survival-analysis.html#fit-statistics-for-model-comparsion" id="toc-fit-statistics-for-model-comparsion"><span class="toc-section-number">17.4.8</span> Fit statistics for model comparsion</a></li>
<li><a href="survival-analysis.html#graphical-method-for-distinguishing-different-distributions-in-sas" id="toc-graphical-method-for-distinguishing-different-distributions-in-sas"><span class="toc-section-number">17.4.9</span> Graphical method for distinguishing different distributions in SAS</a></li>
<li><a href="survival-analysis.html#prediction-and-hazard-function" id="toc-prediction-and-hazard-function"><span class="toc-section-number">17.4.10</span> Prediction and hazard function</a></li>
<li><a href="survival-analysis.html#left-censoring-and-interval-censoring" id="toc-left-censoring-and-interval-censoring"><span class="toc-section-number">17.4.11</span> Left Censoring and Interval Censoring</a></li>
</ul></li>
<li><a href="survival-analysis.html#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model"><span class="toc-section-number">17.5</span> Cox Proportional Hazards Model</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">17.5.1</span> Introduction</a></li>
<li><a href="survival-analysis.html#parameter-estimate" id="toc-parameter-estimate"><span class="toc-section-number">17.5.2</span> Parameter estimate</a></li>
<li><a href="survival-analysis.html#parameter-test" id="toc-parameter-test"><span class="toc-section-number">17.5.3</span> Parameter test</a></li>
<li><a href="survival-analysis.html#graphs-of-the-survival-and-baseline-hazard-function-in-sas" id="toc-graphs-of-the-survival-and-baseline-hazard-function-in-sas"><span class="toc-section-number">17.5.4</span> Graphs of the survival and baseline hazard function in SAS</a></li>
<li><a href="survival-analysis.html#check-proportional-hazards" id="toc-check-proportional-hazards"><span class="toc-section-number">17.5.5</span> Check proportional hazards</a></li>
<li><a href="survival-analysis.html#dealing-with-nonproportionality" id="toc-dealing-with-nonproportionality"><span class="toc-section-number">17.5.6</span> Dealing with nonproportionality</a></li>
<li><a href="correlation-and-regression.html#model-diagnostics" id="toc-model-diagnostics"><span class="toc-section-number">17.5.7</span> Model Diagnostics</a></li>
</ul></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#advanced-survival-analysis" id="toc-advanced-survival-analysis"><span class="toc-section-number">18</span> Advanced Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#tied-or-discrete-data" id="toc-tied-or-discrete-data"><span class="toc-section-number">18.1</span> Tied or Discrete Data</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-of-tie" id="toc-introduction-of-tie"><span class="toc-section-number">18.1.1</span> Introduction of Tie</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time" id="toc-discrete-time"><span class="toc-section-number">18.1.2</span> Discrete time</a></li>
<li><a href="advanced-survival-analysis.html#notation-and-definitions" id="toc-notation-and-definitions"><span class="toc-section-number">18.1.3</span> Notation and Definitions</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cox-regression" id="toc-discrete-cox-regression"><span class="toc-section-number">18.1.4</span> Discrete Cox Regression</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-regression-models" id="toc-discrete-time-regression-models"><span class="toc-section-number">18.1.5</span> Discrete-Time Regression Models</a></li>
<li><a href="advanced-survival-analysis.html#the-glm-framework-and-person-period-data" id="toc-the-glm-framework-and-person-period-data"><span class="toc-section-number">18.1.6</span> The GLM Framework and Person-Period Data</a></li>
<li><a href="advanced-survival-analysis.html#discrete-time-survival-analysis-in-r" id="toc-discrete-time-survival-analysis-in-r"><span class="toc-section-number">18.1.7</span> Discrete-Time Survival Analysis in R</a></li>
<li><a href="advanced-survival-analysis.html#discrete-cause-specific-hazards-model" id="toc-discrete-cause-specific-hazards-model"><span class="toc-section-number">18.1.8</span> Discrete Cause-Specific Hazards Model</a></li>
<li><a href="advanced-survival-analysis.html#discrete-subdistribution-hazard-model" id="toc-discrete-subdistribution-hazard-model"><span class="toc-section-number">18.1.9</span> Discrete Subdistribution Hazard Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#time-dependent-covariates" id="toc-time-dependent-covariates"><span class="toc-section-number">18.2</span> Time-dependent covariates</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">18.2.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#programming-method" id="toc-programming-method"><span class="toc-section-number">18.2.2</span> Programming method</a></li>
<li><a href="advanced-survival-analysis.html#counting-method" id="toc-counting-method"><span class="toc-section-number">18.2.3</span> Counting method</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#additive-hazards-regression-model" id="toc-additive-hazards-regression-model"><span class="toc-section-number">18.3</span> Additive Hazards Regression Model</a>
<ul>
<li><a href="advanced-survival-analysis.html#preview" id="toc-preview"><span class="toc-section-number">18.3.1</span> Preview</a></li>
<li><a href="advanced-survival-analysis.html#lin-and-yings-additive-hazards-model" id="toc-lin-and-yings-additive-hazards-model"><span class="toc-section-number">18.3.2</span> Lin and Ying’s additive hazards model</a></li>
<li><a href="advanced-survival-analysis.html#aalens-additive-hazards-model" id="toc-aalens-additive-hazards-model"><span class="toc-section-number">18.3.3</span> Aalen’s Additive Hazards Model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#competing-risk" id="toc-competing-risk"><span class="toc-section-number">18.4</span> Competing Risk</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">18.4.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#type-specific-hazards" id="toc-type-specific-hazards"><span class="toc-section-number">18.4.2</span> Type-specific hazards</a></li>
<li><a href="advanced-survival-analysis.html#covariate-effects-via-cox-model" id="toc-covariate-effects-via-cox-model"><span class="toc-section-number">18.4.3</span> Covariate effects via COX model</a></li>
<li><a href="advanced-survival-analysis.html#cumulative-incidence-function-cif" id="toc-cumulative-incidence-function-cif"><span class="toc-section-number">18.4.4</span> Cumulative incidence function (CIF)</a></li>
<li><a href="advanced-survival-analysis.html#subdistribution-hazard-function" id="toc-subdistribution-hazard-function"><span class="toc-section-number">18.4.5</span> Subdistribution hazard function</a></li>
<li><a href="advanced-survival-analysis.html#cause-specific-hazard-function" id="toc-cause-specific-hazard-function"><span class="toc-section-number">18.4.6</span> Cause-specific hazard function</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#clustered-events" id="toc-clustered-events"><span class="toc-section-number">18.5</span> Clustered Events</a>
<ul>
<li><a href="advanced-survival-analysis.html#introduction-4" id="toc-introduction-4"><span class="toc-section-number">18.5.1</span> Introduction</a></li>
<li><a href="advanced-survival-analysis.html#proportional-hazards-model-which-adopts-a-marginal" id="toc-proportional-hazards-model-which-adopts-a-marginal"><span class="toc-section-number">18.5.2</span> Proportional hazards model which adopts a marginal</a></li>
<li><a href="advanced-survival-analysis.html#frailty-model" id="toc-frailty-model"><span class="toc-section-number">18.5.3</span> Frailty model</a></li>
</ul></li>
<li><a href="advanced-survival-analysis.html#non-proportional-hazards-in-survival-analysis" id="toc-non-proportional-hazards-in-survival-analysis"><span class="toc-section-number">18.6</span> Non-proportional hazards in Survival Analysis</a>
<ul>
<li><a href="advanced-survival-analysis.html#weighted-piecewise-log-rank-test" id="toc-weighted-piecewise-log-rank-test"><span class="toc-section-number">18.6.1</span> Weighted Piecewise Log-Rank Test</a></li>
<li><a href="advanced-survival-analysis.html#restricted-mean-survival-time-difference" id="toc-restricted-mean-survival-time-difference"><span class="toc-section-number">18.6.2</span> Restricted Mean Survival Time Difference</a></li>
<li><a href="advanced-survival-analysis.html#maximum-combination-test" id="toc-maximum-combination-test"><span class="toc-section-number">18.6.3</span> Maximum Combination Test</a></li>
</ul></li>
</ul></li>
<li><a href="mixed-model.html#mixed-model" id="toc-mixed-model"><span class="toc-section-number">19</span> Mixed Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">19.1</span> Introduction</a>
<ul>
<li><a href="mixed-model.html#correlated-response-data" id="toc-correlated-response-data"><span class="toc-section-number">19.1.1</span> Correlated response data</a></li>
<li><a href="mixed-model.html#hierarchical-and-marginal-model" id="toc-hierarchical-and-marginal-model"><span class="toc-section-number">19.1.2</span> Hierarchical and Marginal model</a></li>
<li><a href="mixed-model.html#mle-in-marginal-model" id="toc-mle-in-marginal-model"><span class="toc-section-number">19.1.3</span> MLE in Marginal model</a></li>
<li><a href="mixed-model.html#reml-in-marginal-model" id="toc-reml-in-marginal-model"><span class="toc-section-number">19.1.4</span> REML in Marginal model</a></li>
<li><a href="mixed-model.html#variance-correction" id="toc-variance-correction"><span class="toc-section-number">19.1.5</span> Variance correction</a></li>
<li><a href="mixed-model.html#hypothesis-tests" id="toc-hypothesis-tests"><span class="toc-section-number">19.1.6</span> Hypothesis tests</a></li>
<li><a href="mixed-model.html#residual-structure" id="toc-residual-structure"><span class="toc-section-number">19.1.7</span> Residual Structure</a></li>
<li><a href="mixed-model.html#converge-problems" id="toc-converge-problems"><span class="toc-section-number">19.1.8</span> Converge problems</a></li>
<li><a href="mixed-model.html#preface-of-linear-mixed-model" id="toc-preface-of-linear-mixed-model"><span class="toc-section-number">19.1.9</span> Preface of linear mixed model</a></li>
</ul></li>
<li><a href="mixed-model.html#random-slope-and-intercept-model" id="toc-random-slope-and-intercept-model"><span class="toc-section-number">19.2</span> Random Slope and Intercept Model</a>
<ul>
<li><a href="mixed-model.html#model-introduction" id="toc-model-introduction"><span class="toc-section-number">19.2.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation" id="toc-sas-implementation"><span class="toc-section-number">19.2.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation" id="toc-r-implementation"><span class="toc-section-number">19.2.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#covariance-structure" id="toc-covariance-structure"><span class="toc-section-number">19.3</span> Covariance Structure</a>
<ul>
<li><a href="mixed-model.html#model-introduction-1" id="toc-model-introduction-1"><span class="toc-section-number">19.3.1</span> Model Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-1" id="toc-sas-implementation-1"><span class="toc-section-number">19.3.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-1" id="toc-r-implementation-1"><span class="toc-section-number">19.3.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#hierarchical-regression-model-for-normal-response" id="toc-hierarchical-regression-model-for-normal-response"><span class="toc-section-number">19.4</span> Hierarchical Regression Model for Normal Response</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">19.4.1</span> Introduction</a></li>
<li><a href="parametric-test.html#sas-implementation-2" id="toc-sas-implementation-2"><span class="toc-section-number">19.4.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-2" id="toc-r-implementation-2"><span class="toc-section-number">19.4.3</span> R Implementation</a></li>
</ul></li>
<li><a href="mixed-model.html#generalized-estimating-equation" id="toc-generalized-estimating-equation"><span class="toc-section-number">19.5</span> Generalized Estimating Equation</a>
<ul>
<li><a href="mixed-model.html#introduction-of-gee" id="toc-introduction-of-gee"><span class="toc-section-number">19.5.1</span> Introduction of GEE</a></li>
<li><a href="parametric-test.html#sas-implementation-3" id="toc-sas-implementation-3"><span class="toc-section-number">19.5.2</span> SAS Implementation</a></li>
<li><a href="parametric-test.html#r-implementation-3" id="toc-r-implementation-3"><span class="toc-section-number">19.5.3</span> R Implementation</a></li>
</ul></li>
</ul></li>
<li><a href="glmm-and-gam.html#glmm-and-gam" id="toc-glmm-and-gam"><span class="toc-section-number">20</span> GLMM and GAM</a>
<ul>
<li><a href="glmm-and-gam.html#genaralised-linear-model" id="toc-genaralised-linear-model"><span class="toc-section-number">20.1</span> Genaralised linear model</a>
<ul>
<li><a href="glmm-and-gam.html#review" id="toc-review"><span class="toc-section-number">20.1.1</span> Review</a></li>
<li><a href="glmm-and-gam.html#exponential-families" id="toc-exponential-families"><span class="toc-section-number">20.1.2</span> Exponential Families</a></li>
<li><a href="glmm-and-gam.html#testing-linear-hypotheses" id="toc-testing-linear-hypotheses"><span class="toc-section-number">20.1.3</span> Testing linear Hypotheses</a></li>
<li><a href="glmm-and-gam.html#maximum-likelihood-estimation-in-glm" id="toc-maximum-likelihood-estimation-in-glm"><span class="toc-section-number">20.1.4</span> Maximum Likelihood Estimation in GLM</a></li>
<li><a href="glmm-and-gam.html#irls-algorithm-for-estimating-glm" id="toc-irls-algorithm-for-estimating-glm"><span class="toc-section-number">20.1.5</span> IRLS Algorithm for Estimating GLM</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-linear-mixed-model" id="toc-generalized-linear-mixed-model"><span class="toc-section-number">20.2</span> Generalized Linear Mixed Model</a>
<ul>
<li><a href="glmm-and-gam.html#backgroud" id="toc-backgroud"><span class="toc-section-number">20.2.1</span> Backgroud</a></li>
<li><a href="glmm-and-gam.html#lmm-to-glmm" id="toc-lmm-to-glmm"><span class="toc-section-number">20.2.2</span> LMM to GLMM</a></li>
<li><a href="glmm-and-gam.html#link-functions-and-families" id="toc-link-functions-and-families"><span class="toc-section-number">20.2.3</span> Link Functions and Families</a></li>
<li><a href="glmm-and-gam.html#parameter-estimation" id="toc-parameter-estimation"><span class="toc-section-number">20.2.4</span> Parameter estimation</a></li>
<li><a href="glmm-and-gam.html#logistic-model-with-fixed-and-random-effectss" id="toc-logistic-model-with-fixed-and-random-effectss"><span class="toc-section-number">20.2.5</span> logistic model with fixed and random effectss</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#generalized-additive-models" id="toc-generalized-additive-models"><span class="toc-section-number">20.3</span> Generalized Additive Models</a>
<ul>
<li><a href="glmm-and-gam.html#concept" id="toc-concept"><span class="toc-section-number">20.3.1</span> Concept</a></li>
</ul></li>
</ul></li>
<li><a href="missing-data.html#missing-data" id="toc-missing-data"><span class="toc-section-number">21</span> Missing Data</a>
<ul>
<li><a href="missing-data.html#missing-mechanisms" id="toc-missing-mechanisms"><span class="toc-section-number">21.1</span> Missing mechanisms</a></li>
<li><a href="missing-data.html#compatibility-and-congeniality" id="toc-compatibility-and-congeniality"><span class="toc-section-number">21.2</span> Compatibility and Congeniality</a></li>
<li><a href="missing-data.html#single-imputation" id="toc-single-imputation"><span class="toc-section-number">21.3</span> Single imputation</a></li>
<li><a href="missing-data.html#multiple-imputation" id="toc-multiple-imputation"><span class="toc-section-number">21.4</span> Multiple imputation</a>
<ul>
<li><a href="missing-data.html#joint-modeling-jm" id="toc-joint-modeling-jm"><span class="toc-section-number">21.4.1</span> Joint Modeling (JM)</a></li>
<li><a href="missing-data.html#multiple-imputation-by-fully-conditional-specification-mice" id="toc-multiple-imputation-by-fully-conditional-specification-mice"><span class="toc-section-number">21.4.2</span> Multiple Imputation by Fully Conditional Specification (MICE)</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">21.5</span> Bayesian linear regression</a></li>
<li><a href="missing-data.html#predictive-mean-matching" id="toc-predictive-mean-matching"><span class="toc-section-number">21.6</span> Predictive Mean Matching</a></li>
<li><a href="missing-data.html#mice-using-random-forest" id="toc-mice-using-random-forest"><span class="toc-section-number">21.7</span> MICE using random forest</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-analysis" id="toc-meta-analysis"><span class="toc-section-number">22</span> Meta Analysis</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">22.1</span> Introduction</a>
<ul>
<li><a href="meta-analysis.html#meta-analysis-for-different-data" id="toc-meta-analysis-for-different-data"><span class="toc-section-number">22.1.1</span> meta-analysis for different data</a></li>
</ul></li>
<li><a href="meta-analysis.html#fixed-effect-model-for-continuous-outcomes" id="toc-fixed-effect-model-for-continuous-outcomes"><span class="toc-section-number">22.2</span> Fixed Effect Model for Continuous Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures" id="toc-effect-measures"><span class="toc-section-number">22.2.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#standardized-mean-difference" id="toc-standardized-mean-difference"><span class="toc-section-number">22.2.2</span> Standardized Mean Difference</a></li>
<li><a href="meta-analysis.html#inverse-variance-weighted-average-method" id="toc-inverse-variance-weighted-average-method"><span class="toc-section-number">22.2.3</span> Inverse variance-weighted average method</a></li>
<li><a href="meta-analysis.html#generic-inverse-variance-meta-analysis-metagen" id="toc-generic-inverse-variance-meta-analysis-metagen"><span class="toc-section-number">22.2.4</span> Generic inverse variance meta-analysis <code>metagen</code></a></li>
<li><a href="meta-analysis.html#weighted-sum-of-z-scores" id="toc-weighted-sum-of-z-scores"><span class="toc-section-number">22.2.5</span> Weighted Sum of Z-Scores</a></li>
</ul></li>
<li><a href="meta-analysis.html#random-effects-model-for-continuous-outcomes" id="toc-random-effects-model-for-continuous-outcomes"><span class="toc-section-number">22.3</span> Random Effects Model for Continuous Outcomes</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">22.3.1</span> Introduction</a></li>
<li><a href="meta-analysis.html#implementation" id="toc-implementation"><span class="toc-section-number">22.3.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#hartung-knapp-adjustment" id="toc-hartung-knapp-adjustment"><span class="toc-section-number">22.3.3</span> Hartung-Knapp Adjustment</a></li>
</ul></li>
<li><a href="meta-analysis.html#meta-regression" id="toc-meta-regression"><span class="toc-section-number">22.4</span> Meta-Regression</a></li>
<li><a href="meta-analysis.html#meta-analysis-with-binary-outcomes" id="toc-meta-analysis-with-binary-outcomes"><span class="toc-section-number">22.5</span> Meta-Analysis with Binary Outcomes</a>
<ul>
<li><a href="meta-analysis.html#effect-measures-1" id="toc-effect-measures-1"><span class="toc-section-number">22.5.1</span> Effect Measures</a></li>
<li><a href="meta-analysis.html#implementation-1" id="toc-implementation-1"><span class="toc-section-number">22.5.2</span> Implementation</a></li>
<li><a href="meta-analysis.html#estimation-in-sparse-data---continuity-correction" id="toc-estimation-in-sparse-data---continuity-correction"><span class="toc-section-number">22.5.3</span> Estimation in Sparse Data - Continuity correction</a></li>
<li><a href="meta-analysis.html#peto-odds-ratio" id="toc-peto-odds-ratio"><span class="toc-section-number">22.5.4</span> Peto Odds Ratio</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-inverse-variance-method" id="toc-fixed-effect-model-inverse-variance-method"><span class="toc-section-number">22.5.5</span> Fixed Effect Model: Inverse Variance Method</a></li>
<li><a href="meta-analysis.html#fixed-effect-model-mantelhaenszel-method" id="toc-fixed-effect-model-mantelhaenszel-method"><span class="toc-section-number">22.5.6</span> Fixed Effect Model: Mantel–Haenszel Method</a></li>
<li><a href="meta-analysis.html#random-effects-model" id="toc-random-effects-model"><span class="toc-section-number">22.5.7</span> Random Effects Model</a></li>
</ul></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-analysis" id="toc-time-series-analysis"><span class="toc-section-number">23</span> Time Series Analysis</a>
<ul>
<li><a href="time-series-analysis.html#fundational-concepts" id="toc-fundational-concepts"><span class="toc-section-number">23.1</span> Fundational Concepts</a>
<ul>
<li><a href="time-series-analysis.html#means-variances-and-covariances" id="toc-means-variances-and-covariances"><span class="toc-section-number">23.1.1</span> Means, Variances, and Covariances</a></li>
<li><a href="time-series-analysis.html#properties-of-covariance" id="toc-properties-of-covariance"><span class="toc-section-number">23.1.2</span> Properties of covariance</a></li>
<li><a href="time-series-analysis.html#properties-of-expectation" id="toc-properties-of-expectation"><span class="toc-section-number">23.1.3</span> Properties of Expectation</a></li>
<li><a href="time-series-analysis.html#properties-of-variance" id="toc-properties-of-variance"><span class="toc-section-number">23.1.4</span> Properties of Variance</a></li>
<li><a href="time-series-analysis.html#the-random-walk" id="toc-the-random-walk"><span class="toc-section-number">23.1.5</span> The Random Walk</a></li>
<li><a href="time-series-analysis.html#a-moving-average" id="toc-a-moving-average"><span class="toc-section-number">23.1.6</span> A Moving Average</a></li>
<li><a href="time-series-analysis.html#strictly-stationarity" id="toc-strictly-stationarity"><span class="toc-section-number">23.1.7</span> Strictly Stationarity</a></li>
<li><a href="time-series-analysis.html#weakly-or-second-order-stationary" id="toc-weakly-or-second-order-stationary"><span class="toc-section-number">23.1.8</span> Weakly (or second-order) stationary</a></li>
<li><a href="time-series-analysis.html#white-noise" id="toc-white-noise"><span class="toc-section-number">23.1.9</span> White Noise</a></li>
<li><a href="time-series-analysis.html#deterministic-versus-stochastic-trends" id="toc-deterministic-versus-stochastic-trends"><span class="toc-section-number">23.1.10</span> Deterministic Versus Stochastic Trends</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arma-models" id="toc-arma-models"><span class="toc-section-number">23.2</span> ARMA models</a>
<ul>
<li><a href="time-series-analysis.html#general-linear-processes" id="toc-general-linear-processes"><span class="toc-section-number">23.2.1</span> General Linear Processes</a></li>
<li><a href="time-series-analysis.html#moving-average-processes" id="toc-moving-average-processes"><span class="toc-section-number">23.2.2</span> Moving Average Processes</a></li>
<li><a href="time-series-analysis.html#autoregressive-processes" id="toc-autoregressive-processes"><span class="toc-section-number">23.2.3</span> Autoregressive Processes</a></li>
<li><a href="time-series-analysis.html#the-mixed-autoregressive-moving-average-model" id="toc-the-mixed-autoregressive-moving-average-model"><span class="toc-section-number">23.2.4</span> The Mixed Autoregressive Moving Average Model</a></li>
<li><a href="time-series-analysis.html#invertibility" id="toc-invertibility"><span class="toc-section-number">23.2.5</span> Invertibility</a></li>
<li><a href="time-series-analysis.html#fit-the-ar-model-in-r" id="toc-fit-the-ar-model-in-r"><span class="toc-section-number">23.2.6</span> Fit the AR model in R</a></li>
<li><a href="time-series-analysis.html#fit-the-ma-model-in-r" id="toc-fit-the-ma-model-in-r"><span class="toc-section-number">23.2.7</span> Fit the MA model in R</a></li>
</ul></li>
<li><a href="time-series-analysis.html#arima-models" id="toc-arima-models"><span class="toc-section-number">23.3</span> ARIMA Models</a>
<ul>
<li><a href="time-series-analysis.html#stationarity-through-differencing" id="toc-stationarity-through-differencing"><span class="toc-section-number">23.3.1</span> Stationarity Through Differencing</a></li>
<li><a href="time-series-analysis.html#arima-integrated-autoregressive-moving-average-model" id="toc-arima-integrated-autoregressive-moving-average-model"><span class="toc-section-number">23.3.2</span> ARIMA: Integrated autoregressive moving average model</a></li>
<li><a href="time-series-analysis.html#ima11-model" id="toc-ima11-model"><span class="toc-section-number">23.3.3</span> IMA(1,1) Model</a></li>
<li><a href="time-series-analysis.html#ari11-model" id="toc-ari11-model"><span class="toc-section-number">23.3.4</span> ARI(1,1) Model</a></li>
</ul></li>
<li><a href="time-series-analysis.html#time-series-graphics" id="toc-time-series-graphics"><span class="toc-section-number">23.4</span> Time series graphics</a>
<ul>
<li><a href="time-series-analysis.html#time-plots" id="toc-time-plots"><span class="toc-section-number">23.4.1</span> Time plots</a></li>
<li><a href="time-series-analysis.html#seasonal-plots" id="toc-seasonal-plots"><span class="toc-section-number">23.4.2</span> Seasonal plots</a></li>
<li><a href="time-series-analysis.html#scatterplots-matrices" id="toc-scatterplots-matrices"><span class="toc-section-number">23.4.3</span> Scatterplots matrices</a></li>
<li><a href="time-series-analysis.html#lag-plots" id="toc-lag-plots"><span class="toc-section-number">23.4.4</span> Lag plots</a></li>
<li><a href="time-series-analysis.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">23.4.5</span> Autocorrelation</a></li>
<li><a href="time-series-analysis.html#white-noise-1" id="toc-white-noise-1"><span class="toc-section-number">23.4.6</span> White noise</a></li>
</ul></li>
</ul></li>
<li><a href="clinic-trail-design.html#clinic-trail-design" id="toc-clinic-trail-design"><span class="toc-section-number">24</span> Clinic Trail Design</a>
<ul>
<li><a href="clinic-trail-design.html#regulation" id="toc-regulation"><span class="toc-section-number">24.1</span> Regulation</a></li>
<li><a href="clinic-trail-design.html#randomization" id="toc-randomization"><span class="toc-section-number">24.2</span> Randomization</a>
<ul>
<li><a href="clinic-trail-design.html#simple-randomization" id="toc-simple-randomization"><span class="toc-section-number">24.2.1</span> Simple randomization</a></li>
<li><a href="clinic-trail-design.html#block-randomization" id="toc-block-randomization"><span class="toc-section-number">24.2.2</span> Block randomization</a></li>
<li><a href="clinic-trail-design.html#stratified-randomization" id="toc-stratified-randomization"><span class="toc-section-number">24.2.3</span> Stratified randomization</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-i-trials-design" id="toc-phase-i-trials-design"><span class="toc-section-number">24.3</span> Phase I Trials Design</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">24.3.1</span> Introduction</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#pharmacokinetic-analysis-pk-package" id="toc-pharmacokinetic-analysis-pk-package"><span class="toc-section-number">24.4</span> Pharmacokinetic Analysis (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">24.4.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">24.4.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">24.4.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">24.4.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">24.4.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">24.4.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">24.4.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-ii-trials-design" id="toc-phase-ii-trials-design"><span class="toc-section-number">24.5</span> Phase II Trials Design</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">24.5.1</span> Introduction</a></li>
<li><a href="clinic-trail-design.html#gehans-design" id="toc-gehans-design"><span class="toc-section-number">24.5.2</span> Gehan’s design</a></li>
<li><a href="clinic-trail-design.html#flemings-two-stage-design" id="toc-flemings-two-stage-design"><span class="toc-section-number">24.5.3</span> Fleming’s Two-Stage design</a></li>
<li><a href="clinic-trail-design.html#simons-2-stage-design" id="toc-simons-2-stage-design"><span class="toc-section-number">24.5.4</span> Simon’s 2-Stage Design</a></li>
<li><a href="clinic-trail-design.html#jonckheere-terptsra-jt-trend-test" id="toc-jonckheere-terptsra-jt-trend-test"><span class="toc-section-number">24.5.5</span> Jonckheere-Terptsra (JT) trend test</a></li>
<li><a href="clinic-trail-design.html#cochran-armitage-ca-trend-test" id="toc-cochran-armitage-ca-trend-test"><span class="toc-section-number">24.5.6</span> Cochran-Armitage (CA) trend test</a></li>
<li><a href="clinic-trail-design.html#mcp-mod" id="toc-mcp-mod"><span class="toc-section-number">24.5.7</span> MCP-Mod</a></li>
<li><a href="clinic-trail-design.html#two-stage-phase-ii-design-for-response-and-toxicity" id="toc-two-stage-phase-ii-design-for-response-and-toxicity"><span class="toc-section-number">24.5.8</span> Two Stage Phase II Design for Response and Toxicity</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#phase-iii-trials-design" id="toc-phase-iii-trials-design"><span class="toc-section-number">24.6</span> Phase III Trials Design</a>
<ul>
<li><a href="clinic-trail-design.html#non-inferiority-and-equivalence-three-armed-trial" id="toc-non-inferiority-and-equivalence-three-armed-trial"><span class="toc-section-number">24.6.1</span> Non-inferiority and Equivalence Three-armed trial</a></li>
<li><a href="clinic-trail-design.html#pigeot-method" id="toc-pigeot-method"><span class="toc-section-number">24.6.2</span> Pigeot Method</a></li>
</ul></li>
<li><a href="clinic-trail-design.html#medical-devices-postmarketing-surveillance-pms" id="toc-medical-devices-postmarketing-surveillance-pms"><span class="toc-section-number">24.7</span> Medical Devices Postmarketing Surveillance (PMS)</a>
<ul>
<li><a href="clinic-trail-design.html#phase-iv-and-pms" id="toc-phase-iv-and-pms"><span class="toc-section-number">24.7.1</span> Phase IV and PMS</a></li>
</ul></li>
</ul></li>
<li><a href="group-sequential-design.html#group-sequential-design" id="toc-group-sequential-design"><span class="toc-section-number">25</span> Group Sequential Design</a>
<ul>
<li><a href="group-sequential-design.html#classical-designs-without-futility-stopping" id="toc-classical-designs-without-futility-stopping"><span class="toc-section-number">25.1</span> Classical Designs without futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#pocock-method" id="toc-pocock-method"><span class="toc-section-number">25.1.1</span> Pocock Method</a></li>
<li><a href="group-sequential-design.html#obrien-fleming-method" id="toc-obrien-fleming-method"><span class="toc-section-number">25.1.2</span> O’Brien &amp; Fleming Method</a></li>
<li><a href="group-sequential-design.html#wang-tsiatis-method" id="toc-wang-tsiatis-method"><span class="toc-section-number">25.1.3</span> Wang &amp; Tsiatis Method</a></li>
<li><a href="group-sequential-design.html#rejection-bounds-and-local-p-values" id="toc-rejection-bounds-and-local-p-values"><span class="toc-section-number">25.1.4</span> Rejection bounds and Local p-values</a></li>
<li><a href="group-sequential-design.html#power-and-sample-size" id="toc-power-and-sample-size"><span class="toc-section-number">25.1.5</span> Power and Sample size</a></li>
</ul></li>
<li><a href="group-sequential-design.html#classical-designs-with-binding-futility-stopping" id="toc-classical-designs-with-binding-futility-stopping"><span class="toc-section-number">25.2</span> Classical Designs with binding futility stopping</a>
<ul>
<li><a href="group-sequential-design.html#symmetric-designs" id="toc-symmetric-designs"><span class="toc-section-number">25.2.1</span> Symmetric designs</a></li>
<li><a href="group-sequential-design.html#one-sided-designs" id="toc-one-sided-designs"><span class="toc-section-number">25.2.2</span> One-Sided Designs</a></li>
</ul></li>
<li><a href="group-sequential-design.html#alpha-spending-function-approach" id="toc-alpha-spending-function-approach"><span class="toc-section-number">25.3</span> Alpha Spending Function Approach</a></li>
<li><a href="group-sequential-design.html#r-implementation-using-rpact" id="toc-r-implementation-using-rpact"><span class="toc-section-number">25.4</span> R Implementation using rpact</a>
<ul>
<li><a href="group-sequential-design.html#basic-functions" id="toc-basic-functions"><span class="toc-section-number">25.4.1</span> Basic Functions</a></li>
<li><a href="group-sequential-design.html#getdesigngroupsequential-defining-efficacy-boundaries" id="toc-getdesigngroupsequential-defining-efficacy-boundaries"><span class="toc-section-number">25.4.2</span> <code>getDesignGroupSequential</code> defining efficacy boundaries</a></li>
</ul></li>
<li><a href="group-sequential-design.html#sample-size" id="toc-sample-size"><span class="toc-section-number">25.5</span> Sample Size</a>
<ul>
<li><a href="group-sequential-design.html#sample-sizes-for-different-types-of-endpoints-without-ia" id="toc-sample-sizes-for-different-types-of-endpoints-without-ia"><span class="toc-section-number">25.5.1</span> Sample Sizes for Different Types of Endpoints without IA</a></li>
<li><a href="group-sequential-design.html#two-groups-continuous-endpoint-without-ia" id="toc-two-groups-continuous-endpoint-without-ia"><span class="toc-section-number">25.5.2</span> Two groups continuous endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#two-groups-binary-endpoint-without-ia" id="toc-two-groups-binary-endpoint-without-ia"><span class="toc-section-number">25.5.3</span> Two groups binary endpoint (without IA)</a></li>
<li><a href="group-sequential-design.html#group-sequential-designs-for-conti-and-binary" id="toc-group-sequential-designs-for-conti-and-binary"><span class="toc-section-number">25.5.4</span> Group-sequential designs for conti and binary</a></li>
<li><a href="group-sequential-design.html#survival-endpoint" id="toc-survival-endpoint"><span class="toc-section-number">25.5.5</span> Survival endpoint</a></li>
</ul></li>
</ul></li>
<li><a href="adaptive-designs.html#adaptive-designs" id="toc-adaptive-designs"><span class="toc-section-number">26</span> Adaptive designs</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">26.1</span> Introduction</a>
<ul>
<li><a href="adaptive-designs.html#early-termination-due-to-futility" id="toc-early-termination-due-to-futility"><span class="toc-section-number">26.1.1</span> Early termination due to futility</a></li>
<li><a href="adaptive-designs.html#early-termination-due-to-efficacy" id="toc-early-termination-due-to-efficacy"><span class="toc-section-number">26.1.2</span> Early termination due to efficacy</a></li>
<li><a href="adaptive-designs.html#sample-size-reassessment" id="toc-sample-size-reassessment"><span class="toc-section-number">26.1.3</span> Sample size reassessment</a></li>
<li><a href="adaptive-designs.html#change-or-modification-of-the-primary-endpoint" id="toc-change-or-modification-of-the-primary-endpoint"><span class="toc-section-number">26.1.4</span> Change or modification of the primary endpoint</a></li>
<li><a href="adaptive-designs.html#discontinuing-treatment-arms" id="toc-discontinuing-treatment-arms"><span class="toc-section-number">26.1.5</span> Discontinuing treatment arms</a></li>
<li><a href="adaptive-designs.html#switching-between-superiority-and-non-inferiority" id="toc-switching-between-superiority-and-non-inferiority"><span class="toc-section-number">26.1.6</span> Switching between superiority and non-inferiority</a></li>
<li><a href="adaptive-designs.html#selection-of-the-patient-population" id="toc-selection-of-the-patient-population"><span class="toc-section-number">26.1.7</span> Selection of the patient population</a></li>
</ul></li>
<li><a href="adaptive-designs.html#general-theory" id="toc-general-theory"><span class="toc-section-number">26.2</span> General Theory</a>
<ul>
<li><a href="adaptive-designs.html#stopping-boundary" id="toc-stopping-boundary"><span class="toc-section-number">26.2.1</span> Stopping Boundary</a></li>
<li><a href="adaptive-designs.html#power-and-adjusted-p-value" id="toc-power-and-adjusted-p-value"><span class="toc-section-number">26.2.2</span> Power and Adjusted p-value</a></li>
<li><a href="adaptive-designs.html#stopping-probabilities-design-evaluation" id="toc-stopping-probabilities-design-evaluation"><span class="toc-section-number">26.2.3</span> Stopping Probabilities (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-duration-of-an-adaptive-trial-design-evaluation" id="toc-expected-duration-of-an-adaptive-trial-design-evaluation"><span class="toc-section-number">26.2.4</span> Expected Duration of an Adaptive Trial (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#expected-sample-sizes-design-evaluation" id="toc-expected-sample-sizes-design-evaluation"><span class="toc-section-number">26.2.5</span> Expected Sample Sizes (Design Evaluation)</a></li>
<li><a href="adaptive-designs.html#conditional-power-and-futility-index" id="toc-conditional-power-and-futility-index"><span class="toc-section-number">26.2.6</span> Conditional Power and futility index</a></li>
</ul></li>
<li><a href="adaptive-designs.html#methods" id="toc-methods"><span class="toc-section-number">26.3</span> Methods</a>
<ul>
<li><a href="adaptive-designs.html#four-inroduction" id="toc-four-inroduction"><span class="toc-section-number">26.3.1</span> Four Inroduction</a></li>
<li><a href="adaptive-designs.html#sample-size-re-estimation" id="toc-sample-size-re-estimation"><span class="toc-section-number">26.3.2</span> Sample size re-estimation</a></li>
<li><a href="adaptive-designs.html#additional-considerations" id="toc-additional-considerations"><span class="toc-section-number">26.3.3</span> Additional Considerations</a></li>
</ul></li>
<li><a href="adaptive-designs.html#combination-of-p-values" id="toc-combination-of-p-values"><span class="toc-section-number">26.4</span> Combination of p-values</a>
<ul>
<li><a href="adaptive-designs.html#method-based-on-individual-p-values" id="toc-method-based-on-individual-p-values"><span class="toc-section-number">26.4.1</span> Method Based on Individual p-values</a></li>
<li><a href="adaptive-designs.html#method-based-on-the-sum-of-p-values" id="toc-method-based-on-the-sum-of-p-values"><span class="toc-section-number">26.4.2</span> Method Based on the Sum of p-values</a></li>
<li><a href="adaptive-designs.html#method-with-product-of-p-values" id="toc-method-with-product-of-p-values"><span class="toc-section-number">26.4.3</span> Method with Product of p-values</a></li>
<li><a href="adaptive-designs.html#r-implementing" id="toc-r-implementing"><span class="toc-section-number">26.4.4</span> R Implementing</a></li>
</ul></li>
<li><a href="adaptive-designs.html#inverse-normal-combination-function" id="toc-inverse-normal-combination-function"><span class="toc-section-number">26.5</span> Inverse normal combination function</a>
<ul>
<li><a href="adaptive-designs.html#method-with-linear-combination-of-z-scores" id="toc-method-with-linear-combination-of-z-scores"><span class="toc-section-number">26.5.1</span> Method with Linear Combination of z-Scores</a></li>
<li><a href="adaptive-designs.html#weighted-inverse-normal-method" id="toc-weighted-inverse-normal-method"><span class="toc-section-number">26.5.2</span> Weighted inverse normal method</a></li>
</ul></li>
<li><a href="adaptive-designs.html#conditional-error-function-method-cefm-and-conditional-power" id="toc-conditional-error-function-method-cefm-and-conditional-power"><span class="toc-section-number">26.6</span> Conditional Error Function Method (CEFM) and Conditional Power</a>
<ul>
<li><a href="adaptive-designs.html#proschanhunsberger-method" id="toc-proschanhunsberger-method"><span class="toc-section-number">26.6.1</span> Proschan–Hunsberger Method</a></li>
<li><a href="adaptive-designs.html#denne-method" id="toc-denne-method"><span class="toc-section-number">26.6.2</span> Denne Method</a></li>
</ul></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-analysis" id="toc-pk-and-pd-analysis"><span class="toc-section-number">27</span> PK and PD Analysis</a>
<ul>
<li><a href="pk-and-pd-analysis.html#pharmacokinetic-concepts" id="toc-pharmacokinetic-concepts"><span class="toc-section-number">27.1</span> Pharmacokinetic Concepts</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">27.1.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#pk-analysis-package-in-r" id="toc-pk-analysis-package-in-r"><span class="toc-section-number">27.1.2</span> PK Analysis Package in R</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-intravenous-bolus-administration" id="toc-one-compartment-models-intravenous-bolus-administration"><span class="toc-section-number">27.1.3</span> One-Compartment Models-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-constant-rate-infusion" id="toc-one-compartment-models-constant-rate-infusion"><span class="toc-section-number">27.1.4</span> One-Compartment Models-Constant rate infusion</a></li>
<li><a href="pk-and-pd-analysis.html#integration-of-clearance-and-volume" id="toc-integration-of-clearance-and-volume"><span class="toc-section-number">27.1.5</span> Integration of clearance and volume</a></li>
<li><a href="pk-and-pd-analysis.html#one-compartment-models-extravascular-administration" id="toc-one-compartment-models-extravascular-administration"><span class="toc-section-number">27.1.6</span> One-Compartment Models-Extravascular administration</a></li>
<li><a href="pk-and-pd-analysis.html#plasma-and-urine-data" id="toc-plasma-and-urine-data"><span class="toc-section-number">27.1.7</span> Plasma and Urine Data</a></li>
<li><a href="pk-and-pd-analysis.html#multi-compartment-catenary-and-mammillary-models" id="toc-multi-compartment-catenary-and-mammillary-models"><span class="toc-section-number">27.1.8</span> Multi-Compartment-Catenary and mammillary models</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-intravenous-bolus-administration" id="toc-two-compartment-model-intravenous-bolus-administration"><span class="toc-section-number">27.1.9</span> Two-compartment model-Intravenous bolus administration</a></li>
<li><a href="pk-and-pd-analysis.html#two-compartment-model-constant-rate-infusion" id="toc-two-compartment-model-constant-rate-infusion"><span class="toc-section-number">27.1.10</span> Two-compartment model-Constant rate infusion</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#non-compartmental-analysis-nca" id="toc-non-compartmental-analysis-nca"><span class="toc-section-number">27.2</span> Non-Compartmental Analysis (NCA)</a>
<ul>
<li><a href="pk-and-pd-analysis.html#nca-vs-regression-analysis" id="toc-nca-vs-regression-analysis"><span class="toc-section-number">27.2.1</span> NCA vs regression analysis</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---linear-trapezoidal-rule" id="toc-computational-methods---linear-trapezoidal-rule"><span class="toc-section-number">27.2.2</span> Computational methods - Linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#computational-methods---log-linear-trapezoidal-rule" id="toc-computational-methods---log-linear-trapezoidal-rule"><span class="toc-section-number">27.2.3</span> Computational methods - Log-linear trapezoidal rule</a></li>
<li><a href="pk-and-pd-analysis.html#pertinent-pharmacokinetic-estimates" id="toc-pertinent-pharmacokinetic-estimates"><span class="toc-section-number">27.2.4</span> Pertinent pharmacokinetic estimates</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#calculation-pk-package" id="toc-calculation-pk-package"><span class="toc-section-number">27.3</span> Calculation (PK package）</a>
<ul>
<li><a href="clinic-trail-design.html#auc" id="toc-auc"><span class="toc-section-number">27.3.1</span> AUC</a></li>
<li><a href="clinic-trail-design.html#auc-in-complete-data-design" id="toc-auc-in-complete-data-design"><span class="toc-section-number">27.3.2</span> AUC in complete data design</a></li>
<li><a href="clinic-trail-design.html#auc-in-repeated-complete-data-design" id="toc-auc-in-repeated-complete-data-design"><span class="toc-section-number">27.3.3</span> AUC in repeated complete data design</a></li>
<li><a href="clinic-trail-design.html#bioequivalence-between-aucs" id="toc-bioequivalence-between-aucs"><span class="toc-section-number">27.3.4</span> Bioequivalence between AUCs</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-biexponential-model" id="toc-two-phase-half-life-estimation-by-biexponential-model"><span class="toc-section-number">27.3.5</span> Two-phase half-life estimation by biexponential model</a></li>
<li><a href="clinic-trail-design.html#two-phase-half-life-estimation-by-linear-fitting" id="toc-two-phase-half-life-estimation-by-linear-fitting"><span class="toc-section-number">27.3.6</span> Two-phase half-life estimation by linear fitting</a></li>
<li><a href="clinic-trail-design.html#estimation-of-various-pk-parameters" id="toc-estimation-of-various-pk-parameters"><span class="toc-section-number">27.3.7</span> Estimation of various PK parameters</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-concepts" id="toc-pharmacodynamic-concepts"><span class="toc-section-number">27.4</span> Pharmacodynamic Concepts</a>
<ul>
<li><a href="parametric-test.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">27.4.1</span> Introduction</a></li>
<li><a href="pk-and-pd-analysis.html#response" id="toc-response"><span class="toc-section-number">27.4.2</span> Response</a></li>
<li><a href="pk-and-pd-analysis.html#law-of-mass-action" id="toc-law-of-mass-action"><span class="toc-section-number">27.4.3</span> Law of Mass Action</a></li>
<li><a href="pk-and-pd-analysis.html#pharmacodynamic-models" id="toc-pharmacodynamic-models"><span class="toc-section-number">27.4.4</span> Pharmacodynamic Models</a></li>
<li><a href="pk-and-pd-analysis.html#interaction-models" id="toc-interaction-models"><span class="toc-section-number">27.4.5</span> Interaction Models</a></li>
</ul></li>
<li><a href="pk-and-pd-analysis.html#pk-and-pd-data-transfer" id="toc-pk-and-pd-data-transfer"><span class="toc-section-number">27.5</span> PK and PD data transfer</a>
<ul>
<li><a href="pk-and-pd-analysis.html#adpp-specification" id="toc-adpp-specification"><span class="toc-section-number">27.5.1</span> ADPP Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpp" id="toc-adpp"><span class="toc-section-number">27.5.2</span> ADPP</a></li>
<li><a href="pk-and-pd-analysis.html#adpc-specification" id="toc-adpc-specification"><span class="toc-section-number">27.5.3</span> ADPC Specification</a></li>
<li><a href="pk-and-pd-analysis.html#adpc" id="toc-adpc"><span class="toc-section-number">27.5.4</span> ADPC</a></li>
</ul></li>
</ul></li>
<li><a href="cdisc.html#cdisc" id="toc-cdisc"><span class="toc-section-number">28</span> CDISC</a>
<ul>
<li><a href="cdisc.html#study-data-tabulation-model-sdtm" id="toc-study-data-tabulation-model-sdtm"><span class="toc-section-number">28.1</span> Study Data Tabulation Model (SDTM)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">28.1.1</span> Introduction</a></li>
<li><a href="cdisc.html#model-concepts-and-terms" id="toc-model-concepts-and-terms"><span class="toc-section-number">28.1.2</span> Model Concepts and Terms</a></li>
<li><a href="cdisc.html#sdtm-domains" id="toc-sdtm-domains"><span class="toc-section-number">28.1.3</span> SDTM Domains</a></li>
<li><a href="cdisc.html#sdtm-define.xml" id="toc-sdtm-define.xml"><span class="toc-section-number">28.1.4</span> SDTM Define.xml</a></li>
<li><a href="cdisc.html#extract-transform-load-etl" id="toc-extract-transform-load-etl"><span class="toc-section-number">28.1.5</span> Extract-Transform-Load (ETL)</a></li>
<li><a href="cdisc.html#example-building-dm-sdtm-datasets" id="toc-example-building-dm-sdtm-datasets"><span class="toc-section-number">28.1.6</span> Example Building DM SDTM Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#sdtm-sas-macro" id="toc-sdtm-sas-macro"><span class="toc-section-number">28.2</span> SDTM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define" id="toc-make_define"><span class="toc-section-number">28.2.1</span> ％make_define</a></li>
<li><a href="cdisc.html#make_codelist_formats" id="toc-make_codelist_formats"><span class="toc-section-number">28.2.2</span> %make_codelist_formats</a></li>
<li><a href="cdisc.html#make_empty_dataset" id="toc-make_empty_dataset"><span class="toc-section-number">28.2.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#make_dtc_date" id="toc-make_dtc_date"><span class="toc-section-number">28.2.4</span> %make_dtc_date</a></li>
<li><a href="cdisc.html#make_sdtm_dy" id="toc-make_sdtm_dy"><span class="toc-section-number">28.2.5</span> %make_sdtm_dy</a></li>
<li><a href="cdisc.html#make_sort_order" id="toc-make_sort_order"><span class="toc-section-number">28.2.6</span> %make_sort_order</a></li>
<li><a href="cdisc.html#create_stdm_domains" id="toc-create_stdm_domains"><span class="toc-section-number">28.2.7</span> %Create_STDM_Domains</a></li>
<li><a href="cdisc.html#detectduplicates" id="toc-detectduplicates"><span class="toc-section-number">28.2.8</span> %DetectDuplicates</a></li>
<li><a href="cdisc.html#changedvarnum" id="toc-changedvarnum"><span class="toc-section-number">28.2.9</span> %ChangedVarNum</a></li>
<li><a href="cdisc.html#changedlabels" id="toc-changedlabels"><span class="toc-section-number">28.2.10</span> %ChangedLabels</a></li>
</ul></li>
<li><a href="cdisc.html#analysis-data-model-adam" id="toc-analysis-data-model-adam"><span class="toc-section-number">28.3</span> Analysis Data Model (ADaM)</a>
<ul>
<li><a href="cdisc.html#compare-with-sdtm" id="toc-compare-with-sdtm"><span class="toc-section-number">28.3.1</span> Compare with SDTM</a></li>
<li><a href="cdisc.html#types-of-adam-metadata" id="toc-types-of-adam-metadata"><span class="toc-section-number">28.3.2</span> 4 types of ADaM metadata</a></li>
<li><a href="cdisc.html#subject-level-analysis-dataset-adsl" id="toc-subject-level-analysis-dataset-adsl"><span class="toc-section-number">28.3.3</span> Subject-Level Analysis Dataset (ADSL)</a></li>
<li><a href="cdisc.html#the-basic-data-structure-bds" id="toc-the-basic-data-structure-bds"><span class="toc-section-number">28.3.4</span> The Basic Data Structure (BDS)</a></li>
<li><a href="cdisc.html#example-building-adsl-datasets" id="toc-example-building-adsl-datasets"><span class="toc-section-number">28.3.5</span> Example Building ADSL Datasets</a></li>
<li><a href="cdisc.html#example-building-adam-basic-data-structure-bds-datasets" id="toc-example-building-adam-basic-data-structure-bds-datasets"><span class="toc-section-number">28.3.6</span> Example Building ADaM Basic Data Structure (BDS) Datasets</a></li>
<li><a href="cdisc.html#example-building-adae-adverse-event-analysis-datasets-datasets" id="toc-example-building-adae-adverse-event-analysis-datasets-datasets"><span class="toc-section-number">28.3.7</span> Example Building ADAE – Adverse Event Analysis Datasets Datasets</a></li>
</ul></li>
<li><a href="cdisc.html#adam-sas-macro" id="toc-adam-sas-macro"><span class="toc-section-number">28.4</span> ADaM SAS Macro</a>
<ul>
<li><a href="cdisc.html#make_define-1" id="toc-make_define-1"><span class="toc-section-number">28.4.1</span> %make_define</a></li>
<li><a href="cdisc.html#create_adam_dataset" id="toc-create_adam_dataset"><span class="toc-section-number">28.4.2</span> %create_adam_dataset</a></li>
<li><a href="cdisc.html#make_empty_dataset-1" id="toc-make_empty_dataset-1"><span class="toc-section-number">28.4.3</span> %make_empty_dataset</a></li>
<li><a href="cdisc.html#dtc2dt" id="toc-dtc2dt"><span class="toc-section-number">28.4.4</span> %DTC2DT</a></li>
<li><a href="cdisc.html#imputed_date" id="toc-imputed_date"><span class="toc-section-number">28.4.5</span> %imputed_date</a></li>
<li><a href="cdisc.html#mergsupp" id="toc-mergsupp"><span class="toc-section-number">28.4.6</span> %mergsupp</a></li>
</ul></li>
<li><a href="cdisc.html#project-example-mediwound1" id="toc-project-example-mediwound1"><span class="toc-section-number">28.5</span> Project Example MEDIWOUND1</a>
<ul>
<li><a href="cdisc.html#study-design" id="toc-study-design"><span class="toc-section-number">28.5.1</span> Study Design</a></li>
<li><a href="cdisc.html#primary-objective" id="toc-primary-objective"><span class="toc-section-number">28.5.2</span> Primary Objective</a></li>
<li><a href="cdisc.html#statistical-analysis" id="toc-statistical-analysis"><span class="toc-section-number">28.5.3</span> Statistical Analysis</a></li>
<li><a href="cdisc.html#cdisc-programming" id="toc-cdisc-programming"><span class="toc-section-number">28.5.4</span> CDISC Programming</a></li>
</ul></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#regularization-penalized-regression" id="toc-regularization-penalized-regression"><span class="toc-section-number">29</span> Regularization Penalized Regression</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">29.1</span> Introduction</a>
<ul>
<li><a href="regularization-penalized-regression.html#motivation" id="toc-motivation"><span class="toc-section-number">29.1.1</span> Motivation</a></li>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">29.1.2</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#best-subset-regression" id="toc-best-subset-regression"><span class="toc-section-number">29.1.3</span> Best subset regression</a></li>
</ul></li>
<li><a href="advanced-linear-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">29.2</span> Ridge Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">29.2.1</span> Modeling</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#lasso-regression" id="toc-lasso-regression"><span class="toc-section-number">29.3</span> Lasso Regression</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">29.3.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#glmnet-cross-validation" id="toc-glmnet-cross-validation"><span class="toc-section-number">29.3.2</span> glmnet cross validation</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#elasticnet" id="toc-elasticnet"><span class="toc-section-number">29.4</span> ElasticNet</a>
<ul>
<li><a href="regularization-penalized-regression.html#modelling-1" id="toc-modelling-1"><span class="toc-section-number">29.4.1</span> Modelling</a></li>
<li><a href="regularization-penalized-regression.html#classification" id="toc-classification"><span class="toc-section-number">29.4.2</span> Classification</a></li>
</ul></li>
</ul></li>
<li><a href="bayesian-theory.html#bayesian-theory" id="toc-bayesian-theory"><span class="toc-section-number">30</span> Bayesian Theory</a>
<ul>
<li><a href="bayesian-theory.html#introduction-of-bayesian" id="toc-introduction-of-bayesian"><span class="toc-section-number">30.1</span> Introduction of Bayesian</a>
<ul>
<li><a href="bayesian-theory.html#frequency-and-bayesian" id="toc-frequency-and-bayesian"><span class="toc-section-number">30.1.1</span> Frequency and Bayesian</a></li>
<li><a href="bayesian-theory.html#bayesian-and-classical-methods" id="toc-bayesian-and-classical-methods"><span class="toc-section-number">30.1.2</span> Bayesian and classical methods</a></li>
<li><a href="bayesian-theory.html#bayes-rule" id="toc-bayes-rule"><span class="toc-section-number">30.1.3</span> Bayes’ Rule</a></li>
<li><a href="bayesian-theory.html#bootstrap" id="toc-bootstrap"><span class="toc-section-number">30.1.4</span> Bootstrap</a></li>
<li><a href="bayesian-theory.html#posterior-distribution" id="toc-posterior-distribution"><span class="toc-section-number">30.1.5</span> Posterior Distribution</a></li>
<li><a href="bayesian-theory.html#bayesian-credible-intervals" id="toc-bayesian-credible-intervals"><span class="toc-section-number">30.1.6</span> Bayesian Credible Intervals</a></li>
</ul></li>
<li><a href="anova.html#parameter-estimates" id="toc-parameter-estimates"><span class="toc-section-number">30.2</span> Parameter estimates</a>
<ul>
<li><a href="bayesian-theory.html#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation"><span class="toc-section-number">30.2.1</span> Maximum likelihood estimation</a></li>
<li><a href="bayesian-theory.html#maximum-a-posteriori-estimation" id="toc-maximum-a-posteriori-estimation"><span class="toc-section-number">30.2.2</span> Maximum a posteriori estimation</a></li>
<li><a href="bayesian-theory.html#bayesian-model" id="toc-bayesian-model"><span class="toc-section-number">30.2.3</span> Bayesian Model</a></li>
</ul></li>
<li><a href="bayesian-theory.html#prior-distributions" id="toc-prior-distributions"><span class="toc-section-number">30.3</span> Prior Distributions</a>
<ul>
<li><a href="bayesian-theory.html#conjugate-prior-distributions" id="toc-conjugate-prior-distributions"><span class="toc-section-number">30.3.1</span> Conjugate Prior Distributions</a></li>
<li><a href="bayesian-theory.html#non-informativ-priors" id="toc-non-informativ-priors"><span class="toc-section-number">30.3.2</span> Non-informativ Priors</a></li>
</ul></li>
<li><a href="bayesian-theory.html#mcmc" id="toc-mcmc"><span class="toc-section-number">30.4</span> MCMC</a>
<ul>
<li><a href="bayesian-theory.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">30.4.1</span> Monte Carlo Simulation</a></li>
<li><a href="bayesian-theory.html#概率分布采样" id="toc-概率分布采样"><span class="toc-section-number">30.4.2</span> 概率分布采样</a></li>
<li><a href="bayesian-theory.html#接受-拒绝采样" id="toc-接受-拒绝采样"><span class="toc-section-number">30.4.3</span> 接受-拒绝采样</a></li>
<li><a href="bayesian-theory.html#markov-chain" id="toc-markov-chain"><span class="toc-section-number">30.4.4</span> Markov Chain</a></li>
<li><a href="bayesian-theory.html#马尔科夫链的收敛性质" id="toc-马尔科夫链的收敛性质"><span class="toc-section-number">30.4.5</span> 马尔科夫链的收敛性质</a></li>
<li><a href="bayesian-theory.html#基于马尔科夫链采样" id="toc-基于马尔科夫链采样"><span class="toc-section-number">30.4.6</span> 基于马尔科夫链采样</a></li>
<li><a href="bayesian-theory.html#mcmc采样" id="toc-mcmc采样"><span class="toc-section-number">30.4.7</span> MCMC采样</a></li>
<li><a href="bayesian-theory.html#m-h采样" id="toc-m-h采样"><span class="toc-section-number">30.4.8</span> M-H采样</a></li>
<li><a href="bayesian-theory.html#gibbs采样" id="toc-gibbs采样"><span class="toc-section-number">30.4.9</span> Gibbs采样</a></li>
</ul></li>
<li><a href="bayesian-theory.html#regression-and-variable-selection" id="toc-regression-and-variable-selection"><span class="toc-section-number">30.5</span> Regression and Variable Selection</a>
<ul>
<li><a href="bayesian-theory.html#classical-least-squares-estimator" id="toc-classical-least-squares-estimator"><span class="toc-section-number">30.5.1</span> Classical Least Squares Estimator</a></li>
<li><a href="bayesian-theory.html#the-jeffreys-prior-analysis" id="toc-the-jeffreys-prior-analysis"><span class="toc-section-number">30.5.2</span> The Jeffreys Prior Analysis</a></li>
<li><a href="bayesian-theory.html#zellners-g-prior-analysis" id="toc-zellners-g-prior-analysis"><span class="toc-section-number">30.5.3</span> Zellner’s G-prior analysis</a></li>
</ul></li>
<li><a href="missing-data.html#bayesian-linear-regression" id="toc-bayesian-linear-regression"><span class="toc-section-number">30.6</span> Bayesian linear regression</a></li>
<li><a href="bayesian-theory.html#item-response-theory" id="toc-item-response-theory"><span class="toc-section-number">30.7</span> Item Response Theory</a>
<ul>
<li><a href="bayesian-theory.html#item-response-theory-1" id="toc-item-response-theory-1"><span class="toc-section-number">30.7.1</span> Item response theory</a></li>
<li><a href="bayesian-theory.html#em-algorithm" id="toc-em-algorithm"><span class="toc-section-number">30.7.2</span> EM algorithm</a></li>
<li><a href="bayesian-theory.html#mcmc-algorithm" id="toc-mcmc-algorithm"><span class="toc-section-number">30.7.3</span> MCMC algorithm</a></li>
<li><a href="bayesian-theory.html#unidimensional-irt-models" id="toc-unidimensional-irt-models"><span class="toc-section-number">30.7.4</span> Unidimensional IRT Models</a></li>
</ul></li>
</ul></li>
<li><a href="smoothing.html#smoothing" id="toc-smoothing"><span class="toc-section-number">31</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#smoothing-1" id="toc-smoothing-1"><span class="toc-section-number">31.1</span> Smoothing</a>
<ul>
<li><a href="smoothing.html#bin-smoothing" id="toc-bin-smoothing"><span class="toc-section-number">31.1.1</span> Bin smoothing</a></li>
<li><a href="smoothing.html#kernels" id="toc-kernels"><span class="toc-section-number">31.1.2</span> Kernels</a></li>
<li><a href="smoothing.html#local-weighted-regression-loess" id="toc-local-weighted-regression-loess"><span class="toc-section-number">31.1.3</span> Local weighted regression (loess)</a></li>
</ul></li>
<li><a href="smoothing.html#loess-regression" id="toc-loess-regression"><span class="toc-section-number">31.2</span> Loess Regression</a></li>
</ul></li>
<li><a href="knn.html#knn" id="toc-knn"><span class="toc-section-number">32</span> KNN</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">32.1</span> Introduction</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">32.1.1</span> Idee</a></li>
<li><a href="knn.html#加权最近邻法" id="toc-加权最近邻法"><span class="toc-section-number">32.1.2</span> 加权最近邻法</a></li>
<li><a href="knn.html#knn算法三要素" id="toc-knn算法三要素"><span class="toc-section-number">32.1.3</span> KNN算法三要素</a></li>
<li><a href="knn.html#优缺点" id="toc-优缺点"><span class="toc-section-number">32.1.4</span> 优缺点</a></li>
</ul></li>
<li><a href="knn.html#knn算法的实现方式" id="toc-knn算法的实现方式"><span class="toc-section-number">32.2</span> KNN算法的实现方式</a>
<ul>
<li><a href="knn.html#brute-force" id="toc-brute-force"><span class="toc-section-number">32.2.1</span> Brute-force</a></li>
<li><a href="knn.html#kd树实现" id="toc-kd树实现"><span class="toc-section-number">32.2.2</span> KD树实现</a></li>
<li><a href="knn.html#球树实现" id="toc-球树实现"><span class="toc-section-number">32.2.3</span> 球树实现</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">32.3</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">32.3.1</span> Data Preparation</a></li>
<li><a href="knn.html#knn-modelling" id="toc-knn-modelling"><span class="toc-section-number">32.3.2</span> KNN Modelling</a></li>
<li><a href="knn.html#加权最近邻法-1" id="toc-加权最近邻法-1"><span class="toc-section-number">32.3.3</span> 加权最近邻法</a></li>
<li><a href="knn.html#over-training" id="toc-over-training"><span class="toc-section-number">32.3.4</span> Over-training</a></li>
</ul></li>
</ul></li>
<li><a href="svm.html#svm" id="toc-svm"><span class="toc-section-number">33</span> SVM</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">33.1</span> Introduction</a>
<ul>
<li><a href="svm.html#perceptron" id="toc-perceptron"><span class="toc-section-number">33.1.1</span> Perceptron</a></li>
<li><a href="svm.html#函数间隔与几何间隔" id="toc-函数间隔与几何间隔"><span class="toc-section-number">33.1.2</span> 函数间隔与几何间隔</a></li>
<li><a href="svm.html#svm支持向量" id="toc-svm支持向量"><span class="toc-section-number">33.1.3</span> SVM支持向量</a></li>
<li><a href="svm.html#svm模型目标函数与优化" id="toc-svm模型目标函数与优化"><span class="toc-section-number">33.1.4</span> SVM模型目标函数与优化</a></li>
<li><a href="svm.html#线性可分svm的算法过程" id="toc-线性可分svm的算法过程"><span class="toc-section-number">33.1.5</span> 线性可分SVM的算法过程</a></li>
<li><a href="svm.html#线性svm的软间隔最大化" id="toc-线性svm的软间隔最大化"><span class="toc-section-number">33.1.6</span> 线性SVM的软间隔最大化</a></li>
<li><a href="svm.html#线性不可分支持向量机与核函数" id="toc-线性不可分支持向量机与核函数"><span class="toc-section-number">33.1.7</span> 线性不可分支持向量机与核函数</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">33.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">33.2.1</span> Data Preparation</a></li>
<li><a href="svm.html#svm-modelling" id="toc-svm-modelling"><span class="toc-section-number">33.2.2</span> SVM Modelling</a></li>
<li><a href="advanced-linear-regression.html#model-selection" id="toc-model-selection"><span class="toc-section-number">33.2.3</span> Model Selection</a></li>
<li><a href="svm.html#character-selection" id="toc-character-selection"><span class="toc-section-number">33.2.4</span> Character selection</a></li>
</ul></li>
</ul></li>
<li><a href="tree-models.html#tree-models" id="toc-tree-models"><span class="toc-section-number">34</span> Tree models</a>
<ul>
<li><a href="tree-models.html#decision-tree-model" id="toc-decision-tree-model"><span class="toc-section-number">34.1</span> Decision Tree Model</a>
<ul>
<li><a href="tree-models.html#decision-tree-algorithm" id="toc-decision-tree-algorithm"><span class="toc-section-number">34.1.1</span> Decision tree algorithm</a></li>
<li><a href="tree-models.html#id3-algorithm" id="toc-id3-algorithm"><span class="toc-section-number">34.1.2</span> ID3 Algorithm</a></li>
<li><a href="tree-models.html#c4.5-algorithm" id="toc-c4.5-algorithm"><span class="toc-section-number">34.1.3</span> C4.5 Algorithm</a></li>
<li><a href="tree-models.html#cart-algorithm" id="toc-cart-algorithm"><span class="toc-section-number">34.1.4</span> CART Algorithm</a></li>
<li><a href="tree-models.html#pruning" id="toc-pruning"><span class="toc-section-number">34.1.5</span> Pruning</a></li>
<li><a href="tree-models.html#package-rpart" id="toc-package-rpart"><span class="toc-section-number">34.1.6</span> Package ‘rpart’</a></li>
</ul></li>
<li><a href="tree-models.html#random-forest" id="toc-random-forest"><span class="toc-section-number">34.2</span> Random Forest</a>
<ul>
<li><a href="tree-models.html#bootstrap-bagging" id="toc-bootstrap-bagging"><span class="toc-section-number">34.2.1</span> Bootstrap (Bagging)</a></li>
<li><a href="tree-models.html#bagging算法流程" id="toc-bagging算法流程"><span class="toc-section-number">34.2.2</span> bagging算法流程</a></li>
<li><a href="tree-models.html#random-forest-algorithm" id="toc-random-forest-algorithm"><span class="toc-section-number">34.2.3</span> Random Forest Algorithm</a></li>
<li><a href="tree-models.html#random-forest-promotion" id="toc-random-forest-promotion"><span class="toc-section-number">34.2.4</span> Random forest promotion</a></li>
<li><a href="tree-models.html#package-randomforest" id="toc-package-randomforest"><span class="toc-section-number">34.2.5</span> Package ‘randomForest’</a></li>
</ul></li>
<li><a href="regularization-penalized-regression.html#modelling" id="toc-modelling"><span class="toc-section-number">34.3</span> Modelling</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">34.3.1</span> Data preparation</a></li>
<li><a href="tree-models.html#regression-tree-1" id="toc-regression-tree-1"><span class="toc-section-number">34.3.2</span> Regression tree</a></li>
<li><a href="tree-models.html#classification-tree-1" id="toc-classification-tree-1"><span class="toc-section-number">34.3.3</span> Classification tree</a></li>
<li><a href="tree-models.html#random-forest-for-regression" id="toc-random-forest-for-regression"><span class="toc-section-number">34.3.4</span> Random forest for regression</a></li>
<li><a href="tree-models.html#random-forest-for-classification" id="toc-random-forest-for-classification"><span class="toc-section-number">34.3.5</span> Random forest for classification</a></li>
<li><a href="tree-models.html#皮玛印第安人糖尿病数据集" id="toc-皮玛印第安人糖尿病数据集"><span class="toc-section-number">34.3.6</span> 皮玛印第安人糖尿病数据集</a></li>
<li><a href="tree-models.html#使用随机森林进行特征选择" id="toc-使用随机森林进行特征选择"><span class="toc-section-number">34.3.7</span> 使用随机森林进行特征选择</a></li>
</ul></li>
<li><a href="tree-models.html#gradient-boosting" id="toc-gradient-boosting"><span class="toc-section-number">34.4</span> Gradient Boosting</a></li>
<li><a href="tree-models.html#gradient-descent" id="toc-gradient-descent"><span class="toc-section-number">34.5</span> Gradient Descent</a>
<ul>
<li><a href="tree-models.html#gradient" id="toc-gradient"><span class="toc-section-number">34.5.1</span> Gradient</a></li>
<li><a href="tree-models.html#gradient-descent-1" id="toc-gradient-descent-1"><span class="toc-section-number">34.5.2</span> Gradient Descent</a></li>
<li><a href="tree-models.html#gradient-descent-algorithm" id="toc-gradient-descent-algorithm"><span class="toc-section-number">34.5.3</span> Gradient Descent Algorithm</a></li>
<li><a href="tree-models.html#gradient-descent-familiy" id="toc-gradient-descent-familiy"><span class="toc-section-number">34.5.4</span> Gradient Descent Familiy</a></li>
<li><a href="tree-models.html#gbdt分类算法" id="toc-gbdt分类算法"><span class="toc-section-number">34.5.5</span> GBDT分类算法</a></li>
<li><a href="tree-models.html#package-gbm" id="toc-package-gbm"><span class="toc-section-number">34.5.6</span> Package ‘gbm’</a></li>
<li><a href="tree-models.html#极限梯度提升分类" id="toc-极限梯度提升分类"><span class="toc-section-number">34.5.7</span> 极限梯度提升——分类</a></li>
</ul></li>
<li><a href="tree-models.html#cubist-model" id="toc-cubist-model"><span class="toc-section-number">34.6</span> Cubist Model</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">34.6.1</span> Introduction</a></li>
<li><a href="tree-models.html#application-data-preparation" id="toc-application-data-preparation"><span class="toc-section-number">34.6.2</span> Application Data Preparation</a></li>
<li><a href="tree-models.html#fit-continious-outcome" id="toc-fit-continious-outcome"><span class="toc-section-number">34.6.3</span> Fit Continious Outcome</a></li>
<li><a href="tree-models.html#variable-importance" id="toc-variable-importance"><span class="toc-section-number">34.6.4</span> Variable Importance</a></li>
<li><a href="tree-models.html#summary-display" id="toc-summary-display"><span class="toc-section-number">34.6.5</span> Summary display</a></li>
<li><a href="tree-models.html#specific-parts" id="toc-specific-parts"><span class="toc-section-number">34.6.6</span> specific parts</a></li>
<li><a href="tree-models.html#ensembles-by-committees" id="toc-ensembles-by-committees"><span class="toc-section-number">34.6.7</span> Ensembles By Committees</a></li>
<li><a href="tree-models.html#nearestneighbors-adjustmemt" id="toc-nearestneighbors-adjustmemt"><span class="toc-section-number">34.6.8</span> Nearest–neighbors Adjustmemt</a></li>
<li><a href="tree-models.html#optimize-parameters" id="toc-optimize-parameters"><span class="toc-section-number">34.6.9</span> Optimize parameters</a></li>
<li><a href="tree-models.html#logistic-cv" id="toc-logistic-cv"><span class="toc-section-number">34.6.10</span> Logistic CV</a></li>
</ul></li>
</ul></li>
<li><a href="pca.html#pca" id="toc-pca"><span class="toc-section-number">35</span> PCA</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">35.1</span> Introduction</a>
<ul>
<li><a href="pca.html#component" id="toc-component"><span class="toc-section-number">35.1.1</span> Component</a></li>
<li><a href="pca.html#pca算法" id="toc-pca算法"><span class="toc-section-number">35.1.2</span> PCA算法</a></li>
<li><a href="pca.html#主成分旋转" id="toc-主成分旋转"><span class="toc-section-number">35.1.3</span> 主成分旋转</a></li>
<li><a href="pca.html#kernelized-pca" id="toc-kernelized-pca"><span class="toc-section-number">35.1.4</span> Kernelized PCA</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">35.2</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">35.2.1</span> Data preparation</a></li>
<li><a href="regularization-penalized-regression.html#modeling" id="toc-modeling"><span class="toc-section-number">35.2.2</span> Modeling</a></li>
</ul></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">36</span> Cluster Analysis</a>
<ul>
<li><a href="cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">36.1</span> Hierarchical Clustering</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">36.1.1</span> Introduction</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms"><span class="toc-section-number">36.1.2</span> Hierarchical clustering algorithms</a></li>
<li><a href="cluster-analysis.html#measure-the-dissimilarity-between-two-clusters-of-observations" id="toc-measure-the-dissimilarity-between-two-clusters-of-observations"><span class="toc-section-number">36.1.3</span> Measure the dissimilarity between two clusters of observations</a></li>
</ul></li>
<li><a href="cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">36.2</span> K-means Clustering</a>
<ul>
<li><a href="cluster-analysis.html#algorithm" id="toc-algorithm"><span class="toc-section-number">36.2.1</span> Algorithm</a></li>
<li><a href="cluster-analysis.html#k-means" id="toc-k-means"><span class="toc-section-number">36.2.2</span> K-Means++</a></li>
<li><a href="cluster-analysis.html#elkan-k-means" id="toc-elkan-k-means"><span class="toc-section-number">36.2.3</span> elkan K-Means</a></li>
<li><a href="cluster-analysis.html#mini-batch-k-means" id="toc-mini-batch-k-means"><span class="toc-section-number">36.2.4</span> Mini Batch K-Means</a></li>
</ul></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam" id="toc-gowers-coefficient-and-pam"><span class="toc-section-number">36.3</span> Gower’s coefficient and PAM</a>
<ul>
<li><a href="cluster-analysis.html#gowers-coefficient" id="toc-gowers-coefficient"><span class="toc-section-number">36.3.1</span> Gower’s coefficient</a></li>
<li><a href="cluster-analysis.html#不同数据类型的相异度计算-距离法" id="toc-不同数据类型的相异度计算-距离法"><span class="toc-section-number">36.3.2</span> 不同数据类型的相异度计算 (距离法)</a></li>
<li><a href="cluster-analysis.html#pam" id="toc-pam"><span class="toc-section-number">36.3.3</span> PAM</a></li>
</ul></li>
<li><a href="cluster-analysis.html#birch-clustering" id="toc-birch-clustering"><span class="toc-section-number">36.4</span> BIRCH Clustering</a>
<ul>
<li><a href="cluster-analysis.html#birch-introduction" id="toc-birch-introduction"><span class="toc-section-number">36.4.1</span> BIRCH Introduction</a></li>
<li><a href="cluster-analysis.html#聚类特征cf与聚类特征树cf-tree" id="toc-聚类特征cf与聚类特征树cf-tree"><span class="toc-section-number">36.4.2</span> 聚类特征CF与聚类特征树CF Tree</a></li>
<li><a href="cluster-analysis.html#cf-tree的生成" id="toc-cf-tree的生成"><span class="toc-section-number">36.4.3</span> CF Tree的生成</a></li>
<li><a href="cluster-analysis.html#birch算法" id="toc-birch算法"><span class="toc-section-number">36.4.4</span> BIRCH算法</a></li>
</ul></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">36.5</span> Application</a>
<ul>
<li><a href="regularization-penalized-regression.html#data-preparation" id="toc-data-preparation"><span class="toc-section-number">36.5.1</span> Data preparation</a></li>
<li><a href="cluster-analysis.html#hierarchical-clustering-1" id="toc-hierarchical-clustering-1"><span class="toc-section-number">36.5.2</span> Hierarchical Clustering</a></li>
<li><a href="cluster-analysis.html#k-means-clustering-1" id="toc-k-means-clustering-1"><span class="toc-section-number">36.5.3</span> K-means Clustering</a></li>
<li><a href="cluster-analysis.html#gowers-coefficient-and-pam-1" id="toc-gowers-coefficient-and-pam-1"><span class="toc-section-number">36.5.4</span> Gower’s coefficient and PAM</a></li>
</ul></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda"><span class="toc-section-number">37</span> linear discriminant analysis (LDA)</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">37.1</span> Introduction</a>
<ul>
<li><a href="linear-discriminant-analysis-lda.html#naive-bayes" id="toc-naive-bayes"><span class="toc-section-number">37.1.1</span> Naive Bayes</a></li>
<li><a href="linear-discriminant-analysis-lda.html#controlling-prevalence" id="toc-controlling-prevalence"><span class="toc-section-number">37.1.2</span> Controlling prevalence</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda" id="toc-qda"><span class="toc-section-number">37.1.3</span> QDA</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda" id="toc-lda"><span class="toc-section-number">37.1.4</span> LDA</a></li>
</ul></li>
<li><a href="linear-discriminant-analysis-lda.html#discriminant-analysis-algorithm" id="toc-discriminant-analysis-algorithm"><span class="toc-section-number">37.2</span> Discriminant analysis algorithm</a>
<ul>
<li><a href="knn.html#idee" id="toc-idee"><span class="toc-section-number">37.2.1</span> Idee</a></li>
<li><a href="linear-discriminant-analysis-lda.html#瑞利商rayleigh-quotient" id="toc-瑞利商rayleigh-quotient"><span class="toc-section-number">37.2.2</span> 瑞利商（Rayleigh quotient）</a></li>
<li><a href="linear-discriminant-analysis-lda.html#广义瑞利商-genralized-rayleigh-quotient" id="toc-广义瑞利商-genralized-rayleigh-quotient"><span class="toc-section-number">37.2.3</span> 广义瑞利商 genralized Rayleigh quotient</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda算法流程" id="toc-lda算法流程"><span class="toc-section-number">37.2.4</span> LDA算法流程</a></li>
<li><a href="linear-discriminant-analysis-lda.html#lda-application" id="toc-lda-application"><span class="toc-section-number">37.2.5</span> LDA Application</a></li>
<li><a href="linear-discriminant-analysis-lda.html#qda-1" id="toc-qda-1"><span class="toc-section-number">37.2.6</span> QDA</a></li>
</ul></li>
</ul></li>
<li><a href="neural-network.html#neural-network" id="toc-neural-network"><span class="toc-section-number">38</span> Neural Network</a>
<ul>
<li><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">38.1</span> Introduction</a></li>
<li><a href="neural-network.html#反向传播方法进行训练的前馈神经网络" id="toc-反向传播方法进行训练的前馈神经网络"><span class="toc-section-number">38.2</span> 反向传播方法进行训练的前馈神经网络</a></li>
<li><a href="glmm-and-gam.html#application" id="toc-application"><span class="toc-section-number">38.3</span> Application</a>
<ul>
<li><a href="neural-network.html#数据准备" id="toc-数据准备"><span class="toc-section-number">38.3.1</span> 数据准备</a></li>
<li><a href="neural-network.html#模型构建" id="toc-模型构建"><span class="toc-section-number">38.3.2</span> 模型构建</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">As a Statistician</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> ggplot2</h1>
<div id="htmlwidget-24da0019bcdbe49c063b" style="width:672px;height:480px;" class="markmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-24da0019bcdbe49c063b">{"x":{"data":"# \n## ggplot2\n### Parametric Rendering\n#### Grammar\n#### Coordinate system\n#### Legend\n#### geom\n#### position\n#### scale\n#### stat\n#### Color\n#### Thema\n#### Saving plots\n### Scatter plot\n#### Grouping Aesthetic\n#### facet\n#### geom_smooth\n#### Dot Plot\n#### Label and Title\n#### Residuals\n#### Encircling\n#### Dumbbell Plot \n### Histogram \n#### General appearance\n#### Themes\n#### geom_freqpoly()\n#### Marginal Histogram / Boxplot\n#### Scales\n### Bar plot\n#### Aesthetic\n#### Proportion\n#### coord\n#### stat=\"identity\"\n#### Ranking\n#### Means and error bars\n#### Waffle Chart\n### Box plot\n#### varwidth\n#### Reorder\n#### Fill\n#### stat=\"identity\"\n#### Dot + Box Plot \n#### Violin Plot \n### Other rendering \n#### Annotation\n#### Text: ggtext\n#### Text: ggrepel\n#### Arrage: gridExtra\n#### Interactive charts: plotly\n### DiagrammeR\n#### Basic flowchart using `grViz`\n#### Graphviz Attributes\n#### Gantt chart\n### ggstatsplot\n#### ggbetweenstats","options":{"preset":"colorful","autoFit":true}},"evals":[],"jsHooks":[]}</script>
<div id="parametric-rendering" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Parametric Rendering</h2>
<div id="grammar" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Grammar</h3>
<p>ggplot2 implements the idea of a “grammar of graphics”. The grammar implemented by ggplot2 could be summarized as follows:</p>
<ul>
<li>plot ::= coord scale+ facet? layer+</li>
<li>layer ::= data mapping stat geom position?</li>
</ul>
<p>A plot is defined by a coordinate system (coord), one or more scales (scale), an optional faceting specification (facet), and one or more layers (layer). A layer is defined as an R data frame (data), a specification mapping columns of that frame into aesthetic properties (mapping), a statistical approach to summarize the rows of that frame (stat), a geometric object to visually represent that summary (geom), and an optional position adjustment to move overlapping geometric objects out of their way (position).</p>
</div>
<div id="coordinate-system" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Coordinate system</h3>
<ul>
<li><strong>coord</strong></li>
</ul>
<!-- coord_cartesian（默认）笛卡尔坐标系, coord_flip 直角坐标系 -->
<pre><code>* coord_cartesian - (default) cartesian coordinate system (x horizontal from left to right, y vertical from bottom to top)
* coord_flip - flipped cartesian coordinate system (x vertical from bottom to top, y horizontal from left to right)
* coord_trans
* coord_equal
* coord_polar - polar coordinate system; the x (or y) scale is mapped to the angle (theta)
* coord_map - various map projections</code></pre>
<ul>
<li><p><strong>facet</strong></p>
<ul>
<li>facet_wrap(~cell) - univariate: create a 1-d strip of panels, based on one factor, and wrap the strip into a 2-d matrix</li>
<li>facet_grid(row~col) - (usually) bivariate: create a 2-d matrix of panels, based on two factors</li>
</ul></li>
<li><p>Modify the display <strong>range</strong> of the axis</p>
<p>scale_x_continuous(break, lables, …)
scale_y_continuous
…</p></li>
<li><p>Modify the label of the axis (<strong>content, size, font, color, bold, position, angle</strong>)</p>
<ol style="list-style-type: decimal">
<li><ul>
<li>labs(subtitle=“…..”, title=“…..”, y=“…..”, x=“…..”)</li>
</ul></li>
<li><ul>
<li>ggtitle(title=“…..”, subtitle=“…..”) + xlab(“…..”) + ylab(“…..”)</li>
</ul></li>
</ol>
<p>Change label of x axis</p>
<ul>
<li>xlab(“…..”) + theme(axis.title.x = element_text(size=12, color=“green”, face=“bold”,vjust=0.5,hjust=0.5,angle=45))</li>
</ul></li>
<li><p>Remove the axis <strong>tick marks</strong></p>
<p>theme(panel.grid = element_blank())
theme(axis.text = element_blank())
theme(axis.ticks = element_blank())
theme(axis.ticks.y = element_blank())</p></li>
</ul>
</div>
<div id="legend" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Legend</h3>
<ul>
<li><p>Change the legend title</p>
<ol style="list-style-type: decimal">
<li>p + labs(fill = “Type”)</li>
<li>order p + guides(fill = guide_legend(title = ‘Type’))</li>
</ol></li>
<li><p>Change the legend position</p>
<ol style="list-style-type: decimal">
<li><p>“left”,“top”, “right”, “bottom”, “none”
p + theme(legend.position=“top”)</p></li>
<li><p>order given numerical position coordinates
p + theme(legend.position = c(0.7, 0.1),
legend.direction = “horizontal”)</p></li>
</ol></li>
<li><p>Reverse legend order</p>
<ol style="list-style-type: decimal">
<li>p + guides(fill = guide_legend(reverse=TRUE))</li>
<li>p + scale_fill_discrete(guide = guide_legend(reverse=TRUE))</li>
<li>p + scale_fill_discrete(breaks = rev(levels(iris$Species)))</li>
</ol></li>
<li><p>Change labels and order</p>
<ol style="list-style-type: decimal">
<li><p>Change the x order
p + scale_x_discrete(limits=c(“versicolor”, “virginica”, “setosa”))</p></li>
<li><p>Change legend label name
p + scale_fill_discrete(name = “Species”, labels = c(“S”, “V1”, “V2”))</p></li>
</ol></li>
<li><p>Change legend color</p>
<p>p + scale_fill_manual(values = c(“#d8b365”, “#f5f5f5”, “#5ab4ac”))</p></li>
<li><p>Remove legend</p>
<ol style="list-style-type: decimal">
<li>p + theme(legend.position = “none”)</li>
<li>p + guides(fill=FALSE)</li>
<li>Modify multiple legends: remove two</li>
</ol>
<p>data(mtcars)
mtcars<span class="math inline">\(cyl&lt;-as.factor(mtcars\)</span>cyl)
mtcars<span class="math inline">\(gear &lt;- as.factor(mtcars\)</span>gear)
p &lt;- ggplot(data = mtcars, aes(x = mpg, y = wt))+
geom_point(aes(color = cyl, size = qsec, shape = gear)) + theme_bw()
p + guides(shape = FALSE, size = FALSE)</p></li>
<li><p>Change legend font (color, size)</p>
<p>p + theme(legend.title = element_text(color = “blue”, size = 15),
legend.text = element_text(color = “orange”, size = 12))</p></li>
<li><p>Change legend background</p>
<p>p + theme(
# Change legend background color
legend.background = element_rect(fill = “gray”),
legend.key = element_rect(fill = “yellow”, color = NA),
# Change legend key size and key width
legend.key.size = unit(1.5, “cm”),
legend.key.width = unit(1,“cm”)
)</p></li>
<li><p>Add legend outer border</p>
<p>p + theme(
legend.background = element_rect(color = “blue”, linetype = “solid”, size = 1)
)</p></li>
</ul>
</div>
<div id="geom" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> geom</h3>
<table>
<colgroup>
<col width="5%" />
<col width="14%" />
<col width="13%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th>geom</th>
<th>Useful stats (default in bold)</th>
<th>Default position adjustment</th>
<th>Parameters (when used with given stat)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>blank</td>
<td>identity</td>
<td>identity</td>
<td>no parameters</td>
</tr>
<tr class="even">
<td>abline</td>
<td>abline</td>
<td>identity</td>
<td>slope, intercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>slope, intercept, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>hline</td>
<td>hline</td>
<td>identity</td>
<td>yintercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>y, yend, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>vline</td>
<td>vline</td>
<td>identity</td>
<td>xintercept, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td></td>
<td>identity</td>
<td>identity</td>
<td>x, xend, size, linetype, colour, alpha</td>
</tr>
<tr class="even">
<td>text</td>
<td>identity</td>
<td>identity</td>
<td>x, y, label, size, colour, alpha, hjust, vjust, parse</td>
</tr>
<tr class="odd">
<td>point</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, shape, colour, fill, alpha, na.rm</td>
</tr>
<tr class="even">
<td>jitter</td>
<td>identity</td>
<td>jitter</td>
<td>x, y, size, shape, colour, fill, alpha, na.rm</td>
</tr>
<tr class="odd">
<td>segment</td>
<td>identity</td>
<td>identity</td>
<td>x, xend, y, yend, size, linetype, colour, alpha, arrow</td>
</tr>
<tr class="even">
<td>line</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, arrow</td>
</tr>
<tr class="odd">
<td>bar</td>
<td>identity</td>
<td>stack</td>
<td>x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>bin</td>
<td>stack</td>
<td>x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>histogram</td>
<td>alias for geom_bar</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>area</td>
<td>identity</td>
<td>stack</td>
<td>group, x, y, size, linetype, colour, fill, alpha, na.rm</td>
</tr>
<tr class="odd">
<td>ribbon</td>
<td>identity</td>
<td>identity</td>
<td>group, x, ymin, ymax, size, linetype, colour, fill, alpha, na.rm</td>
</tr>
<tr class="even">
<td>linerange</td>
<td>identity</td>
<td>identity</td>
<td>x, ymin, ymax, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td>pointrange</td>
<td>identity</td>
<td>identity</td>
<td>x, y, ymin, ymax, size, shape, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td>errorbar</td>
<td>identity</td>
<td>identity</td>
<td>x, ymin, ymax, size, linetype, colour, alpha, width</td>
</tr>
<tr class="odd">
<td>errorbarh</td>
<td>identity</td>
<td>identity</td>
<td>x, xmin, xmax, y, size, linetype, colour, alpha, height</td>
</tr>
<tr class="even">
<td>crossbar</td>
<td>identity</td>
<td>identity</td>
<td>x, y, ymin, ymax, size, linetype, colour, fill, alpha, width, fatten</td>
</tr>
<tr class="odd">
<td>boxplot</td>
<td>identity</td>
<td>dodge</td>
<td>x, ymin, lower, middle, upper, ymax, size, colour, fill, alpha, weight(?), width(?), outliers(?), outlier.size, outlier.shape, outlier.colour ???</td>
</tr>
<tr class="even">
<td></td>
<td>boxplot</td>
<td>dodge</td>
<td>x, ymin, lower, middle, upper, ymax, size, colour, fill, alpha, weight(?), width(?), outliers(?), outlier.size, outlier.shape, outlier.colour ???</td>
</tr>
<tr class="odd">
<td>path</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="even">
<td>polygon</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>rect</td>
<td>identity</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td>rug</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, linetype, colour, alpha</td>
</tr>
<tr class="odd">
<td>step</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, direction</td>
</tr>
<tr class="even">
<td>bin2d</td>
<td>identity</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td></td>
<td>bin2d</td>
<td>identity</td>
<td>xmin, xmax, ymin, ymax, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td>tile</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>hex</td>
<td>identity</td>
<td>identity</td>
<td>x, y, size, colour, fill, alpha</td>
</tr>
<tr class="even">
<td></td>
<td>binhex</td>
<td>identity</td>
<td>x, y, size, colour, fill, alpha</td>
</tr>
<tr class="odd">
<td>density</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>density</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>density2d</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="even">
<td></td>
<td>density2d</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="odd">
<td>contour</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="even">
<td></td>
<td>contour</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?), na.rm, arrow, linemitre, linejoin, lineend ???</td>
</tr>
<tr class="odd">
<td>freqpoly</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?) ???</td>
</tr>
<tr class="even">
<td></td>
<td>bin</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight(?) ???</td>
</tr>
<tr class="odd">
<td>quantile</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="even">
<td></td>
<td>quantile</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, alpha, weight, quantiles, formula, xseq, method, na.rm, arrow, linemitre, linejoin, lineend</td>
</tr>
<tr class="odd">
<td>smooth</td>
<td>identity</td>
<td>identity</td>
<td>group, x, y, ymin, ymax, size, linetype, colour, fill, alpha</td>
</tr>
<tr class="even">
<td></td>
<td>smooth</td>
<td>identity</td>
<td>group, x, y, size, linetype, colour, fill, alpha, weight</td>
</tr>
</tbody>
</table>
</div>
<div id="position" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> position</h3>
<ul>
<li>position_identity - default of most geoms</li>
<li>position_jitter - default of geom_jitter</li>
<li>position_dodge - default of geom_boxplot</li>
<li>position_stack - default of geom_bar==geom_histogram and geom_area</li>
<li>position_fill - useful for geom_bar==geom_histogram and geom_area</li>
</ul>
</div>
<div id="scale" class="section level3" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> scale</h3>
<ul>
<li>size - size of a geom</li>
<li>shape - shape of a geom</li>
<li>linetype - type of a geom’s outline (e.g., dashed, dotted)</li>
<li>colour - color of a geom’s outline</li>
<li>fill - color of a geom’s fill</li>
<li>alpha - transparency of a geom (0=transparent … 1=opaque)</li>
</ul>
<p>Functions that ggplot2 provides to define each of the above kinds of scales.</p>
<ul>
<li>x (or y) position
<ul>
<li>scale_x_continuous</li>
<li>scale_x_date</li>
<li>scale_x_datetime</li>
<li>scale_x_discrete</li>
</ul></li>
<li>size
<ul>
<li>scale_size_continuous</li>
<li>scale_area</li>
<li>scale_size_discrete</li>
<li>scale_size_identity</li>
<li>scale_size_manual</li>
</ul></li>
<li>shape
<ul>
<li>scale_shape_discrete</li>
<li>scale_shape_identity</li>
<li>scale_shape_manual</li>
</ul></li>
<li>linetype
<ul>
<li>scale_linetype_discrete</li>
<li>scale_linetype_identity</li>
<li>scale_linetype_manual</li>
</ul></li>
<li>colour (or fill)
<ul>
<li>scale_colour_gradient</li>
<li>scale_colour_gradient2</li>
<li>scale_colour_gradientn</li>
<li>scale_colour_hue</li>
<li>scale_colour_brewer</li>
<li>scale_colour_grey</li>
<li>scale_colour_identity</li>
<li>scale_colour_manual</li>
</ul></li>
<li>alpha
<ul>
<li>scale_alpha_continuous</li>
</ul></li>
</ul>
</div>
<div id="stat" class="section level3" number="4.1.7">
<h3><span class="header-section-number">4.1.7</span> stat</h3>
<ul>
<li>stat_abline - used by geom_abline</li>
<li>stat_bin - used by geom_bar == geom_histogram, and geom_freqpoly</li>
<li>stat_bin2d - used by geom_bin2d</li>
<li>stat_binhex - used by geom_hex</li>
<li>stat_boxplot - used by geom_boxplot</li>
<li>stat_contour - used by geom_contour</li>
<li>stat_density - used by geom_density</li>
<li>stat_density2d - used by geom_density2d</li>
<li>stat_ecdf</li>
<li>stat_function</li>
<li>stat_hline - used by geom_hline</li>
<li>stat_identity - used by a large number of geoms</li>
<li>stat_qq</li>
<li>stat_quantile - used by geom_quantile</li>
<li>stat_smooth - used by geom_smooth</li>
<li>stat_spoke</li>
<li>stat_sum</li>
<li>stat_summary</li>
<li>stat_unique</li>
<li>stat_vline - used by geom_vline</li>
</ul>
</div>
<div id="color" class="section level3" number="4.1.8">
<h3><span class="header-section-number">4.1.8</span> Color</h3>
<ul>
<li><a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">ColorBrewer scales</a></li>
<li>Hexadecimal color code chart</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:Hexadecimal"></span>
<img src="02_Plots/ggplot2_Hexadecimal_Color_Code.png" alt="Figure: Hexadecimal color code chart" width="100%" />
<p class="caption">
Figure 4.1: Figure: Hexadecimal color code chart
</p>
</div>
</div>
<div id="thema" class="section level3" number="4.1.9">
<h3><span class="header-section-number">4.1.9</span> Thema</h3>
<ul>
<li>theme_grey() - the default theme, with a grey background</li>
<li>theme_bw() - a theme with a white background</li>
</ul>
<p>ggplot2 includes eight themes by default, as shown in Figure. Many more are included in add-on packages like <a href="https://github.com/jrnold/ggthemes">ggthemes</a>, by Jeffrey Arnold.</p>
<div class="figure" style="text-align: center"><span id="fig:Thema"></span>
<img src="02_Plots/ggplot2_ggthemes.png" alt="Figure: ggplot2 Thema" width="100%" />
<p class="caption">
Figure 4.2: Figure: ggplot2 Thema
</p>
</div>
</div>
<div id="saving-plots" class="section level3" number="4.1.10">
<h3><span class="header-section-number">4.1.10</span> Saving plots</h3>
<pre><code># Save the plot
ggsave(p, filename = &quot;chartFromRPractical.png&quot;)</code></pre>
</div>
</div>
<div id="scatter-plot" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Scatter plot</h2>
<div id="grouping-aesthetic" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Grouping Aesthetic</h3>
<ul>
<li>Color Aesthetic</li>
<li>Size Aesthetic</li>
<li>Alpha Aesthetic</li>
<li>Shape Aesthetic</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ggplot2.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="ggplot2.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Color Aesthetic</span></span>
<span id="cb3-3"><a href="ggplot2.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="ggplot2.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ggplot2.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set the aesthetic properties of your geom manually</span></span>
<span id="cb4-2"><a href="ggplot2.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="ggplot2.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ggplot2.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Size Aesthetic</span></span>
<span id="cb5-2"><a href="ggplot2.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="ggplot2.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ggplot2.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Alpha aesthetic, which controls the transparency of the points</span></span>
<span id="cb6-2"><a href="ggplot2.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="ggplot2.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ggplot2.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## shape aesthetic</span></span>
<span id="cb7-2"><a href="ggplot2.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="ggplot2.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="ggplot2.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb8-2"><a href="ggplot2.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb8-3"><a href="ggplot2.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="ggplot2.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="ggplot2.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#3399CC&quot;</span>,<span class="st">&quot;#33FF33&quot;</span>,<span class="st">&quot;#FFCC33&quot;</span>))<span class="sc">+</span></span>
<span id="cb8-6"><a href="ggplot2.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="ggplot2.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Petal Length&quot;</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">&quot;Petal Width&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="ggplot2.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-9"><a href="ggplot2.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Petal Width and Length&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="ggplot2.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb8-11"><a href="ggplot2.html#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-12"><a href="ggplot2.html#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.85</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/the%20aesthetic-6.png" width="672" /></p>
</div>
<div id="facet" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> facet</h3>
<p>facet_wrap(), “winding facet”, only one standard can be applied to data classification, and the small shapes obtained from different sets of data are arranged in the order of “winding” from left to right and from top to bottom</p>
<p>facet_grid(), facet the drawing of the combination of two variables</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ggplot2.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="ggplot2.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="ggplot2.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span> class, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="ggplot2.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="ggplot2.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="ggplot2.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> class)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-2.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ggplot2.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="ggplot2.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="ggplot2.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-3.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ggplot2.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="ggplot2.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="ggplot2.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/facet_wrap%20and%20facet_grid-4.png" width="672" /></p>
<p><strong>Replacing facet strips with text boxes using ggtext::</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ggplot2.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cowplot&quot;</span>)</span>
<span id="cb13-2"><a href="ggplot2.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="ggplot2.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="ggplot2.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="ggplot2.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class) <span class="sc">+</span></span>
<span id="cb13-6"><a href="ggplot2.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_half_open</span>(<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="ggplot2.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_grid</span>() </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Replacing%20facet%20strips-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="ggplot2.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggtext&quot;</span>)</span>
<span id="cb14-2"><a href="ggplot2.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="ggplot2.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="ggplot2.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class) <span class="sc">+</span></span>
<span id="cb14-5"><a href="ggplot2.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_half_open</span>(<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="ggplot2.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_grid</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="ggplot2.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-8"><a href="ggplot2.html#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-9"><a href="ggplot2.html#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_textbox</span>(</span>
<span id="cb14-10"><a href="ggplot2.html#cb14-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb14-11"><a href="ggplot2.html#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#5D729D&quot;</span>, <span class="at">box.color =</span> <span class="st">&quot;#4A618C&quot;</span>,</span>
<span id="cb14-12"><a href="ggplot2.html#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">halign =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb14-13"><a href="ggplot2.html#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb14-14"><a href="ggplot2.html#cb14-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-15"><a href="ggplot2.html#cb14-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Replacing%20facet%20strips-2.png" width="672" /></p>
</div>
<div id="geom_smooth" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> geom_smooth</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ggplot2.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## display different aesthetics in different layers</span></span>
<span id="cb15-2"><a href="ggplot2.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="ggplot2.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="ggplot2.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="ggplot2.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## no aesthetic just grouping</span></span>
<span id="cb16-2"><a href="ggplot2.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb16-3"><a href="ggplot2.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">group =</span> drv)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="ggplot2.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ggplot2.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## linetype aesthetic set the shape of a point</span></span>
<span id="cb17-2"><a href="ggplot2.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="ggplot2.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linetype =</span> drv))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="ggplot2.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## color aesthetic</span></span>
<span id="cb18-2"><a href="ggplot2.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb18-3"><a href="ggplot2.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb18-4"><a href="ggplot2.html#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv),</span>
<span id="cb18-5"><a href="ggplot2.html#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb18-6"><a href="ggplot2.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ggplot2.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear line</span></span>
<span id="cb19-2"><a href="ggplot2.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy))<span class="sc">+</span></span>
<span id="cb19-3"><a href="ggplot2.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb19-4"><a href="ggplot2.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb19-5"><a href="ggplot2.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb19-6"><a href="ggplot2.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, </span>
<span id="cb19-7"><a href="ggplot2.html#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;hwy&quot;</span>, </span>
<span id="cb19-8"><a href="ggplot2.html#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;cty&quot;</span>, </span>
<span id="cb19-9"><a href="ggplot2.html#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Scatterplot with overlapping points&quot;</span>, </span>
<span id="cb19-10"><a href="ggplot2.html#cb19-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="ggplot2.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The raw dataset has 234 observations, but shown in figure fewer, because some points lay together, the jitter plot could be used in this case by applying jitter_geom</span></span>
<span id="cb20-2"><a href="ggplot2.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy))<span class="sc">+</span></span>
<span id="cb20-3"><a href="ggplot2.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-4"><a href="ggplot2.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-5"><a href="ggplot2.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">5</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="ggplot2.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, </span>
<span id="cb20-7"><a href="ggplot2.html#cb20-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;hwy&quot;</span>, </span>
<span id="cb20-8"><a href="ggplot2.html#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;cty&quot;</span>, </span>
<span id="cb20-9"><a href="ggplot2.html#cb20-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Jittered Points&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Grouping%20Aesthetic-6.png" width="672" /></p>
</div>
<div id="dot-plot" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Dot Plot</h3>
<p>Order <code>fct_reorder</code>: Modifying factor order</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ggplot2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb21-2"><a href="ggplot2.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-3"><a href="ggplot2.html#cb21-3" aria-hidden="true" tabindex="-1"></a>relig_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="ggplot2.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(relig) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="ggplot2.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-6"><a href="ggplot2.html#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-7"><a href="ggplot2.html#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-8"><a href="ggplot2.html#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb21-9"><a href="ggplot2.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-10"><a href="ggplot2.html#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="ggplot2.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(tvhours, relig)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/fct_reorder-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="ggplot2.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(tvhours, <span class="fu">fct_reorder</span>(relig, tvhours))) <span class="sc">+</span></span>
<span id="cb22-2"><a href="ggplot2.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/fct_reorder-2.png" width="672" /></p>
<p><strong>Diverging Dot Plot </strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ggplot2.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Prep</span></span>
<span id="cb23-2"><a href="ggplot2.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)  <span class="co"># load data</span></span>
<span id="cb23-3"><a href="ggplot2.html#cb23-3" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)  <span class="co"># create new column for car names</span></span>
<span id="cb23-4"><a href="ggplot2.html#cb23-4" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>mpg_z <span class="ot">&lt;-</span> <span class="fu">round</span>((mtcars<span class="sc">$</span>mpg <span class="sc">-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg))<span class="sc">/</span><span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg), <span class="dv">2</span>)  <span class="co"># compute normalized mpg</span></span>
<span id="cb23-5"><a href="ggplot2.html#cb23-5" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>mpg_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg_z <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;below&quot;</span>, <span class="st">&quot;above&quot;</span>)  <span class="co"># above / below avg flag</span></span>
<span id="cb23-6"><a href="ggplot2.html#cb23-6" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars[<span class="fu">order</span>(mtcars<span class="sc">$</span>mpg_z), ]  <span class="co"># sort</span></span>
<span id="cb23-7"><a href="ggplot2.html#cb23-7" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">levels =</span> mtcars<span class="sc">$</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>)  <span class="co"># convert to factor to retain sorted order in plot.</span></span>
<span id="cb23-8"><a href="ggplot2.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="ggplot2.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="ggplot2.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb23-11"><a href="ggplot2.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="fu">aes</span>(<span class="at">col=</span>mpg_type), <span class="at">size=</span><span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb23-12"><a href="ggplot2.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Mileage&quot;</span>, </span>
<span id="cb23-13"><a href="ggplot2.html#cb23-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), </span>
<span id="cb23-14"><a href="ggplot2.html#cb23-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;above&quot;</span><span class="ot">=</span><span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span><span class="ot">=</span><span class="st">&quot;#f8766d&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="ggplot2.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="ggplot2.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Diverging Dot Plot&quot;</span>, </span>
<span id="cb23-17"><a href="ggplot2.html#cb23-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Dotplot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb23-18"><a href="ggplot2.html#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="ggplot2.html#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ggplot2.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Diverging Lollipop Chart</span></span>
<span id="cb24-2"><a href="ggplot2.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="ggplot2.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="at">fill=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb24-4"><a href="ggplot2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb24-5"><a href="ggplot2.html#cb24-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">`</span><span class="at">car name</span><span class="st">`</span>, </span>
<span id="cb24-6"><a href="ggplot2.html#cb24-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> mpg_z, </span>
<span id="cb24-7"><a href="ggplot2.html#cb24-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">car name</span><span class="st">`</span>), </span>
<span id="cb24-8"><a href="ggplot2.html#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="ggplot2.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="ggplot2.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Diverging Lollipop Chart&quot;</span>, </span>
<span id="cb24-11"><a href="ggplot2.html#cb24-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Lollipop&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-12"><a href="ggplot2.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="ggplot2.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ggplot2.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diverging Barcharts</span></span>
<span id="cb25-2"><a href="ggplot2.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">car name</span><span class="st">`</span>, <span class="at">y=</span>mpg_z, <span class="at">label=</span>mpg_z)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="ggplot2.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>mpg_type), <span class="at">width=</span>.<span class="dv">5</span>)  <span class="sc">+</span></span>
<span id="cb25-4"><a href="ggplot2.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Mileage&quot;</span>, </span>
<span id="cb25-5"><a href="ggplot2.html#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), </span>
<span id="cb25-6"><a href="ggplot2.html#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;above&quot;</span><span class="ot">=</span><span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span><span class="ot">=</span><span class="st">&quot;#f8766d&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb25-7"><a href="ggplot2.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Normalised mileage from &#39;mtcars&#39;&quot;</span>, </span>
<span id="cb25-8"><a href="ggplot2.html#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span> <span class="st">&quot;Diverging Bars&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="ggplot2.html#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="ggplot2.html#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Diverging%20Dot%20Plot%20-3.png" width="672" /></p>
</div>
<div id="label-and-title" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Label and Title</h3>
<p><code>+ ggtitle("Area Vs Population", subtitle="From midwest dataset") + xlab("Area") + ylab("Population")</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ggplot2.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="ggplot2.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb26-3"><a href="ggplot2.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-4"><a href="ggplot2.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000000</span>)) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="ggplot2.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Area Vs Population&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;From midwest dataset&quot;</span>, <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, <span class="at">x=</span><span class="st">&quot;Area&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Midwest Demographics&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtitle-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ggplot2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Or</span></span>
<span id="cb27-2"><a href="ggplot2.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="ggplot2.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb27-4"><a href="ggplot2.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="ggplot2.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000000</span>)) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="ggplot2.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Area Vs Population&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;From midwest dataset&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Area&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Population&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtitle-2.png" width="672" /></p>
<p><strong>Change the Title rendering using ggtext::element_textbox()</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="ggplot2.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(disp, mpg)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="ggplot2.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="ggplot2.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-4"><a href="ggplot2.html#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;&lt;b&gt;Fuel economy vs. engine displacement&lt;/b&gt;&lt;br&gt;</span></span>
<span id="cb28-5"><a href="ggplot2.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;span style = &#39;font-size:10pt&#39;&gt;Lorem ipsum *dolor sit amet,*</span></span>
<span id="cb28-6"><a href="ggplot2.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">    consectetur adipiscing elit, **sed do eiusmod tempor incididunt** ut</span></span>
<span id="cb28-7"><a href="ggplot2.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">    labore et dolore magna aliqua. &lt;span style = &#39;color:red;&#39;&gt;Ut enim</span></span>
<span id="cb28-8"><a href="ggplot2.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">    ad minim veniam,&lt;/span&gt; quis nostrud exercitation ullamco laboris nisi</span></span>
<span id="cb28-9"><a href="ggplot2.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ut aliquip ex ea commodo consequat.&lt;/span&gt;&quot;</span>,</span>
<span id="cb28-10"><a href="ggplot2.html#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;displacement (in&lt;sup&gt;3&lt;/sup&gt;)&quot;</span>,</span>
<span id="cb28-11"><a href="ggplot2.html#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Miles per gallon (mpg)&lt;br&gt;&lt;span style = &#39;font-size:8pt&#39;&gt;A measure of</span></span>
<span id="cb28-12"><a href="ggplot2.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">    the car&#39;s fuel efficiency.&lt;/span&gt;&quot;</span></span>
<span id="cb28-13"><a href="ggplot2.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-14"><a href="ggplot2.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-15"><a href="ggplot2.html#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb28-16"><a href="ggplot2.html#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-17"><a href="ggplot2.html#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">13</span>,</span>
<span id="cb28-18"><a href="ggplot2.html#cb28-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lineheight =</span> <span class="dv">1</span>,</span>
<span id="cb28-19"><a href="ggplot2.html#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fl">5.5</span>),</span>
<span id="cb28-20"><a href="ggplot2.html#cb28-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>),</span>
<span id="cb28-21"><a href="ggplot2.html#cb28-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;cornsilk&quot;</span></span>
<span id="cb28-22"><a href="ggplot2.html#cb28-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-23"><a href="ggplot2.html#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-24"><a href="ggplot2.html#cb28-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-25"><a href="ggplot2.html#cb28-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb28-26"><a href="ggplot2.html#cb28-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb28-27"><a href="ggplot2.html#cb28-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb28-28"><a href="ggplot2.html#cb28-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="dv">8</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb28-29"><a href="ggplot2.html#cb28-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;azure1&quot;</span></span>
<span id="cb28-30"><a href="ggplot2.html#cb28-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-31"><a href="ggplot2.html#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_textbox_simple</span>(</span>
<span id="cb28-32"><a href="ggplot2.html#cb28-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb28-33"><a href="ggplot2.html#cb28-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">orientation =</span> <span class="st">&quot;left-rotated&quot;</span>,</span>
<span id="cb28-34"><a href="ggplot2.html#cb28-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">minwidth =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb28-35"><a href="ggplot2.html#cb28-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxwidth =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;in&quot;</span>),</span>
<span id="cb28-36"><a href="ggplot2.html#cb28-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb28-37"><a href="ggplot2.html#cb28-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb28-38"><a href="ggplot2.html#cb28-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;lightsteelblue1&quot;</span></span>
<span id="cb28-39"><a href="ggplot2.html#cb28-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-40"><a href="ggplot2.html#cb28-40" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/element_textbox-1.png" width="672" /></p>
</div>
<div id="residuals" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Residuals</h3>
<pre><code>modf2 &lt;- fortify(lm(formular, data = rf10_comp))
ggplot(modf2, aes(x = modf$bmi, y = .resid)) + geom_point()+
  geom_hline(aes(yintercept=0), colour=&quot;#990000&quot;) +
  labs(title=&quot;Residuals plot for BMI using MICE RF with 10 trees&quot;,
       x = &quot;BMI&quot;,
       y = &quot;Residuals&quot;)+
  theme_classic()
  
## Standardized Residuals
modf &lt;- fortify(lm(formular, data = data))
ggplot(modf, aes(x = modf$bmi, y = .stdresid)) + geom_point()+
  geom_hline(aes(yintercept=0), colour=&quot;#990000&quot;) +
  labs(title=&quot;Standardised residuals plot for BMI using Full data&quot;,
       x = &quot;BMI&quot;,
       y = &quot;Residuals&quot;)+
  theme_classic()</code></pre>
</div>
<div id="encircling" class="section level3" number="4.2.7">
<h3><span class="header-section-number">4.2.7</span> Encircling</h3>
<p>In geom_encircle(), set the data to a new data frame containing only points (rows) or points of interest. In addition, you can expand the curve so that it passes outside the point. The color and size (thickness) of the curve can also be modified.</p>
<!-- 在图表中加上某些特殊的点或区域组，以便引起人们对这些特殊情况的注意。 可以使用ggalt包中的geom_encircle（）方便地完成此操作。 -->
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="ggplot2.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install &#39;ggalt&#39; pkg</span></span>
<span id="cb30-2"><a href="ggplot2.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span></span>
<span id="cb30-3"><a href="ggplot2.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb30-4"><a href="ggplot2.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb30-5"><a href="ggplot2.html#cb30-5" aria-hidden="true" tabindex="-1"></a>midwest_select <span class="ot">&lt;-</span> midwest[midwest<span class="sc">$</span>poptotal <span class="sc">&gt;</span> <span class="dv">350000</span> <span class="sc">&amp;</span> </span>
<span id="cb30-6"><a href="ggplot2.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>poptotal <span class="sc">&lt;=</span> <span class="dv">500000</span> <span class="sc">&amp;</span> </span>
<span id="cb30-7"><a href="ggplot2.html#cb30-7" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>area <span class="sc">&gt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> </span>
<span id="cb30-8"><a href="ggplot2.html#cb30-8" aria-hidden="true" tabindex="-1"></a>                            midwest<span class="sc">$</span>area <span class="sc">&lt;</span> <span class="fl">0.1</span>, ]</span>
<span id="cb30-9"><a href="ggplot2.html#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="ggplot2.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb30-11"><a href="ggplot2.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb30-12"><a href="ggplot2.html#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>state, <span class="at">size=</span>popdensity)) <span class="sc">+</span>   <span class="co"># draw points</span></span>
<span id="cb30-13"><a href="ggplot2.html#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span> </span>
<span id="cb30-14"><a href="ggplot2.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb30-15"><a href="ggplot2.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) <span class="sc">+</span>   <span class="co"># draw smoothing line</span></span>
<span id="cb30-16"><a href="ggplot2.html#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_encircle</span>(<span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal), </span>
<span id="cb30-17"><a href="ggplot2.html#cb30-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>midwest_select, </span>
<span id="cb30-18"><a href="ggplot2.html#cb30-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb30-19"><a href="ggplot2.html#cb30-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="dv">2</span>, </span>
<span id="cb30-20"><a href="ggplot2.html#cb30-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">expand=</span><span class="fl">0.08</span>) <span class="sc">+</span>   <span class="co"># encircle</span></span>
<span id="cb30-21"><a href="ggplot2.html#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Area Vs Population&quot;</span>, </span>
<span id="cb30-22"><a href="ggplot2.html#cb30-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, </span>
<span id="cb30-23"><a href="ggplot2.html#cb30-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Area&quot;</span>, </span>
<span id="cb30-24"><a href="ggplot2.html#cb30-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Scatterplot + Encircle&quot;</span>, </span>
<span id="cb30-25"><a href="ggplot2.html#cb30-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Encircling%20for%20emphasizen-1.png" width="672" /></p>
</div>
<div id="dumbbell-plot" class="section level3" number="4.2.8">
<h3><span class="header-section-number">4.2.8</span> Dumbbell Plot</h3>
<p>Dumbbell plot is used to visualize the relative position of two time points (increase or decrease), it could also be used to compare the distance between 2 categories. In order to get right orders of dumbbell, the variable <span class="math inline">\(Y\)</span> should be treated as factor with conresponding orders shown in figure.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ggplot2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggalt) </span></span>
<span id="cb31-2"><a href="ggplot2.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb31-3"><a href="ggplot2.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># health &lt;- read.csv(&quot;https://raw.githubusercontent.com/selva86/datasets/master/health.csv&quot;)</span></span>
<span id="cb31-4"><a href="ggplot2.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># health$Area &lt;- factor(health$Area, levels=as.character(health$Area))  # for right ordering of the dumbells</span></span>
<span id="cb31-5"><a href="ggplot2.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb31-6"><a href="ggplot2.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # health$Area &lt;- factor(health$Area)</span></span>
<span id="cb31-7"><a href="ggplot2.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(health, aes(x=pct_2013, xend=pct_2014, y=Area, group=Area)) + </span></span>
<span id="cb31-8"><a href="ggplot2.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_dumbbell(color=&quot;#a3c4dc&quot;, </span></span>
<span id="cb31-9"><a href="ggplot2.html#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                 size=0.75, </span></span>
<span id="cb31-10"><a href="ggplot2.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                 point.colour.l=&quot;#0e668b&quot;) + </span></span>
<span id="cb31-11"><a href="ggplot2.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x=NULL, </span></span>
<span id="cb31-12"><a href="ggplot2.html#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        y=NULL, </span></span>
<span id="cb31-13"><a href="ggplot2.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        title=&quot;Dumbbell Chart&quot;, </span></span>
<span id="cb31-14"><a href="ggplot2.html#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#        subtitle=&quot;Pct Change: 2013 vs 2014&quot;, </span></span>
<span id="cb31-15"><a href="ggplot2.html#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#        caption=&quot;Source: https://github.com/hrbrmstr/ggalt&quot;) +</span></span>
<span id="cb31-16"><a href="ggplot2.html#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic()+</span></span>
<span id="cb31-17"><a href="ggplot2.html#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;),</span></span>
<span id="cb31-18"><a href="ggplot2.html#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background=element_rect(fill=&quot;#f7f7f7&quot;),</span></span>
<span id="cb31-19"><a href="ggplot2.html#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background=element_rect(fill=&quot;#f7f7f7&quot;),</span></span>
<span id="cb31-20"><a href="ggplot2.html#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.grid.minor=element_blank(),</span></span>
<span id="cb31-21"><a href="ggplot2.html#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.grid.major.y=element_blank(),</span></span>
<span id="cb31-22"><a href="ggplot2.html#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.grid.major.x=element_line(),</span></span>
<span id="cb31-23"><a href="ggplot2.html#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks=element_blank(),</span></span>
<span id="cb31-24"><a href="ggplot2.html#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.position=&quot;top&quot;,</span></span>
<span id="cb31-25"><a href="ggplot2.html#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.border=element_blank())</span></span></code></pre></div>
</div>
</div>
<div id="histogram" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Histogram</h2>
<div id="general-appearance" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> General appearance</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ggplot2.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb32-2"><a href="ggplot2.html#cb32-2" aria-hidden="true" tabindex="-1"></a>smaller <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="ggplot2.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb32-4"><a href="ggplot2.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smaller, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">fill=</span>color))<span class="sc">+</span></span>
<span id="cb32-5"><a href="ggplot2.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span>.<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="ggplot2.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram with Auto Binning&quot;</span>, </span>
<span id="cb32-7"><a href="ggplot2.html#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Engine Displacement across Vehicle Classes&quot;</span>)  </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Appearance-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ggplot2.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## geom_histogram(bins=5, col=&quot;black&quot;, size=.1) </span></span>
<span id="cb33-2"><a href="ggplot2.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="ggplot2.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Change the color according the number of legend</span></span>
<span id="cb33-4"><a href="ggplot2.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## scale_color_manual(values = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;)) </span></span>
<span id="cb33-5"><a href="ggplot2.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## scale_fill_manual(values = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))</span></span></code></pre></div>
</div>
<div id="themes" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Themes</h3>
<p>ggplot2 offers a set of pre-built themes. Try the followings to see which one you like the most:</p>
<ul>
<li>theme_bw()</li>
<li>theme_dark()</li>
<li>theme_minimal()</li>
<li>theme_classic()</li>
</ul>
<p>The hrbrthemes package provides my favourite style.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ggplot2.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb34-2"><a href="ggplot2.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read.table(&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/1_OneNum.csv&quot;, header=TRUE)</span></span>
<span id="cb34-3"><a href="ggplot2.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Make the histogram</span></span>
<span id="cb34-4"><a href="ggplot2.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(hrbrthemes)</span></span>
<span id="cb34-5"><a href="ggplot2.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;%</span></span>
<span id="cb34-6"><a href="ggplot2.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter( price&lt;300 ) %&gt;%</span></span>
<span id="cb34-7"><a href="ggplot2.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot( aes(x=price)) +</span></span>
<span id="cb34-8"><a href="ggplot2.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     stat_bin(breaks=seq(0,300,10), fill=&quot;#69b3a2&quot;, color=&quot;#e9ecef&quot;, alpha=0.9) +</span></span>
<span id="cb34-9"><a href="ggplot2.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle(&quot;Night price distribution of Airbnb appartements&quot;) +</span></span>
<span id="cb34-10"><a href="ggplot2.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_ipsum()</span></span></code></pre></div>
</div>
<div id="geom_freqpoly" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> geom_freqpoly()</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ggplot2.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb35-2"><a href="ggplot2.html#cb35-2" aria-hidden="true" tabindex="-1"></a>smaller <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="ggplot2.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb35-4"><a href="ggplot2.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smaller, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">colour =</span> cut)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="ggplot2.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ggplot2.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## display density instead of count</span></span>
<span id="cb36-2"><a href="ggplot2.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> ..density..)) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="ggplot2.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> cut), <span class="at">binwidth =</span> <span class="dv">500</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-2.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ggplot2.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## geom_density</span></span>
<span id="cb37-2"><a href="ggplot2.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="ggplot2.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl)), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="ggplot2.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Density plot&quot;</span>, </span>
<span id="cb37-5"><a href="ggplot2.html#cb37-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&quot;City Mileage Grouped by Number of cylinders&quot;</span>,</span>
<span id="cb37-6"><a href="ggplot2.html#cb37-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb37-7"><a href="ggplot2.html#cb37-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">&quot;City Mileage&quot;</span>,</span>
<span id="cb37-8"><a href="ggplot2.html#cb37-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="st">&quot;# Cylinders&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/freqpoly-3.png" width="672" /></p>
</div>
<div id="marginal-histogram-boxplot" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Marginal Histogram / Boxplot</h3>
<p>This can be achieved using the ggMarginal() function in the “ggExtra” package. In addition to histograms, you can choose to draw marginal box plots or density plots by setting the corresponding type options.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="ggplot2.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggExtra&quot;</span>)</span>
<span id="cb38-2"><a href="ggplot2.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="ggplot2.html#cb38-3" aria-hidden="true" tabindex="-1"></a>mpg_select <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>hwy <span class="sc">&gt;=</span> <span class="dv">35</span> <span class="sc">&amp;</span> mpg<span class="sc">$</span>cty <span class="sc">&gt;</span> <span class="dv">27</span>, ]</span>
<span id="cb38-4"><a href="ggplot2.html#cb38-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="ggplot2.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>() <span class="sc">+</span> </span>
<span id="cb38-6"><a href="ggplot2.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb38-7"><a href="ggplot2.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-8"><a href="ggplot2.html#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="ggplot2.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>, <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb38-10"><a href="ggplot2.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;boxplot&quot;</span>,   <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb38-11"><a href="ggplot2.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(g, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>,   <span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Marginal%20Plot-1.png" width="672" /></p>
</div>
<div id="scales" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Scales</h3>
<p>Scales control the details of how data values are translated to visual properties. Many <a href="https://ggplot2.tidyverse.org/reference/index.html#section-scales">different scales</a> are offered by ggplot2. The most widely one is probably the log scale.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ggplot2.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-2"><a href="ggplot2.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load dataset from github</span></span>
<span id="cb39-3"><a href="ggplot2.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read.table(&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/1_OneNum.csv&quot;, header=TRUE)</span></span>
<span id="cb39-4"><a href="ggplot2.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-5"><a href="ggplot2.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Make the histogram</span></span>
<span id="cb39-6"><a href="ggplot2.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;%</span></span>
<span id="cb39-7"><a href="ggplot2.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot( aes(x=price)) +</span></span>
<span id="cb39-8"><a href="ggplot2.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_histogram(color=&quot;white&quot;, fill=&quot;steelblue4&quot;) +</span></span>
<span id="cb39-9"><a href="ggplot2.html#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle(&quot;Night price distribution of Airbnb appartements&quot;) +</span></span>
<span id="cb39-10"><a href="ggplot2.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab(&quot;Night price&quot;) +</span></span>
<span id="cb39-11"><a href="ggplot2.html#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab(&quot;Number of apartments&quot;)</span></span>
<span id="cb39-12"><a href="ggplot2.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-13"><a href="ggplot2.html#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;%</span></span>
<span id="cb39-14"><a href="ggplot2.html#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot( aes(x=price)) +</span></span>
<span id="cb39-15"><a href="ggplot2.html#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_histogram(color=&quot;white&quot;, fill=&quot;steelblue4&quot;) +</span></span>
<span id="cb39-16"><a href="ggplot2.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle(&quot;Night price distribution of Airbnb appartements&quot;) +</span></span>
<span id="cb39-17"><a href="ggplot2.html#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab(&quot;Night price&quot;) +</span></span>
<span id="cb39-18"><a href="ggplot2.html#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab(&quot;Number of apartments&quot;) +</span></span>
<span id="cb39-19"><a href="ggplot2.html#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_x_log10()</span></span></code></pre></div>
</div>
</div>
<div id="bar-plot" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Bar plot</h2>
<div id="aesthetic" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Aesthetic</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="ggplot2.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Color Aesthetic</span></span>
<span id="cb40-2"><a href="ggplot2.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb40-3"><a href="ggplot2.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> cut ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ggplot2.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb41-2"><a href="ggplot2.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> color ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-2.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="ggplot2.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Position aesthetic</span></span>
<span id="cb42-2"><a href="ggplot2.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## position adjustment options: &quot;identity&quot;, &quot;dodge&quot; or &quot;fill&quot;.</span></span>
<span id="cb42-3"><a href="ggplot2.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">## position =“fill” is like overlay, but each bar has same height. </span></span>
<span id="cb42-4"><a href="ggplot2.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">## position =“dodge” put objects together</span></span>
<span id="cb42-5"><a href="ggplot2.html#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="ggplot2.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity)) <span class="sc">+</span> </span>
<span id="cb42-7"><a href="ggplot2.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-3.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ggplot2.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">colour =</span> clarity)) <span class="sc">+</span> </span>
<span id="cb43-2"><a href="ggplot2.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb43-3"><a href="ggplot2.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>color) <span class="sc">+</span></span>
<span id="cb43-4"><a href="ggplot2.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-4.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="ggplot2.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="ggplot2.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="ggplot2.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="ggplot2.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram on Categorical Variable&quot;</span>, </span>
<span id="cb44-5"><a href="ggplot2.html#cb44-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Manufacturer across Vehicle Classes&quot;</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-5.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ggplot2.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="ggplot2.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Aesthetic-6.png" width="672" /></p>
<p><strong>Change outline colors</strong></p>
<p>It is also possible to change manually barplot line colors using the functions :</p>
<ul>
<li>scale_color_manual() : to use custom color palettes
<ul>
<li><code>p+scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))</code></li>
</ul></li>
<li>scale_color_brewer() : to use color palettes from RColorBrewer package
<ul>
<li><code>p+scale_color_brewer(palette="Dark2")</code></li>
</ul></li>
<li>scale_color_grey() : to use grey color palettes
<ul>
<li><code>p + scale_color_grey() + theme_classic()</code></li>
</ul></li>
</ul>
<p><strong>Change fill colors</strong></p>
<ul>
<li>scale_fill_manual() : to use custom colors
<ul>
<li><code>p+scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))</code></li>
</ul></li>
<li>scale_fill_brewer() : to use color palettes from RColorBrewer package
<ul>
<li><code>p+scale_fill_brewer(palette="Dark2")</code></li>
</ul></li>
<li>scale_fill_grey() : to use grey color palettes
<ul>
<li><code>p + scale_fill_grey()</code></li>
</ul></li>
</ul>
<p><strong>Change the legend position</strong></p>
<ul>
<li>Change bar fill colors to blues
<ul>
<li><code>p &lt;- p+scale_fill_brewer(palette="Blues")</code></li>
</ul></li>
<li>Change the legend position
<ul>
<li><code>p + theme(legend.position="top")</code></li>
<li><code>p + theme(legend.position="bottom")</code></li>
</ul></li>
<li>Remove legend
<ul>
<li><code>p + theme(legend.position="none")</code></li>
</ul></li>
<li>Change the order of items in the legend
<ul>
<li><code>p + scale_x_discrete(limits=c("D2", "D0.5", "D1"))</code></li>
</ul></li>
</ul>
</div>
<div id="proportion" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Proportion</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ggplot2.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="ggplot2.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> color ))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/proportion-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ggplot2.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion, rather than count:</span></span>
<span id="cb47-2"><a href="ggplot2.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="ggplot2.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">y =</span> ..prop.., <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb47-4"><a href="ggplot2.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb47-5"><a href="ggplot2.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Name&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-6"><a href="ggplot2.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/proportion-2.png" width="672" />
### coord</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ggplot2.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## coord_polar() uses polar coordinates</span></span>
<span id="cb48-2"><a href="ggplot2.html#cb48-2" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="ggplot2.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb48-4"><a href="ggplot2.html#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> cut), </span>
<span id="cb48-5"><a href="ggplot2.html#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-6"><a href="ggplot2.html#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span></span>
<span id="cb48-7"><a href="ggplot2.html#cb48-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb48-8"><a href="ggplot2.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="ggplot2.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb48-10"><a href="ggplot2.html#cb48-10" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/coordinary%20system-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="ggplot2.html#cb49-1" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/coordinary%20system-2.png" width="672" /></p>
</div>
<div id="statidentity" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> stat=“identity”</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ggplot2.html#cb50-1" aria-hidden="true" tabindex="-1"></a>Rotation_5 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/Rotation_5.rds&quot;</span>)</span>
<span id="cb50-2"><a href="ggplot2.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="ggplot2.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Rotation_5, <span class="fu">aes</span>(<span class="at">x =</span> Visit, <span class="at">y=</span> Percentage, <span class="at">fill=</span>Treatment)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="ggplot2.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width =</span><span class="fl">0.5</span>,</span>
<span id="cb50-5"><a href="ggplot2.html#cb50-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb50-6"><a href="ggplot2.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>N), <span class="at">vjust=</span><span class="fl">1.6</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb50-7"><a href="ggplot2.html#cb50-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb50-8"><a href="ggplot2.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>P, <span class="at">x=</span>Visit, <span class="at">y=</span><span class="fl">0.97</span>),<span class="at">hjust=</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb50-9"><a href="ggplot2.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-10"><a href="ggplot2.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb50-11"><a href="ggplot2.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb50-12"><a href="ggplot2.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="ggplot2.html#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb50-14"><a href="ggplot2.html#cb50-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Responder rate&quot;</span>,</span>
<span id="cb50-15"><a href="ggplot2.html#cb50-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Rotational stability within 5° from Visit H0 (sitting)&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/identity-1.png" width="672" /></p>
</div>
<div id="ranking" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Ranking</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ggplot2.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Ordered Bar Chart </span></span>
<span id="cb51-2"><a href="ggplot2.html#cb51-2" aria-hidden="true" tabindex="-1"></a>cty_mpg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(mpg<span class="sc">$</span>cty, <span class="at">by=</span><span class="fu">list</span>(mpg<span class="sc">$</span>manufacturer), <span class="at">FUN=</span>mean)  <span class="co"># aggregate</span></span>
<span id="cb51-3"><a href="ggplot2.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cty_mpg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;make&quot;</span>, <span class="st">&quot;mileage&quot;</span>)  <span class="co"># change column names</span></span>
<span id="cb51-4"><a href="ggplot2.html#cb51-4" aria-hidden="true" tabindex="-1"></a>cty_mpg <span class="ot">&lt;-</span> cty_mpg[<span class="fu">order</span>(cty_mpg<span class="sc">$</span>mileage), ]  <span class="co"># sort</span></span>
<span id="cb51-5"><a href="ggplot2.html#cb51-5" aria-hidden="true" tabindex="-1"></a>cty_mpg<span class="sc">$</span>make <span class="ot">&lt;-</span> <span class="fu">factor</span>(cty_mpg<span class="sc">$</span>make, <span class="at">levels =</span> cty_mpg<span class="sc">$</span>make)  <span class="co"># to retain the order in plot.</span></span>
<span id="cb51-6"><a href="ggplot2.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="ggplot2.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw plot</span></span>
<span id="cb51-8"><a href="ggplot2.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cty_mpg, <span class="fu">aes</span>(<span class="at">x=</span>make, <span class="at">y=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb51-9"><a href="ggplot2.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">&quot;tomato3&quot;</span>) <span class="sc">+</span> </span>
<span id="cb51-10"><a href="ggplot2.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Ordered Bar Chart&quot;</span>, </span>
<span id="cb51-11"><a href="ggplot2.html#cb51-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, </span>
<span id="cb51-12"><a href="ggplot2.html#cb51-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb51-13"><a href="ggplot2.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb51-14"><a href="ggplot2.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Ranking%20the%20bar-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="ggplot2.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Lollipop Chart</span></span>
<span id="cb52-2"><a href="ggplot2.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Lollipop charts conveys the same information as in bar charts. By reducing the thick bars into thin lines, it reduces the clutter and lays more emphasis on the value. It looks nice and modern.</span></span>
<span id="cb52-3"><a href="ggplot2.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cty_mpg, <span class="fu">aes</span>(<span class="at">x=</span>make, <span class="at">y=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb52-4"><a href="ggplot2.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb52-5"><a href="ggplot2.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>make, </span>
<span id="cb52-6"><a href="ggplot2.html#cb52-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend=</span>make, </span>
<span id="cb52-7"><a href="ggplot2.html#cb52-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span><span class="dv">0</span>, </span>
<span id="cb52-8"><a href="ggplot2.html#cb52-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend=</span>mileage)) <span class="sc">+</span> </span>
<span id="cb52-9"><a href="ggplot2.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Lollipop Chart&quot;</span>, </span>
<span id="cb52-10"><a href="ggplot2.html#cb52-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, </span>
<span id="cb52-11"><a href="ggplot2.html#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-12"><a href="ggplot2.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Ranking%20the%20bar-2.png" width="672" /></p>
</div>
<div id="means-and-error-bars" class="section level3" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Means and error bars</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ggplot2.html#cb53-1" aria-hidden="true" tabindex="-1"></a>PrimEnd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;Primary Endpoint&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Primary Analysis&quot;</span>, </span>
<span id="cb53-2"><a href="ggplot2.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Sensitivity Analysis 1&quot;</span>,</span>
<span id="cb53-3"><a href="ggplot2.html#cb53-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Sensitivity Analysis 2&quot;</span>,</span>
<span id="cb53-4"><a href="ggplot2.html#cb53-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Primary Analysis after imputation&quot;</span>),</span>
<span id="cb53-5"><a href="ggplot2.html#cb53-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2945</span>, <span class="sc">-</span><span class="fl">0.08334</span>, <span class="sc">-</span><span class="fl">0.2926</span>, <span class="sc">-</span><span class="fl">0.2395</span>),</span>
<span id="cb53-6"><a href="ggplot2.html#cb53-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">LL=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.9612</span>, <span class="sc">-</span><span class="fl">0.2861</span>, <span class="sc">-</span><span class="fl">0.9344</span>, <span class="sc">-</span><span class="fl">0.7521</span>),</span>
<span id="cb53-7"><a href="ggplot2.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">UL=</span><span class="fu">c</span>(<span class="fl">0.3722</span>, <span class="fl">0.1194</span>, <span class="fl">0.3491</span>, <span class="fl">0.2730</span>),</span>
<span id="cb53-8"><a href="ggplot2.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">pvalue=</span><span class="fu">c</span>(<span class="st">&quot;P = 0.313&quot;</span>, <span class="st">&quot;P = 0.347&quot;</span>, <span class="st">&quot;P = 0.304&quot;</span>,<span class="st">&quot;P = 0.359&quot;</span>))</span>
<span id="cb53-9"><a href="ggplot2.html#cb53-9" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> PrimEnd<span class="sc">$</span>Primary.Endpoint</span>
<span id="cb53-10"><a href="ggplot2.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="ggplot2.html#cb53-11" aria-hidden="true" tabindex="-1"></a>PrimEnd<span class="sc">$</span>Primary.Endpoint <span class="ot">&lt;-</span> <span class="fu">factor</span>(PrimEnd<span class="sc">$</span>Primary.Endpoint, <span class="at">levels=</span>level)</span>
<span id="cb53-12"><a href="ggplot2.html#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-13"><a href="ggplot2.html#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PrimEnd, <span class="fu">aes</span>(<span class="at">x=</span>Primary.Endpoint, <span class="at">y=</span>mean)) <span class="sc">+</span> </span>
<span id="cb53-14"><a href="ggplot2.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-15"><a href="ggplot2.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-16"><a href="ggplot2.html#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>pvalue),<span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb53-17"><a href="ggplot2.html#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dot&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb53-18"><a href="ggplot2.html#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>LL, <span class="at">ymax=</span>UL), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb53-19"><a href="ggplot2.html#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb53-20"><a href="ggplot2.html#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-21"><a href="ggplot2.html#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb53-22"><a href="ggplot2.html#cb53-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Difference between the IOLs&quot;</span>,</span>
<span id="cb53-23"><a href="ggplot2.html#cb53-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Superiority analysis in mean absolute rotation between Visit H0 (sitting) and H1&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="ggplot2.html#cb54-1" aria-hidden="true" tabindex="-1"></a>tg <span class="ot">&lt;-</span> ToothGrowth</span>
<span id="cb54-2"><a href="ggplot2.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb54-3"><a href="ggplot2.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb54-4"><a href="ggplot2.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb54-5"><a href="ggplot2.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb54-6"><a href="ggplot2.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA&#39;s</span></span>
<span id="cb54-7"><a href="ggplot2.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb54-8"><a href="ggplot2.html#cb54-8" aria-hidden="true" tabindex="-1"></a>summarySE <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data=</span><span class="cn">NULL</span>, measurevar, <span class="at">groupvars=</span><span class="cn">NULL</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>,</span>
<span id="cb54-9"><a href="ggplot2.html#cb54-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">conf.interval=</span>.<span class="dv">95</span>, <span class="at">.drop=</span><span class="cn">TRUE</span>) {</span>
<span id="cb54-10"><a href="ggplot2.html#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(plyr)</span>
<span id="cb54-11"><a href="ggplot2.html#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="ggplot2.html#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># New version of length which can handle NA&#39;s: if na.rm==T, don&#39;t count them</span></span>
<span id="cb54-13"><a href="ggplot2.html#cb54-13" aria-hidden="true" tabindex="-1"></a>    length2 <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">na.rm=</span><span class="cn">FALSE</span>) {</span>
<span id="cb54-14"><a href="ggplot2.html#cb54-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (na.rm) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))</span>
<span id="cb54-15"><a href="ggplot2.html#cb54-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>       <span class="fu">length</span>(x)</span>
<span id="cb54-16"><a href="ggplot2.html#cb54-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-17"><a href="ggplot2.html#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="ggplot2.html#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This does the summary. For each group&#39;s data frame, return a vector with</span></span>
<span id="cb54-19"><a href="ggplot2.html#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># N, mean, and sd</span></span>
<span id="cb54-20"><a href="ggplot2.html#cb54-20" aria-hidden="true" tabindex="-1"></a>    datac <span class="ot">&lt;-</span> <span class="fu">ddply</span>(data, groupvars, <span class="at">.drop=</span>.drop,</span>
<span id="cb54-21"><a href="ggplot2.html#cb54-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fun =</span> <span class="cf">function</span>(xx, col) {</span>
<span id="cb54-22"><a href="ggplot2.html#cb54-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="at">N    =</span> <span class="fu">length2</span>(xx[[col]], <span class="at">na.rm=</span>na.rm),</span>
<span id="cb54-23"><a href="ggplot2.html#cb54-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>   (xx[[col]], <span class="at">na.rm=</span>na.rm),</span>
<span id="cb54-24"><a href="ggplot2.html#cb54-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd   =</span> <span class="fu">sd</span>     (xx[[col]], <span class="at">na.rm=</span>na.rm)</span>
<span id="cb54-25"><a href="ggplot2.html#cb54-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb54-26"><a href="ggplot2.html#cb54-26" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb54-27"><a href="ggplot2.html#cb54-27" aria-hidden="true" tabindex="-1"></a>      measurevar</span>
<span id="cb54-28"><a href="ggplot2.html#cb54-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-29"><a href="ggplot2.html#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="ggplot2.html#cb54-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename the &quot;mean&quot; column    </span></span>
<span id="cb54-31"><a href="ggplot2.html#cb54-31" aria-hidden="true" tabindex="-1"></a>    datac <span class="ot">&lt;-</span> <span class="fu">rename</span>(datac, <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span> <span class="ot">=</span> measurevar))</span>
<span id="cb54-32"><a href="ggplot2.html#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="ggplot2.html#cb54-33" aria-hidden="true" tabindex="-1"></a>    datac<span class="sc">$</span>se <span class="ot">&lt;-</span> datac<span class="sc">$</span>sd <span class="sc">/</span> <span class="fu">sqrt</span>(datac<span class="sc">$</span>N)  <span class="co"># Calculate standard error of the mean</span></span>
<span id="cb54-34"><a href="ggplot2.html#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="ggplot2.html#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Confidence interval multiplier for standard error</span></span>
<span id="cb54-36"><a href="ggplot2.html#cb54-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate t-statistic for confidence interval: </span></span>
<span id="cb54-37"><a href="ggplot2.html#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb54-38"><a href="ggplot2.html#cb54-38" aria-hidden="true" tabindex="-1"></a>    ciMult <span class="ot">&lt;-</span> <span class="fu">qt</span>(conf.interval<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> .<span class="dv">5</span>, datac<span class="sc">$</span>N<span class="dv">-1</span>)</span>
<span id="cb54-39"><a href="ggplot2.html#cb54-39" aria-hidden="true" tabindex="-1"></a>    datac<span class="sc">$</span>ci <span class="ot">&lt;-</span> datac<span class="sc">$</span>se <span class="sc">*</span> ciMult</span>
<span id="cb54-40"><a href="ggplot2.html#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="ggplot2.html#cb54-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(datac)</span>
<span id="cb54-42"><a href="ggplot2.html#cb54-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-43"><a href="ggplot2.html#cb54-43" aria-hidden="true" tabindex="-1"></a>tgc <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(tg, <span class="at">measurevar=</span><span class="st">&quot;len&quot;</span>, <span class="at">groupvars=</span><span class="fu">c</span>(<span class="st">&quot;supp&quot;</span>,<span class="st">&quot;dose&quot;</span>))</span>
<span id="cb54-44"><a href="ggplot2.html#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="co"># The errorbars overlapped, so use position_dodge to move them horizontally</span></span>
<span id="cb54-45"><a href="ggplot2.html#cb54-45" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.1</span>) </span>
<span id="cb54-46"><a href="ggplot2.html#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tgc, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>len, <span class="at">colour=</span>supp, <span class="at">group=</span>supp)) <span class="sc">+</span> </span>
<span id="cb54-47"><a href="ggplot2.html#cb54-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>len<span class="sc">-</span>se, <span class="at">ymax=</span>len<span class="sc">+</span>se), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb54-48"><a href="ggplot2.html#cb54-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb54-49"><a href="ggplot2.html#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position=</span>pd, <span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="co"># 21 is filled circle</span></span>
<span id="cb54-50"><a href="ggplot2.html#cb54-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-51"><a href="ggplot2.html#cb54-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Tooth length&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-52"><a href="ggplot2.html#cb54-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_hue</span>(<span class="at">name=</span><span class="st">&quot;Supplement type&quot;</span>,    <span class="co"># Legend label, use darker colors</span></span>
<span id="cb54-53"><a href="ggplot2.html#cb54-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;OJ&quot;</span>, <span class="st">&quot;VC&quot;</span>),</span>
<span id="cb54-54"><a href="ggplot2.html#cb54-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Orange juice&quot;</span>, <span class="st">&quot;Ascorbic acid&quot;</span>),</span>
<span id="cb54-55"><a href="ggplot2.html#cb54-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">l=</span><span class="dv">40</span>) <span class="sc">+</span>                    <span class="co"># Use darker colors, lightness=40</span></span>
<span id="cb54-56"><a href="ggplot2.html#cb54-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;The Effect of Vitamin C on</span><span class="sc">\n</span><span class="st">Tooth Growth in Guinea Pigs&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-57"><a href="ggplot2.html#cb54-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>) <span class="sc">+</span>                        <span class="co"># Expand y range</span></span>
<span id="cb54-58"><a href="ggplot2.html#cb54-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">+</span>         <span class="co"># Set tick every 4</span></span>
<span id="cb54-59"><a href="ggplot2.html#cb54-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-60"><a href="ggplot2.html#cb54-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.justification=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb54-61"><a href="ggplot2.html#cb54-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))               <span class="co"># Position legend in bottom right</span></span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-2.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ggplot2.html#cb55-1" aria-hidden="true" tabindex="-1"></a>tgc2 <span class="ot">&lt;-</span> tgc</span>
<span id="cb55-2"><a href="ggplot2.html#cb55-2" aria-hidden="true" tabindex="-1"></a>tgc2<span class="sc">$</span>dose <span class="ot">&lt;-</span> <span class="fu">factor</span>(tgc2<span class="sc">$</span>dose)</span>
<span id="cb55-3"><a href="ggplot2.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tgc2, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>len, <span class="at">fill=</span>supp)) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="ggplot2.html#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,</span>
<span id="cb55-5"><a href="ggplot2.html#cb55-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="co"># Use black outlines,</span></span>
<span id="cb55-6"><a href="ggplot2.html#cb55-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span>.<span class="dv">3</span>) <span class="sc">+</span>      <span class="co"># Thinner lines</span></span>
<span id="cb55-7"><a href="ggplot2.html#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>len<span class="sc">-</span>se, <span class="at">ymax=</span>len<span class="sc">+</span>se),</span>
<span id="cb55-8"><a href="ggplot2.html#cb55-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span>.<span class="dv">3</span>,    <span class="co"># Thinner lines</span></span>
<span id="cb55-9"><a href="ggplot2.html#cb55-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb55-10"><a href="ggplot2.html#cb55-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb55-11"><a href="ggplot2.html#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-12"><a href="ggplot2.html#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Tooth length&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="ggplot2.html#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hue</span>(<span class="at">name=</span><span class="st">&quot;Supplement type&quot;</span>, <span class="co"># Legend label, use darker colors</span></span>
<span id="cb55-14"><a href="ggplot2.html#cb55-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;OJ&quot;</span>, <span class="st">&quot;VC&quot;</span>),</span>
<span id="cb55-15"><a href="ggplot2.html#cb55-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Orange juice&quot;</span>, <span class="st">&quot;Ascorbic acid&quot;</span>)) <span class="sc">+</span></span>
<span id="cb55-16"><a href="ggplot2.html#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;The Effect of Vitamin C on</span><span class="sc">\n</span><span class="st">Tooth Growth in Guinea Pigs&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-17"><a href="ggplot2.html#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb55-18"><a href="ggplot2.html#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_errorbar-3.png" width="672" /></p>
</div>
<div id="waffle-chart" class="section level3" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Waffle Chart</h3>
<p>Show a good way to make a total classification. Although there is no direct function, it can be clarified by using the geom_tile () function.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ggplot2.html#cb56-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> mpg<span class="sc">$</span>class  <span class="co"># the categorical data </span></span>
<span id="cb56-2"><a href="ggplot2.html#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="ggplot2.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Prep data (nothing to change here)</span></span>
<span id="cb56-4"><a href="ggplot2.html#cb56-4" aria-hidden="true" tabindex="-1"></a>nrows <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb56-5"><a href="ggplot2.html#cb56-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span>nrows, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>nrows)</span>
<span id="cb56-6"><a href="ggplot2.html#cb56-6" aria-hidden="true" tabindex="-1"></a>categ_table <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">table</span>(var) <span class="sc">*</span> ((nrows<span class="sc">*</span>nrows)<span class="sc">/</span>(<span class="fu">length</span>(var))))</span>
<span id="cb56-7"><a href="ggplot2.html#cb56-7" aria-hidden="true" tabindex="-1"></a>categ_table</span></code></pre></div>
<pre><code>## var
##    2seater    compact    midsize    minivan     pickup subcompact        suv 
##          2         20         18          5         14         15         26</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="ggplot2.html#cb58-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">names</span>(categ_table), categ_table)) </span>
<span id="cb58-2"><a href="ggplot2.html#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="ggplot2.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb58-4"><a href="ggplot2.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> category)) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="ggplot2.html#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="ggplot2.html#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb58-7"><a href="ggplot2.html#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">trans =</span> <span class="st">&#39;reverse&#39;</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="ggplot2.html#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="ggplot2.html#cb58-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Waffle Chart&quot;</span>, <span class="at">subtitle=</span><span class="st">&quot;&#39;Class&#39; of vehicles&quot;</span>,</span>
<span id="cb58-10"><a href="ggplot2.html#cb58-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb58-11"><a href="ggplot2.html#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">size =</span> <span class="dv">2</span>),</span>
<span id="cb58-12"><a href="ggplot2.html#cb58-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>)),</span>
<span id="cb58-13"><a href="ggplot2.html#cb58-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-14"><a href="ggplot2.html#cb58-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-15"><a href="ggplot2.html#cb58-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-16"><a href="ggplot2.html#cb58-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-17"><a href="ggplot2.html#cb58-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_tile-1.png" width="672" /></p>
</div>
</div>
<div id="box-plot" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Box plot</h2>
<div id="varwidth" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> varwidth</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ggplot2.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span>
<span id="cb59-2"><a href="ggplot2.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="ggplot2.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty))<span class="sc">+</span></span>
<span id="cb59-4"><a href="ggplot2.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth=</span>T, <span class="at">fill=</span><span class="st">&quot;plum&quot;</span>) <span class="sc">+</span> </span>
<span id="cb59-5"><a href="ggplot2.html#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot&quot;</span>, </span>
<span id="cb59-6"><a href="ggplot2.html#cb59-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,</span>
<span id="cb59-7"><a href="ggplot2.html#cb59-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb59-8"><a href="ggplot2.html#cb59-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb59-9"><a href="ggplot2.html#cb59-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Boxplot%20using%20identity-1.png" width="672" />
### Reorder</p>
<p>Reorder: To make the trend easier to see, we can reorder class based on the median value of hwy:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ggplot2.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span></span>
<span id="cb60-2"><a href="ggplot2.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(class, hwy, <span class="at">FUN =</span> median), <span class="at">y =</span> hwy))<span class="sc">+</span></span>
<span id="cb60-3"><a href="ggplot2.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Reorder%20according%20to%20median-1.png" width="672" /></p>
</div>
<div id="fill" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Fill</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ggplot2.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty))<span class="sc">+</span></span>
<span id="cb61-2"><a href="ggplot2.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="ggplot2.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="ggplot2.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot&quot;</span>, </span>
<span id="cb61-5"><a href="ggplot2.html#cb61-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,</span>
<span id="cb61-6"><a href="ggplot2.html#cb61-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb61-7"><a href="ggplot2.html#cb61-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb61-8"><a href="ggplot2.html#cb61-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/grouping%20using%20fill-1.png" width="672" /></p>
</div>
<div id="statidentity-1" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> stat=“identity”</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ggplot2.html#cb62-1" aria-hidden="true" tabindex="-1"></a>Cylinder3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/Cylinder_Baseline.rds&quot;</span>)</span>
<span id="cb62-2"><a href="ggplot2.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-3"><a href="ggplot2.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Cylinder3,<span class="fu">aes</span>(<span class="at">x=</span>Subgroup,<span class="at">fill=</span>Treatment))<span class="sc">+</span></span>
<span id="cb62-4"><a href="ggplot2.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">lower=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">  SD</span><span class="st">`</span>,</span>
<span id="cb62-5"><a href="ggplot2.html#cb62-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">  SD</span><span class="st">`</span>,</span>
<span id="cb62-6"><a href="ggplot2.html#cb62-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">middle=</span><span class="st">`</span><span class="at">  Mean</span><span class="st">`</span>,</span>
<span id="cb62-7"><a href="ggplot2.html#cb62-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin=</span><span class="st">`</span><span class="at">  Min</span><span class="st">`</span>,</span>
<span id="cb62-8"><a href="ggplot2.html#cb62-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax=</span><span class="st">`</span><span class="at">  Max</span><span class="st">`</span>),</span>
<span id="cb62-9"><a href="ggplot2.html#cb62-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-10"><a href="ggplot2.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="st">`</span><span class="at">P-Value</span><span class="st">`</span>, <span class="at">x=</span>Subgroup, <span class="at">y=</span><span class="fl">5.5</span>),<span class="at">hjust=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb62-11"><a href="ggplot2.html#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb62-12"><a href="ggplot2.html#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-13"><a href="ggplot2.html#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="ggplot2.html#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Subgroups&quot;</span>,</span>
<span id="cb62-15"><a href="ggplot2.html#cb62-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cylinder [D]&quot;</span>,</span>
<span id="cb62-16"><a href="ggplot2.html#cb62-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Subjective refraction Cylinder at Baseline&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/identity-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ggplot2.html#cb63-1" aria-hidden="true" tabindex="-1"></a>MeanRotation <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./01_Datasets/MeanRotation.rds&quot;</span> )</span>
<span id="cb63-2"><a href="ggplot2.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(MeanRotation, <span class="fu">aes</span>(<span class="at">x=</span>Visit,<span class="at">fill=</span>Treatment))<span class="sc">+</span></span>
<span id="cb63-3"><a href="ggplot2.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">lower=</span>mean<span class="sc">-</span>SD,</span>
<span id="cb63-4"><a href="ggplot2.html#cb63-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">upper=</span>mean<span class="sc">+</span>SD,</span>
<span id="cb63-5"><a href="ggplot2.html#cb63-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">middle=</span>mean,</span>
<span id="cb63-6"><a href="ggplot2.html#cb63-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin=</span>min,</span>
<span id="cb63-7"><a href="ggplot2.html#cb63-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax=</span>max),</span>
<span id="cb63-8"><a href="ggplot2.html#cb63-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-9"><a href="ggplot2.html#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>n, <span class="at">x=</span>Visit, <span class="at">y=</span>mean<span class="fl">+1.5</span>), <span class="at">vjust=</span><span class="fl">1.3</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb63-10"><a href="ggplot2.html#cb63-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), <span class="at">size=</span><span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb63-11"><a href="ggplot2.html#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>P,<span class="at">colour=</span>label_color, <span class="at">x=</span>Visit, <span class="at">y=</span><span class="dv">25</span>),<span class="at">hjust=</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">3.5</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb63-12"><a href="ggplot2.html#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-13"><a href="ggplot2.html#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span> Subgroup, <span class="at">nrow =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb63-14"><a href="ggplot2.html#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb63-15"><a href="ggplot2.html#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-16"><a href="ggplot2.html#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-17"><a href="ggplot2.html#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb63-18"><a href="ggplot2.html#cb63-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean absolute rotation&quot;</span>,</span>
<span id="cb63-19"><a href="ggplot2.html#cb63-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Mean absolute rotation by visit&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Identity-2.png" width="672" /></p>
</div>
<div id="dot-box-plot" class="section level3" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Dot + Box Plot</h3>
<p>In addition to the information provided by the box plot, you can provide clearer information in the form of summary statistics for each group. These points are interlaced to make each point represent an observation value.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="ggplot2.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb64-2"><a href="ggplot2.html#cb64-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">reorder</span>(manufacturer, cty, <span class="at">FUN =</span> median) , cty))</span>
<span id="cb64-3"><a href="ggplot2.html#cb64-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="ggplot2.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">&#39;y&#39;</span>, </span>
<span id="cb64-5"><a href="ggplot2.html#cb64-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">stackdir=</span><span class="st">&#39;center&#39;</span>, </span>
<span id="cb64-6"><a href="ggplot2.html#cb64-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">dotsize =</span> .<span class="dv">5</span>, </span>
<span id="cb64-7"><a href="ggplot2.html#cb64-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="ggplot2.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">65</span>, <span class="at">vjust=</span><span class="fl">0.6</span>)) <span class="sc">+</span> </span>
<span id="cb64-9"><a href="ggplot2.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-10"><a href="ggplot2.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Box plot + Dot plot&quot;</span>, </span>
<span id="cb64-11"><a href="ggplot2.html#cb64-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage vs Class: Each dot represents 1 row in source data&quot;</span>,</span>
<span id="cb64-12"><a href="ggplot2.html#cb64-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb64-13"><a href="ggplot2.html#cb64-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb64-14"><a href="ggplot2.html#cb64-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/Dot%20Box%20Plot-1.png" width="672" />
### Violin Plot</p>
<p>The violigogram is similar to the box pattern, but the density of the group is displayed. There is no too much information like a box line map.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ggplot2.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="ggplot2.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb65-3"><a href="ggplot2.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Violin plot&quot;</span>, </span>
<span id="cb65-4"><a href="ggplot2.html#cb65-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">&quot;City Mileage vs Class of vehicle&quot;</span>,</span>
<span id="cb65-5"><a href="ggplot2.html#cb65-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,</span>
<span id="cb65-6"><a href="ggplot2.html#cb65-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,</span>
<span id="cb65-7"><a href="ggplot2.html#cb65-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;City Mileage&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="ggplot2.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/geom_violin-1.png" width="672" /></p>
</div>
</div>
<div id="other-rendering" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Other rendering</h2>
<div id="annotation" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Annotation</h3>
<p>Annotation for Text, Shape</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="ggplot2.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset from github</span></span>
<span id="cb66-2"><a href="ggplot2.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read.table(&quot;https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/3_TwoNumOrdered.csv&quot;, header=T)</span></span>
<span id="cb66-3"><a href="ggplot2.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data$date &lt;- as.Date(data$date)</span></span>
<span id="cb66-4"><a href="ggplot2.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;%</span></span>
<span id="cb66-5"><a href="ggplot2.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot( aes(x=date, y=value)) +</span></span>
<span id="cb66-6"><a href="ggplot2.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line(color=&quot;#69b3a2&quot;)+</span></span>
<span id="cb66-7"><a href="ggplot2.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     annotate(geom=&quot;text&quot;, x=as.Date(&quot;2017-01-01&quot;), y=19000, </span></span>
<span id="cb66-8"><a href="ggplot2.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              label=&quot;Bitcoin price reached 20k $\nat the end of 2017&quot;)+</span></span>
<span id="cb66-9"><a href="ggplot2.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     annotate(geom=&quot;point&quot;, x=as.Date(&quot;2017-12-17&quot;), y=20089, size=10, shape=21, fill=&quot;transparent&quot;)+</span></span>
<span id="cb66-10"><a href="ggplot2.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_hline(yintercept=5000, color=&quot;orange&quot;, size=.5)</span></span></code></pre></div>
</div>
<div id="text-ggtext" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Text: ggtext</h3>
<p><strong>Markdown in theme elements</strong></p>
<p>The ggtext package defines two new theme elements, element_markdown() and element_textbox(). Both behave similarly to element_text() but render the provided text as markdown/html. element_markdown() is meant as a direct replacement for element_text(), and it renders text without word wrapping. To start a new line, use the <br> tag or add two spaces before the end of a line.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ggplot2.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## remotes::install_github(&quot;wilkelab/ggtext&quot;)</span></span>
<span id="cb67-2"><a href="ggplot2.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;ggtext&quot;)</span></span>
<span id="cb67-3"><a href="ggplot2.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggtext&quot;</span>)</span>
<span id="cb67-4"><a href="ggplot2.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb67-5"><a href="ggplot2.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;glue&quot;</span>)</span>
<span id="cb67-6"><a href="ggplot2.html#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="ggplot2.html#cb67-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-8"><a href="ggplot2.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bactname =</span> <span class="fu">c</span>(<span class="st">&quot;Staphylococcaceae&quot;</span>, <span class="st">&quot;Moraxella&quot;</span>, <span class="st">&quot;Streptococcus&quot;</span>, <span class="st">&quot;Acinetobacter&quot;</span>),</span>
<span id="cb67-9"><a href="ggplot2.html#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">OTUname =</span> <span class="fu">c</span>(<span class="st">&quot;OTU 1&quot;</span>, <span class="st">&quot;OTU 2&quot;</span>, <span class="st">&quot;OTU 3&quot;</span>, <span class="st">&quot;OTU 4&quot;</span>),</span>
<span id="cb67-10"><a href="ggplot2.html#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb67-11"><a href="ggplot2.html#cb67-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-12"><a href="ggplot2.html#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="ggplot2.html#cb67-13" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb67-14"><a href="ggplot2.html#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#0072B2&quot;</span>, <span class="st">&quot;#000000&quot;</span>),</span>
<span id="cb67-15"><a href="ggplot2.html#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">glue</span>(<span class="st">&quot;&lt;i style=&#39;color:{color}&#39;&gt;{bactname}&lt;/i&gt; ({OTUname})&quot;</span>),</span>
<span id="cb67-16"><a href="ggplot2.html#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">fct_reorder</span>(name, value)</span>
<span id="cb67-17"><a href="ggplot2.html#cb67-17" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">%&gt;%</span></span>
<span id="cb67-18"><a href="ggplot2.html#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, name, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb67-19"><a href="ggplot2.html#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb67-20"><a href="ggplot2.html#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb67-21"><a href="ggplot2.html#cb67-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">&quot;Example posted on **stackoverflow.com**&lt;br&gt;(using made-up data)&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-22"><a href="ggplot2.html#cb67-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-23"><a href="ggplot2.html#cb67-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb67-24"><a href="ggplot2.html#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_markdown</span>(<span class="at">lineheight =</span> <span class="fl">1.2</span>)</span>
<span id="cb67-25"><a href="ggplot2.html#cb67-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggtext-1.png" width="672" /></p>
</div>
<div id="text-ggrepel" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Text: ggrepel</h3>
<p>There are two important functions in ggrepel R packages:</p>
<ul>
<li>geom_label_repel()</li>
<li>geom_text_repel()</li>
</ul>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="ggplot2.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb68-2"><a href="ggplot2.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Take a subset of 15 random points</span></span>
<span id="cb68-3"><a href="ggplot2.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-4"><a href="ggplot2.html#cb68-4" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">15</span>)</span>
<span id="cb68-5"><a href="ggplot2.html#cb68-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mtcars[ss, ]</span>
<span id="cb68-6"><a href="ggplot2.html#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="ggplot2.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a scatter plot:</span></span>
<span id="cb68-8"><a href="ggplot2.html#cb68-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb68-9"><a href="ggplot2.html#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb68-10"><a href="ggplot2.html#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb68-11"><a href="ggplot2.html#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="ggplot2.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Add text labels:</span></span>
<span id="cb68-13"><a href="ggplot2.html#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Add text annotations using ggplot2::geom_text</span></span>
<span id="cb68-14"><a href="ggplot2.html#cb68-14" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df)),</span>
<span id="cb68-15"><a href="ggplot2.html#cb68-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ggplot2.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Use ggrepel::geom_text_repel</span></span>
<span id="cb69-2"><a href="ggplot2.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb69-3"><a href="ggplot2.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb69-4"><a href="ggplot2.html#cb69-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df)),</span>
<span id="cb69-5"><a href="ggplot2.html#cb69-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fl">3.5</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-2.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ggplot2.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change color by groups</span></span>
<span id="cb70-2"><a href="ggplot2.html#cb70-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(df),</span>
<span id="cb70-3"><a href="ggplot2.html#cb70-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="fu">factor</span>(cyl)), <span class="at">color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb70-4"><a href="ggplot2.html#cb70-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="ggplot2.html#cb70-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-3.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="ggplot2.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With selection</span></span>
<span id="cb71-2"><a href="ggplot2.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Data are available in the gapminder package</span></span>
<span id="cb71-3"><a href="ggplot2.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb71-4"><a href="ggplot2.html#cb71-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">==</span><span class="st">&quot;2007&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>year)</span>
<span id="cb71-5"><a href="ggplot2.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb71-6"><a href="ggplot2.html#cb71-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="ggplot2.html#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">annotation =</span> <span class="fu">ifelse</span>(gdpPercap <span class="sc">&gt;</span> <span class="dv">5000</span> <span class="sc">&amp;</span> lifeExp <span class="sc">&lt;</span> <span class="dv">60</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</span>
<span id="cb71-8"><a href="ggplot2.html#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb71-9"><a href="ggplot2.html#cb71-9" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb71-10"><a href="ggplot2.html#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>gdpPercap, <span class="at">y=</span>lifeExp, <span class="at">size =</span> pop, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb71-11"><a href="ggplot2.html#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb71-12"><a href="ggplot2.html#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-13"><a href="ggplot2.html#cb71-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data=</span>tmp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annotation<span class="sc">==</span><span class="st">&quot;yes&quot;</span>), <span class="fu">aes</span>(<span class="at">label=</span>country), <span class="at">size=</span><span class="dv">4</span> )</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggrepel-4.png" width="672" /></p>
</div>
<div id="arrage-gridextra" class="section level3" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Arrage: gridExtra</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ggplot2.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## assemble multiple plots on a page is to use the grid.arrange() function</span></span>
<span id="cb72-2"><a href="ggplot2.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb72-3"><a href="ggplot2.html#cb72-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(mpg, wt, <span class="at">data =</span> mtcars, <span class="at">colour =</span> cyl)</span>
<span id="cb72-4"><a href="ggplot2.html#cb72-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(mpg, <span class="at">data =</span> mtcars) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;title&quot;</span>)</span>
<span id="cb72-5"><a href="ggplot2.html#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="ggplot2.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/lay-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ggplot2.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tables and other grobs</span></span>
<span id="cb73-2"><a href="ggplot2.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb73-3"><a href="ggplot2.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tableGrob</span>(mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]),</span>
<span id="cb73-4"><a href="ggplot2.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  p2,</span>
<span id="cb73-5"><a href="ggplot2.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb73-6"><a href="ggplot2.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>),</span>
<span id="cb73-7"><a href="ggplot2.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">clip =</span> <span class="cn">FALSE</span></span>
<span id="cb73-8"><a href="ggplot2.html#cb73-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/lay-2.png" width="672" /></p>
</div>
<div id="interactive-charts-plotly" class="section level3" number="4.6.5">
<h3><span class="header-section-number">4.6.5</span> Interactive charts: plotly</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ggplot2.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb74-2"><a href="ggplot2.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb74-3"><a href="ggplot2.html#cb74-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year<span class="sc">==</span><span class="st">&quot;2007&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>year)</span>
<span id="cb74-4"><a href="ggplot2.html#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="ggplot2.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive version</span></span>
<span id="cb74-6"><a href="ggplot2.html#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb74-7"><a href="ggplot2.html#cb74-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="ggplot2.html#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">myText=</span><span class="fu">paste</span>(<span class="st">&quot;This country is: &quot;</span> , country )) <span class="sc">%&gt;%</span></span>
<span id="cb74-9"><a href="ggplot2.html#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>gdpPercap, <span class="at">y=</span>lifeExp, <span class="at">size =</span> pop, <span class="at">color =</span> continent, <span class="at">text=</span>myText)) <span class="sc">+</span></span>
<span id="cb74-10"><a href="ggplot2.html#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>) </span>
<span id="cb74-11"><a href="ggplot2.html#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="ggplot2.html#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-2f404ec3be95e9b94ac2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2f404ec3be95e9b94ac2">{"x":{"data":[{"x":[6223.367465,4797.231267,1441.284873,12569.85177,1217.032994,430.0706916,2042.09524,706.016537,1704.063724,986.1478792,277.5518587,3632.557798,1544.750112,2082.481567,5581.180998,12154.08975,641.3695236,690.8055759,13206.48452,752.7497265,1327.60891,942.6542111,579.231743,1463.249282,1569.331442,414.5073415,12057.49928,1044.770126,759.3499101,1042.581557,1803.151496,10956.99112,3820.17523,823.6856205,4811.060429,619.6768924,2013.977305,7670.122558,863.0884639,1598.435089,1712.472136,862.5407561,926.1410683,9269.657808,2602.394995,4513.480643,1107.482182,882.9699438,7092.923025,1056.380121,1271.211593,469.7092981],"y":[72.301,42.731,56.728,50.728,52.295,49.58,50.43,44.741,50.651,65.152,46.462,55.322,48.328,54.791,71.338,51.579,58.04,52.947,56.735,59.448,60.022,56.007,46.388,54.11,42.592,45.678,73.952,59.443,48.303,54.467,64.164,72.801,71.164,42.082,52.906,56.867,46.859,76.442,46.242,65.528,63.062,42.568,48.159,49.339,58.556,39.613,52.517,58.42,73.923,51.542,42.384,43.487],"text":["This country is:  Algeria","This country is:  Angola","This country is:  Benin","This country is:  Botswana","This country is:  Burkina Faso","This country is:  Burundi","This country is:  Cameroon","This country is:  Central African Republic","This country is:  Chad","This country is:  Comoros","This country is:  Congo, Dem. Rep.","This country is:  Congo, Rep.","This country is:  Cote d'Ivoire","This country is:  Djibouti","This country is:  Egypt","This country is:  Equatorial Guinea","This country is:  Eritrea","This country is:  Ethiopia","This country is:  Gabon","This country is:  Gambia","This country is:  Ghana","This country is:  Guinea","This country is:  Guinea-Bissau","This country is:  Kenya","This country is:  Lesotho","This country is:  Liberia","This country is:  Libya","This country is:  Madagascar","This country is:  Malawi","This country is:  Mali","This country is:  Mauritania","This country is:  Mauritius","This country is:  Morocco","This country is:  Mozambique","This country is:  Namibia","This country is:  Niger","This country is:  Nigeria","This country is:  Reunion","This country is:  Rwanda","This country is:  Sao Tome and Principe","This country is:  Senegal","This country is:  Sierra Leone","This country is:  Somalia","This country is:  South Africa","This country is:  Sudan","This country is:  Swaziland","This country is:  Tanzania","This country is:  Togo","This country is:  Tunisia","This country is:  Uganda","This country is:  Zambia","This country is:  Zimbabwe"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.7,"size":[6.77527173254923,5.598900411863,5.24035330707835,4.40395768399738,5.7356199392208,5.26901439581437,5.9564773609874,4.8422259478741,5.42852631166044,4.15169850163956,7.9562662998771,4.76713328307226,5.97611663817011,4.06305719383881,8.43636871732964,4.08813627550005,4.90865391372741,8.32592567062337,4.36262596871136,4.41454467512776,6.25770233060098,5.40445197132612,4.3666011970112,6.87649613589243,4.480300710223,4.68010775450673,5.03693920169262,6.0461636385333,5.66517797748393,5.5697344023561,4.69148323166173,4.31315004312066,6.79437672410524,6.09253246174489,4.48845333089755,5.6338762963756,9.82271393327331,4.18215900239245,5.3111594952501,3.77952755905512,5.58747695964146,5.04848038390226,5.33382085391144,7.22380829377829,7.1561065468969,4.282361176813,6.98520027409899,5.00028803920838,5.43159101796171,6.580769078434,5.54798462578679,5.59074371141117],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Africa","legendgroup":"Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12779.37964,3822.137084,9065.800825,36319.23501,13171.63885,7006.580419,9645.06142,8948.102923,6025.374752,6873.262326,5728.353514,5186.050003,1201.637154,3548.330846,7320.880262,11977.57496,2749.320965,9809.185636,4172.838464,7408.905561,19328.70901,18008.50924,42951.65309,10611.46299,11415.80569],"y":[75.32,65.554,72.39,80.653,78.553,72.889,78.782,78.273,72.235,74.994,71.878,70.259,60.916,70.198,72.567,76.195,72.899,75.537,71.752,71.421,78.746,69.819,78.242,76.384,73.747],"text":["This country is:  Argentina","This country is:  Bolivia","This country is:  Brazil","This country is:  Canada","This country is:  Chile","This country is:  Colombia","This country is:  Costa Rica","This country is:  Cuba","This country is:  Dominican Republic","This country is:  Ecuador","This country is:  El Salvador","This country is:  Guatemala","This country is:  Haiti","This country is:  Honduras","This country is:  Jamaica","This country is:  Mexico","This country is:  Nicaragua","This country is:  Panama","This country is:  Paraguay","This country is:  Peru","This country is:  Puerto Rico","This country is:  Trinidad and Tobago","This country is:  United States","This country is:  Uruguay","This country is:  Venezuela"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":0.7,"size":[7.07528369289545,5.33385387656466,10.9497220287062,6.77784403625228,5.86681801798997,7.23282911414924,4.81182340745332,5.52260397354913,5.35122378867242,5.69571313317988,5.1306777542305,5.61021330347734,5.27919109958551,5.18415329737334,4.6155666029278,9.20063061292984,4.99737544049698,4.68733172329479,5.10307852744492,6.55670348636785,4.78640121163658,4.26132881438327,12.807919245623,4.71746231550028,6.42738713411734],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Americas","legendgroup":"Americas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[974.5803384,29796.04834,1391.253792,1713.778686,4959.114854,39724.97867,2452.210407,3540.651564,11605.71449,4471.061906,25523.2771,31656.06806,4519.461171,1593.06548,23348.13973,47306.98978,10461.05868,12451.6558,3095.772271,944,1091.359778,22316.19287,2605.94758,3190.481016,21654.83194,47143.17964,3970.095407,4184.548089,28718.27684,7458.396327,2441.576404,3025.349798,2280.769906],"y":[43.828,75.635,64.062,59.723,72.961,82.208,64.698,70.65,70.964,59.545,80.745,82.603,72.535,67.297,78.623,77.588,71.993,74.241,66.803,62.069,63.785,75.64,65.483,71.688,72.777,79.972,72.396,74.143,78.4,70.616,74.249,73.422,62.698],"text":["This country is:  Afghanistan","This country is:  Bahrain","This country is:  Bangladesh","This country is:  Cambodia","This country is:  China","This country is:  Hong Kong, China","This country is:  India","This country is:  Indonesia","This country is:  Iran","This country is:  Iraq","This country is:  Israel","This country is:  Japan","This country is:  Jordan","This country is:  Korea, Dem. Rep.","This country is:  Korea, Rep.","This country is:  Kuwait","This country is:  Lebanon","This country is:  Malaysia","This country is:  Mongolia","This country is:  Myanmar","This country is:  Nepal","This country is:  Oman","This country is:  Pakistan","This country is:  Philippines","This country is:  Saudi Arabia","This country is:  Singapore","This country is:  Sri Lanka","This country is:  Syria","This country is:  Taiwan","This country is:  Thailand","This country is:  Vietnam","This country is:  West Bank and Gaza","This country is:  Yemen, Rep."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":0.7,"size":[6.70929835135528,4.1508288847182,10.1588656081799,5.72211801075065,22.6771653543307,5.13475345805415,21.1203680953071,11.5573968303758,8.11057131553749,6.49879524068774,5.07824026167466,9.65077587363648,5.03869129857133,6.28100350114513,7.4168446506104,4.56983839481089,4.78354392302204,6.36196165910748,4.63065651672448,7.36876387589759,6.56775273775666,4.68175365529605,10.5466615830696,8.74086596862592,6.50384061768477,4.86541785279541,6.11737587407916,6.05493528307165,6.27409491409121,7.97119993399054,8.57951329437571,4.79655097614072,6.22127948111281],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"Asia","legendgroup":"Asia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5937.029526,36126.4927,33692.60508,7446.298803,10680.79282,14619.22272,22833.30851,35278.41874,33207.0844,30470.0167,32170.37442,27538.41188,18008.94444,36180.78919,40675.99635,28569.7197,9253.896111,36797.93332,49357.19017,15389.92468,20509.64777,10808.47561,9786.534714,18678.31435,25768.25759,28821.0637,33859.74835,37506.41907,8458.276384,33203.26128],"y":[76.423,79.829,79.441,74.852,73.005,75.748,76.486,78.332,79.313,80.657,79.406,79.483,73.338,81.757,78.885,80.546,74.543,79.762,80.196,75.563,78.098,72.476,74.002,74.663,77.926,80.941,80.884,81.701,71.777,79.425],"text":["This country is:  Albania","This country is:  Austria","This country is:  Belgium","This country is:  Bosnia and Herzegovina","This country is:  Bulgaria","This country is:  Croatia","This country is:  Czech Republic","This country is:  Denmark","This country is:  Finland","This country is:  France","This country is:  Germany","This country is:  Greece","This country is:  Hungary","This country is:  Iceland","This country is:  Ireland","This country is:  Italy","This country is:  Montenegro","This country is:  Netherlands","This country is:  Norway","This country is:  Poland","This country is:  Portugal","This country is:  Romania","This country is:  Serbia","This country is:  Slovak Republic","This country is:  Slovenia","This country is:  Spain","This country is:  Sweden","This country is:  Switzerland","This country is:  Turkey","This country is:  United Kingdom"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":0.7,"size":[4.73930360976545,5.2515712457991,5.44107849786917,4.86531670289218,5.16855282584858,4.85794694387522,5.42769965273683,4.97410786436283,4.94778140481952,7.84043376621969,8.49809123744673,5.46648280699294,5.40514308400654,3.9460291298415,4.8085649745634,7.74130405516196,4.14203032052794,5.88528441607637,4.87472139425141,7.00115515259145,5.46138101214586,6.22484391610449,5.42123845033248,4.97176812735327,4.47964255788798,7.0812884751231,5.32616181946541,5.19097245574501,8.16356363915206,7.83015990857845],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Europe","legendgroup":"Europe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34435.36744,25185.00911],"y":[81.235,80.204],"text":["This country is:  Australia","This country is:  New Zealand"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":0.7,"size":[6.12061399094626,4.80944439195868],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Oceania","legendgroup":"Oceania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2176.430056865,51811.172085565],"tickmode":"array","ticktext":["0","10000","20000","30000","40000","50000"],"tickvals":[0,10000,20000,30000,40000,50000],"categoryorder":"array","categoryarray":["0","10000","20000","30000","40000","50000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"gdpPercap","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.4635,84.7525],"tickmode":"array","ticktext":["40","50","60","70","80"],"tickvals":[40,50,60,70,80],"categoryorder":"array","categoryarray":["40","50","60","70","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"lifeExp","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.826771653543307},"annotations":[{"text":"pop<br />continent","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"6fc3d4770f":{"x":{},"y":{},"size":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"6fc3d4770f","visdat":{"6fc3d4770f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="diagrammer" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> DiagrammeR</h2>
<div id="basic-flowchart-using-grviz" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Basic flowchart using <code>grViz</code></h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ggplot2.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DiagrammeR&quot;</span>)</span>
<span id="cb75-2"><a href="ggplot2.html#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="ggplot2.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph flowchart {</span></span>
<span id="cb75-4"><a href="ggplot2.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb75-5"><a href="ggplot2.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb75-6"><a href="ggplot2.html#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb75-7"><a href="ggplot2.html#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb75-8"><a href="ggplot2.html#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb75-9"><a href="ggplot2.html#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb75-10"><a href="ggplot2.html#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="st">      tab5 [label = &#39;@@5&#39;]</span></span>
<span id="cb75-11"><a href="ggplot2.html#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="ggplot2.html#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="st">      # edge definitions with the node IDs</span></span>
<span id="cb75-13"><a href="ggplot2.html#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 -&gt; tab2 -&gt; tab3 -&gt; tab4 -&gt; tab5;</span></span>
<span id="cb75-14"><a href="ggplot2.html#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb75-15"><a href="ggplot2.html#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="ggplot2.html#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">      [1]: &#39;Questionnaire sent to n=1000 participants&#39;</span></span>
<span id="cb75-17"><a href="ggplot2.html#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="st">      [2]: &#39;Participants responded to questionnaire n=850&#39;</span></span>
<span id="cb75-18"><a href="ggplot2.html#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="st">      [3]: &#39;Participants came to clinic for evaluation n=700&#39;</span></span>
<span id="cb75-19"><a href="ggplot2.html#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="st">      [4]: &#39;Participants eligible for the study n=600&#39;</span></span>
<span id="cb75-20"><a href="ggplot2.html#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="st">      [5]: &#39;Study sample n=600&#39;</span></span>
<span id="cb75-21"><a href="ggplot2.html#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div id="htmlwidget-e2b1c10754091e7c6dd7" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e2b1c10754091e7c6dd7">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Questionnaire sent to n=1000 participants\"]\n      tab2 [label = \"Participants responded to questionnaire n=850\"]\n      tab3 [label = \"Participants came to clinic for evaluation n=700\"]\n      tab4 [label = \"Participants eligible for the study n=600\"]\n      tab5 [label = \"Study sample n=600\"]\n\n      # edge definitions with the node IDs\n      tab1 -> tab2 -> tab3 -> tab4 -> tab5;\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ggplot2.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph flowchart {</span></span>
<span id="cb76-2"><a href="ggplot2.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb76-3"><a href="ggplot2.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb76-4"><a href="ggplot2.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb76-5"><a href="ggplot2.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb76-6"><a href="ggplot2.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb76-7"><a href="ggplot2.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb76-8"><a href="ggplot2.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="st">      tab5 [label = &#39;@@5&#39;]</span></span>
<span id="cb76-9"><a href="ggplot2.html#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="ggplot2.html#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="st">      # edge definitions with the node IDs</span></span>
<span id="cb76-11"><a href="ggplot2.html#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 -&gt; tab2;</span></span>
<span id="cb76-12"><a href="ggplot2.html#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 -&gt; tab3;</span></span>
<span id="cb76-13"><a href="ggplot2.html#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4 -&gt; tab5</span></span>
<span id="cb76-14"><a href="ggplot2.html#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb76-15"><a href="ggplot2.html#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="ggplot2.html#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="st">      [1]: &#39;Questionnaire sent to n=1000 participants&#39;</span></span>
<span id="cb76-17"><a href="ggplot2.html#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="st">      [2]: &#39;Participants came to clinic for evaluation n=700&#39;</span></span>
<span id="cb76-18"><a href="ggplot2.html#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="st">      [3]: &#39;Participants non-eligible for the study n=100&#39;</span></span>
<span id="cb76-19"><a href="ggplot2.html#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="st">      [4]: &#39;Participants eligible for the study n=600&#39;</span></span>
<span id="cb76-20"><a href="ggplot2.html#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="st">      [5]: &#39;Study sample n=600&#39;</span></span>
<span id="cb76-21"><a href="ggplot2.html#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div id="htmlwidget-efdb5054a06b8c868aea" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-efdb5054a06b8c868aea">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Questionnaire sent to n=1000 participants\"]\n      tab2 [label = \"Participants came to clinic for evaluation n=700\"]\n      tab3 [label = \"Participants non-eligible for the study n=100\"]\n      tab4 [label = \"Participants eligible for the study n=600\"]\n      tab5 [label = \"Study sample n=600\"]\n\n      # edge definitions with the node IDs\n      tab1 -> tab2;\n      tab2 -> tab3;\n      tab2 -> tab4 -> tab5\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="graphviz-attributes" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Graphviz Attributes</h3>
<ul>
<li>Node Attributes</li>
<li>Edge Attributes</li>
<li>Colors</li>
<li>Node Shapes</li>
<li>Arrow Shapes</li>
</ul>
<p>See more under <code>Graphviz and mermaid in DiagrammeR</code></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="ggplot2.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="at">diagram =</span> <span class="st">&quot;digraph flowchart {</span></span>
<span id="cb77-2"><a href="ggplot2.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="st">      # define node aesthetics</span></span>
<span id="cb77-3"><a href="ggplot2.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="st">      node [fontname = Arial, shape = oval, color = Lavender, style = filled]        </span></span>
<span id="cb77-4"><a href="ggplot2.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb77-5"><a href="ggplot2.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb77-6"><a href="ggplot2.html#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb77-7"><a href="ggplot2.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb77-8"><a href="ggplot2.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="st"># set up node layout</span></span>
<span id="cb77-9"><a href="ggplot2.html#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 -&gt; tab2;</span></span>
<span id="cb77-10"><a href="ggplot2.html#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 -&gt; tab3;</span></span>
<span id="cb77-11"><a href="ggplot2.html#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4</span></span>
<span id="cb77-12"><a href="ggplot2.html#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb77-13"><a href="ggplot2.html#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="st">[1]: &#39;Learning Data Science&#39;</span></span>
<span id="cb77-14"><a href="ggplot2.html#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="st">      [2]: &#39;Industry vs Technical Knowledge&#39;</span></span>
<span id="cb77-15"><a href="ggplot2.html#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="st">      [3]: &#39;Python/R&#39;</span></span>
<span id="cb77-16"><a href="ggplot2.html#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="st">      [4]: &#39;Domain Experience&#39;</span></span>
<span id="cb77-17"><a href="ggplot2.html#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div id="htmlwidget-db44f680600997ae90cc" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-db44f680600997ae90cc">{"x":{"diagram":"digraph flowchart {\n      # define node aesthetics\n      node [fontname = Arial, shape = oval, color = Lavender, style = filled]        \n      tab1 [label = \"Learning Data Science\"]\n      tab2 [label = \"Industry vs Technical Knowledge\"]\n      tab3 [label = \"Python/R\"]\n      tab4 [label = \"Domain Experience\"]\n# set up node layout\n      tab1 -> tab2;\n      tab2 -> tab3;\n      tab2 -> tab4\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="ggplot2.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph {</span></span>
<span id="cb78-2"><a href="ggplot2.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="st">graph [layout = dot, rankdir = LR]</span></span>
<span id="cb78-3"><a href="ggplot2.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="st"># define the global styles of the nodes. We can override these in box if we wish</span></span>
<span id="cb78-4"><a href="ggplot2.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="st">node [shape = rectangle, style = filled, fillcolor = Linen]</span></span>
<span id="cb78-5"><a href="ggplot2.html#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="ggplot2.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="st">data1 [label = &#39;Dataset 1&#39;, shape = folder, fillcolor = Beige]</span></span>
<span id="cb78-7"><a href="ggplot2.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="st">data2 [label = &#39;Dataset 2&#39;, shape = folder, fillcolor = Beige]</span></span>
<span id="cb78-8"><a href="ggplot2.html#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="st">process [label =  &#39;Process </span><span class="sc">\n</span><span class="st"> Data&#39;]</span></span>
<span id="cb78-9"><a href="ggplot2.html#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="st">statistical [label = &#39;Statistical </span><span class="sc">\n</span><span class="st"> Analysis&#39;]</span></span>
<span id="cb78-10"><a href="ggplot2.html#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="st">results [label= &#39;Results&#39;]</span></span>
<span id="cb78-11"><a href="ggplot2.html#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="ggplot2.html#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="st"># edge definitions with the node IDs</span></span>
<span id="cb78-13"><a href="ggplot2.html#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="st">{data1 data2}  -&gt; process -&gt; statistical -&gt; results</span></span>
<span id="cb78-14"><a href="ggplot2.html#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-8aff3d8852336ce36ed4" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-8aff3d8852336ce36ed4">{"x":{"diagram":"digraph {\ngraph [layout = dot, rankdir = LR]\n# define the global styles of the nodes. We can override these in box if we wish\nnode [shape = rectangle, style = filled, fillcolor = Linen]\n\ndata1 [label = \"Dataset 1\", shape = folder, fillcolor = Beige]\ndata2 [label = \"Dataset 2\", shape = folder, fillcolor = Beige]\nprocess [label =  \"Process \n Data\"]\nstatistical [label = \"Statistical \n Analysis\"]\nresults [label= \"Results\"]\n\n# edge definitions with the node IDs\n{data1 data2}  -> process -> statistical -> results\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="gantt-chart" class="section level3" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Gantt chart</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ggplot2.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the Gantt chart and plot the result (not shown)</span></span>
<span id="cb79-2"><a href="ggplot2.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mermaid</span>(<span class="st">&quot;gantt</span></span>
<span id="cb79-3"><a href="ggplot2.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="st">        Section Initiation</span></span>
<span id="cb79-4"><a href="ggplot2.html#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="st">        Planning           :a1, 2016-01-01, 10d</span></span>
<span id="cb79-5"><a href="ggplot2.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="st">        Data processing    :after a1, 30d</span></span>
<span id="cb79-6"><a href="ggplot2.html#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="st">        Data analysis      :b1, 2016-03-01, 15d&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-a6abfa9227733bb90a39" style="width:672px;height:480px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-a6abfa9227733bb90a39">{"x":{"diagram":"gantt\n        Section Initiation\n        Planning           :a1, 2016-01-01, 10d\n        Data processing    :after a1, 30d\n        Data analysis      :b1, 2016-03-01, 15d"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ggstatsplot" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> ggstatsplot</h2>
<p>ggstatsplot is an extension of ggplot2 package for creating graphics with details from statistical tests included in the plots themselves and targeted primarily at behavioral sciences community to provide a one-line code to produce information-rich plots.</p>
<ul>
<li><a href="https://indrajeetpatil.github.io/ggstatsplot/articles/" class="uri">https://indrajeetpatil.github.io/ggstatsplot/articles/</a></li>
<li>Patil, I. (2021). Visualizations with statistical details: The ‘ggstatsplot’ approach. Journal of Open Source Software, 6(61), 3167, <a href="doi:10.21105/joss.03167" class="uri">doi:10.21105/joss.03167</a></li>
</ul>
<div id="ggbetweenstats" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> ggbetweenstats</h3>
<ul>
<li>to check if a continuous variable differs across multiple groups/conditions</li>
<li>to compare distributions visually and check for outliers</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="ggplot2.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb80-2"><a href="ggplot2.html#cb80-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(<span class="at">x =</span> gapminder<span class="sc">::</span>gapminder)</span></code></pre></div>
<pre><code>## Rows: 1,704
## Columns: 6
## $ country   &lt;fct&gt; Afghanistan, Afghanistan, Afghanistan, Afghanistan, Afghani…
## $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia,…
## $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997,…
## $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.…
## $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 1…
## $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134,…</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="ggplot2.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## since the confidence intervals for the effect sizes are computed using</span></span>
<span id="cb82-2"><a href="ggplot2.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="do">## bootstrapping, important to set a seed for reproducibility</span></span>
<span id="cb82-3"><a href="ggplot2.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="do">## for reproducibility</span></span>
<span id="cb82-4"><a href="ggplot2.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-5"><a href="ggplot2.html#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb82-6"><a href="ggplot2.html#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="ggplot2.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="do">## plot</span></span>
<span id="cb82-8"><a href="ggplot2.html#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb82-9"><a href="ggplot2.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> iris,</span>
<span id="cb82-10"><a href="ggplot2.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x     =</span> Species,</span>
<span id="cb82-11"><a href="ggplot2.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y     =</span> Sepal.Length,</span>
<span id="cb82-12"><a href="ggplot2.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Distribution of sepal length across Iris species&quot;</span></span>
<span id="cb82-13"><a href="ggplot2.html#cb82-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/test-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-management-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descriptive-statistics-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
